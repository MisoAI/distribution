!function(){"use strict";try{if("undefined"!=typeof document){var e=document.createElement("style");e.appendChild(document.createTextNode(":root{--mfa-color-primary-10: #e5eefa;--mfa-color-primary-20: #d2e1f3;--mfa-color-primary-100: #0055cc;--mfa-color-secondary-100: #06aeb8;--mfa-color-neutral-10: #e5e7ea;--mfa-color-neutral-40: #8c8c8c;--mfa-color-neutral-60: #66707e;--mfa-color-neutral-80: #544f4f;--mfa-color-neutral-100: #001129;--miso-ask-combo-content-padding: 0 !important}.mfa-card{background-color:#fff;border:1px solid var(--mfa-color-neutral-10);border-radius:.25rem;padding:1.5rem}.mfa-card .mfa-card__header{color:var(--mfa-color-neutral-100);font-size:1.125rem;font-weight:600;margin-bottom:.75rem;font-family:Roboto,sans-serif;line-height:1.2}.mfa-ask-input .miso-search-box__input-group{border:none!important;align-items:center;padding-right:.25rem}.mfa-ask-input .miso-search-box__input{height:2.75rem}.mfa-ask-input .miso-search-box__input::-moz-placeholder{color:var(--mfa-color-neutral-60)!important}.mfa-ask-input .miso-search-box__input::placeholder{color:var(--mfa-color-neutral-60)!important}.mfa-ask-input .miso-search-box__button{background-color:var(--mfa-color-primary-100)!important;color:#fff!important;height:2.4rem;padding:.5rem 1.5rem!important;font-family:Roboto,sans-serif!important;font-size:.875rem!important;font-weight:600}.mfa-question-option{background-color:var(--mfa-color-primary-10);border-radius:.25rem;padding:.75rem;display:flex;align-items:center;gap:.5rem;cursor:pointer}.mfa-question-option svg{flex-shrink:0;color:var(--mfa-color-secondary-100)}.mfa-question-option .mfa-question-option__text{color:var(--mfa-color-neutral-100);font-family:Roboto,sans-serif;font-size:.875rem;font-weight:400}.mfa-question-option:hover{background-color:var(--mfa-color-primary-20)}miso-answer .miso-markdown p{line-height:1.5}miso-answer .miso-markdown li:not(:last-child){margin-bottom:1.25rem}.miso-list__item{border:none!important}.miso-list__item .miso-list__item-body{padding:0!important}.miso-list__item .miso-list__item-index{margin-top:-3px}.miso-ask-combo__related-resources-phrase{font-size:1.25rem!important;margin-bottom:1.5rem!important}miso-related-questions .miso-list__list{display:flex;flex-direction:column;gap:.75rem;list-style-type:none;padding-left:0!important}.mfa-answer-header{margin-top:1.5rem;margin-bottom:1.2rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}.mfa-answer-header.mfa-answer-header--unready{display:none}.mfa-answer-header__title{font-size:1.875rem;display:flex;flex-wrap:wrap}.mfa-answer-header__title miso-ask[status~=ready][visible-when~=ready]{display:flex!important;font-weight:700}.mfa-answer-header__title miso-ask[status~=ready][visible-when~=ready] .miso-text{font-size:1.875rem;line-height:1.5;margin:0}.mfa-answer-header__action{border:none;color:var(--mfa-color-primary-100);font-size:.875rem;font-weight:600;display:flex;align-items:center}.mfa-answer-header__action svg{width:1.25rem;height:1.25rem}.mfa-answer-header__action:hover{text-decoration:underline}.mfa-answer__info{display:flex;align-items:center;gap:.25rem;margin-bottom:1rem}.mfa-answer__info svg{color:var(--mfa-color-secondary-100)}.mfa-answer-container{display:flex;flex-direction:row;gap:4rem}.mfa-answer-main-block,.mfa-answer-secondary-block{width:50%}.mfa-answer-related{margin-top:2rem}.mfa-answer-footer{margin-bottom:4rem}.mfa-source-item__main-block{display:flex;flex-direction:column;gap:.5rem}.mfa-source-item__main-block .mfa-source-item__title{font-family:Roboto,sans-serif;font-size:.875rem;font-weight:600;line-height:1.2;color:var(--mfa-color-neutral-100)}.mfa-source-item__main-block .mfa-source-item__date{font-family:Roboto,sans-serif;font-size:.875rem;font-weight:400;line-height:1.5;letter-spacing:-.02em;color:var(--mfa-color-neutral-60)}.mfa-source-item__main-block .mfa-source-item__snippet{font-family:Roboto,sans-serif;font-size:.875rem;font-weight:400;line-height:1.2;color:var(--mfa-color-neutral-100)}.mfa-source-item__main-block .mfa-source-item__snippet mark{background-color:transparent}.mfa-source-item__main-block .mfa-source-item__actions{display:flex;align-items:center;gap:.5rem;color:var(--mfa-color-secondary-100);font-size:.875rem}miso-sources .miso-list__item{margin-top:.75rem!important;border-radius:0!important}miso-sources .miso-list__item:not(:last-child){padding-bottom:.75rem!important;border-bottom:1px solid #d9d9d9!important}miso-sources .miso-list__item-body:hover .mfa-source-item__actions{text-decoration:underline}.mfa-related-resource{width:100%;display:flex;gap:1.875rem;font-size:.875rem}.mfa-related-resource .miso-list__item-body{flex:1}.mfa-related-resource__tags{margin-bottom:.625rem}.mfa-related-resource__tag{font-size:.625rem;border-radius:.25rem;padding:.125rem .5rem;text-transform:uppercase}.mfa-related-resource__tag--ebook{background-color:#2062ce;color:#fff}.mfa-related-resource__title{font-size:1.25rem;line-height:1;font-weight:700;margin-bottom:.625rem;color:#333}.mfa-related-resource__array-data-group{display:flex;gap:.25rem}.mfa-related-resource__array-data-group:not(:last-child){margin-bottom:.25rem}.mfa-related-resource__array-data-label{font-weight:700;color:#544f4f;text-transform:capitalize}.mfa-related-resource__array-data-value{color:#8c8c8c}.mfa-related-resource__snippet{margin-top:.875rem;display:flex;gap:.5rem}.mfa-related-resource__snippet svg{margin-top:2px;color:var(--mfa-color-secondary-100)}.mfa-related-resource__snippet div{color:#333}.mfa-related-resource__snippet div mark{background-color:transparent}.mfa-related-resource__actions{width:9rem;display:flex;flex-direction:column;gap:.625rem}.mfa-related-resource__action{display:flex;align-items:center;gap:.5rem;cursor:pointer}.mfa-related-resource__action span{color:#2062ce}.mfa-related-resource__action:hover span{text-decoration:underline}.mfa-answer{padding-bottom:2rem}.mfa-source{padding-bottom:1.5rem}.mfa-answer-divider{margin-top:0!important;margin-bottom:2.5rem!important;background-color:transparent!important;background:repeating-linear-gradient(to right,#333333 0 4px,transparent 0 8px)}.mfa-followup-title{font-size:1.875rem;margin-bottom:1.25rem}.mfa-followup-title .mfa-followup-title__question{font-weight:700}.mfa-followup-title .miso-text{display:inline;font-size:1.875rem!important;line-height:1.5!important;margin:0!important}.miso-ask-combo__ask-this-book{height:100%}.mfa-ask-this-book{height:100%;font-size:.875rem;line-height:1.5rem}.mfa-ask-this-book .mfa-ask-input{padding:0 .625rem}.mfa-ask-this-book .mfa-ask-this-book__container{height:calc(600px - 4rem);padding:0 .625rem 2rem;overflow-y:auto}.mfa-ask-this-book .miso-search-box .miso-search-box__input-group{border:1px solid var(--miso-border-color-light)!important}.mfa-ask-this-book .miso-search-box .miso-search-box__input{font-size:.875rem!important}.mfa-ask-this-book .mfa-ask-input{margin-bottom:1.25rem}.mfa-ask-this-book__answer-title{font-weight:700;margin-bottom:.75rem}.mfa-ask-this-book__answer-title .miso-text{display:inline;font-size:.875rem!important;line-height:1.5rem!important;margin:0!important}.mfa-ask-this-book__explore--hide{display:none}.mfa-ask-this-book__info{font-size:.625rem;text-align:right;padding-right:.625rem}.mfa-ask-this-book__info--hide{display:none}.mfa-related-questions-container__header{font-family:Roboto,sans-serif;font-size:.875rem;font-weight:600;line-height:1.2;color:var(--mfa-color-neutral-100);margin-bottom:.75rem}.mfa-ask-this-book__tabs,.mfa-my-answers__tabs{display:flex;gap:1rem;border-bottom:1px solid var(--miso-border-color-light)}.mfa-ask-this-book__tabs .mfa-ask-this-book__tab,.mfa-ask-this-book__tabs .mfa-my-answers__tab,.mfa-my-answers__tabs .mfa-ask-this-book__tab,.mfa-my-answers__tabs .mfa-my-answers__tab{font-family:Roboto,sans-serif;font-size:.8rem;font-weight:600;letter-spacing:-.02em;padding:.1rem 0;cursor:pointer;color:var(--mfa-color-neutral-40)}.mfa-ask-this-book__tabs .mfa-ask-this-book__tab.mfa-ask-this-book__tab--active,.mfa-ask-this-book__tabs .mfa-ask-this-book__tab.mfa-my-answers__tab--active,.mfa-ask-this-book__tabs .mfa-my-answers__tab.mfa-ask-this-book__tab--active,.mfa-ask-this-book__tabs .mfa-my-answers__tab.mfa-my-answers__tab--active,.mfa-my-answers__tabs .mfa-ask-this-book__tab.mfa-ask-this-book__tab--active,.mfa-my-answers__tabs .mfa-ask-this-book__tab.mfa-my-answers__tab--active,.mfa-my-answers__tabs .mfa-my-answers__tab.mfa-ask-this-book__tab--active,.mfa-my-answers__tabs .mfa-my-answers__tab.mfa-my-answers__tab--active{color:var(--mfa-color-primary-100);border-bottom:2px solid var(--mfa-color-primary-100)}.mfa-ask-this-book__tabs{margin-bottom:1.25rem}.mfa-my-answers__tabs{margin-bottom:.5rem}.mfa-ask-this-book__tab-content,.mfa-my-answers__tab-content{display:none}.mfa-ask-this-book__tab-content.mfa-ask-this-book__tab-content--active,.mfa-ask-this-book__tab-content.mfa-my-answers__tab-content--active,.mfa-my-answers__tab-content.mfa-ask-this-book__tab-content--active,.mfa-my-answers__tab-content.mfa-my-answers__tab-content--active{display:block}.miso-user-history__empty{font-size:.875rem;color:var(--mfa-color-neutral-60);text-align:center;padding:1rem 0}.miso-user-history__list{list-style-type:none;padding-left:0}.miso-user-history__list .miso-user-history__item{cursor:pointer;padding:.75rem 0;font-size:.875rem;border-bottom:1px solid var(--miso-border-color-light)}.miso-user-history__list .miso-user-history__item:last-child{border-bottom:none}.miso-placeholder[data-v-96a45b61]{width:100%;display:flex;flex-direction:column;gap:1rem;justify-content:center;align-items:center;padding:2rem;background-color:#23449e;color:#fff;border-radius:.5rem}.miso-placeholder__button[data-v-96a45b61]{border:solid 1px #ffffff;padding:.4rem 2rem;min-width:14rem;border-radius:.5rem;cursor:pointer;font-size:.875rem}.miso-placeholder[data-v-ce19f90d]{width:100%;display:flex;flex-direction:column;gap:1rem;justify-content:center;align-items:center;padding:2rem;background-color:#23449e;color:#fff;border-radius:.5rem}.miso-placeholder__button[data-v-ce19f90d]{border:solid 1px #ffffff;padding:.4rem 2rem;min-width:14rem;border-radius:.5rem;cursor:pointer;font-size:.875rem}.miso-placeholder[data-v-b811650e]{width:100%;display:flex;flex-direction:column;gap:1rem;justify-content:center;align-items:center;padding:2rem;background-color:#23449e;color:#fff;border-radius:.5rem}.miso-placeholder__button[data-v-b811650e]{border:solid 1px #ffffff;padding:.4rem 2rem;min-width:14rem;border-radius:.5rem;cursor:pointer;font-size:.875rem}")),document.head.appendChild(e)}}catch(a){console.error("vite-plugin-css-injected-by-js",a)}}();
!function(){"use strict";const e="1.12.3-beta.6";function t(...e){const t=e.length;if(0===t)return(new AbortController).signal;if(1===t)return e[0];const s=new AbortController;for(const n of e)if(n&&n.addEventListener){if(n.aborted)return AbortSignal.abort(n.reason);n.addEventListener("abort",(()=>s.abort(n.reason)))}return s.signal}const s=Object.freeze({ASK:"ask",SEARCH:"search",RECOMMENDATION:"recommendation",INTERACTIONS:"interactions"}),n=Object.freeze({QUESTIONS:"questions",RELATED_QUESTIONS:"related_questions",TRENDING_QUESTIONS:"trending_questions",SEARCH:"search",AUTOCOMPLETE:"autocomplete",SEARCH_AUTOCOMPLETE:"search_autocomplete",MGET:"mget",USER_TO_PRODUCTS:"user_to_products",USER_TO_CATEGORIES:"user_to_categories",USER_TO_ATTRIBUTES:"user_to_attributes",USER_TO_TRENDING:"user_to_trending",USER_TO_HISTORY:"user_to_history",PRODUCT_TO_PRODUCTS:"product_to_products",UPLOAD:"upload"}),i=Object.freeze(Object.defineProperty({__proto__:null,GROUP:s,NAME:n},Symbol.toStringTag,{value:"Module"}));function o(e,t){if(!e)return;const s=e.indexOf(t);s>-1&&e.splice(s,1)}function r(e){return Array.isArray(e)?e:void 0===e?[]:[e]}function a(e){if("object"!=typeof e)return e;const t={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&void 0!==e[s]&&(t[s]=e[s]);return t}function c(e){return null==e}function l(e,t,s){s="string"==typeof s?[s]:s,Object.defineProperties(e,s.reduce(((e,s)=>(e[s]={get:()=>{const e=t[s];return"function"==typeof e?e.bind(t):e}},e)),{}))}function u(e,t){for(const s in t)t.hasOwnProperty(s)&&Object.defineProperty(e,s,{value:t[s]})}function d(e){return e.replace(/-([a-z])/g,(e=>e[1].toUpperCase()))}function h(e){return e.replace(/[-_][a-z]/g,(e=>e[1].toUpperCase()))}function _(e){return e.replace(/([A-Z])/g,"-$1").toLowerCase()}class p{constructor(e,{duration:t=0,onDuration:s,offDuration:n,state:i}={}){if("function"!=typeof e)throw new Error(`Callback must be a function: ${e}`);this._callback=e,Object.defineProperty(this,"durations",{value:Object.freeze({on:void 0!==s?s:t,off:void 0!==n?n:t})}),this._value=this._state=!!i,this._active=!0}get active(){return this._active}get state(){return this._state}get value(){return this._value}set value(e){if(e=!!e,this._value===e)return;!function(e){if(!e._timeout)return;clearTimeout(e._timeout),e._timeout=void 0}(this);const t=this.durations[e?"on":"off"];t?this._timeout=setTimeout((()=>f(this,e)),t):f(this,e),this._value=e}disconnect(){this._active=!1}}function f(e,t){e._state!==t&&(e._state=t,e._active&&e._callback(t))}function m(e,t,{root:s=e.ownerDocument}={}){for(;e&&e!==s;e=e.parentElement){const s=t(e);if(void 0!==s)return s}}function g(e){const{tagName:t}=e;customElements.define(t,e);for(const s of document.querySelectorAll(t))customElements.upgrade(s)}async function y(e){return new Promise(((t,s)=>{window.requestAnimationFrame((async n=>{try{await e(n),t()}catch(i){s(i)}}))}))}async function b(e,{area:t=.5,duration:s=1e3,signal:n}={}){var i;return e="string"==typeof(i=e)?document.querySelector(i):i,new Promise(((i,o)=>{const r=new p((e=>{e&&(r.disconnect(),a.disconnect(),i())}),{onDuration:s}),a=new IntersectionObserver((e=>{r.value=e[0].isIntersecting}),{threshold:t});a.observe(e),n&&n.addEventListener&&n.addEventListener("abort",(()=>{r.disconnect(),a.disconnect(),o(new DOMException("Aborted","AbortError"))}))}))}function v(e){return(e=`${e}`)&&e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function w(){return(crypto&&crypto.randomUUID?crypto.randomUUID():void 0)||function(){if(!URL||!URL.createObjectURL||URL.revokeObjectURL||!Blob)return;const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.substring(t.lastIndexOf("/")+1)}()||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function k(e,t){const s=S((()=>window.localStorage.getItem(e))),n=S((()=>function(e){const t=`; ${document.cookie}`,s=`; ${encodeURIComponent(e)}=`,n=t.indexOf(s);if(n<0)return;const i=n+s.length,o=t.indexOf(";",i);return decodeURIComponent(o<0?t.substring(i):t.substring(i,o))}(e))),i=s||n||`${t()}`;return i&&!s&&S((()=>window.localStorage.setItem(e,i))),i&&!n&&S((()=>function(e,t){document.cookie=`${encodeURIComponent(e)}=${encodeURIComponent(t)}; max-age=31536000; path=/`}(e,i))),i}function S(e){try{return e()}catch(t){if(!function(e){return"SecurityError"===e.name}(t))throw t}}function E(e){return new C(e)}class C{constructor(e){this._value=e;const t=e=>{this._value=e};u(this,{set:t,args:(...e)=>t(e),t:()=>t(!0),f:()=>t(!1),merge:e=>t({...this._value,...e})})}get value(){return this._value}}class x{constructor(){const e=this;e.promise=new Promise(((t,s)=>{e.resolve=t,e.reject=s})),Object.freeze(this)}}class O{constructor(){this._index=-1,this._done=!1,this._aborted=!1,this._abortReason=void 0,this._error=void 0}get aborted(){return this._aborted}get abortReason(){return this._abortReason}get done(){return this._done}update(e,t=!1){this._done||(this._value=e,this._done=t,this._index++,this._resolution&&(this._resolution.resolve(),this._resolution=void 0))}error(e){this._error=e,this._resolution&&(this._resolution.reject(e),this._resolution=void 0)}abort(e){this._aborted=!0,this._abortReason=e,this._resolution&&(e instanceof Error?this._resolution.reject(e):this._resolution.resolve(),this._resolution=void 0)}async*[Symbol.asyncIterator](){let e=0;for(;;){if(this._error)throw this._error;if(this._aborted)break;if(e>this._index&&(this._resolution||(this._resolution=new x),await this._resolution.promise),this._aborted)break;const t=this._done,s=this._index+1;if(yield this._value,this._aborted||t)break;e=s}}}function I(e,t){const s=window[e]||(window[e]=[]);if(s._processed)return;s._processed=!0;const n=e=>function(e,{onError:t=e=>console.error(e),transform:s=e=>e}={}){try{s(e)()}catch(n){t(n)}}(e,t);Object.defineProperty(s,"push",{value:n});for(const i of s)n(i)}let T;try{T=document.currentScript}catch(X_){}async function A(e){try{let t=function(e){return document.head.querySelector(`link[href="${e}"]`)}(e);return t||(t=document.createElement("link"),t.rel="stylesheet",t.href=e,document.head.appendChild(t)),async function(e){await async function(e){if(e.sheet)return;return new Promise(((t,s)=>{let n;e.onerror=()=>{n&&clearInterval(n),s()},n=setInterval((()=>{e.sheet&&(n&&clearInterval(n),t())}),100)}))}(e),await async function(e){if(N(e))return;return new Promise((t=>{let s;s=setInterval((()=>{N(e)&&(s&&clearInterval(s),t())}),100)}))}(e)}(t)}catch(X_){console.error(X_)}}function R(e){return`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@1.12.3-beta.6/dist/css/${e}.css`}function N(e){for(const t of document.styleSheets)if(t.ownerNode===e)return!0;return!1}function $(e){let t;return s=>{t&&clearTimeout(t),t=setTimeout((()=>{t=void 0,s()}),e)}}function P(e,{depth:t=5,...s}={}){return L(e,t)}function L(e,t,s){return t<=0?"(...)":"object"==typeof e&&e?void 0!==e.length?Array.prototype.map.call(e,(e=>L(e,t-1))):e instanceof Node?function(e){if(e instanceof Element)return`<${e.tagName.toLowerCase()}${e.id?` id="${e.id}"`:""}${e.className?` class="${e.className}"`:""}>`;return`[TextNode](${e.length})`}(e):function(e,t){const s={};if(t<=0)return s;for(const n in e){const i=e[n];"function"!=typeof i&&(n.startsWith("_")&&"object"==typeof i&&"Object"!==i.constructor.name||(s[n]=L(i,t-1)))}return s}(e,t):e}function q(e,t){const s=Object.getOwnPropertyDescriptors(t),n=Object.getOwnPropertyDescriptors(e);for(const[i,o]of Object.entries(s))"constructor"!==i&&void 0===n[i]&&Object.defineProperty(e,i,o)}function U(e){const t={},s=new Set;for(let n=e;n!==Object.prototype;n=Object.getPrototypeOf(n)){const i=Object.getOwnPropertyDescriptors(n);for(const n in i){if("constructor"===n||n.startsWith("_")||s.has(n))continue;s.add(n);const{value:o}=i[n];o&&(t[n]="function"==typeof o?o.bind(e):o)}}return Object.freeze(t)}function M(e={},t={}){const s=e.metadata||t.metadata?a({...e.metadata,...t.metadata}):void 0,n=e._meta||t._meta?a({...e._meta,...t._meta}):void 0;return a({...e,...t,metadata:s,_meta:n})}function j(e={},t={}){const s=e.context&&e.context.custom_context||t.context&&t.context.custom_context?a({...e.context&&e.context.custom_context,...t.context&&t.context.custom_context}):void 0,n=e.context||t.context?a({...e.context,...t.context,custom_context:s}):void 0;return a({...e,...t,context:n})}function D(e){const t=function({speed:e=100,acceleration:t=4}={}){if("function"==typeof e)return e;if("number"!=typeof e)throw new Error(`Invalid speed: ${e}`);if("number"!=typeof t)throw new Error(`Invalid acceleration: ${t}`);return(s,n)=>{let i=e*(Math.random()+.5);return t>0&&void 0!==n&&s>n&&(i*=1+(s-n)*t/1e3),i}}(e);return(e,s,n,i)=>{const o=t(n,s);return e+Math.max(i-n,0)*o/1e3}}const F=Symbol.for("miso:resources");class B{constructor(){this._resources=new Map;const e=window[F]||[];for(const s of e)try{const[e,t]=s;this.push([e,t])}catch(t){}}push([e,t]){z(this._resources,e).resolve(t)}async get(e){return z(this._resources,e).promise}}function z(e,t){if(e.has(t))return e.get(t);const s=new x;return e.set(t,s),s}function H(){return window[F]||(window[F]=new B)}class Q{constructor(e,t){this._dispatchRequested=!1,this._requests=[],this._run=e,this._error=t||(e=>console.error(e)),this._bulkId=0,this._dispatch=this._dispatch.bind(this)}get info(){return{bulkId:this._bulkId,index:this._requests.length}}async run(e){const t=new x;return this._requests.push({action:e,resolution:t}),this._requestDispatch(),t.promise}_requestDispatch(){this._dispatchRequested||(this._dispatchRequested=!0,setTimeout(this._dispatch))}_dispatch(){if(!this._dispatchRequested)return;this._dispatchRequested=!1;const e=this._requests,t=this._bulkId++;this._requests=[];try{this._run(e,{bulkId:t})}catch(X_){this._error(X_)}}}class V{constructor({target:e,error:t,replays:s=[]}={}){if(this._error=t||(e=>console.error(e)),!Array.isArray(s))throw new Error(`Replays option must be an array of strings: ${s}`);this._replays=new Set(s),this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={},e&&this._injectSubscribeInterface(e)}emit(e,t){const s={data:t,meta:{name:e,ts:Date.now()}},n=this._namedCallbacks[e];if(n)for(const i of n)i(s);for(const i of this._unnamedCallbacks)i(s);this._shallStoreForReplay(e)&&(this._pastEvents[e]||(this._pastEvents[e]=[])).push(s)}on(e,t){return this._checkName(e),this._checkCallback(t),this._on(e,this._wrapCallback(t))}once(e){this._checkName(e);const t=this;return new Promise(((s,n)=>{const i=t._on(e,(e=>{setTimeout((()=>i()));try{s(e)}catch(X_){n(X_)}}))}))}clear(){this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={}}_checkName(e){if("string"!=typeof e)throw new Error(`Event name should be a string: ${e}`)}_checkCallback(e){if("function"!=typeof e)throw new Error(`Event callback should be a function: ${e}`)}_shallStoreForReplay(e){return this._replays.has(e)}_wrapCallback(e){const t=this;return({data:s,meta:n})=>{try{e(s,n)}catch(X_){t._error(X_)}}}_on(e,t){if("*"===e?this._unnamedCallbacks.push(t):(this._namedCallbacks[e]||(this._namedCallbacks[e]=[])).push(t),"*"===e)for(const s in this._pastEvents)this._pastEvents[s].forEach(t);else this._pastEvents[e]&&this._pastEvents[e].forEach(t);return()=>this._off(e,t)}_off(e,t){if("*"===e)o(this._unnamedCallbacks,t);else{const s=this._namedCallbacks[e];s&&o(s,t)}}_injectSubscribeInterface(e){l(e,this,["on","once"])}}function G(e,t){return Object.freeze([...t&&t.meta&&t.meta.path||[],...e?[e]:[]])}class W{constructor(e,t){const s=function(e,t){if(void 0!==e&&"string"!=typeof e&&void 0===t&&(t=e,e=void 0),void 0!==e&&("string"!=typeof e||!e))throw new Error(`Invalid Component name: "${e}"`);return Object.freeze({name:e,parent:t,path:G(e,t),uuid:w()})}(e,t);u(this,{meta:s});const n=this._error=this._error.bind(this);this._events=new V({target:this,error:n,replays:["child"]}),this._warn=this._warn.bind(this),(t=s.parent)&&t._events&&t._events.emit("child",this)}_warn(...e){const t=this.meta.parent;(t&&t._warn||console.warn)(...e)}_error(...e){const t=this.meta.parent;(t&&t._error||console.error)(...e)}}!function(e,t){const s=Symbol.for(t);Object.defineProperty(e,s,{value:!0}),Object.defineProperty(e,"isTypeOf",{value:t=>t&&t instanceof e||"function"==typeof t.constructor&&!0===t.constructor[s]})}(W,"miso:component");class K extends W{constructor(e,t,{libName:s,keyName:n}={}){switch(super(e,t),this._events._replays.add("register"),this._libraries={},this._libResolutions={},this._libName=s,typeof n){case"string":this._keyFn=e=>e[n];break;case"function":this._keyFn=n;break;default:throw new Error(`Expect keyName to be a string or a function: ${n}`)}}isRegistered(e){return this._checkKey(e),!!this._libraries[e]}get registered(){return Object.values(this._libraries)}async whenRegistered(e){if(this.isRegistered(e))return this._libraries[e];const{promise:t}=this._libResolutions[e]||(this._libResolutions[e]=new x);return t}register(...e){for(const t of e)this._register(t)}_checkKey(e){if("string"!=typeof e||!e)throw new Error(`Expect key to be a non-empty string: ${e}`)}_checkLib(e){if("function"!=typeof e)throw new Error(`Expect lib to be a class or function: ${e}`)}_register(e){this._checkLib(e);const t=this._keyFn(e);this._checkKey(t);const s=this._libraries||(this._libraries={});s[t],s[t]=e,this._libResolutions[t]&&this._libResolutions[t].resolve(e),this._events.emit("register",e)}}class Y{constructor(e,t){this._callback=e,this._options=t||{},!1!==t&&(this._intersection=new IntersectionObserver(this._handleIntersection.bind(this),{threshold:t.area||.5}),this._continuity=new p(this._handleContinuity.bind(this),{onDuration:t.duration||1e3})),this._displayed=void 0,this._intersecting=!1,this._triggered=new Set}observe(e){!1!==this._options&&this._intersection.observe(e)}unobserve(e){!1!==this._options&&this._intersection.unobserve(e)}display(e){!1!==this._options&&(this._triggered.has(e)&&(e=void 0),this._displayed!==e&&(this._displayed=e,this._continuity.value=!1,this._syncContinuity()))}disconnect(){!1!==this._options&&(this._continuity.disconnect(),this._intersection.disconnect())}get triggeredCount(){return this._triggered.size}get triggered(){return new Set(this._triggered)}_syncContinuity(){this._continuity.value=this._intersecting&&void 0!==this._displayed}_handleIntersection(e){this._intersecting=e[0].isIntersecting,this._syncContinuity()}_handleContinuity(e){const t=this._displayed;if(e&&void 0!==t){if(this._triggered.has(t))return;this._triggered.add(t),this._displayed=void 0,this._callback(t)}}}class Z{constructor(e){this._ac=new AbortController,this._timeout=e,this.touch()}clear(){void 0!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0)}touch(){this.clear(),this._timeoutId=setTimeout((()=>this.abort()),this._timeout)}get signal(){return this._ac.signal}abort(e){this.clear(),this._ac.abort(e||new Error(`Stall timeout: data stay unchanged for ${this._timeout/1e3} seconds.`))}}const J=Object.freeze({DATA_ENDPOINT:"https://api-edge.askmiso.com/v1",EVENT_ENDPOINT:"https://api.askmiso.com/v1"});class X{constructor(e,t){this._client=e,this._root=t,this._bulk=new Q(this._runBulkFetch.bind(this),e._error.bind(e))}async fetch(e,t,{method:s="POST",headers:n,timeout:i}={}){const{apiKey:o,request:r={}}=this._client.options;i=i||r.timeout;const c="GET"!==s&&null!=t?JSON.stringify(t):void 0,l=i?AbortSignal.timeout(i):void 0,u=await(this._root._customFetch||window.fetch)(e,a({method:s,headers:n,body:c,cache:"no-cache",mode:"cors",signal:l})),d=await u.json();if(u.status>=400||d.errors){var h=new Error(d.message);throw h.data=d,h.status=u.status,h}return d}get bulkInfo(){return this._bulk.info}async fetchForBulk(e,t,s,{method:n}={}){if(n&&"POST"!==n)throw new Error(`Non-POST API is not supported in bulk mode: ${url}`);return this._bulk.run({apiGroup:e,apiName:t,payload:s})}async _runBulkFetch(e){const t=this.url(["bulk"]),s={requests:e.map((({action:{apiGroup:e,apiName:t,payload:s}})=>({api_name:`${e}/${t}`,body:s})))},{data:n}=await this.fetch(t,s);for(let i=0,o=e.length;i<o;i++){const{resolution:t}=e[i],{error:s,status_code:o,body:r}=n[i];o>=400||s?t.reject({status_code:o,body:r}):t.resolve(r)}}sendBeacon(e,t,{method:s}={}){if(s&&"POST"!==s)throw new Error(`Non-POST API is not supported in useBeacon mode: ${e}`);if(!(this._root._customSendBeacon?this._root._customSendBeacon(e,JSON.stringify(t)):window.navigator.sendBeacon(e,JSON.stringify(t))))throw new Error(`Send beacon unsuccessful: ${e}`)}url(e){const{apiKey:t}=this._client.options,s=e.filter((e=>e)).join("/");return`${`${this.getApiEndpoint(s)}/${s}`}?api_key=${window.encodeURIComponent(t)}`}getApiEndpoint(e){const{dataEndpoint:t=J.DATA_ENDPOINT,eventEndpoint:s=J.EVENT_ENDPOINT}=this._client.options;return"interactions"===e?s:t}applyUrlPasses(e,{apiGroup:t,apiName:s,url:n}){const i=this._client;for(const o of this._root._urlPasses)try{n=o({client:i,apiGroup:t,apiName:s,url:n})||n}catch(X_){(e._error||console.error)(X_)}return n}applyPayloadPasses(e,{apiGroup:t,apiName:s,payload:n}){const i=this._client;for(const o of this._root._payloadPasses)try{n=o({client:i,apiGroup:t,apiName:s,payload:n})||n}catch(X_){(e._error||console.error)(X_)}return n}applyHeaderPasses(e,{apiGroup:t,apiName:s,payload:n,headers:i,options:o}){const r=this._client;for(const a of this._root._headersPasses)try{i=a({client:r,apiGroup:t,apiName:s,payload:n,headers:i,options:o})||i}catch(X_){(e._error||console.error)(X_)}return i}}class ee extends W{constructor(e,t){super(t,e),this._apiPath=t,this.helpers=e.helpers,this.clientOptions=e._client.options,this.context=e._client.context}async _run(e,t,s={}){const{bulk:n}=s,i=n?{bulk:this.helpers.bulkInfo}:void 0,o=this._apiPath,r=this._url({apiGroup:o,apiName:e,payload:t,options:s}),a=this._headers({apiGroup:o,apiName:e,payload:t,options:s}),c={apiGroup:o,apiName:e,payload:t=this._preprocess({apiGroup:o,apiName:e,payload:t,options:s}),url:r,headers:a,options:s};this._events.emit("request",{...c,...i});const l=await this._send(c),u={...c,response:l};return this._events.emit("response",{...u,...i}),this._postprocess(u)}_headers({apiGroup:e,apiName:t,payload:s,options:n}){return this.helpers.applyHeaderPasses(this,{apiGroup:e,apiName:t,payload:s,headers:{},options:n})}_preprocess({apiGroup:e,apiName:t,payload:s,options:n}){return this.helpers.applyPayloadPasses(this,{apiGroup:e,apiName:t,payload:s,options:n})}_url({apiGroup:e,apiName:t,options:s}){const n=this.helpers.url([e,t],s);return this.helpers.applyUrlPasses(this,{apiGroup:e,apiName:t,url:n,options:s})}async _send({apiGroup:e,apiName:t,url:s,headers:n,payload:i,options:{bulk:o,...r}={}}){return o?this.helpers.fetchForBulk(e,t,i):this.helpers.fetch(s,i,{...r,headers:n})}_postprocess({response:e}){return e.data}}const{GROUP:te,NAME:se}=i;class ne extends ee{constructor(e){super(e,te.INTERACTIONS)}async upload(e,t){try{return await this._run(se.UPLOAD,e,t)}catch(X_){if(!(400===X_.status&&X_.message&&X_.message.toLowerCase().indexOf("playground")>-1))throw X_;this._warn("Ignore interactions uploaded to playground app.")}}_url({apiGroup:e,apiName:t,options:s}){const n=this.helpers.url([this._apiPath],s);return this.helpers.applyUrlPasses(this,{apiGroup:e,apiName:t,url:n,options:s})}_preprocess({apiGroup:e,apiName:t,payload:s}){return t===se.UPLOAD&&(s=this._normalizeUploadPayload(s)),super._preprocess({apiGroup:e,apiName:t,payload:s})}_normalizeUploadPayload(e){if("object"!=typeof e)throw new Error(`Interactions payload has to be either an object or an array of objects: ${e}`);return Array.isArray(e)||(e=[e]),{data:e}}async _send({options:{useBeacon:e=!0,...t}={},...s}){if(e){const{url:e,payload:n}=s;return this.helpers.sendBeacon(e,n,t),{}}return super._send({...s,options:t})}}class ie{constructor(e={}){this._ac=new AbortController,this._options=e}async get(e){return this._get({...this._options,...e})}_get(e){throw new Error("Not implemented")}abort(e){this._ac.abort(e)}[Symbol.asyncIterator](){let{pollingInterval:e,signal:s,stallTimeout:n=12e4,...i}=this._options;const o=new Z(n);let r;s=t(this._ac.signal,o.signal,s);return function(e,{interval:t=1e3,errorLimit:s=10,onError:n,onResponse:i,signal:o}={}){if(o&&o.aborted)return[];let r,a,l=0,u=!1;function d(){r&&clearInterval(r),u=!0}const h=new O;return r=setInterval((async()=>{let t,r,_;try{if([t,r,_]=await e(o?{signal:o}:{}),u||!c(a)&&_<=a)return;c(_)||(a=_),i&&i(t,r,_),l=0}catch(p){return n&&n(p),l++,void(l>s&&(d(),h.error(p)))}h.update(t,r),r&&d()}),t),o&&o.addEventListener&&o.addEventListener("abort",(()=>{d(),h.abort(o.reason)})),h}((async({signal:e}={})=>{const t=await this.get();return[t,this._isFinished(t),this._revisionOf(t)]}),{interval:e,signal:s,onResponse:(e,t)=>{t?o.clear():this._isUpdated(r,e)&&o.touch(),r=e},...i})[Symbol.asyncIterator]()}_isFinished(e){return!(!e||!e.finished)}_isUpdated(e,t){return!e||e.answer_stage!==t.answer_stage||re(e.answer)!==re(t.answer)||re(e.reasoning)!==re(t.reasoning)}_revisionOf(e){return e&&e.revision}}class oe extends ie{constructor(e,t,s,n){super(n),this._api=e,this._method=t,this._id=s}async _get(e){return this._api[this._method](this._id,e)}}function re(e=""){return e.length}const{GROUP:ae,NAME:ce}=i;let le=class extends ee{constructor(e){super(e,ae.ASK)}async questions(e,t={}){var s;if("string"==typeof(s=e)&&"{"!==s.charAt(0)&&(e={question_id:e}),e.question_id)return new ue(this,e,t);const n=await this._run(ce.QUESTIONS,e,t);return new ue(this,n,t)}async _questions(e,t){return this._run(ce.QUESTIONS,e,t)}async _questionGet(e,t){return this._run(`${ce.QUESTIONS}/${e}/answer`,void 0,{...t,method:"GET"})}async relatedQuestions(e,t={}){return this._run(ce.RELATED_QUESTIONS,e,t)}async trendingQuestions(e,t={}){return this._run(ce.TRENDING_QUESTIONS,e,t)}async search(e,t={}){const s=await this._run(ce.SEARCH,e,t);return s.question_id?new de(this,s,t):s}async _searchGet(e,t){return this._run(`${ce.QUESTIONS}/${e}/answer`,void 0,{...t,method:"GET"})}async autocomplete(e,t){return this._run(ce.AUTOCOMPLETE,e,t)}async searchAutocomplete(e,t){return this._run(ce.SEARCH_AUTOCOMPLETE,e,t)}};class ue extends oe{constructor(e,t,s={}){super(e,"_questionGet",t.question_id,s),this._response=t}get questionId(){return this._id}}class de extends oe{constructor(e,t,s={}){super(e,"_searchGet",t.question_id,s),u(this,t),this._response=t}get questionId(){return this._id}}const{GROUP:he,NAME:_e}=i;let pe=class extends ee{constructor(e){super(e,he.SEARCH)}async search(e,t){return this._run(_e.SEARCH,e,t)}async autocomplete(e,t){return this._run(_e.AUTOCOMPLETE,e,t)}async multipleGet(e,t){return this._run(_e.MGET,e,t)}};const{GROUP:fe,NAME:me}=i;let ge=class extends ee{constructor(e){super(e,fe.RECOMMENDATION)}async userToProducts(e,t){return this._run(me.USER_TO_PRODUCTS,e,t)}async userToCategories(e,t){return this._run(me.USER_TO_CATEGORIES,e,t)}async userToAttributes(e,t){return this._run(me.USER_TO_ATTRIBUTES,e,t)}async userToTrending(e,t){return this._run(me.USER_TO_TRENDING,e,t)}async userToHistory(e,t){return this._run(me.USER_TO_HISTORY,e,t)}async productToProducts(e,t){return this._run(me.PRODUCT_TO_PRODUCTS,e,t)}};class ye extends W{constructor(e,t){super("api",e),this._client=e,this.helpers=new X(e,t),this.interactions=new ne(this),this.ask=new le(this),this.search=new pe(this),this.recommendation=new ge(this)}}const be=Object.freeze(Object.defineProperty({__proto__:null,Api:ye,ApiBase:ee,ApiHelpers:X,Ask:le,Interactions:ne,Recommendation:ge,Search:pe},Symbol.toStringTag,{value:"Module"}));let ve=class extends W{constructor(e){super("context",e),this._client=e}};const we={api:be,context:{Context:ve}};class ke{constructor(e){u(this,{install:e})}}class Se extends K{constructor(e){super("plugins",e,{libName:"plugin class",keyName:"id"}),this._root=e,this._currentScript=document.currentScript,this._events._replays.add("install").add("subtree"),this._installed={},this._installedResolutions={},this._useRequests={},this._subtrees=[],this.context=new Ee(this,we),this.plugins=new Ce(this)}isInstalled(e){return this._checkKey(e),!!this._installed[e]}get installed(){return Object.values(this._installed)}get(e){return this._installed[e]}getPluginClass(e){return this._libraries[e]}use(e,t){if("function"==typeof e&&e.id&&"string"==typeof e.id)return this.register(e),void this.use(e.id,t);let s;if("string"==typeof e&&this.isInstalled(e))return s=this.get(e),void this._tryConfig(s,t);"string"!=typeof e||this.isRegistered(e)?(s=this._instantiate(e,t),this._install(s)):(this._useRequests[e]||(this._useRequests[e]=[])).push(t)}async install(e,t){return this.use(e,t),"string"!=typeof e||this.isRegistered(e)||await this._tryRegisterRemotely(e),this.whenInstalled(e)}async whenInstalled(e){if("function"==typeof e&&e.id&&"string"==typeof e.id&&(e=e.id),this.isInstalled(e))return this.get(e);const{promise:t}=this._installedResolutions[e]||(this._installedResolutions[e]=new x);return t}addSubtree(e){this._subtrees.push(e),this._events.emit("subtree",e)}addPayloadPass(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._payloadPasses.push(e)}addHeadersPass(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._headersPasses.push(e)}addUrlPass(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._urlPasses.push(e)}setCustomFetch(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._customFetch=e}setCustomSendBeacon(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._customSendBeacon=e}onHubUpdate(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._hubUpdateCallbacks.push(e)}onHubEmit(e){if("function"!=typeof e)throw new Error(`Expect parameter to be a function: ${e}`);this._root._hubEmitCallbacks.push(e)}_tryConfig(e,t){void 0!==t&&("function"==typeof e.config?(e.config(t),this._events.emit("config",[e,t])):this._warn(`Attempt to pass options to plugin "${e.id}", which offers no config() method.`))}_instantiate(e,t){switch(typeof e){case"string":this._checkKey(e);const s=this._libraries[e];if(!s)throw new Error(`Plugin class not found: ${e}`);const n=new s;return u(n,{id:e}),this._tryConfig(n,t),n;case"function":return new ke(e)}throw new Error(`Unexpected parameters: ${e}`)}_install(e){if("function"!=typeof e.install)throw new Error(`Expect plugin.install to be a function: ${e}`);try{e.installed=!1,e.install(this.MisoClient,this.context),e.installed=!0}catch(X_){throw X_}e.id&&(this._installed[e.id]=e,this._installedResolutions[e.id]&&(this._installedResolutions[e.id].resolve(e),delete this._installedResolutions[e.id])),this._events.emit("install",e)}_register(e){super._register(e),this._fulfillUseRequests(e.id)}_fulfillUseRequests(e){const t=this._useRequests[e];if(t){for(const s of t)try{this.use(e,s)}catch(X_){this._error(X_)}delete this._useRequests[e]}}async _tryRegisterRemotely(e){if(e.startsWith("std:"))try{return void(await this._registerStdRemotely(e))}catch(X_){console.error(X_)}throw new Error(`Cannot register plugin remotely: ${e}`)}async _registerStdRemotely(e){const{version:t}=this._root,s="dev"===t?`plugin:${e}@dev:${this.MisoClient.uuid}`:`plugin:${e}@${t}`;if(!document.querySelector(`script[data-request="${s}"]`)){const n=document.createElement("script");n.async=!0,n.src=function(e,t,s){const n=e.slice(4);if("dev"===t){const e=s.src,t=e.indexOf("?"),i=t<0?e.length:t,o=e.lastIndexOf("/",i)+1,r=e.indexOf(".",o),a=r<0?"":e.slice(r,i);return`${e.slice(0,o)}plugins/${n}${a}`}return`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@${t}/dist/umd/plugins/${n}.min.js`}(e,t,this._currentScript),n.setAttribute("data-request",s),document.head.appendChild(n)}const n=await(new H).get(s);!this.isRegistered(e)&&this.register(n)}}class Ee{constructor(e,t){l(this,e,["getPluginClass","addSubtree","addPayloadPass","addHeadersPass","addUrlPass","setCustomFetch","setCustomSendBeacon","onHubUpdate","onHubEmit","whenInstalled","whenRegistered"]),u(this,{classes:t})}}class Ce{constructor(e){l(this,e,["installed","registered","isInstalled","isRegistered","whenInstalled","whenRegistered","get","register","use","install"])}}const xe=new class extends W{constructor(){super(),this._events._replays.add("create"),this._pluginRoot=new Se(this),this._clients=[],this._payloadPasses=[],this._headersPasses=[],this._urlPasses=[],this._customFetch=void 0,this._customSendBeacon=void 0,this._hubUpdateCallbacks=[],this._hubEmitCallbacks=[],this.version=e,this._cmdRes=new x}get instances(){return[...this._clients]}async any(){return this._clients[0]||this._any||(this._any=(await this._events.once("create")).data)}get cmdDone(){return this._cmdRes.promise}};const Oe=Object.freeze(Object.defineProperty({__proto__:null,debounce:$,viewable:b},Symbol.toStringTag,{value:"Module"})),{currentScript:Ie}=document;let Te=class e extends W{static attach(){(window.MisoClients||(window.MisoClients=[])).push(e),window.MisoClient?window.MisoClient!==e&&console.warn(`window.MisoClient already exists: (${window.MisoClient.version}).`):window.MisoClient=e}static debug(){}constructor(e){var t;super("client",xe),this._config(e),this.context=new ve(this),this.api=new ye(this,xe),t=this,xe._clients.push(t),xe._events.emit("create",t)}get version(){return e.version}_config(e){this.options=Object.freeze(this._normalizeOptions(e))}_normalizeOptions(e={}){if("string"==typeof e&&(e={apiKey:e}),e.readConfigFromScriptUrl&&(e={...this._readConfigFromScriptUrl(),...e}),!e.apiKey)throw new Error("Require API key to initialize miso client.");return e.request&&e.request.sendApiKeyByHeader&&console.warn('`sendApiKeyByHeader` option is deprecated. Please call `MisoClient.plugins.use("std:header-api-key");` instead.'),e.dataEndpoint=e.dataEndpoint||e.apiHost,e.eventEndpoint=e.eventEndpoint||e.apiHost,delete e.apiHost,a(e)}_readConfigFromScriptUrl(){const e=Ie.src||Ie.href;return a({apiKey:new URL(new Request(e).url).searchParams.get("api_key")||void 0})}};Te.helpers=Oe,u(Te,{uuid:w()});const Ae=function(e){const t=xe._pluginRoot;return xe.MisoClient=t.MisoClient=e,l(e,xe,["version","instances","any","meta","on","once","cmdDone"]),l(e,t,["plugins"]),e}(Te),{GROUP:Re,NAME:Ne}=i;let $e;class Pe{constructor(e){this._plugin=e,this._props={}}get anonymous_id(){return this._props.anonymous_id||$e||($e=k("miso_anonymous_id",w))}set anonymous_id(e){this._requireString("anonymous_id",e),this._set("anonymous_id",e)}get user_id(){return this._props.user_id}set user_id(e){this._requireString("user_id",e),this._set("user_id",e)}get user_hash(){return this._props.user_hash}set user_hash(e){this._requireString("user_hash",e),this._set("user_hash",e)}get user_type(){return this._props.user_type}set user_type(e){this._requireString("user_type",e),this._set("user_type",e)}get site(){return this._props.site}set site(e){this._requireString("site",e),this._set("site",e)}get auth(){return this._props.auth}set auth(e){this._requireString("auth",e),this._set("auth",e)}_set(e,t){this._props[e]=t,this._plugin._events.emit("set",`${e} = '${t}'`)}_requireString(e,t){if("string"!=typeof t&&void 0!==t)throw new Error(`${e} must be a string`);return t}}function Le(){const e=new URLSearchParams(window.location.search);let t=a({source:e.get("utm_source")||void 0,medium:e.get("utm_medium")||void 0,name:e.get("utm_campaign")||void 0,term:e.get("utm_term")||void 0,content:e.get("utm_content")||void 0});return 0===Object.keys(t).length?void 0:t}class qe{constructor(e){this._plugin=e,this._config={search:!0},this.interface=Object.freeze({config:this.config.bind(this)})}config(e={}){if("object"!=typeof e)throw new Error(`Config options must be an object or undefined: ${e}`);for(const t of e){if(!this._config.hasOwnProperty(t))continue;const s=this._config[t],n=e[t];n!==s&&(this._config[t]=s,this._plugin._events.emit("config",`${t}: ${s} -> ${n}`))}return Object.freeze({...this._config})}}function Ue(t){const{context:s={}}=t,n={...s.custom_context,sdk_version:e};return n.uuid||(n.uuid=w()),{...t,context:{...s,custom_context:n}}}const Me="std:native-fetch";let je,De;const Fe=(()=>{if(window.fetch.toString().indexOf("[native code]")>-1)return je="original",window.fetch;try{const e=document.createElement("iframe");return e.style.display="none",document.head.appendChild(e),je="borrowed",e.contentWindow.fetch}catch(X_){De=X_}})();const Be="std:header-api-key";const ze="miso-logdump",He="miso-logdump",Qe=`${He}__download-btn`,Ve="Miso Log";class Ge{constructor(e={}){this._options=e,this._logs=[]}config(e={}){this._options={...this._options,...e}}async showDownloadButton(){await async function(){return Ze||(Ze=A(R("logdump")))}();let e=document.getElementById(ze);if(!e){const t=document.createElement("div");t.textContent=this._options.logDownloadButtonText||Ve,t.classList.add(Qe),t.addEventListener("click",(()=>this.download())),e=document.createElement("div"),e.id=ze,e.classList.add(He),e.appendChild(t),document.body.appendChild(e)}e.style.display="block"}_syncUi(){const e=document.getElementById(ze),t=e&&e.querySelector(`.${Qe}`);t&&(t.textContent=this._options.logDownloadButtonText||Ve)}hideDownloadButton(){const e=document.getElementById(ze);e&&(e.style.display="none")}download(){const e=this._logs,t=new Blob([Ke(e)],{type:"application/json"}),s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=this._filename(),n.click()}_filename(){let{logFilename:e}=this._options;if("function"==typeof e){e=e({timestamp:We()})}return e&&"string"==typeof e?e:`miso-log.${We()}.jsonl`}clear(){this._logs=[]}}function We(){return(new Date).toISOString().replaceAll(/[\:\.]/g,"-")}function Ke(e){return e.map((e=>JSON.stringify(P(function(e){if("<progressive-markdown>"===e[0]){const t=e.length;return[...e.slice(0,t-1),Ye(e[t-1])]}return e}(e),{depth:10})))).join("\n")}function Ye(e){return e?P(e,{depth:2}):e}let Ze;const Je="std:debug";function Xe(e){const t=typeof e;return"function"===t||"object"===t&&!Array.isArray(e)?[e]:e}function et(e,t){return null==t||t<=e?e:e+Math.floor(Math.random()*(t-e+1))}const tt={"code-span":()=>["`","`"],"emphasis-1":()=>it(st(1),2),"emphasis-2":()=>it(st(2),2),"emphasis-3":()=>it(st(3),2),strikethrough:()=>["~","~"],link:({url:e="https://miso.ai"}={})=>["[",`](${e})`]};function st(e=[1,3]){return e="number"==typeof e?e:et(...e),"_*".charAt(et(0,1)).repeat(e)}const nt=Object.keys(tt);function it(e,t){const s=[];for(let n=0;n<t;n++)s.push("function"==typeof e?e():e);return s}new Set(nt),Ae.plugins.register(class{constructor(e={}){this._options=e,this._logs=new Ge(e)}static get id(){return Je}install(e){this._injectComponents(e),e.debug=(...e)=>this._logr(...e),e.logs=this._logs}config(e={}){this._options={...this._options,...e},this._logs.config(e),e.preserveLog&&this._log(Je,"ua",window.navigator.userAgent)}_injectComponents(e,t=[]){e.on("child",(e=>this._injectComponents(e,t))),e.on("subtree",(s=>this._injectComponents(s,t.concat(e.meta.path)))),e.on("*",((s,n)=>this._handleEvent(e,n,s,t)))}_handleEvent(e,{name:t},s,n=[]){if("child"===t||"subtree"===t)return;const i=n.concat(e.meta.path);if(i.length||"create"!==t){switch(i[0]){case"client":if("api"===i[1])return void this._handleApiEvent(t,{...s,groupName:i[2]});break;case"plugins":return void(1===i.length?this._handlePluginsEvent(t,s):this._handlePluginSpecificEvent(i[1],i.slice(2),t,s))}this._logw(i.join("."),t,s)}else this._handleCreateClient(t,s)}_handleCreateClient(e,t){this._logw("client",e,t)}_handleApiEvent(e,{groupName:t,apiName:s,url:n,bulk:i,...o}){const r=new URL(n).pathname,a=["api",e];if(i&&a.push(`(bulk ${i.bulkId})`),a.push(`POST ${r}`),"interactions"===t){const e=o.payload.data[0],{type:t,custom_action_name:s,context:{custom_context:{property:n}={}}={}}=e,i="custom"===t&&s?`${t}:${s}`:t;a.push(n?`${i} (${n})`:`${i}`)}a.push([{...o,url:n}]),this._log(...a)}_handlePluginsEvent(e,t){let s=[];Array.isArray(t)&&(s=t.slice(1),t=t[0]),this._log("plugins",e,`${t.id||"(anonymous)"}`,[t,...s])}_handlePluginSpecificEvent(e,t,s,n){this._logw([e,t.join(".")],s,n)}_getPath(e){const t=[];for(let s=e;s;s=s.meta.parent)s.meta.name&&t.push(s.meta.name);return t.reverse()}_logw(e,t,s){void 0===s?this._log(e,t):Array.isArray(s)?this._log(e,t,...s.map(Xe)):this._log(e,t,Xe(s))}_log(e,t,...s){this._logr(function(e){return`<${"string"==typeof e?e:e.filter((e=>e)).join("/")}>`}(e),function(e){return`[${e}]`}(t),...s)}_logr(...e){const t=this._options.console||{};this._options.preserveLog&&this._logs._logs.push(e),console.log(function({text:e="Miso"}={}){return`%c${e}`}(t),function({color:e="#fff",background:t="#334cbb"}={}){return`color: ${e}; background-color: ${t}; padding: 2px 2px 1px 4px;`}(t),...e)}},class{constructor(e={}){this._options=e,this.id="std:dry-run",this.name="dry-run"}static get id(){return"std:dry-run"}install(e,{addUrlPass:t}){t(this._modifyUrl.bind(this))}_modifyUrl({apiGroup:e,apiName:t,url:s}){return"interactions"===e&&"upload"===t?function(e,t,s){return e+(e.indexOf("?")<0?"?":"&")+encodeURIComponent(t)+"="+encodeURIComponent(`${s}`)}(s,"dry_run","1"):s}},class{static get id(){return Me}install(e,t){Fe?(t.setCustomFetch(Fe),e.debug(`<plugin:${Me}>`,"[info]",`Using ${je} native fetch`)):e.debug(`<plugin:${Me}>`,"[error]",`Failed to obtain native fetch: ${De.message}`)}},class{static get id(){return Be}install(e,t){t.addUrlPass(this._modifyUrl.bind(this)),t.addHeadersPass(this._modifyHeaders.bind(this)),e.debug(`<plugin:${Be}>`,"[info]","Send API key in header")}_modifyUrl({url:e}){return e.replace(/[?&]api_key=[^&]*/g,"")}_modifyHeaders({client:e,headers:t}){const{apiKey:s}=e.options;return s?{...t,"X-API-KEY":s}:t}}),Ae.plugins.use(class extends W{static get id(){return"std:context"}constructor(){super("context")}install(e,t){t.addSubtree(this),e.on("create",this._injectClient.bind(this)),t.addHeadersPass(this._modifyHeaders.bind(this)),t.addPayloadPass(this._modifyPayload.bind(this))}_injectClient(e){const t=new Pe(this);var s,n,i;s=e.context,n=t,i="string"==typeof(i=["anonymous_id","user_id","user_hash","user_type","site","auth"])?[i]:i,Object.defineProperties(s,i.reduce(((e,t)=>(e[t]={get:()=>n[t],set:e=>{n[t]=e}},e)),{}))}_modifyHeaders({client:e,headers:t}){const{auth:s}=e.context;return s&&(t={...t,Authorization:s}),t}_modifyPayload({client:e,apiGroup:t,apiName:s,payload:n}){return n?t===Re.INTERACTIONS?s===Ne.UPLOAD?this._modifyPayloadForInteractions(e,n):n:this._modifyPayloadForQueries(e,n):n}_modifyPayloadForQueries(e,t){const{user_id:s,user_hash:n,user_type:i,anonymous_id:o,site:r}=e.context;return M(t,{...s?{user_id:s,user_type:i,user_hash:n}:{anonymous_id:o},metadata:r?{site:r}:void 0})}_modifyPayloadForInteractions(e,{data:t}){const{anonymous_id:s,user_id:n,site:i}=e.context,o={anonymous_id:s,user_id:n},r=i?{site:i}:void 0,a=r?{custom_context:r}:void 0;return{data:t=t.map((e=>j(e,{...o,context:a})))}}}),Ae.plugins.use(class{static get id(){return"std:page-info"}constructor(){}install(e,{addPayloadPass:t}){t(this._modifyPayload.bind(this))}_modifyPayload({apiGroup:e,apiName:t,payload:s}){return"interactions"===e&&"upload"===t?this._modifyPayloadForInteractions(s):s}_modifyPayloadForInteractions({data:e}){return{data:e=e.map((e=>({...e,context:{...a({page:a({url:window.location.href,referrer:document.referrer||void 0,title:document.title}),campaign:Le()}),...e.context}})))}}}),Ae.plugins.use(class extends W{static get id(){return"std:auto-events"}constructor(){super("auto-events"),this._contexts=new WeakMap}install(e,t){t.addSubtree(this),e.on("create",this._injectClient.bind(this)),t.addPayloadPass(this._captureApiRequest.bind(this))}_injectClient(e){const t=new qe(this);this._contexts.set(e,t),e.autoEvents=t.interface}_captureApiRequest({client:e,apiGroup:t,apiName:i,payload:o}){if(t===s.SEARCH)if(i===n.SEARCH)this._captureSearchApiRequest(e,o)}_captureSearchApiRequest(e,{q:t}){if(!t||"*"===t)return;const s=this._contexts.get(e);s&&s._config.search&&e.api.interactions.upload({type:"search",search:{keywords:t},context:{custom_context:{channel:"miso_api"}}})}}),Ae.plugins.use(class{static get id(){return"std:interactions"}constructor(){}install(e,{addPayloadPass:t}){t(this._modifyPayload.bind(this))}_modifyPayload({apiGroup:e,apiName:t,payload:s}){return"interactions"===e&&"upload"===t?this._modifyPayloadForInteractions(s):s}_modifyPayloadForInteractions({data:e}){return{data:e.map(Ue)}}}),Ae.plugins.use(class extends W{static get id(){return"std:api-patch"}constructor(){super("api-patch")}install(e,t){t.addSubtree(this),t.addPayloadPass(this._patchApiPayload.bind(this))}_patchApiPayload(e){let{payload:t,...s}=e;return t?(t=this._copyMetadataToMeta(t,s),t=this._suppressMetadata(t,s),t=this._suppressUserType(t,s),t):t}_copyMetadataToMeta(e,{apiGroup:t}){return t===s.ASK&&e.metadata?{...e,_meta:e.metadata}:e}_suppressMetadata(e,{apiGroup:t}){switch(t){case s.SEARCH:case s.RECOMMENDATION:const{_meta:t,metadata:n,...i}=e;return i;default:return e}}_suppressUserType(e,{apiGroup:t}){switch(t){case s.SEARCH:case s.RECOMMENDATION:const{user_type:t,...n}=e;return n;default:return e}}});const ot="default",rt=Object.freeze({CONTAINER:"container",BANNER:"banner",QUERY:"query",FEEDBACK:"feedback",PRODUCTS:"products",CATEGORIES:"categories",ATTRIBUTES:"attributes",RESULTS:"results",ITEMS:"items",QUESTION:"question",ANSWER:"answer",REASONING:"reasoning",IMAGES:"images",SOURCES:"sources",RELATED_RESOURCES:"related_resources",FOLLOW_UP_QUESTIONS:"follow_up_questions",QUERY_SUGGESTIONS:"query_suggestions",RELATED_QUESTIONS:"related_questions",AFFILIATION:"affiliation",KEYWORDS:"keywords",FACETS:"facets",TOTAL:"total",MORE:"more",SORT:"sort",ERROR:"error"}),at=new Set([rt.PRODUCTS,rt.CATEGORIES,rt.ATTRIBUTES,rt.RESULTS,rt.ITEMS,rt.QUESTION,rt.ANSWER,rt.REASONING,rt.IMAGES,rt.SOURCES,rt.RELATED_RESOURCES,rt.FOLLOW_UP_QUESTIONS,rt.QUERY_SUGGESTIONS,rt.RELATED_QUESTIONS,rt.AFFILIATION,rt.FACETS,rt.TOTAL]);function ct(e){return at.has(e)}const lt=new Set([rt.PRODUCTS,rt.IMAGES,rt.SOURCES,rt.RELATED_RESOURCES]);const ut=Object.freeze({IMPRESSION:"impression",VIEWABLE:"viewable",CLICK:"click",SUBMIT:"submit",FEEDBACK:"feedback"}),dt=[ut.IMPRESSION,ut.VIEWABLE,ut.CLICK,ut.SUBMIT,ut.FEEDBACK],ht=[ut.IMPRESSION,ut.VIEWABLE,ut.CLICK],_t=new Set(ht);const pt=Object.freeze({UNTRACKED:"untracked",TRACKING:"tracking",TRIGGERED:"triggered"}),ft=Object.freeze({INITIAL:"initial",LOADING:"loading",ERRONEOUS:"erroneous",READY:"ready",ONGOING:"ongoing",DONE:"done",EMPTY:"empty",NONEMPTY:"nonempty",UNANSWERABLE:"unanswerable"}),mt=Object.freeze({ORGANIC:"_organic",SUGGESTED_QUESTIONS:"_suggested_questions",INLINE_QUESTION_LINK:"_inline_question_link"});function gt(e){if(dt.indexOf(e)<0)throw new Error(`Unrecognized event type: ${e}`)}const yt=Object.freeze({API:"api",LAYOUTS:"layouts",DATA_PROCESSOR:"dataProcessor",TRACKERS:"trackers",INTERACTIONS:"interactions",FILTERS:"filters",PAGINATION:"pagination",TEMPLATES:"templates"}),bt=Object.freeze({QUERY:"query",REFINE:"refine",MORE:"more"});function vt(e,t){return Object.freeze({...e,...t,members:wt(e.members,t.members),mappings:Object.freeze({...e.mappings,...t.mappings})})}function wt(e=[],t=[]){return[...new Set([...e,...t])]}function kt(e,t){let s={};for(const n of e)n&&(s=t(s,n));return a(s)}function St(e){if(void 0===e)throw new Error(`Expect options to be an object or a boolean value: ${e}`);return"boolean"==typeof e&&(e={active:e}),e}function Et(...e){return!1!==e[e.length-1]&&kt(e,((e,t)=>Object.assign(e,{...t,payload:M(e.payload,t.payload)})))}function Ct(e){return e=function(e){return e.replaceAll("-","_")}(e=e.replace(/[A-Z]/g,(e=>`_${e.toLowerCase()}`)))}function xt(e){if(void 0===e)return;let[t,s]=r(e);return"object"==typeof t&&(s=t,t=void 0),[t,s]}function Ot(e,t){return!1===(t=xt(t))[0]?t:e&&t?[t[0]||e[0],It(e[1],t[1])]:t||e}function It(e,t){return{...e,...t,link:{...e&&e.link,...t&&t.link},templates:{...e&&e.templates,...t&&t.templates}}}const Tt=Object.freeze({active:!0,impression:Object.freeze({active:!0}),viewable:Object.freeze({active:!0,area:.5,duration:1e3}),click:Object.freeze({active:!0,lenient:!1})});function At(e={}){e=St(e);const{active:t,...s}=e;for(const[n,i]of Object.entries(s))Rt(i);return e}function Rt(e={}){return e=St(e)}function Nt(e={},t={}){const s={...e};for(const[n,i]of Object.entries(t))void 0!==i&&(s[n]=dt.includes(n)?$t(e[n],i):i);return s}function $t(e={},t={}){return{...e,...t}}const Pt=St;function Lt(e){return void 0===e?void 0:"function"!=typeof e?()=>e:e}const qt=[{key:yt.API,normalize:function([e,t]=[]){if(!1===e)return{actor:!1};let s;if("object"==typeof e&&void 0===t&&(t=e,e=void 0),e&&-1!==e.indexOf("/")&&([s,e]=e.split("/")),e&&"string"!=typeof e||void 0!==t&&"object"!=typeof t)throw new Error(`Invalid arguments for useApi(): ${e}, ${t}`);return a({group:s,name:e,payload:t})},merge:Et},{key:yt.LAYOUTS,normalize:function(e={}){if(!1===e)return!1;const{results:t,...s}=e;void 0!==t&&(console.warn(`useLayouts({ results: ... }) is deprecated, use useLayouts({ ${rt.PRODUCTS}: ... }) instead`),e={...s,[rt.PRODUCTS]:t});const n={};for(const[i,o]of Object.entries(e))n[Ct(i)]=xt(o);return n},merge:function(...e){return!1!==e[e.length-1]&&kt(e,((e,t)=>{for(const[s,n]of Object.entries(t))e[s]=Ot(e[s],n);return e}))}},{key:yt.DATA_PROCESSOR,normalize:function(e){e=r(e);for(const t of e)if("function"!=typeof t)throw new Error(`Expect data processor options to be a function: ${t}`);return e},merge:function(...e){return e.flat().filter(Boolean)}},{key:yt.TRACKERS,normalize:function(e={}){e=St(e);const{active:t,...s}=e,n={};for(const[i,o]of Object.entries(s))n[i]=At(o);return{active:t,...n}},merge:function(...e){return!1!==e[e.length-1]&&kt(e,((e,t)=>{for(const[s,n]of Object.entries(t))void 0!==n&&(e[s]="active"===s?n:Nt(e[s],n));return e}))}},{key:yt.INTERACTIONS,normalize:function(e){if(void 0===e)return;if(!1===e)return{handle:()=>{}};const t=r(e.preprocess);for(const s of t)if("function"!=typeof s)throw new Error(`Expect preprocess options to be a function: ${s}`);if(e.handle&&"function"!=typeof e.handle)throw new Error(`Expect handle options to be a function: ${e.handle}`);return{...e,preprocess:t}},merge:function(...e){return!1!==e[e.length-1]&&kt(e,((e,t)=>{return Object.assign(e,{...t,preprocess:(s=e.preprocess,n=t.preprocess,s&&s.length?n&&n.length?[...s,...n]:s:n)});var s,n}))}},{key:yt.FILTERS,normalize:Pt,merge:function(...e){return!1!==e[e.length-1]&&kt(e,((e,t)=>Object.assign(e,t)))}},{key:yt.PAGINATION,normalize:function(e){if(void 0===e)throw new Error(`Expect pagination options to be an object or a boolean value: ${e}`);return"boolean"==typeof e&&(e={active:e}),e},merge:function(...e){return!1!==e[e.length-1]&&kt(e,((e,t)=>Object.assign(e,t)))}},{key:yt.TEMPLATES,normalize:function(e={}){const t={};for(const[s,n]of Object.entries(e))t[s]=Lt(n);return t},merge:function(...e){return kt(e,((e,t)=>{for(const[n,i]of Object.entries(t))e[n]=(s=e[n],Lt(i)||s);var s;return e}))}}];class Ut{constructor(){this._events=new V({target:this}),this._globals={}}_notify(e){this._events.emit(e),this._events.emit("_update",e)}}class Mt{constructor(e={},t={}){this._events=new V({target:this}),this._defaults=t,this._context=e||{},this._locals={},u(this,{resolved:new jt(this),defaults:t}),e&&e.on&&(this._unsubscribes=[e.on("_update",(e=>this._notify(e)))])}_notify(e){this.resolved._invalidate(e),this._events.emit(e)}_destroy(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[]}}class jt{constructor(e){this._options=e,this._cache={}}_invalidate(e){this._cache[e]=void 0}_get({key:e,merge:t}){if(void 0===this._cache[e]){const s=this._options,n=s._context[e];this._cache[e]=t(s._defaults[e],n&&n.get(),s._locals[e])}return this._cache[e]}}class Dt{constructor(e,t,s,n,i){this._options=e,this._store=t,this._key=s,this._normalize=e=>void 0!==e?n(e):void 0,this._merge=i}get(){return this._store[this._key]}set(e){this._set(this._normalize(e))}merge(e){this._set(this._merge(this.get(),this._normalize(e)))}_set(e){this._store[this._key]=e,this._options._notify(this._key)}}for(const ep of qt){const{key:e,normalize:t,merge:s}=ep;Object.defineProperty(Ut.prototype,e,{get:function(){const n=`_${e}`;return this[n]||(this[n]=new Dt(this,this._globals,e,t,s))}}),Object.defineProperty(Mt.prototype,e,{get:function(){const n=`_${e}`;return this[n]||(this[n]=new Dt(this,this._locals,e,t,s))}}),Object.defineProperty(jt.prototype,e,{get:function(){return this._get(ep)}})}const Ft=[yt.API,yt.LAYOUTS,yt.DATA_PROCESSOR,yt.TRACKERS,yt.INTERACTIONS];function Bt(e,t=Ft){for(const s of t)zt(e,s)}function zt(e,t){if("api"===t)Object.assign(e,{useApi(...e){return this._options.api.merge(e),this},clearApi(){return this._options.api.set(),this}});else{const n=(s=t).charAt(0).toUpperCase()+s.slice(1);Object.assign(e,{[`use${n}`](e){return this._options[t].merge(e),this},[`clear${n}`](){return this._options[t].set(),this}})}var s}function Ht(e={}){const{setValue:t,focus:s,param:n,sourceParam:i}=this._autoQuery=function({setValue:e=!0,focus:t=!0,updateUrl:s=!0,param:n="q",sourceParam:i="qs",...o}={}){return{setValue:e,focus:t,updateUrl:s,param:n,sourceParam:i,...o}}(e),o=new URLSearchParams(window.location.search),r=o.get(n),c=o.get(i)||void 0,{layout:l}=this._views.get(rt.QUERY);l&&(r&&t&&(l.value=r),!r&&s&&l.focus()),r&&this.query(a({q:r,qs:c}))}class Qt extends W{constructor(e,t,s){super(e,t),this._name=e,this._plugin=t,this._client=s,this._options=new Ut}}function Vt(e){return e?`view:${e}`:"view"}Bt(Qt.prototype);class Gt{constructor(e={}){(this._events=new V)._injectSubscribeInterface(this),this._options=e,this._states={},u(this,{states:new Proxy(this._states,{set(){}})})}update(e,t,s={}){this._states[e]=Object.freeze(t);const n=Object.freeze({action:"update",name:e,state:t,...s});"function"==typeof this._options.onUpdate&&this._options.onUpdate(n),s.silent||this._events.emit(e,t),"function"==typeof this._options.onEmit&&this._options.onEmit(n)}trigger(e,t){const s=Object.freeze({action:"trigger",name:e,state:t});"function"==typeof this._options.onUpdate&&this._options.onUpdate(s),this._events.emit(e,t),"function"==typeof this._options.onEmit&&this._options.onEmit(s)}}class Wt{constructor(e){this._hub=e,this._sessionIndex=0}restart(){const e=Object.freeze({uuid:w(),index:this._sessionIndex++,meta:{}});this._hub.update("session",e)}}function Kt(e,t){if(!t)return!1;const{session:s}=e.states;return s&&s.index===t.index}class Yt{constructor(e,{source:t,options:s}){this._hub=e,this._source=t,this._options=s,this._unsubscribes=[e.on("session",(e=>this._handleSession(e))),e.on("request",(e=>this._handleRequest(e)))]}get active(){return!1!==this._options.resolved.api.actor}get source(){return this._source}_handleSession(e){this._session&&e.index===this._session.index||(this._ac&&this._ac.abort({type:"new-session",message:"A new session is created, discarding the old one."}),this._ac=new AbortController),this._session=e}async _handleRequest(e){if(!this.active)return;const{session:t,...s}=e;try{const{signal:n}=this._ac||{},i={...e.options,signal:n},o=await this._source({session:t,...s,options:i});if(o&&o[Symbol.asyncIterator]){let e;for await(e of(o._response&&this._emitResponseWithSessionCheck({session:t,request:s,value:o._response}),o)){if(!Kt(this._hub,t))break;this._emitResponse({session:t,request:s,value:e})}}else this._emitResponseWithSessionCheck({session:t,request:s,value:o})}catch(n){this._error(n),this._emitResponseWithSessionCheck({session:t,request:s,error:n})}}_emitResponseWithSessionCheck(e){Kt(this._hub,e.session)&&this._emitResponse(e)}_emitResponse(e){this._hub.update("response",e)}_error(e){console.error(e)}_destroy(){this._ac&&this._ac.abort({type:"data-actor-destroy",message:"Data actor is destroyed."});for(const e of this._unsubscribes)e();this._unsubscribes=[]}}class Zt{constructor(e){this._get="function"==typeof e?e:()=>e,this._handlers=[],this._elementUpdatedHandlers=[],this.sync()}get current(){return this._element}on(e,t){if("element"===e)return this._onElementUpdated(t);const s=this._get();return s&&s.addEventListener(e,t),this._handlers.push({event:e,handler:t}),()=>this._off(e,t)}_off(e,t){const s=this._get();s&&s.removeEventListener(e,t),function(e,t){if(!e)return;const s=e.findIndex(t);s>-1&&e.splice(s,1)}(this._handlers,(e=>e.handler===t))}_onElementUpdated(e){return this._elementUpdatedHandlers.push(e),()=>{o(this._elementUpdatedHandlers,e)}}sync({silent:e=!1}={}){const t=this._get();if(this._element===t)return;if(this._offAllFromCurrentElement(),t)for(const{event:n,handler:i}of this._handlers)t.addEventListener(n,i);const s=this._element;if(this._element=t,!e)for(const n of this._elementUpdatedHandlers)try{n(t,s)}catch(X_){console.error(X_)}}_offAllFromCurrentElement(){if(this._element)for(const{event:e,handler:t}of this._handlers)this._element.removeEventListener(e,t)}destroy(){this._offAllFromCurrentElement()}}const{IMPRESSION:Jt,VIEWABLE:Xt,CLICK:es}=ut,{UNTRACKED:ts,TRIGGERED:ss}=pt,ns=Object.freeze({[Jt]:ts,[Xt]:ts,[es]:ts});class is{constructor(e){this.sessionId=e,this._states=new Map}getFullState(e){const t=this._states.get(this._getKey(e));return t?{...t}:ns}get(e,t){const s=this._states.get(this._getKey(e));return s&&s[t]||ts}set(e,t,s){gt(t),function(e){if(e!==pt.UNTRACKED&&e!==pt.TRACKING&&e!==pt.TRIGGERED)throw new Error(`Unrecognized tracking status: ${e}`)}(s);for(const n of r(e))this._setOne(n,t,s)}untriggered(e,t){return e.filter((e=>this.get(e,t)!==ss))}_getKey(e){return e.product_id||e.text||e.id||e}_setOne(e,t,s){(function(e,t,s){if(e.has(t))return e.get(t);const n=s(t);return e.set(t,n),n}(this._states,this._getKey(e),(()=>({...ns}))))[t]=s}}const os=[Symbol("itemless")];class rs{constructor({hub:e,role:t,options:s}){this._hub=e,this._role=t,this._options=s,this._states=new is(this._getSessionId())}get options(){return"function"==typeof this._options?this._options():this._options}getState(e){return this._states.getFullState(e)}_trigger(e,t,s){gt(e);const{options:n}=this;if(!n||!1===n.active)return;this._syncSession();const{deduplicated:i=!0,itemless:o=!1}=n;if(i){if(o&&(t=os),0===(t=this._states.untriggered(r(t),e)).length)return;this._states.set(t,e,pt.TRIGGERED)}this._sendToHub({type:e,items:o?void 0:t,...s})}submit({value:e}){this._syncSession(),this._sendToHub({type:ut.SUBMIT,value:e})}_sendToHub(e){this._hub.trigger("tracker",Object.freeze(a({role:this._role,...e})))}_syncSession(){const e=this._getSessionId();e&&(this._states&&e===this._states.sessionId||(this._states=new is(e)))}_getSessionId(){const{session:e}=this._getViewState()||{};return e&&e.uuid}_getMisoId(){const e=this._getViewState();return e&&e.meta&&e.meta.miso_id||void 0}_getRequestPayload(){const{request:e}=this._getViewState()||{};return e&&e.payload}_getViewState(){return this._hub.states[Vt(this._role)]}}for(const ep of ht)rs.prototype[ep]=function(e,t){this._trigger(ep,e,t)};function as(e){return e&&e.meta&&e.meta.empty}class cs{constructor(e,t){this._events=new V({target:this}),this._views=e,this._mapping=us((e._roles.mappings||{})[t]||t),u(this,{role:t,interface:new ls(this)})}get hub(){return this._views._hub}get element(){return this._element}set element(e){e!==this._element&&(this._element&&this._safeApplyOnLayout("unrender",this._element),this._element=e,this._proxyElement&&this._proxyElement.sync(),this._events.emit("element",e),this.refresh({force:!0}))}get proxyElement(){return this._proxyElement||(this._proxyElement=new Zt((()=>this.element))),this._proxyElement}get layout(){return this._layout}set layout(e){if(e===this._layout)return;if(e&&"function"!=typeof e.render)throw new Error("Render function is mandatory in a layout.");const{element:t}=this;t&&this._safeApplyOnLayout("unrender",t),this._safeApplyOnLayout("destroy"),this._layout=e,e&&(e._view=this,"function"==typeof e.initialize&&e.initialize(this)),this.refresh({force:!0})}get tracker(){const{role:e}=this;if(e===rt.CONTAINER)return this._views._getContainerTracker();if(!this._tracker){const{hub:t}=this;this._tracker=new rs({hub:t,role:e,options:()=>this.trackerOptions})}return this._tracker}get workflow(){return this._views._workflow}get workflowOptions(){return this._views._options.resolved}get trackerOptions(){return this._views._getTrackerOptions(this.role)}get filters(){return this._views.filters}async refresh({force:e=!1,data:t}={}){if(!this._layout)return;const{element:s}=this;if(!s)return;const n=this._data;if(this._data=t=this._sliceData(t||this._views._getData()),!e&&((i=t)===(o=n)||i&&o&&i.status===o.status&&i.error===o.error&&i.value===o.value&&i.ongoing===o.ongoing&&as(i)===as(o)&&function(e,t){return e===t||e&&t&&e.uuid===t.uuid}(i.session,o.session)))return;var i,o;const{session:r,status:a,ongoing:c,request:l,meta:u,value:d}=t,h={session:r,status:a,ongoing:c,request:l,meta:u,data:d,...ds(this.role,t)},_=(e={},t)=>{!1!==e&&this.updateState({...h,...e},t)};try{await this._layout.render(s,t,{notifyUpdate:_})}catch(p){this._error(p),_({error:p})}}updateState(e,{silent:t=!1}={}){const s=e.error?ft.ERRONEOUS:e.status;e=this._state=Object.freeze(a({...e,status:s}));const{role:n}=this;this.hub.update(Vt(n),e,{silent:t})}_sliceData(e){const{value:t,error:s,status:n,meta:i,...o}=e,r={value:this._mapping(e,this),status:n,data:t,meta:i,...o};return this.role===rt.CONTAINER&&(r.meta={...i,empty:this._isContainerEmpty(e)}),a(r)}_isContainerEmpty(e){const{element:t}=this;if(!t)return!1;for(const{role:s}of t.components){if(!ct(s))continue;if(!hs(s,us((this._views._roles.mappings||{})[s]||s)(e,this)))return!1}return!0}_syncSize(){this._element&&this._safeApplyOnLayout("syncSize",this._element)}_safeApplyOnLayout(e,...t){if(this._layout&&"function"==typeof this._layout[e])try{this._layout[e](...t)}catch(X_){this._error(X_)}}_error(e){this._views._error(e)}_destroy(){this._safeApplyOnLayout("destroy"),this._proxyElement&&this._proxyElement.destroy()}}class ls{constructor(e){l(this,e,["role","layout","element","proxyElement","refresh","on","tracker"])}}function us(e){switch(typeof e){case"function":return e;case"string":return t=>t.value&&t.value[e];default:throw new Error(`Invalid mapping function: ${e}`)}}function ds(e,t){return function(e){return e.status===ft.READY&&!e.ongoing}(t)?{empty:!!hs(e,t&&t.value)}:{}}function hs(e,t){switch(e){case rt.ANSWER:case rt.REASONING:return!t||!t.value;default:return void 0===t||(Array.isArray(t)||"string"==typeof t)&&!t.length}}function _s(e){if(!e)return;const{options:t=[]}=e;for(const s of t)if(s.default)return Object.freeze(s);return Object.freeze(t[0])}class ps{constructor(e,{facets:t}={}){this._views=e,this._hub=e._hub;const s=this._error=this._error.bind(this);this._events=new V({target:this,error:s}),u(this,{facets:new fs(this,t)}),this._unsubscribes=[e._options.on("filters",(()=>this._syncOptions()))],this._syncOptions(),this._states=void 0}_syncOptions(){const e=this._views._options.resolved.filters;this._initialStates=function({sort:e}={}){return a({facets:Object.freeze({}),sort:_s(e)})}(e),this.apply({silent:!0})}_getStates(){return this._states||this._initialStates}update(e){const t=this._getStates();this._states=function(e={},t={}){return Object.freeze(a({...e,...t,facets:Object.freeze(a({...e.facets,...t.facets}))}))}({...t,...e});const s=this._getStates();this._events.emit("update",{updates:e,states:s,oldStates:t})}reset({silent:e=!1}={}){const t=this._states;this._states=void 0;const s=this._getStates();this._hub.update("filters",s,{silent:e}),this._events.emit("reset",{states:s,oldStates:t})}apply({silent:e=!1}={}){const t=this._getStates();this._hub.update("filters",t,{silent:e}),!e&&this._events.emit("apply")}_error(e){this._views._error(e)}_destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[]}}class fs{constructor(e,t={}){this._filters=e,this._options=t}isSelected(e,t){return this._getFieldValues(e).includes(t)}select(e,t){this.isSelected(e,t)||this._select(e,t)}unselect(e,t){this.isSelected(e,t)&&this._unselect(e,t)}toggle(e,t){this.isSelected(e,t)?this._unselect(e,t):this._select(e,t)}_getFieldValues(e){return this._filters._getStates().facets[e]||[]}_select(e,t){const s=this._options.multivalued?[...this._getFieldValues(e),t]:[t];s.sort(),this._filters.update({facets:{[e]:s}})}_unselect(e,t){let s=this._getFieldValues(e).filter((e=>e!==t));0===s.length&&(s=void 0),this._filters.update({facets:{[e]:s}})}}const ms=Symbol.for("miso:tracked");function gs(e){return!!e[ms]}function ys(e){e[ms]=!0}const bs=Object.freeze({impression:Object.freeze({}),viewable:Object.freeze({area:.5,duration:1e3}),click:Object.freeze({lenient:!1})});function vs(e,t){return!!t&&{...e,...t}}class ws{constructor(e,{workflow:t,extensions:s,layouts:n,roles:i,options:o}){this._hub=e,this._workflow=t,this._workflowName=t._name,this._extensions=s,this._layoutFactory=n,this._options=o,this._roles=i,this._containers=new Map,this._containerTracker=void 0,this._views={},this._filters=new ps(this);for(const a of i.members)a!==rt.CONTAINER&&(this._views[a]=new cs(this,a));u(this,{interface:new ks(this),trackers:new Ss(this,i.members)});const r=()=>this.syncSize();window.addEventListener("resize",r),this._unsubscribes=[()=>window.removeEventListener("resize",r),e.on("data",(e=>this.refresh({data:e}))),o.on("layouts",(()=>this._syncLayouts()))],this._syncLayouts()}get filters(){return this._filters}addContainer(e){if(this._containers.has(e))return;const t=new cs(this,rt.CONTAINER);t.layout=this._createLayout(rt.CONTAINER),t.element=e,this._containers.set(e,t);const{components:s}=e;for(const n of s)this.addComponent(n)}removeContainer(e){const t=this._containers.get(e);if(!t)return;const{components:s}=e;for(const n of s)this.removeComponent(n);t._destroy(),this._containers.delete(e)}addComponent(e){this._getViewByElement(e).element=e}removeComponent(e){this._getViewByElement(e).element=void 0}updateComponentRole(e,t,s){}containsElement(e){return this._containers.has(e)||this._views[e.role]}refreshElement(e){const t=e.isContainer?this._containers.get(e):this._getViewByElement(e);t&&t.refresh({force:!0})}_getViewByElement(e){let{role:t}=e;if(!t)throw new Error("Component must have a role");return this.get(t)}_syncLayouts(){const{layouts:e}=this._options.resolved;if(!1===e){for(const e of this._containers.values())e.layout=void 0;for(const e of Object.values(this._views))e.layout=void 0}else for(let[t,[s,n]]of Object.entries(e)){const e=()=>this._layoutFactory.create(s,{...n,role:t,workflow:this._workflowName});if(t===rt.CONTAINER)for(const t of this._containers.values())t.layout=e();else{const s=this.get(t);s&&(s.layout=e())}}}_createLayout(e){const t=this._options.resolved.layouts[e];if(!t)return;const[s,n]=t;return this._layoutFactory.create(s,{...n,role:e,workflow:this._workflowName})}get(e){return this._views[e]}get views(){return this._getViews(!0)}_getViews(e=!0){return e?[...this._containers.values(),...Object.values(this._views)]:[...Object.values(this._views),...this._containers.values()]}syncSize(){for(const e of Object.values(this._views))e._syncSize()}async refresh({force:e,data:t}={}){t=this._getData(t);let s=this._getViews(!0);await Promise.all(s.map((s=>s.refresh({force:e,data:t}))))}_getData(e){return e||this._hub.states.data}_getTrackerOptions(e){const t=this._options.resolved.trackers;return function(e){if(!1===e)return!1;if(!0===e&&(e={}),"object"!=typeof e)throw new Error(`Invalid options: ${e}`);const{impression:t={},viewable:s={},click:n={},...i}=e;return a({...bs,...i,impression:vs(bs.impression,t),viewable:vs(bs.viewable,s),click:vs(bs.click,n)})}(t&&t[e]||!1)}_getContainerTracker(){if(!this._containerTracker){const e=this._hub,t=rt.CONTAINER;this._containerTracker=new rs({hub:e,role:t,itemless:!0,options:()=>this._getTrackerOptions(t)})}return this._containerTracker}_error(e){console.error(e)}_destroy({dom:e}={}){for(const t of this._getViews(!1))t._destroy();for(const t of this._unsubscribes)t();this._unsubscribes=[],this._filters._destroy()}}class ks{constructor(e){this._actor=e,l(this,e,["syncSize","refresh","trackers","filters"])}get(e){return this._actor.get(e).interface}get all(){return this._actor.views.map((e=>e.interface))}}class Ss{constructor(e,t){this._views=e;for(const s of t)s!==rt.CONTAINER&&Object.defineProperty(this,s,{get:()=>e.get(s).tracker});Object.defineProperty(this,rt.CONTAINER,{get:()=>e._getContainerTracker()})}}class Es{constructor(e){this._hub=e,this._unsubscribes=[e.on("feedback",(e=>this._trigger(e)))]}_trigger(e){this._hub.trigger("tracker",{type:ut.FEEDBACK,result_type:"answer",value:e.unselected?"unselected":e.value})}_destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[]}}class Cs{constructor(e,{client:t,options:s}){this._client=t,this._options=s,this._unsubscribes=[e.on("interaction",(e=>this._handle(e)))]}_handle(e){0!==(e=r(e)).length&&this._client.api.interactions.upload(e,{merge:!0})}destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[]}}function xs(e){return async({group:t,name:i,payload:o,options:r})=>{if(t===s.ASK)switch(i){case n.QUESTIONS:return e.api.ask.questions(o,r);case n.SEARCH:return e.api.ask.search(o,r)}return e.api[t]._run(i,o,r)}}class Os{constructor({role:e,workflow:t,...s}={}){u(this,{role:e,workflow:t,options:s}),this._unsubscribes=[],this._rendered=new WeakMap,this._element=void 0,this._notifyUpdate=void 0,this._pending=void 0}async render(e,t,s={}){this._syncElement(e);const n=this._rendered.get(e),i=E(!1);t=this._preprocess({state:t,rendered:n},{skip:i.t})||t,this._updatePending(t,s),i.value||this._handleInput({state:t,rendered:n},s)}_syncElement(e){this._element!==e&&this._rendered.delete(this._element),this._element=e}_preprocess({state:e}){return e}_updatePending(e,t){this._pending=[Object.freeze(e),t]}_takePending(){const e=this._pending;return this._pending=void 0,e}_handleInput(){this._requestRaf()}_requestRaf(){this._requested||(this._requested=!0,y((e=>this._doRaf(e))))}_doRaf(e){this._requested&&(this._requested=!1,this._applyRender(e))}_applyRender(e,t={}){if(!this._pending)return;let[s,{notifyUpdate:n}]=this._takePending();s=Object.freeze({...s,timestamp:e});const i=this._rendered.get(this._element),o=E([]),r=E({});this._render(this._element,{state:s,rendered:i,timestamp:e},{notifyUpdate:o.args,writeToState:r.merge,...t}),s=Object.freeze({...s,...r.value}),this._rendered.set(this._element,s),n&&n(...o.value),this._afterRender(this._element,s)}_render(){throw new Error("Unimplemented")}_afterRender(){}destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[],this._view=void 0,this._element=void 0,this._notifyUpdate=void 0,this._pending=void 0}}function Is(...e){return e.reduce(((e,t)=>(e[t]=function(e){return()=>{throw new Error(`Template '${e}' is not implemented.`)}}(t),e)),{})}function Ts(e,t,s,n){const{templates:i}=e,[o,r]=Vs(e,s);return[o,(i.indexBlock||Hs)(e,s,n),(i.infoBlock||i.articleInfoBlock||$s)(e,s,n),r].join("")}function As(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__item-info-container">${[(i.titleBlock||Ls)(e,t,s),(i.descriptionBlock||Us)(e,t,s),(i.priceBlock||Fs)(e,t,s),(i.ctaBlock||Qs)(e,t,s)].join("")}</div>`}function Rs(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__item-info-container">${[(i.titleBlock||Ls)(e,t,s),(i.descriptionBlock||Us)(e,t,s),(i.priceBlock||Fs)(e,t,s)].join("")}</div>`}function Ns(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__item-info-container">${[(i.titleBlock||Ls)(e,t,s),(i.dateBlock||Ms)(e,t,s),(i.descriptionBlock||Us)(e,t,s),(i.ctaBlock||Qs)(e,t,s)].join("")}</div>`}function $s(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__item-info-container">${[(i.titleBlock||Ls)(e,t,s),(i.authorsAndDateBlock||Ds)(e,t,s)].join("")}</div>`}function Ps(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__item-info-container">${[(i.titleBlock||Ls)(e,t,s)].join("")}</div>`}function Ls({className:e},{title:t,_title_with_markups:s}){const n=Ys(s)||v(t);return n?`<div class="${e}__item-title">${n}</div>`:""}function qs({className:e},{brand:t,brand_logo:s}){if(!t&&!s)return"";return`<div class="${e}__item-brand-container">${s?`<img class="${e}__item-brand-logo" src="${s}"${t?` alt="${t}"`:""}>`:`<div class="${e}__item-brand">${t}</div>`}</div>`}function Us({className:e},{snippet:t,description:s}){return t?`<div class="${e}__item-snippet">${Ys(t)}</div>`:s?`<div class="${e}__item-desc">${v(s)}</div>`:""}function Ms({className:e,templates:t},{created_at:s,updated_at:n,published_at:i}){const o=i||s||n;return o?`<div class="${e}__item-date">${Ks(o,t.date)}</div>`:""}function js({className:e},{authors:t}){return t&&Array.isArray(t)&&t.length?`<div class="${e}__item-authors">${t.join(", ")}</div>`:""}function Ds(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__item-authors-and-date-container">${[(i.authorsBlock||js)(e,t,s),(i.dateBlock||Ms)(e,t,s)].join("")}</div>`}function Fs(e,t){const{className:s,templates:n}=e,{sale_price:i,original_price:o,currency:r="USD"}=t,a=i||o;if(!a)return"";const c=void 0!==o&&void 0!==i&&i<o,l=t.discount_rate_percent||(c?Math.floor(100*(1-i/o)):void 0);let u="";if(c&&(u+=`<span class="${s}__item-original-price miso-price" data-currency="${r}">${o}</span><br>`),u+=`<span class="${s}__item-price miso-price" data-currency="${r}">${a}</span>`,l){u+=` <span class="${s}__item-discount-rate">${(n.discountRateText||Bs)(e,{...t,discount_rate_percent:l})}</span>`}return`<div class="${s}__item-price-container">${u}</div>`}function Bs(e,{discount_rate_percent:t}){return`(${t}% off)`}function zs(e,t,s={}){const{className:n,templates:i}=e,{cover_image:o,image_src:r,image_alt:a}=t;if(!o&&!r)return"";const c=r?"image":"cover-image";return`<div class="${n}__item-${c}-container">${"image"===c?`<img class="${n}__item-${c}" src="${r}"${a?` alt="${a}"`:""}>`:`<img class="${n}__item-${c}" src="${o}">`}${"cover-image"===c&&s.brand?(i.brandBlock||qs)(e,t,s):""}</div>`}function Hs({className:e},t,{index:s}){return`<div class="${e}__item-index-container"><span class="${e}__item-index miso-citation-index" data-index="${s+1}"></span></div>`}function Qs(e,t,s){const{className:n,templates:i}=e,o=Zs.asFunction(i.cta)(e,t,s);return o?`<div class="${n}__item-cta-container">${o}</div>`:""}function Vs({className:e,options:t={}},{product_id:s,url:n},{classSuffix:i="item-body",role:o="item",...r}={}){const a=!1!==r.link&&n?"a":"div";return[`<${a} class="${e}__${i}" ${o?`data-role="${o}"`:""} ${s?`data-miso-product-id="${s}"`:""} ${!1!==r.link&&n?`href="${n}" ${function(e={}){const{target:t="_blank",rel:s="noopener",open:n=!0}=e;let i="";n&&(t&&(i+=` target="${t}"`),s&&(i+=` rel="${s}"`));return i}(t.link)}`:""}>`,`</${a}>`]}const Gs=Object.freeze({locale:"en-US",year:"numeric",month:"short",day:"numeric"}),Ws="en-US";function Ks(e,t=Gs){switch(typeof t){case"function":return t(e);case"string":return new Date(e).toLocaleDateString(t);case"object":return new Date(e).toLocaleDateString(t.locale||Gs.locale,t);default:throw new Error(`Invalid date format: ${t}`)}}function Ys(e){return e&&e.replace(/<\/mark>\s+<mark>/g,"</mark>&nbsp;<mark>")}const Zs=Object.freeze({tagPair:Vs,formatDate:Ks,formatNumber:function(e,t=Ws){switch(typeof t){case"function":return t(e);case"string":return new Intl.NumberFormat(t).format(e);case"object":return new Intl.NumberFormat(t.locale||Ws.locale,t).format(e);default:throw new Error(`Invalid number format: ${t}`)}},formatHtmlWithMarkup:Ys,escapeHtml:v,asFunction:function(e=""){return"function"==typeof e?e:()=>e}});class Js extends Os{constructor({className:e,templates:t,...s}={}){super(s),u(this,{className:e,templates:{...Is("root"),...t,helpers:Zs}})}_preprocess({state:e}){const t=this.templates.root(this,e);return{...e,html:t}}_render(e,{state:t}){e.innerHTML=t.html}}class Xs extends HTMLElement{static get tagName(){return"miso-banner"}async connectedCallback(){Xs.MisoClient.ui.layouts.create("banner").render(this)}}class en{constructor(){this._entries=new WeakMap}isTracked(e){return this._entries.has(e)}async track(e,t={}){if(!t)return!1;if(this._entries.get(e))return!1;const s=new AbortController,{signal:n}=s;this._entries.set(e,{ac:s});let i=!1;try{await b(e,{...t,signal:n}),i=!0}catch(X_){if("AbortError"!==X_.name)throw X_}finally{this._entries.delete(e)}return i}untrack(e){const t=this._entries.get(e);t&&(t.ac.abort(),this._entries.delete(e))}}class tn extends Os{static get type(){return"container"}constructor({logo:e="auto",...t}={}){super({logo:e,...t}),this._impression=!1,this._viewables=new en}_syncElement(e){this._element!==e&&this._viewables.untrack(this._element),super._syncElement(e)}_render(e,t){this._syncBanner(e),this._syncStatus(e,t),this._trackInteractions(e,t)}_afterRender(e,t){this._trackInteractions(e,t)}_syncBanner(e){const t=Xs.tagName,s=this._shallRenderBanner(e),n=e.querySelector(t);s&&!n?e.insertAdjacentHTML("beforeend",`<${t} visible-when="ready"></${t}>`):!s&&n&&n.remove()}_shallRenderBanner(e){const{logo:t}=this.options,{logo:s}=e,n=void 0!==s&&"auto"!==s?s:t;return"auto"===n?e.components.some((({role:e})=>function(e){return e===rt.PRODUCTS||e===rt.ANSWER}(e))):!!n}_syncStatus(e,{state:t}){if(!e)return;const{status:s,ongoing:n,meta:{miso_id:i,empty:o=!1,unanswerable:r=!1}={}}=t,a=[s,o?ft.EMPTY:ft.NONEMPTY];s===ft.READY&&a.push(n?ft.ONGOING:ft.DONE),r&&a.push(ft.UNANSWERABLE),e.setAttribute("status",a.join(" ")),i?e.setAttribute("miso-id",i):e.removeAttribute("miso-id")}_trackInteractions(e,t){const{status:s}=t;s===ft.READY&&(this._trackImpression(),this._trackViewable(e))}_trackImpression(){const{impression:e}=this._view.tracker.options||{};e&&(this._impression||(this._impression=!0,this._view.tracker.impression()))}async _trackViewable(e){const{viewable:t}=this._view.tracker.options||{};t&&await this._viewables.track(e,t)&&this._view.tracker.viewable()}}const sn=Object.freeze({root:function(e,t){const{className:s,templates:n}=e,{status:i,value:o}=t;return"erroneous"!==i?"":`<div class="${s}"><div class="${s}__message">${n.message(e,o)}</div></div>`},message:function(e,t){return`Error: ${t.message||t}`}});class nn extends Js{static get type(){return"error"}static get defaultTemplates(){return sn}constructor({className:e="miso-error",templates:t,...s}={}){super({className:e,templates:{...sn,...t},...s})}}const on=Object.freeze({root:function(e){const{className:t,templates:s}=e;return`<div class="${t}"><div class="${t}__logo">${s.logo(e)}</div></div>`},logo:()=>'<svg viewBox="0 0 500 200"><path d="M131.1,39.4 C144.3,39.4 155,43.8 163.2,52.7 C171.3,61.3 175.2,72.9 175.2,87.6 L175.2,159.1 L140.4,159.1 L140.4,90.6 C140.4,78.7 134.6,71.5 123.7,71.5 C112.3,71.5 105.5,79.7 105.5,93.4 L105.5,159.1 L70.7,159.1 L70.7,90.6 C70.7,78.7 64.9,71.5 54,71.5 C42.6,71.5 35.8,79.7 35.8,93.4 L35.8,159.1 L1,159.1 L1,42.7 L35.8,42.7 L35.8,53.4 C42.1,44.1 52.6,39.4 67,39.4 C80.5,39.4 90.7,44.5 97.4,54.8 C104.6,44.5 115.8,39.4 131.1,39.4 Z M202,42.4 L238.4,42.4 L238.4,159.1 L202,159.1 Z M202,0 L238.4,0 L202,36.4 Z M302.6,76.6 C302.6,81.2 311.7,83.8 323,86.8 C339.2,90.3 360.5,98.7 360.3,124 C360.3,136.6 355.6,146.1 346.2,152.6 C336.8,158.9 325.3,162.1 311.5,162.1 C286.9,162.1 270,152.8 261.1,134.5 L291.6,117.3 C294.6,126.3 301.4,131 311.5,131 C319.9,131 324.2,128.7 324.2,123.8 C324.2,119.1 315,116.3 303.8,113.5 C287.6,109.1 266.5,101.2 266.5,77.5 C266.5,65.4 270.9,56.1 279.6,49.4 C288.5,42.6 299.5,39.4 312.4,39.4 C331.9,39.4 348.6,48.2 358.2,64.3 L328.2,80.3 C324.4,73.6 319.2,70.1 312.4,70.1 C305.9,70.1 302.6,72.2 302.6,76.6 Z M480.4,144.5 C468.4,156.3 453.7,162.1 436.3,162.1 C419,162.1 404.2,156.3 392.2,144.5 C380.3,132.6 374.2,118 374.2,100.8 C374.2,83.6 380.3,69.1 392.2,57.3 C404.2,45.4 419,39.4 436.3,39.4 C453.7,39.4 468.4,45.4 480.4,57.3 C492.4,69.1 498.5,83.6 498.5,100.8 C498.5,118 492.4,132.6 480.4,144.5 Z M417.1,120.5 C422.2,125.6 428.6,128.2 436.3,128.2 C444.1,128.2 450.4,125.6 455.5,120.5 C460.7,115.4 463.3,108.9 463.3,100.8 C463.3,92.6 460.7,86.1 455.5,81 C450.4,75.9 444.1,73.3 436.3,73.3 C428.6,73.3 422.2,75.9 417.1,81 C411.9,86.1 409.3,92.6 409.3,100.8 C409.3,108.9 411.9,115.4 417.1,120.5 Z" /></svg>'});function rn(e,t){const s=[];for(const n of t.entries){const t=e.e2b.get(n.element);t&&t.key===n.key||s.push(n)}return s}class an{constructor(){this._k2b=new Map,this._e2b=new Map,this._entries=[]}get entries(){return[...this._entries]}get(e){return this._e2b.get(e)||void 0}find(e){return this._k2b.get(e)||void 0}update(e,t,s){const n=function(e,t,s){const n=new Map,i=new Map,o=[];for(let r=0;r<e.length;r++){const a=e[r],c=s[r],l=t[r],u=Object.freeze({index:r,key:a,value:l,element:c});n.set(a,u),i.set(c,u),o.push(u)}return{k2b:n,e2b:i,entries:o}}(e,t,s),i={k2b:this._k2b,e2b:this._e2b,entries:this._entries},o=rn(i,n),r=rn(n,i);return this._k2b=n.k2b,this._e2b=n.e2b,this._entries=n.entries,{bounds:o,unbounds:r}}clear(){const e=this._entries;return this._k2b=new Map,this._e2b=new Map,this._entries=[],{bounds:[],unbounds:e}}}function cn(e){q(e,ln.prototype)}class ln{_initTrackable(){this._bindings=new an,this._viewables=new en}_syncBindings(e,t){const s=this._getItems(t)||[],n=s.map((e=>this._getItemKey(e))),i=this._getItemElements(e),{bounds:o,unbounds:r}=this._bindings.update(n,s,i);this._onBindingsUpdate(o,r)}_clearBindings(){const{bounds:e,unbounds:t}=this._bindings.clear();this._onBindingsUpdate(e,t)}_getItemKey(e){return e.product_id||e.text||e.id||e}_getItems(e){throw new Error("Not implemented.")}_getItemElements(e){throw new Error("Not implemented.")}_onBindingsUpdate(e,t){this._trackImpressions(e),this._untrackViewables(t),this._trackViewables(e)}_trackImpressions(e){if(0===e.length)return;const{impression:t}=this._view.tracker.options||{};t&&this._view.tracker.impression(e.map((({value:e})=>e)))}_untrackViewables(e){for(const{element:t}of e)this._viewables.untrack(t)}_trackViewables(e){if(0===e.length)return;const{viewable:t}=this._view.tracker.options||{};if(t)for(const{value:s,element:n}of e)(async()=>{await this._viewables.track(n,t)&&this._view.tracker.viewable([s])})()}_trackClick(e,t){const{click:s}=this._view.tracker.options||{};(function(e={},t){return!!e&&("function"==typeof e.validate?e.validate(t):!!e.lenient||!gs(t)&&0===t.button&&!t.defaultPrevented&&!!m(t.target,(e=>"A"===e.tagName&&e.href||void 0)))})(s,e)&&(ys(e),this._view.tracker.click([t.value]))}_destroyTrackable(){const{unbounds:e}=this._bindings.clear();this._untrackViewables(e)}}class un{_initTriggerable(){this._trigger=void 0}_syncTrigger(e,t){if(!this.options.infiniteScroll)return;const s=this._view.workflowOptions.pagination;s.active&&"infiniteScroll"===s.mode&&(t.status===ft.READY?this._trackTrigger(e):this._untrackTrigger())}async _trackTrigger(e){if(this._trigger)return;const t=e.querySelector('[data-role="trigger"]');if(!t)return;const s=new AbortController;this._trigger=Object.freeze({element:t,ac:s});let n=!1;try{await b(t,{area:1,duration:0,signal:s.signal}),n=!0}catch(X_){if("AbortError"!==X_.name)throw X_}finally{this._trigger=void 0}n&&this._onTrigger()}_onTrigger(){this._view.hub.trigger("more")}_untrackTrigger(){this._trigger&&(this._trigger.ac&&this._trigger.ac.abort(),this._trigger=void 0)}_destroyTriggerable(){this._untrackTrigger()}}const dn=Object.freeze({product:function(e,t,s,n){const{templates:i}=e,[o,r]=Vs(e,s);return[o,(i.imageBlock||zs)(e,s,n),(i.infoBlock||i.productInfoBlock||Rs)(e,s,n),r].join("")},article:function(e,t,s,n){const{templates:i}=e,[o,r]=Vs(e,s);return[o,(i.imageBlock||zs)(e,s,n),(i.infoBlock||i.articleInfoBlock||Ns)(e,s,n),(i.indexBlock||Hs)(e,s,n),r].join("")},compactArticle:Ts,image:function(e,t,s,n){const{templates:i}=e,[o,r]=Vs(e,s);return[o,(i.imageBlock||zs)(e,s,n),(i.infoBlock||i.imageInfoBlock||Ps)(e,s,n),r].join("")},question:function(e,t,s){const[n,i]=Vs(e,s);return`${n}${s.value||s.text||s}${i}`},root:function(e,t){const{className:s,role:n,templates:i,options:o}=e,{status:r}=t;return`<div class="${s} ${r}"${n?` data-role="${n}"`:""}${o.itemType?` data-item-type="${o.itemType}"`:""}>${r===ft.READY?i[r](e,t):""}${i.trigger(e,t)}${i.loading(e,t)}</div>`},[ft.READY]:function(e,t){const{templates:s}=e,n=e._getItems(t)||[];return n.length>0||t.ongoing?s.body(e,t,n):s.empty(e,t)},empty:()=>"",body:function(e,t,s){return e.templates.list(e,t,s)},list:function(e,t,s){const{className:n,templates:i,options:o}=e,r=i.ordered?"ol":"ul";return`<${r} class="${n}__list" data-role="list"${o.itemType?` data-item-type="${o.itemType}"`:""}>${i.items(e,t,s)}</${r}>`},ordered:!1,items:function(e,t,s,{offset:n=0}={}){const{templates:i}=e;let o=n;return s.map((s=>i.item(e,t,s,o++))).join("")},item:function(e,t,s,n){const{className:i,templates:o,options:r}=e,{itemType:a}=r;return`<li class="${i}__item">${o[a](e,t,s,{index:n})}</li>`},productInfoBlock:Rs,articleInfoBlock:Ns,compactArticleInfoBlock:$s,imageInfoBlock:Ps,brandBlock:qs,titleBlock:Ls,descriptionBlock:Us,dateBlock:Ms,authorsBlock:js,authorsAndDateBlock:Ds,priceBlock:Fs,discountRateText:Bs,ctaBlock:Qs,cta:function(e,t,s){const{templates:n}=e,{url:i}=t;if(!i)return"";const[o,r]=Vs(e,{url:i},{classSuffix:"item-cta",role:"cta"}),a=Zs.asFunction(n.ctaText)(e,t,s);return a?`${o}${a}${r}`:""},imageBlock:zs,indexBlock:Hs,trigger:function(e,t){const{className:s}=e;return`<div class="${s}__trigger" data-role="trigger"></div>`},loading:function(){return'<div class="miso-loading" aria-label="Loading" data-role="loading"></div>'}});class hn extends Js{static get defaultTemplates(){return dn}constructor({templates:e,itemType:t="product",...s}){super({templates:{...dn,...e},itemType:t,...s}),this._initTrackable(),this._initTriggerable()}initialize(e){this._unsubscribes.push(e.proxyElement.on("click",this._onClick.bind(this)))}_preprocess({state:e,rendered:t}){const s=this._shallRenderIncrementally(e,t),n=this._html(e,t,s);return{...e,incremental:s,html:n}}_shallRenderIncrementally(e,t){return this.options.incremental&&t&&t.value&&t.value.length>0&&e.value&&e.value.length>=t.value.length&&e.session&&t.session&&e.session.id===t.session.id}_html(e,t,s){if(s){const s=t.value.length,n=(this._getItems(e)||[]).slice(s);return n.length>0?this.templates.items(this,e,n,{offset:s}):""}return this.templates.root(this,e)}_render(e,{state:t},{notifyUpdate:s}){const{incremental:n,html:i}=t;if(n)if(i){this._getListElement(e).insertAdjacentHTML("beforeend",i)}else s(!1);else e.innerHTML=i}_afterRender(e,t){this._syncBindings(e,t),this._syncTrigger(e,t)}_unrender(){this._clearBindings(),this._untrackTrigger()}_getItems(e){return e.value&&(e.value.products||e.value)}_getListElement(e){return e.querySelector('[data-role="list"]')}_getItemElements(e){return e?Array.from(e.querySelectorAll('[data-role="item"]')):[]}_onClick(e){const t=e.target.closest('[data-role="item"]');if(!t)return;const s=this._bindings.get(t);s&&(this._trackClick(e,s),this._emitClickEvent(e,s))}_emitClickEvent(e,t){const{session:s}=this._view._state,{value:n,element:i}=t;this._view._events.emit("click",{session:s,value:n,element:i,domEvent:e})}destroy(){this._destroyTrackable(),this._destroyTriggerable(),this._view=void 0,super.destroy()}}cn(hn.prototype),q(hn.prototype,un.prototype);const _n="miso-list";class pn extends hn{static get type(){return"list"}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return _n}constructor({className:e=_n,...t}={}){super({className:e,...t})}}const fn="miso-horizontal";class mn extends hn{static get type(){return"horizontal"}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return fn}constructor({className:e=fn,...t}={}){super({className:e,...t})}}const gn="miso-cards";function yn(e,t,s){void 0===s?e.removeAttribute(t):e.setAttribute(t,s)}function bn(e,t,s){s?e.classList.add(t):e.classList.remove(t)}function vn(e){if("number"==typeof e)return e;const[t,s]=function(e){const t=e.match(/^([+-]?(?:\d+|\d*\.\d+))([a-z]*)$/);if(!t)throw new Error(`Invalid length: ${e}`);const s=parseFloat(t[1]),n=t[2]||"";return[s,n]}(e);switch(s){case"":case"px":return t;case"rem":return function(e=1){return e*parseFloat(getComputedStyle(document.documentElement).fontSize)}(t);default:throw new Error(`Unsupported unit: ${s}`)}}function wn(e){return void 0===e||e instanceof kn?e:new kn(e)}class kn{constructor(e){switch(this._width=NaN,this._height=NaN,typeof e){case"number":this._width=e,this._height=1;break;case"object":Array.isArray(e)&&(this._width=parseFloat(e[0]),this._height=parseFloat(e[1]));break;case"string":const t=e.indexOf("/");t<0?(this._width=parseFloat(e),this._height=1):(this._width=parseFloat(e.slice(0,t).trim()),this._height=parseFloat(e.slice(t+1).trim()))}if(NaN===this._width||NaN===this._height)throw new Error(`Invalid aspect ratio value: ${e}`)}get width(){return this._width}get height(){return this._height}get floatValue(){return this._width/this._height}scaleBy(e){return e=wn(e),wn([e._width*this._width,e._height*this._height])}toString(){return 1===this._height?`${this._width}`:`${this._width} / ${this._height}`}}class Sn{_initSwipeable(){this._swipeableContext={itemCount:void 0,itemIndex:void 0,displayedCount:void 0,displayedIndex:void 0,displayEventIndex:void 0}}get itemIndex(){return this._swipeableContext.itemIndex}set itemIndex(e){const t=this._swipeableContext;void 0!==t.itemCount&&(e<0?e=t.itemCount-1:e>=t.itemCount&&(e=0),t.itemIndex=e,y((()=>this._syncDisplayedSwipeableItemIndex())))}next(){void 0!==this._swipeableContext.itemCount&&this.itemIndex++}previous(){void 0!==this._swipeableContext.itemCount&&this.itemIndex--}_renderSwipeable(e,t,s){this._syncSwipeableItemCount(t),this._syncDisplayedSwipeableItemCount(),this._syncDisplayedSwipeableItemIndex()}_afterRenderSwipeable(){this._emitSwipeableDisplayEvent()}_syncSwipeableItemCount({state:e}={}){const t=this._swipeableContext,s=this._getItems(e),n=t.itemCount,i=t.itemCount=s?s.length:void 0;i!==n&&(void 0===i?t.itemIndex=void 0:void 0===n&&(t.itemIndex=0))}_syncDisplayedSwipeableItemCount(){const e=this._swipeableContext,{itemCount:t}=e;if(t===e.displayedCount)return;let{element:s}=this._view;s=s.firstElementChild,s&&(yn(s,"data-item-count",t),e.displayedCount=t)}_syncDisplayedSwipeableItemIndex(){const e=this._swipeableContext,{itemIndex:t}=e;t!==e.displayedIndex&&(e.displayedIndex=t,this._syncSwipeableListIndex(t),this._syncSwipeableIndicatorIndex(t))}_syncSwipeableListIndex(e){const{element:t}=this._view,s=t&&this._getListElement(t);s&&(s.style.left=100*-e+"%")}_syncSwipeableIndicatorIndex(e){const{element:t}=this._view,s=t&&this._getSwipeableIndicatorElement(t);if(!s)return;let n=0;for(const i of s.children)bn(i,"active",n===e),n++}_getSwipeableIndicatorElement(e){return e.querySelector('[data-role="index-indicator"]')}_emitSwipeableDisplayEvent(){const e=this._swipeableContext,t=e.displayedIndex;e.displayEventIndex!==t&&(e.displayEventIndex=t,this._view._events.emit("display",{index:t}))}_onClickSwipeable(e){const{target:t}=e;t.closest('[data-role="previous"]')&&(e.preventDefault(),this.previous()),t.closest('[data-role="next"]')&&(e.preventDefault(),this.next())}}const En="miso-ui-icon",Cn=`${En}-svg-${"1.12.3-beta.6".replaceAll(".","_")}`,xn={SEND:"send",SEARCH:"search",TRIANGLE:"triangle",TRIANGLE_EQ:"triangle-eq",CHEVRON:"chevron",CHEVRON_NEGATIVE:"chevron-negative",BULB:"bulb"},On=`<symbol id="${En}-${xn.SEND}" viewBox="0 0 32 32"><path fill="currentColor" d="M11.499,19.173l5.801,-5.849c0.389,-0.392 1.022,-0.394 1.414,-0.006c0.392,0.389 0.395,1.022 0.006,1.414l-5.798,5.847l5.306,8.002c0.207,0.313 0.572,0.483 0.945,0.441c0.373,-0.042 0.691,-0.289 0.824,-0.64l9.024,-23.904c0.138,-0.366 0.05,-0.78 -0.226,-1.058c-0.276,-0.278 -0.689,-0.369 -1.057,-0.233l-24.004,8.892c-0.353,0.13 -0.602,0.448 -0.646,0.821c-0.044,0.373 0.125,0.74 0.438,0.948l7.973,5.325Z"/></symbol>`,In=`<symbol id="${En}-${xn.SEARCH}" viewBox="0 0 24 24"><path fill="currentColor" d="M4 11C4 7.13401 7.13401 4 11 4C14.866 4 18 7.13401 18 11C18 14.866 14.866 18 11 18C7.13401 18 4 14.866 4 11ZM11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C13.125 20 15.078 19.2635 16.6177 18.0319L20.2929 21.7071C20.6834 22.0976 21.3166 22.0976 21.7071 21.7071C22.0976 21.3166 22.0976 20.6834 21.7071 20.2929L18.0319 16.6177C19.2635 15.078 20 13.125 20 11C20 6.02944 15.9706 2 11 2Z"/></symbol>`,Tn=`<symbol id="${En}-${xn.TRIANGLE}" viewBox="-5 -5 105 105"><path d="${function(e){const t=100,s=e*Math.tan(3*Math.PI/8),n=s*Math.sin(Math.PI/4);return`M${e} 0L${t-s} 0A${e} ${e} 0 0 1 ${t-n} ${n}L${n} ${t-n}A${e} ${e} 0 0 1 0 ${t-s}L0 ${e}Z`}(5)}"/></symbol>`,An=`<svg id="${Cn}" style="display:none;">${[On,In,Tn,`<symbol id="${En}-${xn.TRIANGLE_EQ}" viewBox="-100 -100 200 200"><path d="M12.99 -77.5A15 15,0,0,0,-12.99 -77.5L-73.61 27.5A15 15,0,0,0,-60.62 50L60.62 50A15 15,0,0,0,73.61 27.5L12.99 -77.5Z"/></symbol>`,`<symbol id="${En}-${xn.CHEVRON}" viewBox="-100 -100 200 200"><path d="M10.61 -43.94A15 15,0,0,0,-10.61 -43.94L-60.61 6.06A15 15,0,0,0,-39.39 27.27L0 -12.12L39.39 27.27A15 15,0,0,0,60.61 6.06L10.61 -43.94Z"/></symbol>`,`<symbol id="${En}-${xn.CHEVRON_NEGATIVE}" viewBox="-100 -100 200 200"><path d="M100 100V-200H-200V200H200ZM-10.61 -43.94A15 15,0,0,1,10.61 -43.94L60.61 6.06A15 15,0,0,1,39.39 27.27L0 -12.12L-39.39 27.27A15 15,0,0,1,-60.61 6.06L-10.61 -43.94Z"/></symbol>`,`<symbol id="${En}-${xn.BULB}" viewBox="0 0 16 16"><path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1"/></symbol>`].join("")}</svg>`;let Rn=!1;function Nn(e){return`<svg class="miso-ui-icon miso-ui-icon-${e}"><use href="#${En}-${e}"></use></svg>`}Rn||document.head.querySelector(`#${Cn}`)||(Rn=!0,document.head.insertAdjacentHTML("beforeend",An));const $n=new Set(Object.values(xn));const Pn=Nn(xn.TRIANGLE),Ln=Nn(xn.CHEVRON),qn=Nn(xn.CHEVRON_NEGATIVE),Un=Nn(xn.BULB),Mn="miso-carousel",jn=Object.freeze({body:function(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__viewport"><div class="${n}__viewport-inner">${i.list(e,t,s)}</div></div>${i.controls(e,t,s)}`},controls:function(e,t,s){const{templates:n}=e;return`${n.controlContainer(e,t,"previous")}${n.controlContainer(e,t,"next")}${n.indexIndicator(e,t,s)}`},controlContainer:function(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__control-container-${s}">${i.control(e,t,s)}</div>`},control:function(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__control-${s}" data-role="${s}">${i.controlIcon(e,t,s)}</div>`},controlIcon:function(e){return"image"===e.options.itemType?qn:Ln},indexIndicator:function(e,t,s){const{className:n,templates:i}=e;return`<ul class="${n}__index-indicator" data-role="index-indicator">${s.map((s=>`<li class="${n}__index-indicator-item">${i.indexIndicatorItem(e,t,s)}</li>`)).join("")}</ul>`},indexIndicatorItem:()=>"",trigger:()=>""}),Dn=Object.freeze({...hn.defaultTemplates,...jn});class Fn extends hn{static get type(){return"carousel"}static get defaultTemplates(){return Dn}static get defaultClassName(){return Mn}constructor({className:e=Mn,templates:t,...s}={}){super({className:e,templates:{...jn,...t},...s}),this._initSwipeable()}_render(e,t,s){super._render(e,t,s),this._renderSwipeable(e,t,s)}_afterRender(e,t){super._afterRender(e,t),this._afterRenderSwipeable(e,t)}_onClick(e){this._onClickSwipeable(e),super._onClick(e)}}!function(e){q(e,Sn.prototype)}(Fn.prototype);const Bn="16rem",zn=Object.freeze({...hn.defaultTemplates,item:function(e,t,s,n){const{className:i,templates:o,options:r}=e,{itemType:a}=r,c=o[a](e,t,s,{index:n});return`<li class="${i}__item${s._size?` ${i}__item-${s._size}`:""}">${c}</li>`}}),Hn="miso-gallery";class Qn extends hn{static get type(){return"gallery"}static get defaultTemplates(){return zn}static get defaultClassName(){return Hn}constructor({className:e=Hn,templates:t,...s}={}){super({className:e,templates:{...zn,...t},...s}),this._galleryContext={itemAspectRatio:void 0,itemCount:void 0,columnCount:void 0}}syncSize(){const{element:e}=this._view,t=e&&this._getListElement(e);t&&(this._syncListAspectRatio(t),this._syncItemSizes(t))}_preprocess({state:e,rendered:t}){const s=this._shallRenderIncrementally(e,t),n=s?void 0:this._bodyHtml(e),i=this._itemsHtml(e,t);return{...e,...a({incremental:s,bodyHtml:n,itemsHtml:i})}}_bodyHtml(e){return this.templates.root(this,{...e,value:[]})}_itemsHtml(e,t){const s=t&&t.value&&t.value.length||0,n=(this._getItems(e)||[]).slice(s);return n.length>0?this.templates.items(this,e,n,{offset:s}):""}_render(e,t,s){this._syncItemCount(t),this._syncCssVariables();const n=this._renderListElement(e,t,s);n&&(this._syncListAspectRatio(n),this._renderItems(n,t,s))}_renderListElement(e,{state:t}){const{incremental:s,bodyHtml:n}=t;return s||(e.innerHTML=n),this._getListElement(e)}_renderItems(e,t){t.state.incremental?this._appendItems(e,t):this._updateItems(e,t)}_updateItems(e,{state:t}){const{itemSizes:s}=this._galleryContext,n=this._writeItemSizes(this._getItems(t)||[],s);e.innerHTML=this.templates.items(this,t,n)}_appendItems(e,{state:t}){const{itemSizes:s}=this._galleryContext;this._syncItemSizes(e);const n=e.children.length,i=this._writeItemSizes((this._getItems(t)||[]).slice(n),s,n);e.insertAdjacentHTML("beforeend",this.templates.items(this,t,i,{offset:n}))}_writeItemSizes(e,[t=0,s=0]=[],n=0){let i=0;n>0&&(i=Math.min(n,t),n-=i,t-=i),n>0&&(i=Math.min(n,s),n-=i,s-=i);const o=[];for(const r of e){let e="small";t>0?(e="large",t--):s>0&&(e="medium",s--),o.push({...r,_size:e})}return o}_syncCssVariables(){const e=this._galleryContext;let{itemAspectRatio:t=1}=this.options;t=e.itemAspectRatio=wn(t);const{element:s}=this._view;s&&(s.style.setProperty("--miso-gallery-item-1x1-aspect-ratio",`${t}`),s.style.setProperty("--miso-gallery-item-1x2-aspect-ratio",`${t.scaleBy([1,2])}`))}_syncListAspectRatio(e){const t=this._galleryContext,{itemCount:s,itemAspectRatio:n}=t,{height:i=Bn}=this.options,o=vn(i),r=e.clientWidth;if(0===r)return t.columnCount=void 0,void(t.itemSizes=void 0);const a=t.columnCount=Math.round(r*n.width*2/(o*n.height));t.itemSizes=function(e,t){const s=2*t;let n=Math.max(s-e,0),i=e;const o=Math.min(Math.floor(n/3),i);i-=o,n-=3*o;const r=Math.min(n,i);return i-=r,n-=r,[o,r,i]}(s,a),e.style.aspectRatio=`${a} / 2`,e.style.height=s>0?"auto":"0"}_syncItemCount({state:e}={}){const t=this._getItems(e);this._galleryContext.itemCount=t?t.length:void 0}_syncItemSizes(e){const{itemSizes:t=[]}=this._galleryContext;let[s=0,n=0]=t;const{className:i}=this;for(const o of e.children){let e=!1,t=!1;s>0?(e=!0,s--):n>0&&(t=!0,n--),bn(o,`${i}__item-large`,e),bn(o,`${i}__item-medium`,t),bn(o,`${i}__item-small`,!e&&!t)}}}const Vn="miso-search-box";const Gn=Object.freeze({root:function(e){const{className:t,templates:s,role:n,options:i,autocomplete:o}=e,{placeholder:r}=i;return`\n<div class="${t}" ${n?`data-role="${n}"`:""}>\n  <div class="${t}__input-group">\n    <input class="${t}__input" type="text" data-role="input" ${r?`placeholder="${r}"`:""}>\n    <button class="${t}__button" type="submit" data-role="submit">${s.buttonContent(e)}</button>\n  </div>\n  <div class="${o.className}" data-role="autocomplete"></div>\n</div>`.trim()},buttonContent:function(e){const{templates:t,options:s}=e;if(s.buttonText)return s.buttonText;const{buttonText:n,buttonIcon:i}=t;var o;return("function"==typeof n?n(e):`${n}`)+("function"==typeof i?i(e):(o=i,($n.has(o)?Nn(o):"")||`${i}`))},buttonText:"",buttonIcon:"search",completions:function(e,t){const{templates:s,workflow:n,autocomplete:i}=e;e={templates:s,workflow:n,...i};const o=[],r=[];for(const a of t)(a.product?o:r).push(a);return s.queries(e,r)+(r.length>0&&o.length>0?"<hr>":"")+s.products(e,o)},completionList:function(e,t,s){const{className:n,templates:i}=e;return`<ul class="${n}__${t}-list" data-role="${t}-list">${s.map((s=>i.completionItem(e,t,s))).join("")}</ul>`},completionItem:function(e,t,s){const{className:n,templates:i}=e;return`\n<li class="${n}__${t}-item" data-role="${t}-item" data-index="${s._index}" tabindex="0">\n  ${i[t](e,s)}\n</li>`.trim()},queries:function(e,t){const{templates:s}=e;return s.completionList(e,"query",t)},products:function(e,t){const{templates:s}=e;return s.completionList(e,"product",t)},query:function(e,{text:t,text_with_inverted_markups:s}={}){return s||v(t)},product:function(e,{product:t}){const{templates:s}=e,[n,i]=s.helpers.tagPair(e,t,{role:!1});return[n,s.imageBlock(e,t),s.productInfoBlock(e,t),i].join("")},imageBlock:zs,productInfoBlock:Rs}),Wn=Object.freeze({className:"miso-autocomplete",debounce:300});class Kn extends Js{static get type(){return"search-box"}static get defaultTemplates(){return Gn}static get defaultClassName(){return Vn}constructor({className:e=Vn,templates:t,autocomplete:s,...n}={}){super({className:e,templates:{...Gn,...t},...n}),u(this,{autocomplete:{...Wn,...s}}),this._contexts=new WeakMap,this._prevInput=void 0,this._debounce=$(this.autocomplete.debounce)}initialize(e){const{proxyElement:t,hub:s}=e;this._unsubscribes=[...this._unsubscribes,t.on("input",(e=>this._syncInput(e))),t.on("keydown",(e=>this._handleKeyDown(e))),t.on("click",(e=>this._handleClick(e))),t.on("focusin",(e=>this._handleFocusIn(e))),t.on("focusout",(e=>this._handleFocusOut(e))),s.on("completions",(()=>e.refresh({force:!0})))]}focus(){this._element?this._context().focus():this._focusRequested=!0}open(){this._element.classList.add("open")}close(){this._element.classList.remove("open")}set value(e){this._element?this._context().value=e:this._valueRequested=e}_preprocess({state:e}){return e=super._preprocess({state:e}),{...e,completions:this._view.hub.states.completions}}_render(e,t,s){0===e.childElementCount&&super._render(e,t,s),this._updateCompletions(e,t,s)}_afterRender(e,t){this._fullfillFocusRequest(e),this._fullfillValueRequest(e)}_updateCompletions(e,{state:t,rendered:s},{writeToState:n}){if(!t.completions)return;const{status:i=ft.INITIAL,session:o,value:r}=t.completions,{index:a}=o;if(s&&s.completions.index===a&&s.completions.status===i)return;const c=this._context(e),{autocompleteElement:l}=c;if(!l)return;const u=c.trackItems(r);bn(e,"nonempty",u.length>0),l.setAttribute("data-status",i),l.innerHTML=this.templates.completions(this,u),n({completions:{index:a,status:i}})}_fullfillFocusRequest(e){e&&this._focusRequested&&(this._focusRequested=!1,this._context(e).focus())}_fullfillValueRequest(e){e&&this._valueRequested&&(this._context(e).value=this._valueRequested,this._valueRequested=void 0)}_context(e){if(!(e=e||this._view.element))return Yn.empty();let t=this._contexts.get(e);return t||this._contexts.set(e,t=new Yn(e)),t}_syncInput(){const{inputElement:e}=this._context();if(!e)return;const t=e.value.trim();if(this._prevInput===t)return;this._prevInput=t;const s=this;this._debounce((()=>s._view.hub.update("input",{value:t})))}_handleFocusIn({target:e}){this._element&&e.matches('[data-role="input"]')&&(this._syncInput(),this.open())}_handleFocusOut({relatedTarget:e}){this._element&&(e&&m(e,(e=>e===this._element||void 0))||this.close())}_handleKeyDown({key:e,target:t,isComposing:s}){!s&&"Enter"===e&&t.matches('[data-role="input"]')&&(this._submit(t.value),t.blur())}_handleClick(e){const{target:t}=e,{inputElement:s}=this._context();for(let n=t;n&&n!==this._element;n=n.parentElement){if(n.matches('[data-role="submit"]')||n.matches('[data-role="button"]')||n.matches('[type="submit"]'))return void(s&&(s.blur(),this._submit(s.value)));if(n.matches('[data-role="query-item"]')){const t=n.getAttribute("data-index"),i=this._context().data.get(parseInt(t)),o=i&&i.text;return o&&(s&&(s.value=o),this._view._events.emit("select",Object.freeze({value:i,index:t,domEvent:e})),e.defaultPrevented||this._submit(o)),void this.close()}if(n.matches('[data-role="product-item"]'))return void this._view._events.emit("select",Object.freeze({value:item,index:index,domEvent:e}))}}async _submit(e){e&&e.trim()&&(this.close(),this._view.hub.update("query",{q:e}),this._trackSubmit(e))}_trackSubmit(e){const{[ut.SUBMIT]:t}=this._view.tracker.options||{};t&&this._view.tracker.submit({value:e})}}class Yn{static empty(){return Yn._empty||(Yn._empty=new Yn)}constructor(e){this._element=e,this._cache={},this._data=new Map}get inputElement(){return this._get("input")}get autocompleteElement(){return this._get("autocomplete")}get data(){return this._data}trackItems(e){let t=0;const s=this._data=new Map,n=[];for(const i in e)for(const o of e[i])o.product&&!o.product.url||(o._index=t,o._field=i,s.set(t,o),n.push(o),t++);return n}focus(){if(!this._element)return;const{inputElement:e}=this;e&&e.focus()}set value(e){if(!this._element)return;const{inputElement:t}=this;t&&(t.value=e)}_get(e){return this._element?this._cache[e]||(this._cache[e]=this._element.querySelector(`[data-role="${e}"]`)):void 0}}const Zn="miso-option-list";const Jn=Object.freeze({root:function(e,t){const{className:s,role:n,templates:i}=e;return`\n<div class="${s}" ${n?`data-role="${n}"`:""}>\n  ${i.options(e,t)}\n</div>\n`},options:function(e,t){const{className:s,templates:n}=e;return`\n<ol class="${s}__options" data-role="options">\n  ${(t.value||[]).map(((t,s)=>n.option(e,t,{index:s}))).join("")}\n</ol>\n`},option:function(e,t){const{className:s}=e;return`<li class="${s}__option" data-role="option" tabindex="0">${v(t.text||t)}</li>`}});class Xn extends Js{static get type(){return"option-list"}static get defaultTemplates(){return Jn}static get defaultClassName(){return Zn}constructor({className:e=Zn,templates:t,...s}={}){super({className:e,templates:{...Jn,...t},...s}),this._initTrackable()}initialize(e){const{proxyElement:t}=e;this._unsubscribes=[...this._unsubscribes,t.on("click",(e=>this._handleClick(e)))]}_render(e,t,s){super._render(e,t,s);const{state:n}=t;this._syncOptionValues(e,n)}_afterRender(e,t){this._syncBindings(e,t)}_unrender(){this._clearBindings()}_syncOptionValues(e,t){const s=e&&this._getOptionsElement(e);if(!s)return;bn(s,"empty",0===(this._getItems(t)||[]).length)}_getItems(e){return e.value}_getOptionsElement(e){return e.querySelector('[data-role="options"]')}_getItemElements(e){return e?Array.from(e.querySelectorAll('[data-role="option"]')):[]}_handleClick(e){const t=e.target.closest('[data-role="option"]');if(!t)return;const s=this._bindings.get(t),n=s&&s.value;n&&(this._trackClick(e,s),this._select(n.text))}async _select(e){e&&this._view._events.emit("select",{value:e})}destroy(){this._destroyTrackable(),super.destroy()}}cn(Xn.prototype);const ei=Object.freeze({...Is("options"),root:function(e){const{className:t,role:s,templates:n}=e;return`\n<div class="${t}" ${s?`data-role="${s}"`:""}>\n  ${n.options(e)}\n</div>\n`},option:function(e,t){const{className:s,templates:n}=e;return`\n<div role="button" class="${s}__option" data-value="${t.value}">\n  ${n.content(e,t)}\n</div>\n`}});class ti extends Js{static get defaultTemplates(){return ei}constructor({className:e,templates:t,field:s,defaultValue:n,...i}={}){super({className:e,templates:{...ei,...t},...i}),this._field=s,this._defaultValue=n}initialize(e){const{proxyElement:t}=e;this._unsubscribes=[...this._unsubscribes,e.hub.on(this._field,(()=>this._refresh())),t.on("click",(e=>this._handleClick(e)))],this._defaultValue?this._select(this._defaultValue,{silent:!0}):this._clear({silent:!0})}_preprocess(e,t){return e.rendered&&t.skip(),super._preprocess(e,t)}_handleClick({target:e}){const t=m(e,(e=>e.hasAttribute("data-value")?e:void 0));if(!t)return;let{unselected:s,value:n}=this._view.hub.states[this._field];s=s||void 0===n;const i=t.getAttribute("data-value");s||void 0===n||n!==i?this._select(i):this._clear()}_refresh(){this._state=this._view.hub.states[this._field],y((()=>this._syncValueAttribute()))}_syncValueAttribute(){if(!this._state||!this._view)return;const{element:e}=this._view,t=e&&e.children[0];if(!t)return;let{unselected:s,value:n}=this._state;s?t.removeAttribute("data-selected"):t.setAttribute("data-selected",n),this._state=void 0}_select(e,t){this._submit({value:e},t)}_clear(e){this._submit({unselected:!0},e)}async _submit(e,t){this._view.hub.update(this._field,e,t)}}const si="miso-feedback",ni=["helpful","unhelpful"];const ii=Object.freeze({options:function(e){const{templates:t}=e;return ni.map((s=>t.option(e,{value:s}))).join("")},content:function(e,{value:t}){const{className:s,templates:n,options:i={}}=e;return`\n${!1!==i.icon?`<i class="${s}__icon">${n.icon(e,t)}</i>`:""}\n${!1!==i.text?`<span class="${s}__text">${n.text(e,t)}</span>`:""}\n`},icon:function(e,t){switch(t){case"helpful":case"unhelpful":return'<svg viewBox="0 0 16 16"><path d="M8.342 3.652 4.979 5.708a1 1 0 0 0-.479.852v5.561a1 1 0 0 0 .87.992l6.029.79a1 1 0 0 0 1.042-.583l2.534-5.65a1 1 0 0 0-.74-1.394l-3.543-.623.9-3.1A2.097 2.097 0 0 0 10.297 0L8.719 3.237a1 1 0 0 1-.377.415ZM1 6.5a1.5 1.5 0 0 1 3 0v6a1.5 1.5 0 0 1-3 0Z"/></svg>';default:return""}},text:function(e,t){switch(t){case"helpful":return"Helpful";case"unhelpful":return"Not helpful";default:return""}}});class oi extends ti{static get type(){return"feedback"}static get defaultTemplates(){return ii}static get defaultClassName(){return si}constructor({className:e=si,templates:t,...s}={}){if(super({className:e,templates:{...ii,...t},field:"feedback",...s}),!1===s.text&&!1===s.icon)throw new Error("At least one of options.text or options.icon must be enabled")}}const ri="miso-text";const ai=Object.freeze({root:function(e,{value:t}){const{className:s,role:n,options:{raw:i=!1,tag:o}}=e,r=n?`data-role="${n}"`:"",a=void 0!==t?v(function(e){let{format:t}=e.options;const{formatDate:s,formatNumber:n}=e.templates.helpers;if(!t)return e=>`${e}`;switch(typeof t){case"function":return t;case"string":t=[t]}let[i,o]=t;switch(i){case"date":return e=>s(e,o);case"number":return e=>n(e,o);default:return e=>`${e}`}}(e)(t)):"";return i?a:`<${o} class="${s}" ${r}>${a}</${o}>`}});class ci extends Js{static get type(){return"text"}static get defaultTemplates(){return ai}static get defaultClassName(){return ri}constructor({className:e=ri,templates:t,tag:s="p",...n}={}){super({className:e,templates:{...ai,...t},tag:s,...n})}}class li extends Os{constructor(e){super(e)}_takePending(){return this._pending}_applyRender(e,t={}){const s=E(!1);super._applyRender(e,{...t,loop:s.t}),s.value&&this._requestRaf()}}class ui{clear(e){return e.innerText="",{cursor:0,done:!1}}update(e,{value:t,cursor:s},{value:n,cursor:i,done:o}){const r=n.length;i=Math.min(i,r);const a=!!o&&i===r,c=t.substring(0,s),l=!n.startsWith(c);return a||l?e.innerText=n:e.insertAdjacentText("beforeend",n.substring(s,i)),a&&e.classList.add("done"),{cursor:i,done:a}}}function di(e,t,{status:s}){if(!t)return;0===t.children.length&&(t.innerHTML=function(e){let{className:t,role:s,options:{tag:n,format:i,builtInStyles:o=!0}}=e;"auto"===n&&(n="markdown"===i?"div":"p");const r=s?`data-role="${s}"`:"",a=[t,hi(t)];o&&"markdown"===i&&a.push("miso-markdown");return`<${n} class="${a.join(" ")}" ${r} data-format="${i}"></${n}>`}(e));const n=t.children[0];return n.setAttribute("data-status",s||ft.INITIAL),n}function hi(e){return`${e}__cursor`}function _i(e){if(!0===e)return function(e=performance.now()){return function({summary:t,timestamp:s,elapsed:n,ref:i,operation:o,conflict:r}){var a;MisoClient.debug("<progressive-markdown>",`[${a=s-e,Math.floor(a)/1e3+"s"}](${pi(n[0])}, ${pi(n[1])})`,t,`${o}`,i,r)}}();if(e){if("function"==typeof e)return e;throw new Error("onDebug must be a function or a boolean")}}function pi(e){return Math.floor(100*e)/100+"ms"}const fi="miso-typewriter";class mi extends li{static get type(){return"typewriter"}static get defaultClassName(){return fi}constructor({className:e=fi,tag:t="auto",format:s="markdown",tooltip:n=!1,speed:i,acceleration:o,nextCursorFn:r,...a}={}){super({tag:t,format:s,tooltip:n,...a}),u(this,{className:e}),this._prevState=void 0,this._getNextCursor="function"==typeof r?r:D({speed:i,acceleration:o}),this._readiness=new x,"markdown"===s&&mi.MisoClient.plugins.install("std:ui-markdown")}initialize(){this._setup()}async _setup(){try{if("plaintext"===this.options.format)await this._setupForPlaintext();else await this._setupForMarkdown();this._readiness.resolve()}catch(X_){this._readiness.reject(X_)}}async _setupForMarkdown(){const e=await this._view._views._extensions.require("markdown");if(!this._view)return;const t=hi(this.className),{onDebug:s,onCitationLink:n,variant:i}=this.options;this._renderer=e.createRenderer({cursorClass:t,getSource:e=>this._getSource(e),onCitationLink:n,onDebug:_i(s),variant:i}),this._unsubscribes.push(this._view.proxyElement.on("click",(e=>this._onClick(e))))}_getSource(e){const{data:t={}}=this._view._data,{sources:s=[]}=t;return s[e]}async _setupForPlaintext(){this._renderer=new ui}async _ready(){return this._readiness.promise}async render(...e){await this._ready(),await super.render(...e)}_preprocess({state:e}){const t=this._prevState,{value:{value:s="",stage:n,finished:i}={},session:o,status:r}=e,c=(u=e,(l=t)&&u&&l.session&&u.session&&l.session.uuid===u.session.uuid);var l,u;const d=c&&n===t.stage,h=t?d?t.streak:t.streak+1:0,_=c&&t&&t.doneAt||(r===ft.READY&&i?performance.now():void 0),p=void 0!==_;return this._prevState=Object.freeze(a({session:o,status:r,value:s,stage:n,streak:h,doneAt:_,done:p}))}_render(e,{state:t,rendered:s},{notifyUpdate:n,writeToState:i,loop:o}){const r=di(this,e,t);let a;const c=!s||t.streak!==s.streak;if(c)a=this._renderer.clear(r,s);else{const e=this._getNextCursor(s.cursor,t.doneAt,s.timestamp,t.timestamp);a=this._renderer.update(r,s,{...t,cursor:e})}i(a);const l=t.status===ft.READY&&!a.done;n({ongoing:l},{silent:l&&(!s||s.status===ft.READY)&&!c}),l&&o()}_onClick(e){const{target:t}=e,s=t.closest('[data-role="citation-link"]');if(s){const t=parseInt(s.dataset.index);return void(Number.isNaN(t)||this._view._events.emit("citation-click",{event:e,index:t}))}const n=t.closest('[data-role="follow-up-link"]');if(n){let{q:t}=n.dataset;return t=t?t.trim():void 0,void(t&&this._view._events.emit("follow-up-click",{event:e,q:t}))}const i=t.closest("a");if(i){if(!e.defaultPrevented){const{href:t,innerText:s,className:n}=i;t&&this._view._events.emit("link-click",a({event:e,url:t,text:s?s.trim():"",className:n||"",attributes:gi(i)}))}}else;}}function gi(e){const{attributes:t}=e,s={};for(const{name:n,value:i}of t)n.startsWith("data-")&&(s[n]=i);try{return JSON.stringify(s)}catch(X_){return"{}"}}const yi="miso-affiliation";const bi=Object.freeze({root:function(e,t){const{className:s,role:n,templates:i,options:o}=e,{status:r}=t,a=n?` data-role="${n}"`:"",c=t.value||{},l=c.channel?` data-channel="${c.channel}"`:"",u=e._getItems(t),d=u?u.length:void 0,h=void 0!==d?` data-item-count="${d}"`:"";return`<div class="${s} ${r}"${a}${l}${o.itemType?` data-item-type="${o.itemType}"`:""}${h}>${r===ft.READY?i[r](e,t):""}</div>`},[ft.READY]:function(e,t){const{templates:s}=e,n=e._getItems(t);return n&&n.length>0?s.controlContainer(e,t,"previous")+s.body(e,t)+s.controlContainer(e,t,"next"):s.empty(e,t)},controlContainer:function(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__control-${s}-container">${i.control(e,t,s)}</div>`},control:function(e,t,s){const{className:n,templates:i}=e;return`<div class="${n}__control-${s}" data-role="${s}">${i.controlIcon(e,t,s)}</div>`},controlIcon:function(e,t,s){return Pn},body:function(e,t){const{className:s,templates:n}=e,i=e._getItems(t);return`<div class="${s}__body">${n.list(e,t,i)}</div>`},item:function(e,t,s,n){const{className:i,templates:o,options:r}=e,{itemType:a}=r;return`<li class="${i}__item"><div class="${i}__item-inner">${o.itemHeader(e,t,s,{index:n})}${o[a](e,t,s,{index:n})}</div></li>`},itemHeader:function(e,t,s,n){const{className:i,templates:o}=e;let{itemHeaderLeftText:r,itemHeaderRightText:a}=o;return r=Zs.asFunction(r)(e,t,s,n),a=Zs.asFunction(a)(e,t,s,n),`<div class="${i}__item-header">\n  <div class="${i}__item-header-left">${r}</div>\n  <div class="${i}__item-header-right">${a}</div>\n</div>`},affiliation:function(e,t,s,n){const{templates:i}=e,[o,r]=Vs(e,s,{link:!1});return[o,(i.infoBlock||i.affiliationInfoBlock||As)(e,s,n),(i.imageBlock||zs)(e,s,{brand:!0,...n}),r].join("")},ctaText:"View deal",itemHeaderLeftText:"Today's best deals",itemHeaderRightText:function(e,t,s,n){const{className:i,templates:o}=e,r=Zs.asFunction(o.logoText)(e,t,s,n)||"",a=Zs.asFunction(o.logoImg)(e,t,s,n);return a?`<span class="${i}__item-header-logo-text">${r}</span>${a}`:""},logoImg:function(e,t,s,n){const{className:i,templates:o}=e,r=Zs.asFunction(o.logoUrl)(e,t,s,n);if(!r)return"";const a=Zs.asFunction(o.logoAltText)(e,t,s,n);return`<img class="${i}__item-header-logo" src="${r}"${a?` alt="${a}"`:""}>`},logoText:"Selected by"}),vi=Object.freeze({...hn.defaultTemplates,...bi});class wi extends hn{static get type(){return"affiliation"}static get defaultTemplates(){return vi}static get defaultClassName(){return yi}constructor({className:e=yi,templates:t,autoplay:s,...n}={}){super({className:e,itemType:"affiliation",templates:{...bi,...t},...n}),this._itemCount=void 0,this._itemIndex=0,this._displayedCount=void 0,this._displayedIndex=void 0,this._viewable=void 0}initialize(e){super.initialize(e);const{viewable:t}=this._view.tracker.options||{};this._viewable=new Y(this._onViewable.bind(this),t)}get itemIndex(){return this._itemIndex}set itemIndex(e){void 0!==this._itemCount&&(e<0?e=this._itemCount-1:e>=this._itemCount&&(e=0),this._itemIndex=e,y((()=>this._syncItemIndex())))}next(){void 0!==this._itemCount&&this.itemIndex++}previous(){void 0!==this._itemCount&&this.itemIndex--}_render(e,t,s){super._render(e,t,s),this._syncItemCount(t),this._syncItemIndex()}_syncElement(e){const t=this._element;super._syncElement(e),this._syncViewableElement(t,e)}_syncViewableElement(e,t){e!==t&&(e&&this._viewable.unobserve(e),t&&this._viewable.observe(t))}_syncItemCount({state:e}={}){const t=this._getItems(e),s=this._itemCount=t?t.length:void 0;if(s===this._displayedCount)return;let{element:n}=this._view;n=n.firstElementChild,n&&(yn(n,"data-item-count",s),this._displayedCount=s)}_syncItemIndex(){const e=this._itemIndex;if(e===this._displayedIndex)return;const{element:t}=this._view,s=t&&this._getListElement(t);s&&(this._displayedIndex=e,s.style.left=100*-e+"%",this._viewable.display(e),this._view._events.emit("display",{index:e}))}_onViewable(e){const t=this._getRenderedItemData(e);t&&this._view.tracker.viewable([t])}_getRenderedItemData(e){const{value:t}=this._rendered.get(this._element)||{};if(!t)return;const{products:s=[]}=t;return s[e]}_trackViewables(){}_onClick(e){const t=e.target;t.closest('[data-role="previous"]')?this.previous():t.closest('[data-role="next"]')?this.next():super._onClick(e)}}const ki="miso-facets",Si="miso-facet",Ei="custom_attributes.";const Ci=Object.freeze({root:function(e,t){const{className:s,role:n,templates:i}=e;return`<div class="${s}" ${n?`data-role="${n}"`:""}>${i.facets(e,t)}</div>`},facets:function(e,t){const{templates:s}=e,{facet_fields:n={}}=t.value||{};return Object.keys(n).map((i=>s.facet(e,{field:i,entries:n[i]},t)))},facet:function(e,t,s){const{facetClassName:n=Si,templates:i}=e,{field:o}=t;return`<div class="${n}" data-role="facet" data-field="${v(o)}">${i.header(e,t,s)}${i.options(e,t,s)}</div>`},header:function(e,t,s){const{facetClassName:n=Si,templates:i}=e;return`<div class="${n}__header">${i.title(e,t,s)}</div>`},title:function(e,{field:t}){return t.startsWith(Ei)&&(t=t.substring(18)),v(t)},options:function(e,{field:t,entries:s},n){const{facetClassName:i=Si,templates:o}=e;return`<ul class="${i}__options" data-role="options">${s.map((([s,i])=>o.option(e,{field:t,value:s,count:i},n))).join("")}</ul>`},option:function(e,t,s){const{facetClassName:n=Si,templates:i}=e;return`\n<li class="${n}__option" data-role="option" tabindex="0">\n  <span class="${n}__value">${i.value(e,t,s)}</span>\n  <span class="${n}__count">${i.count(e,t,s)}</span>\n</li>`},value:function(e,{value:t},s){return v(t)},count:function(e,{count:t},s){return e.templates.helpers.formatNumber(t)}});function xi(e,t){return`${e}:::${t}`}function Oi(e){const t={};for(const s in e)t[s]=new Set(e[s]);return t}class Ii extends Js{static get type(){return"facets"}static get defaultTemplates(){return Ci}static get defaultClassName(){return ki}constructor({className:e=ki,templates:t,...s}={}){super({className:e,templates:{...Ci,...t},...s}),this._bindings=new an}initialize(e){const{proxyElement:t,filters:s}=e;this._unsubscribes=[...this._unsubscribes,t.on("click",(e=>this._handleClick(e))),s.on("update",(e=>this._updateSelections(e))),s.on("reset",(()=>this._syncSelections()))]}_render(e,t,s){super._render(e,t,s)}_afterRender(e,t){this._syncBindings(e,t),this._syncSelections()}_unrender(){this._clearBindings()}_syncSelections(){const e=Oi(this._view.hub.states.filters.facets);for(const{value:{field:t,value:s},element:n}of this._bindings.entries)this._setSelected(n,e[t]&&e[t].has(s))}_updateSelections({updates:e}){const t=Oi(e.facets);for(const{value:{field:s,value:n},element:i}of this._bindings.entries)t[s]&&this._setSelected(i,t[s].has(n))}_setSelected(e,t){e&&(t?e.classList.add("selected"):e.classList.remove("selected"))}_syncBindings(e,t){if(!e||!t.value)return;const s=this._getItems(t),n=[],i=[],o=[];for(const r of this._getFacetElements(e)){const e=r.getAttribute("data-field"),t=s[e];if(!t)continue;const a=this._getItemElements(r);for(let s=0;s<a.length;s++){const r=a[s],c=t[s];if(!c)break;n.push(xi(e,c)),i.push({field:e,value:c}),o.push(r)}}this._bindings.update(n,i,o)}_clearBindings(){this._bindings.clear()}_getItems({value:e}={}){const{facet_fields:t={}}=e||{},s={};for(const n in t)s[v(n)]=t[n].map((([e])=>e));return s}_getFacetElements(e){return Array.from(e.querySelectorAll('[data-role="facet"]'))}_getFacetElement(e,t){return e.querySelector(`[data-role="facet"][data-field="${t}"]`)}_getItemElements(e){return Array.from(e.querySelectorAll('[data-role="option"]'))}_handleClick(e){if(0!==e.button)return;const t=e.target.closest('[data-role="option"]');if(!t)return;const s=this._bindings.get(t),n=s&&s.value;if(!n)return;const{field:i,value:o}=n;this._view.filters.facets.toggle(i,o),this._view.filters.apply()}destroy(){this._bindings.clear(),super.destroy()}}const Ti="miso-select";const Ai=Object.freeze({root:function(e,t){const{className:s,role:n,templates:i}=e,o=n?`data-role="${n}"`:"",r=e._getItems(t),a=r.find((e=>e.selected))||r[0];return`\n<div class="${s}" ${o}>\n  ${i.button(e,a)}\n  ${i.options(e,t)}\n</div>`},button:function(e,t){const{className:s,templates:n}=e;return`<button class="${s}__button" data-role="button" tabindex="0">${n.text(e,t)}</button>`},options:function(e,t){const{className:s,templates:n}=e;return`<ul class="${s}__options">${e._getItems(t).map(((t,s)=>n.option(e,t,{index:s}))).join("")}</ul>`},option:function(e,t){const{className:s,templates:n}=e;return`<li class="${s}__option ${t.selected?"selected":""}" data-role="option" tabindex="0">${n.text(e,t)}</li>`},text:function(e,t){return v(t&&t.text&&t.text.replace(/[-_]([a-zA-Z])/g,((e,t)=>` ${t}`))||t||"")}});class Ri extends Js{static get type(){return"select"}static get defaultTemplates(){return Ai}static get defaultClassName(){return Ti}constructor({className:e=Ti,templates:t,...s}={}){super({className:e,templates:{...Ai,...t},...s}),this._initTrackable()}initialize(e){const{proxyElement:t}=e;this._unsubscribes=[...this._unsubscribes,t.on("click",(e=>this._handleClick(e)))]}_afterRender(e,t){this._syncBindings(e,t)}_unrender(){this._clearBindings()}_getItems(e){return e.value||[]}_getOptionsElement(e){return e.querySelector('[data-role="options"]')}_getItemElements(e){return e?Array.from(e.querySelectorAll('[data-role="option"]')):[]}_handleClick(e){if(this._element)for(let t=e.target;t&&t!==this._element;t=t.parentElement){const{role:e}=t.dataset;switch(e){case"button":this._toggle();break;case"option":const e=this._bindings.get(t);this._select(e&&e.value)}}}_toggle(){if(!this._element)return;const e=this._element.children[0];e&&e.classList.toggle("open")}async _select(e){e&&this._view._events.emit("select",{value:e})}destroy(){this._destroyTrackable(),super.destroy()}}cn(Ri.prototype);const Ni="miso-more-button";const $i=Object.freeze({root:function(e,t){const{className:s,role:n,templates:i}=e;return`\n<div class="${s}"${n?` data-role="${n}"`:""}${t.status!==ft.READY?" disabled":""}>\n  ${i.text(e)}\n</div>\n`},text:function(e){return"More"}});class Pi extends Js{static get type(){return"more-button"}static get defaultTemplates(){return $i}static get defaultClassName(){return Ni}constructor({className:e=Ni,templates:t,...s}={}){super({className:e,templates:{...$i,...t},...s})}initialize(e){this._unsubscribes=[...this._unsubscribes,e.proxyElement.on("click",(e=>this._handleClick(e)))]}_handleClick(e){if(0!==e.button)return;const t=e.target.closest('[data-role="more"]');t&&!t.disabled&&this._view.hub.trigger("more")}}const Li=Object.freeze(Object.defineProperty({__proto__:null,AffiliationLayout:wi,BannerLayout:class extends Js{static get type(){return"banner"}static get defaultTemplates(){return on}constructor({className:e="miso-banner",templates:t,...s}={}){super({className:e,templates:{...on,...t},...s})}},CardsLayout:class extends hn{static get type(){return"cards"}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return gn}constructor({className:e=gn,...t}={}){super({className:e,...t})}},CarouselLayout:Fn,CollectionLayout:hn,ContainerLayout:tn,ErrorLayout:nn,FacetsLayout:Ii,FeedbackLayout:oi,GalleryLayout:Qn,HorizontalLayout:mn,ListLayout:pn,MoreButtonLayout:Pi,OptionListLayout:Xn,SearchBoxLayout:Kn,SelectLayout:Ri,TemplateBasedLayout:Js,TextLayout:ci,TypewriterLayout:mi},Symbol.toStringTag,{value:"Module"}));function qi(e){return e&&e.value&&e.value.revision}function Ui(e){const t=function(e){if(!e)return ft.INITIAL;const{request:t,error:s,value:n}=e;return s?ft.ERRONEOUS:n?ft.READY:t?ft.LOADING:ft.INITIAL}(e);return a({status:t,ongoing:t===ft.READY?e.ongoing:void 0,...e})}function Mi(e){const{session:t,value:s}=e;if(!t||!s)return;const{miso_id:n}=s;n&&(t.meta.miso_id=n)}function ji(e){const{request:t,value:s}=e;if(!t)return e;const{payload:n}=t||{},{q:i}=n||{};return i?{...e,value:{...s,keywords:i}}:e}function Di(e){const{role:t,type:s,items:n}=e,i={type:"viewable"===s?"viewable_impression":s,context:{custom_context:a({property:t})}};switch(function(e){return _t.has(e)}(s)&&(!function(e,t=[]){return function(e){return lt.has(e)}(e)||t.length>0&&"object"==typeof t[0]&&t[0].product_id}(t,n)?(i.product_ids=[],i.context.custom_context.items=(n||[]).map((e=>e.text||e.id||e))):i.product_ids=(n||[]).map((e=>"string"==typeof e?e:e.product_id)).filter((e=>e))),s){case ut.SUBMIT:i.context.custom_context.value=e.value;break;case ut.FEEDBACK:i.context.custom_context.value=i.value=e.value,i.context.custom_context.result_type=i.result_type=e.result_type}return a(i)}const Fi=Object.freeze({}),Bi=Object.freeze({[rt.CONTAINER]:tn.type,[rt.ERROR]:nn.type}),zi=Object.freeze({}),Hi=Object.freeze({api:Fi,layouts:Bi,trackers:zi}),Qi=Object.freeze({mappings:{[rt.ERROR]:e=>e.error}});class Vi extends W{constructor(e){super(e.name||"workflow",e.plugin);let{context:t,plugin:s,client:n,defaults:i,options:o}=e;this._context=t,this._plugin=s=s||t._plugin,this._client=n=n||t._client,e=Object.freeze({...e,plugin:s,client:n}),this._name=e.name,this._roles=e.roles,this._extensions=s._getExtensions(n),this._defaults=i,this._options=o||new Mt(t&&t._options,i),this._hub=new Gt({onUpdate:e=>this._onHubUpdate(e),onEmit:e=>this._onHubEmit(e)}),this._sessionContext=new WeakMap,n._events.emit("workflow",this),this._initProperties(e),this._initActors(e),this._initSubscriptions(e),this._initSession(e)}_initProperties(){}_initActors({roles:e}){const t=this._hub,s=this._client,n=this._options,i=this._extensions,o=this._plugin.layouts;this._sessions=new Wt(t),this._data=new Yt(t,{source:xs(s),options:n}),this._views=new ws(t,{extensions:i,layouts:o,roles:e,options:n,workflow:this}),this._interactions=new Cs(t,{client:s,options:n})}_initSubscriptions({roles:e}){this._unsubscribes=[this._hub.on("session",(e=>this._onSession(e))),this._hub.on("response",(e=>this.updateData(e))),this._hub.on("tracker",(e=>this._onTracker(e)))],e.main&&this._unsubscribes.push(this._hub.on(Vt(e.main),(e=>this._onMainViewUpdate(e))))}_initSession(){this.restart()}_getSessionContext(e){let t=this._sessionContext.get(e);return t||this._sessionContext.set(e,t={}),t}_onHubUpdate(e){this._runCallbacks(this._client.meta.parent._hubUpdateCallbacks,e)}_onHubEmit(e){this._runCallbacks(this._client.meta.parent._hubEmitCallbacks,e),this._emitAsWorkflowEvent(e)}_emitAsWorkflowEvent({action:e,name:t,state:s,silent:n}){n||this._emit(t,{_action:e,...s})}get uuid(){return this.session&&this.session.uuid}get session(){return this._hub.states.session}get states(){return this._hub.states}get status(){const e=this._hub.states.data;return e&&e.status}get views(){return this._views.interface}restart(){return this._emitInterruptEventIfNecessary(),this._sessions.restart(),this}_emitInterruptEventIfNecessary(){const{main:e}=this._roles;if(!e)return;const t=this._hub.states[Vt(e)]||{};t.session&&t.status===ft.LOADING&&(this._emitLifecycleEvent("interrupt",t),this._emitLifecycleEvent("finally",t))}_onSession(e){this.updateData({session:e})}_onMainViewUpdate(e){const{status:t}=e,s=t===ft.READY,n=t===ft.ERRONEOUS,i=n?"error":t;this._emitLifecycleEvent(i,e),s&&this._emitLifecycleEvent("done",e),(s||n)&&this._emitLifecycleEvent("finally",e)}_shallEmitLifecycleEvent(e,{session:t}){const s=this._getSessionContext(t),n=s.lifecycleEvents||(s.lifecycleEvents=new Set),i=n.has(e);return n.add(e),!i}_emitLifecycleEvent(e,t){this._shallEmitLifecycleEvent(e,t)&&this._emit(e,t)}_request(e={}){const{session:t}=this,s=Et(this._options.resolved.api,e);this.updateData({session:t,request:s}),this._hub.update("request",{...s,session:t})}updateData(e){if(!e)throw new Error("Data is required.");const{session:t}=e;if(!t)throw new Error("Session is required to update data.");if(!this.session)throw new Error("No session is created yet. Call workflow.restart() to start a new session.");if(t.uuid!==this.session.uuid)return;const s=qi(e);if(!c(s)){const e=qi(this._hub.states.data);if(!c(e)&&s<=e)return}return this._updateData(e),this}_updateData(e){const t=this._hub.states.data;e=this._defaultProcessData(e,t);for(const s of this._options.resolved.dataProcessor)e=s(e,t);this._updateDataInHub(e,t)}_defaultProcessData(e,t){return e=function(e,t){if(!e||!e.value||e.request||!t||!t.request)return e;const{request:s}=t;return{...e,request:s}}(e,t),e=function(e){const{value:t}=e;if(!t)return e;const{miso_id:s}=t;return s?{...e,meta:{...e.meta,miso_id:s}}:e}(e=Ui(e))}_updateDataInHub(e){this._hub.update("data",e)}notifyViewUpdate(e,t){return t={status:ft.READY,session:this.session,...t},this._hub.update(Vt(e),t),this}get trackers(){return this._views.trackers}_onTracker(e){const t=this._hub.states.data,s=this._buildInteraction({...e,data:t});this._sendInteraction(s)}_buildInteraction(e){let t=Di(e);t=this._defaultProcessInteraction(t,e);const{preprocess:s=[]}=this._options.resolved.interactions;for(const n of s)t=n(t,e);return t}_defaultProcessInteraction(e,t){return e=function(e,t){const{data:s}=t;if(!s)return e;const n=s.request&&s.request.payload&&s.request.payload.metadata;return n?j(e,{context:{custom_context:n}}):e}(e,t),e=this._writeApiInfoToInteraction(e,t),e=this._writeRequestInfoToInteraction(e,t),e=function(e,t){if(t.role!==rt.AFFILIATION)return e;const{items:s}=t;return j(e,{context:{custom_context:{channel:s[0]&&s[0].channel||void 0,positions:s.map((e=>e.position))}}})}(e=this._writeMisoIdToInteraction(e,t),t),e}_writeApiInfoToInteraction(e){const{group:t,name:s}=this._options.resolved.api;return j(e,{context:{custom_context:{api_group:t,api_name:s}}})}_writeRequestInfoToInteraction(e,t){return e}_writeMisoIdToInteraction(e,t){const s=this._hub.states[Vt(t.role)]||{},n=s.meta&&s.meta.miso_id||void 0;return n?j(e,{miso_id:n}):e}_sendInteraction(e){const{handle:t}=this._options.resolved.interactions;"function"==typeof t?t(e):this._hub.trigger("interaction",e)}destroy(e){this._emit("destroy"),this._destroy(e)}_destroy({dom:e}={}){for(const t of this._unsubscribes||[])t();this._unsubscribes=[],this._views._destroy({dom:e}),this._data._destroy()}_runCallbacks(e,t){for(const s of e)try{s({workflow:this,...t})}catch(X_){this._error(X_)}}_emit(e,t){this._events.emit(e,{_event:e,...t}),this._context&&this._context._events.emit(e,{workflow:this,_event:e,...t})}}function Gi(e){if(e.affiliation_products){const{affiliation_products:s,...n}=e;e={...n,affiliation:(t=s,{channel:"miso",products:t})}}else if(e.sovrn_aff){const{sovrn_aff:t,...s}=e;e={...s,affiliation:Wi(t)}}var t;return function(e){const{affiliation:t}=e;if(!t)return e;let{channel:s,products:n}=t;if(!n)return e;n=n.map((e=>({...e})));let i=0;for(const o of n)s&&(o.channel=s),o.position=i++;return{...e,affiliation:{...t,products:n}}}(e)}function Wi({products:e,...t}){return{channel:"sovrn",...t,products:e.map(Ki)}}function Ki({id:e,deeplink:t,headline:s,description:n,currency:i,retailPrice:o,salePrice:r,discountRate:c,image:l,thumbnail:u,merchant:d,...h}){return a({id:`sovrn-${e}`,title:s,description:n,cover_image:l,url:t,currency:i,original_price:o,sale_price:r,discount_rate_percent:c,brand:d&&d.name,brand_logo:d&&d.logo,custom_attributes:Yi({sovrn_id:e,thumbnail:u,merchant:d,...h})})}function Yi(e,t=""){return Object.keys(e).reduce(((s,n)=>{const i=e[n];if(void 0===i)return s;const o=t?`${t}_${n}`:n;return"object"==typeof i?{...s,...Yi(i,o)}:{...s,[o]:i}}),{})}function Zi(e){q(e,Ji.prototype)}Bt(Vi.prototype),Object.assign(Vi,{DEFAULT_API_OPTIONS:Fi,DEFAULT_LAYOUTS:Bi,DEFAULT_TRACKERS:zi,DEFAULT_OPTIONS:Hi,ROLES_OPTIONS:Qi});class Ji{useLink(e,t={}){if("function"!=typeof e&&!1!==e)throw new Error("useLink(fn) expects fn to be a function or false");return this._linkFn=!!e&&[e,t],this}_submitToPage(e={}){if(!this._linkFn)return;const t=this._getSubmitUrl(e),[s,n={}]=this._linkFn;if(!1===n.open)window.location.href=t;else{const e=n.target||"_blank",s=n.windowFeatures||"";window.open(t,e,s)}}_getSubmitUrl({q:e,...t}={}){if(!this._linkFn)throw new Error("useLink(fn) must be called before _getSubmitUrl()");return this._linkFn[0](e,t)}}const Xi=Object.freeze({...Vi.DEFAULT_API_OPTIONS,group:s.ASK,payload:{...Vi.DEFAULT_API_OPTIONS.payload,source_fl:["cover_image","url","created_at","updated_at","published_at"],cite_link:1,cite_start:"[",cite_end:"]"}}),eo=Object.freeze({actor:!1,api:{group:s.ASK,name:n.AUTOCOMPLETE}}),to=Object.freeze({...Vi.DEFAULT_LAYOUTS,[rt.QUERY]:[Kn.type,{placeholder:"Ask a question"}],[rt.QUESTION]:[ci.type,{tag:"h2"}],[rt.ANSWER]:mi.type,[rt.FEEDBACK]:oi.type,[rt.IMAGES]:[Qn.type,{incremental:!0,itemType:"image"}],[rt.SOURCES]:[pn.type,{incremental:!0,itemType:"article",templates:{ordered:!0}}],[rt.AFFILIATION]:[wi.type,{incremental:!0,itemType:"affiliation",link:{rel:"noopener nofollow"}}]}),so=Object.freeze({...Vi.DEFAULT_TRACKERS,[rt.ANSWER]:{active:!0,itemless:!0,deduplicated:!1,click:Tt.click},[rt.IMAGES]:Tt,[rt.SOURCES]:Tt,[rt.AFFILIATION]:Tt,[rt.PRODUCTS]:Tt}),no=Object.freeze({...Vi.DEFAULT_OPTIONS,api:Xi,autocomplete:eo,layouts:to,trackers:so}),io=vt(Vi.ROLES_OPTIONS,{main:rt.ANSWER,members:Object.keys(to),mappings:{[rt.ANSWER]:function(e){if(!e||!e.value)return;const{answer:t="",answer_stage:s,finished:n}=e.value;return Object.freeze({value:t,stage:s,finished:!!n})},[rt.REASONING]:function(e){if(!e||!e.value)return;const{reasoning:t="",reasoning_finished:s}=e.value;return Object.freeze({value:t,stage:"reasoning",finished:!!s})}}});class oo extends Vi{_initProperties(e){super._initProperties(e),this._questionId=void 0,this._autoQuery=!1}_initActors(e){super._initActors(e),this._feedback=new Es(this._hub)}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._hub.on("query",(e=>this._query(e))),this._views.get(rt.ANSWER).on("citation-click",(e=>this._onCitationClick(e))),this._views.get(rt.ANSWER).on("link-click",(e=>this._onAnswerLinkClick(e)))]}restart(){this._questionId&&(this._questionId=void 0),super.restart()}_shallEmitLifecycleEvent(e,t){return"answer-stage"===e||super._shallEmitLifecycleEvent(e,t)}_emitInterruptEventIfNecessary(){const e=this._hub.states[Vt(this._roles.main)]||{};e.session&&e.status!==ft.INITIAL&&(e.status!==ft.READY||e.ongoing)&&(this._emitLifecycleEvent("interrupt",e),this._emitLifecycleEvent("finally",e))}_onMainViewUpdate(e){const{status:t,session:s}=e,n=t===ft.READY&&!e.ongoing,i=t===ft.ERRONEOUS,o=n?"done":i?"error":t,r=this._getSessionContext(s),a=r.answerStage,c=e.meta&&e.meta.answer_stage;c&&c!==a&&(this._emitLifecycleEvent("answer-stage",Object.freeze({...e,answer_stage:c})),r.answerStage=c),this._emitLifecycleEvent(o,e),(n||i)&&this._emitLifecycleEvent("finally",e)}get questionId(){return this._questionId}autoQuery(e={}){Ht.call(this,e)}query(e){if(!e.q&&!e.questionId)throw new Error("q is required in query() call");this._hub.update("query",e)}_query(e={}){if(this._linkFn)return void this._submitToPage(e);this.restart(),this._writeQuestionSourceToSession(e);const t=this._buildPayload(e);this._request({payload:t})}_writeQuestionSourceToSession(e){this.session.meta.question_source=e.qs||mt.ORGANIC}_buildPayload(){throw new Error("Not implemented")}_writeWikiLinkTemplateToPayload(e){return this._autoQuery&&this._autoQuery.param&&"q"!==this._autoQuery.param?{...e,wiki_link_template:`?${this._autoQuery.param}=%s`}:e}_updateData(e){this._writeQuestionIdFromData(e),!e.value||e.value.answer_stage?(super._updateData(e),this._updateUrlIfNecessary(e)):this._handleHeadResponse(e)}_handleHeadResponse(e){}_defaultProcessData(e,t){return e=function(e){const{value:t}=e;if(!t)return e;const{answer_stage:s}=t;return s?{...e,ongoing:!t.finished,meta:{...e.meta,answer_stage:s}}:e}(e=function(e){if(!e||!e.value)return e;const{value:t}=e;return{...e,value:Gi(t)}}(e=super._defaultProcessData(e,t)))}_writeQuestionIdFromData({value:e}){e&&this._writeQuestionId(e.question_id)}_updateUrlIfNecessary({value:e,request:t}){if(!this._autoQuery||!this._autoQuery.updateUrl)return;const{param:s,sourceParam:n}=this._autoQuery,i=e&&e.question||t&&t.payload&&t.payload.question,o=t&&t.payload&&t.payload.metadata&&t.payload.metadata.question_source;if(!i)return;const r=new URL(window.location),a=r.searchParams.get(s),c=r.searchParams.get(n)||mt.ORGANIC;i===a&&o===c||(r.searchParams.set(s,i),o===mt.ORGANIC?r.searchParams.delete(n):r.searchParams.set(n,o),window.history.replaceState({},"",r))}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=this._writeAskPropertiesToInteraction(e,t),e=function(e,{event_target:t}={}){return t?j(e,{context:{custom_context:{event_target:t}}}):e}(e=this._writeAnswerClickInteraction(e,t),t)}_writeRequestInfoToInteraction(e,t){const{data:s}=t;if(!s)return e;const n=s.request&&s.request.payload;if(!n)return e;const{question:i,fq:o}=n;return j(e,{context:{custom_context:{question:i,fq:o}}})}_writeAskPropertiesToInteraction(e={},t){return j(e,{context:{custom_context:{question_source:this._getQuestionSourceFromViewState(t),question_id:this.questionId}}})}_writeAnswerClickInteraction(e,t){if(t.role!==rt.ANSWER)return e;const{items:s=[]}=t;return j(e,{context:{custom_context:{urls:s.map((e=>e.url)),texts:s.map((e=>e.text)),class_names:s.map((e=>e.className)),attributes:s.map((e=>e.attributes))}}})}_getQuestionSourceFromViewState(e){const{request:t}=this._hub.states[Vt(e.role)]||{},{payload:s}=t||{};return s&&s.metadata&&s.metadata.question_source||void 0}_onCitationClick({index:e,event:t}){if(0!==t.button)return;if(gs(t))return;const{value:s}=this._hub.states.data||{},{sources:n}=s||{},i=n&&n[e-1];i&&i.product_id&&(ys(t),this._views.trackers.sources.click([i.product_id],{event_target:"citation-link"}))}_onAnswerLinkClick({event:e,...t}){0===e.button&&(gs(e)||(ys(e),this._views.trackers.answer.click([],{items:[t]})))}_writeQuestionId(e){!this._questionId&&e&&(this._questionId=e)}_clearQuestionId(){this._questionId=void 0}_destroy(e){this._feedback._destroy(),super._destroy(e)}}Zi(oo.prototype),Object.assign(oo,{DEFAULT_API_OPTIONS:Xi,DEFAULT_AUTOCOMPLETE_OPTIONS:eo,DEFAULT_LAYOUTS:to,DEFAULT_TRACKERS:so,DEFAULT_OPTIONS:no,ROLES_OPTIONS:io});const ro=Object.freeze(Object.defineProperty({__proto__:null,CLASS_PREFIX:"miso-ask-combo",CONAINER_TAG:"miso-ask"},Symbol.toStringTag,{value:"Module"})),ao=Object.freeze(Object.defineProperty({__proto__:null,followUpQuestions:"Related questions you can explore",question:"You asked...",relatedResources:"Go beyond, and learn more about this topic",sources:"This reply is based on the following articles",thoughts:"Thoughts"},Symbol.toStringTag,{value:"Module"}));let co=class{constructor({helpers:e}){this._helpers=e}errorSection(e){const{section:t,container:s}=this._helpers;return t(e,{name:"error"},[s(e,{name:"error",visibleWhen:"erroneous"},"<miso-error></miso-error>")])}answerGroup(e){return[this.answer(e),this.affiliation(e),this.sources(e)]}answer(e){const{container:t}=this._helpers;return t(e,{name:"answer",visibleWhen:"ready"},[...this.question(e),"<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}question(e){const{phrase:t}=this._helpers;return[t(e,{name:"question",tag:"div"}),"<miso-question></miso-question>"]}sources(e){const{container:t,phrase:s}=this._helpers;return t(e,{name:"sources",visibleWhen:"nonempty"},[s(e,{name:"sources",tag:"h3"}),"<miso-sources></miso-sources>"])}affiliation(e){const{container:t}=this._helpers,{affiliation:s=!0}=e||{};return s?t(e,{name:"affiliation",visibleWhen:"nonempty"},["<miso-affiliation></miso-affiliation>"]):""}};class lo{constructor(e){this._context=e,u(this,{lowerCamelToKebab:_,kebabToLowerCamel:d,kebabOrSnakeToLowerCamel:h})}normalizeOptions({classPrefix:e,circledCitationIndex:t=!0,phrases:s,...n}={}){return{classPrefix:e=e||this._context.CLASS_PREFIX,circledCitationIndex:t,phrases:s=this.normalizePhraseOptions(s),...n}}normalizePhraseOptions(e={}){if(!e)return{};const t={};for(const s in e)t[this.normalizePhraseOptionKey(s)]=e[s];return t}normalizePhraseOptionKey(e){return"relatedQuestions"===(e=h(e))||"querySuggestions"===e?"followUpQuestions":e}phrase(e,{name:t,extraNames:s=[],tag:n="div",inline:i=!1}){const{classPrefix:o}=e;return`<${n} class="${i?`${o}__phrase-inline`:`${o}__phrase`} ${[t,...s].map((e=>`${o}__${e}-phrase`)).join(" ")}">${this.phraseText(e,d(t))}</${n}>`}phraseText(e,t){const{phrases:s={}}=e,n=s[t]||this._context.DEFAULT_PHRASES[t];switch(typeof n){case"function":return n(e);case"string":return n;default:return""}}section({classPrefix:e},{name:t},s){return this.element("section",{classes:[`${e}__section`,`${e}__${t}`]},s)}container({classPrefix:e,circledCitationIndex:t,parentQuestionId:s},{name:n,extraNames:i=[],visibleWhen:o,trait:r,logo:a=!1},c){const l=[n,...i].map((t=>`${e}__${t}-container`));return t&&l.push("miso-circled-citation-index"),this.element(this._context.CONAINER_TAG,{classes:l,visibleWhen:o,trait:r,logo:a,parentQuestionId:s},c)}element(e,t={},s=""){return`<${e}${this.attrs(t)}>${Array.isArray(s)?s.join(""):s}</${e}>`}attrs({classes:e=[],...t}={}){let s="";e.length&&(s+=` class="${e.join(" ")}"`);for(const n in t){const e=t[n];void 0!==e&&(s+=` ${_(n)}="${e}"`)}return s}}const uo=U(new lo({...ro,DEFAULT_PHRASES:ao})),ho=U(new class extends co{constructor(){super({helpers:uo})}answerGroup(e){const{container:t}=this._helpers;return[this.question(e),this.reasoning(e),this.answer(e),this.affiliation(e),this.sources(e),this.followUpQuestions(e),t(e,{name:"bottom-spacing",visibleWhen:"ongoing"})]}question(e){const{container:t,phrase:s}=this._helpers;return t(e,{name:"question",visibleWhen:"ready"},[e.parentQuestionId?"<hr>":"",s(e,{name:"question",tag:"div"}),"<miso-question></miso-question>"])}answer(e){const{container:t}=this._helpers;return t(e,{name:"answer",visibleWhen:"ready"},["<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}reasoning(e={}){const{phrases:t,reasoning:s={}}=e,{container:n,element:i,phraseText:o}=this._helpers,r=[];return s.expand&&r.push("expanded"),n(e,{name:"reasoning",visibleWhen:"nonempty"},[i("miso-stub",{classes:r,trait:"collapsible","data-role":"reasoning-box"},[i("div",{classes:["miso-collapsible__header"],"data-role":"toggle-expand"},[`<div class="miso-collapsible__icon">${s.icon||Un}</div>`,`<div class="miso-collapsible__title" data-role="title">${o(t,"thoughts")}</div>`,`<div class="miso-collapsible__toggle">${Ln}</div>`]),i("div",{classes:["miso-collapsible__body"]},["<miso-reasoning></miso-reasoning>"])])])}sources(e){const{container:t,phrase:s}=this._helpers;return t(e,{name:"sources",visibleWhen:"nonempty"},["<hr>",s(e,{name:"sources",tag:"h3"}),"<miso-sources></miso-sources>"])}followUpQuestions(e){const{container:t,phrase:s}=this._helpers,n="follow-up-questions",i=["query-suggestions"];return t(e,{name:n,extraNames:i,visibleWhen:"nonempty"},[s(e,{name:n,extraNames:i,tag:"h3"}),"<miso-follow-up-questions></miso-follow-up-questions>"])}followUps(e){const{features:t={}}=e;return!1===t.followUpQuestions?"":'<miso-follow-ups id="miso-ask-combo__follow-ups" class="miso-ask-combo__follow-ups"></miso-follow-ups>'}relatedResourcesSection(e){const{container:t,phrase:s,section:n}=this._helpers,{features:i={},logo:o=!0}=e;return n(e,{name:"related-resources"},!1===i.relatedResources?"":t(e,{name:"related-resources",visibleWhen:"nonempty",logo:o},[s(e,{name:"related-resources",tag:"h2"}),"<miso-related-resources></miso-related-resources>"]))}}({helpers:uo}));function _o(e={}){const{normalizeOptions:t,section:s,container:n}=uo,{answerGroup:i}=ho;return s(e=t(e),{name:"follow-up"},[n(e,{name:"query",visibleWhen:"initial loading"},"<miso-query></miso-query>"),...i(e)])}const po=Object.freeze(Object.defineProperty({__proto__:null,followUp:_o,helpers:uo,root:function(e={}){const{normalizeOptions:t,section:s,container:n}=uo,{followUps:i,relatedResourcesSection:o,answerGroup:r}=ho;return[s(e=t(e),{name:"question"},[n(e,{name:"query"},"<miso-query></miso-query>")]),s(e,{name:"answer"},r(e)),i(e),o(e)].join("")},sections:ho},Symbol.toStringTag,{value:"Module"})),fo=Object.freeze({...oo.DEFAULT_API_OPTIONS,name:n.QUESTIONS,payload:{...oo.DEFAULT_API_OPTIONS.payload,related_resource_fl:["cover_image","url","created_at","updated_at","published_at"]}}),mo=Object.freeze({...oo.DEFAULT_LAYOUTS,[rt.QUERY]:[Kn.type,{templates:{buttonIcon:"send"}}],[rt.REASONING]:mi.type,[rt.RELATED_RESOURCES]:[pn.type,{incremental:!0,itemType:"article"}],[rt.QUERY_SUGGESTIONS]:Xn.type,[rt.FOLLOW_UP_QUESTIONS]:Xn.type}),go=Object.freeze({...oo.DEFAULT_TRACKERS,[rt.RELATED_RESOURCES]:Tt,[rt.QUERY_SUGGESTIONS]:{...Tt,click:{...Tt.click,validate:e=>0===e.button}}}),yo=Object.freeze({followUp:_o}),bo=Object.freeze({...oo.DEFAULT_OPTIONS,api:fo,layouts:mo,trackers:go,templates:yo}),vo=vt(oo.ROLES_OPTIONS,{members:Object.keys(mo),mappings:{[rt.QUERY_SUGGESTIONS]:function(e,{workflow:t}={}){const s=t.previous,n=s&&s.states.data.value,i=n&&(n.suggested_followup_questions||n.followup_questions||[]);return i&&i.map((e=>({text:e})))},[rt.FOLLOW_UP_QUESTIONS]:function(e){if(e&&e.value)return(e.value.followup_questions||[]).map((e=>({text:e})))}}});class wo extends oo{constructor(e,t){super({name:"ask",context:e,roles:vo,defaults:bo,parentQuestionId:t})}_initProperties(e){super._initProperties(e);const{parentQuestionId:t}=e;u(this,{parentQuestionId:t})}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._hub.on(Vt(rt.REASONING),(e=>this._onReasoningViewUpdate(e))),this._views.get(rt.ANSWER).on("follow-up-click",(e=>this._onFollowUpClick(e))),this._views.get(rt.FOLLOW_UP_QUESTIONS).on("select",(e=>this._onFollowUpQuestionSelect(e))),this._views.get(rt.QUERY_SUGGESTIONS).on("select",(e=>this._onQuerySuggestionSelect(e)))]}_initSession(e){e.parentQuestionId&&this._context._byPqid.set(e.parentQuestionId,this),this._context._events.emit("create",this),super._initSession(e)}restart(){const{next:e}=this;e&&e.destroy(),this._questionId&&this._context._byQid.delete(this._questionId),super.restart()}get rootQuestionId(){return this._context.root.questionId}get previous(){const{parentQuestionId:e}=this;return e?this._context.getByQuestionId(e):void 0}get next(){const{questionId:e}=this;return e?this._context.getByParentQuestionId(e):void 0}getOrCreateNext(){const{questionId:e}=this;return e?this._context.getByParentQuestionId(e,{autoCreate:!0}):void 0}_buildPayload({q:e,qs:t,questionId:s,...n}={}){if(s)return a({...n,question_id:s});const{parentQuestionId:i}=this;let o=a({...n,question:e,parent_question_id:i,metadata:{...n.metadata,question_source:t||mt.ORGANIC}});return o=this._writeWikiLinkTemplateToPayload(o),o}_updateData(e){super._updateData(e),this._triggerSuggestionsRefreshIfNecessary()}_triggerSuggestionsRefreshIfNecessary(){const{next:e}=this;if(!e)return;const t=e._views.get(rt.QUERY_SUGGESTIONS);t&&t.refresh()}_onReasoningViewUpdate({status:e,ongoing:t}){if(e!==ft.READY||t)return;const s=this._getReasoningBoxElement();s&&s.classList.add("done")}_writeAskPropertiesToInteraction(e,t){const s=this.rootQuestionId;let n,i,o,{property:r}=e.context&&e.context.custom_context||{};return t.role!==rt.FOLLOW_UP_QUESTIONS&&t.role!==rt.QUERY_SUGGESTIONS||(r="suggested_followup_questions"),t.role===rt.QUERY_SUGGESTIONS?(i=this.previous&&this.previous.parentQuestionId,n=this.parentQuestionId,o=this.previous&&this.previous.session.meta.question_source):(i=this.parentQuestionId,n=this.questionId,o=this._getQuestionSourceFromViewState(t)),j(e,{context:{custom_context:{property:r,root_question_id:s,parent_question_id:i,question_id:n,question_source:o}}})}_onFollowUpClick({q:e,event:t}={}){0===t.button&&this._submitFollowUpQuestion({q:e,qs:mt.INLINE_QUESTION_LINK})}_onFollowUpQuestionSelect({value:e}){this._submitFollowUpQuestion({q:e,qs:mt.SUGGESTED_QUESTIONS})}_submitFollowUpQuestion({q:e="",qs:t}={}){if(!(e=e.trim()))return;this.getOrCreateNext().query({q:e,qs:t})}_onQuerySuggestionSelect({value:e}){e&&this.query({q:e,qs:mt.SUGGESTED_QUESTIONS})}_writeQuestionId(e){!this._questionId&&e&&(this._questionId=e,this._context._byQid.set(e,this))}_clearQuestionId(){this._questionId&&(this._context._byQid.delete(this._questionId),this._questionId=void 0)}_getReasoningBoxElement(){const e=this._views.get(rt.REASONING),t=e&&e.element;return t&&t.closest('[data-role="reasoning-box"]')}_destroy(e){const{next:t,parentQuestionId:s,questionId:n}=this;t&&t.destroy(e),s&&this._context._byPqid.delete(s),n&&this._context._byQid.delete(n),super._destroy(e)}}const ko={event:"done"};class So extends Qt{constructor(e,t){super("asks",e,t),this._byQid=new Map,this._byPqid=new Map,this._root=new wo(this),this._events.on("*",(e=>this._createNextIfNecessary(e))),this._autoNextFn=void 0}get root(){return this._root}get workflows(){return[this._root,...this._byPqid.values()]}getByQuestionId(e){if("string"!=typeof e)throw new Error(`Required ID to be a string: ${e}`);return this._byQid.get(e)}getByParentQuestionId(e,{autoCreate:t=!1}={}){if(void 0===e)return this._root;if("string"!=typeof e)throw new Error(`Required ID to be a string: ${e}`);let s=this._byPqid.get(e);return!s&&t&&(s=new wo(this,e)),s}reset({root:e=!0,events:t,...s}={}){void 0===t&&(t=!!e),t&&this._events.clear();for(const n of this._byPqid.values())n.destroy(s);e&&this._root.restart()}autoNext(e){this._autoNextFn=function(e=ko){switch(!0===e&&(e=ko),"string"==typeof e&&(e={event:e}),typeof e){case"object":return t=>e.event===t._event;case"function":return e;default:return()=>!1}}(e)}_createNextIfNecessary(e){if(!this._autoNextFn||!this._autoNextFn(e))return;const{workflow:t}=e;t&&t.getOrCreateNext()}}Bt(So.prototype,[yt.TEMPLATES]);const Eo=Object.freeze({...Vi.DEFAULT_API_OPTIONS,group:s.SEARCH,payload:{...Vi.DEFAULT_API_OPTIONS.payload,fl:["cover_image","url","created_at","updated_at","published_at","title"],rows:10}}),Co=Object.freeze({...Vi.DEFAULT_LAYOUTS,[rt.QUERY]:[Kn.type],[rt.PRODUCTS]:[pn.type,{incremental:!0,infiniteScroll:!0}],[rt.KEYWORDS]:[ci.type,{raw:!0}],[rt.TOTAL]:[ci.type,{raw:!0,format:"number"}],[rt.FACETS]:[Ii.type],[rt.SORT]:[Ri.type],[rt.MORE]:[Pi.type]}),xo=Object.freeze({...Vi.DEFAULT_TRACKERS,[rt.PRODUCTS]:Tt}),Oo=Object.freeze({active:!1,mode:"infiniteScroll",pageLimit:10}),Io=Object.freeze({...Vi.DEFAULT_OPTIONS,api:Eo,layouts:Co,trackers:xo,pagination:Oo}),To=vt(Vi.ROLES_OPTIONS,{main:rt.PRODUCTS,members:Object.keys(Co),mappings:{[rt.FACETS]:"facet_counts",[rt.SORT]:function(e,{hub:t,workflowOptions:s={}}={}){const{sort:{options:n=[]}={}}=s.filters||{};if(!n.length)return[];const{sort:i}=t.states.filters||{},o=i&&i.field||function(e){for(const t of e)if(t.default)return t;return e[0]}(n).field;return o?n.map((e=>({...e,selected:e.field===o}))):n}}});class Ao extends Vi{_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._hub.on("query",(e=>this._query(e))),this._hub.on("filters",(()=>this._refine())),this._hub.on("more",(()=>this._more())),this._views.get(rt.SORT).on("select",(e=>this._handleSortSelect(e)))]}restart(){super.restart(),this._page=0}get exhausted(){const e=this._hub.states.data;return!!(e&&e.meta&&e.meta.exhausted)}get page(){return this._page}autoQuery(e={}){Ht.call(this,e)}query(e){if(!e.q)throw new Error("q is required in query() call");this._hub.update("query",e)}_query(e){this._views.filters.reset({silent:!0}),this.restart();const t=bt.QUERY,s=this._buildPayload(e,t);this._request({payload:s,type:t})}_refine(){const{facet_counts:e}=this._hub.states.data.value||{};this._currentFacetCounts=e,this.restart();const t=bt.REFINE,s=this._getQuery(),n=this._buildPayload(s,t);this._request({payload:n,type:t})}_more(){if(this.status!==ft.READY)throw new Error("Can not call more() while loading.");if(this.exhausted||this._page>=9)return;this._page++;const e=bt.MORE,t=this._getQuery(),s=this._buildPayload(t,e);this._request({payload:s,type:e})}_getQuery(){return this._hub.states.query}_getPageSize(){return this._options.resolved.api.payload.rows}_buildPayload(e,t){return e=this._writeFiltersToPayload(e),e=this._writePageInfoToPayload(e),t===bt.MORE&&(e=this._processPayloadForMoreRequest(e)),e}_writeFiltersToPayload(e){const t=this._hub.states.filters,{facets:s,sort:n}=t||{};return a({...e,facet_filters:this._buildFacetFilters(s),order_by:this._buildOrderBy(n)})}_buildFacetFilters(e){if(!e)return;const t={};for(const s in e){const n=e[s];n&&n.length&&(t[s]={terms:n})}return Object.keys(t).length?t:void 0}_buildOrderBy(e){if(e)return r(e)}_writePageInfoToPayload(e){return{...e,metadata:{...e.metadata,page:this._page}}}_processPayloadForMoreRequest(e={}){const t=this._hub.states.data,{[this._roles.main]:s=[]}=t&&t.value||{},n=s.map((e=>e.product_id)).filter((e=>e)),i=[...e.exclude||[],...n];return 0===i.length?e:{...e,exclude:i}}_defaultProcessData(e,t){return e=function(e,{role:t=rt.PRODUCTS}={}){const{status:s,request:n,value:i}=e;if(s!==ft.READY||!n||!i)return e;const{[t]:o}=i;if(!o)return e;const{rows:r}=n.payload,{length:a}=o;return a<r?{...e,meta:{...e.meta,exhausted:!0}}:e}(e=function(e,t){if(!t)return e;const{status:s,value:n}=e;switch(s){case ft.INITIAL:case ft.LOADING:break;default:return e}return n&&n.facet_counts?e:{...e,value:{...n,facet_counts:t}}}(e=ji(e=super._defaultProcessData(e,t)),this._currentFacetCounts),{role:this._roles.main})}_updateDataInHub(e){e=this._appendResultsFromMoreRequest(e),super._updateDataInHub(e)}_appendResultsFromMoreRequest(e){const{request:t}=e;if(!t)return e;const{metadata:s}=t.payload;if(!s||!s.page)return function(e){const{value:t}=e;if(!t)return e;const{miso_id:s}=t;return s?{...e,value:{...t,root_miso_id:s}}:e}(e);return function(e,t,{role:s=rt.PRODUCTS}={}){if(!t.value)return e;const{[s]:n=[],facet_counts:i,total:o,root_miso_id:r}=e.value,{[s]:a=[]}=t.value;return{...t,value:{...t.value,facet_counts:i,total:o,root_miso_id:r,[s]:[...n,...a]}}}(this._hub.states.data,e,{role:this._roles.main})}_handleSortSelect({value:e}={}){e&&(this._views.filters.update({sort:e}),this._views.filters.apply())}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=this._writeRootMisoIdToInteraction(e)}_writeRequestInfoToInteraction(e,t){const{data:s}=t;if(!s)return e;const n=s.request&&s.request.payload;if(!n)return e;const{q:i,fq:o}=n;return j(e,{context:{custom_context:{q:i,fq:o}}})}_writeRootMisoIdToInteraction(e){const t=this._hub.states.data,{root_miso_id:s}=t&&t.value||{};return s?j(e,{context:{custom_context:{root_miso_id:s}}}):e}}Bt(Ao.prototype,[yt.PAGINATION,yt.FILTERS]),Object.assign(Ao,{DEFAULT_API_OPTIONS:Eo,DEFAULT_LAYOUTS:Co,DEFAULT_TRACKERS:xo,DEFAULT_PAGINATION:Oo,DEFAULT_OPTIONS:Io,ROLES_OPTIONS:To});const Ro=Object.freeze({members:[]});function No({layouts:e,trackers:t,...s}={}){return{active:!1,...s,layouts:{},trackers:{}}}function $o(e){return e&&e.value&&e.value.trim()||void 0}class Po extends Vi{constructor(e,{defaults:t,...s}={}){super({name:"autocomplete",plugin:e._plugin,client:e._client,defaults:No(t),roles:Ro,superworkflow:e,...s})}_initProperties(e){super._initProperties(e),this._superworkflow=e.superworkflow,this._active=e.defaults.active}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,e.superworkflow._hub.on("input",(e=>this._query(e)))]}get enabled(){return this._active}enable(){this._active=!0}disable(){this._active=!1}_query(e){if(!this._active||(t=e,s=this._args,$o(t)===$o(s)))return;var t,s;this._args=e,this.restart();const{session:n}=this;if(n.meta.input=e,!$o(e))return void this._updateCompletions({session:n,status:ft.INITIAL});const i=this._buildPayload(e);this._request({payload:i})}_buildPayload(e){return{q:$o(e)}}_updateDataInHub(e){e.value&&(e={...e,value:e.value.completions}),this._updateCompletions(e)}_updateCompletions(e){this._superworkflow.updateCompletions(e)}}function Lo(e){q(e,qo.prototype)}class qo{_initAutocomplete(e){this._autocomplete=new Po(this,{defaults:e.defaults.autocomplete})}get autocomplete(){return this._autocomplete}updateCompletions(e){return this._hub.update("completions",e),this}_destroyAutocomplete(){this._autocomplete&&this._autocomplete._destroy(),this._autocomplete=void 0}}const Uo=vt(oo.ROLES_OPTIONS,{mappings:{[rt.QUESTION]:rt.KEYWORDS}});class Mo extends oo{constructor(e){super({name:"hybrid-search/answer",plugin:e._plugin,client:e._client,options:e._options,defaults:e._defaults,roles:Uo,superworkflow:e})}_initProperties(e){super._initProperties(e),this._initAutocomplete(e),this._superworkflow=e.superworkflow}_initSession(){}restart(){super.restart();const e=this._superworkflow._results;e._views.filters.reset({silent:!0}),e.restart(),this._resultsSession=e.session}_buildPayload(e){return e=this._writeQuestionSourceToPayload(e),e=this._writeWikiLinkTemplateToPayload(e),e=this._superworkflow._results._writeFiltersToPayload(e)}_writeQuestionSourceToPayload({qs:e,...t}={}){return M(t,{metadata:{question_source:e||mt.ORGANIC}})}_defaultProcessData(e,t){return e=function(e){const{value:t}=e;return t?!t.finished||"success"!==t.finish_reason||t.sources&&t.sources.length>0?e:{...e,meta:{...e.meta,unanswerable:!0}}:e}(e=function(e){const{session:t,value:s}=e;if(!t||!s)return e;const{meta:{miso_id:n}={}}=t;return n?{...e,meta:{...e.meta,miso_id:n}}:e}(e=ji(e=super._defaultProcessData(e,t))))}_updateDataInHub(e){switch(e.status){case ft.INITIAL:case ft.LOADING:this._dispatchDataToSibling(e)}super._updateDataInHub(e)}_handleHeadResponse(e){super._handleHeadResponse(e),Mi(e),this._dispatchDataToSibling(e)}_dispatchDataToSibling(e){this._resultsSession&&this._superworkflow._results.updateData({...e,session:this._resultsSession})}_defaultProcessInteraction(e,t){return this._superworkflow._defaultProcessInteraction(e,t)}_defaultProcessInteraction0(e,t){return super._defaultProcessInteraction(e,t)}_destroy(e){this._destroyAutocomplete(),super._destroy(e)}}Lo(Mo.prototype);const jo={...Ao.ROLES_OPTIONS,members:[rt.PRODUCTS,rt.KEYWORDS,rt.TOTAL,rt.FACETS,rt.SORT,rt.MORE,rt.ERROR]};class Do extends Ao{constructor(e){super({name:"hybrid-search/results",plugin:e._plugin,client:e._client,options:e._options,defaults:e._defaults,roles:jo,superworkflow:e})}_initProperties(e){super._initProperties(e),this._superworkflow=e.superworkflow}_initSession(){}_emitLifecycleEvent(e,t){super._emitLifecycleEvent(e,t),this._superworkflow._emitLifecycleEvent(e,t)}_getQuery(){return this._superworkflow._answer._hub.states.query}_buildPayload(e,t){return e=super._buildPayload(e,t),e=this._superworkflow._answer._writeQuestionSourceToPayload(e),e=function(e,t){return t===bt.QUERY?e:{...e,answer:!1}}(e=this._writeQuestionIdToPayload(e),t),e}_buildOrderBy(e){if(e)return e.field}_writeQuestionIdToPayload(e){return M(e,{metadata:{question_id:this._superworkflow._answer.questionId}})}_defaultProcessData(e,t){return Mi(e=super._defaultProcessData(e,t)),e}_defaultProcessInteraction(e,t){return this._superworkflow._defaultProcessInteraction(e,t)}_defaultProcessInteraction0(e,t){return super._defaultProcessInteraction(e,t)}}Object.assign(Do,{ROLES_OPTIONS:jo});class Fo{constructor(e){this._workflow=e,this._containers=new Set}get(e){return this._getSubviews(e).get(e)}addContainer(e){if(this._containers.has(e))return;this._containers.add(e);const{components:t}=e;for(const s of t)this.addComponent(s)}removeContainer(e){for(const t of this._workflow._subworkflows)t._views.removeContainer(e);this._containers.delete(e)}addComponent(e){this._getViewByElement(e).element=e,this._addContainerToSubviews(e._container,e)}removeComponent(e){this._getViewByElement(e).element=void 0,this._removeContainerFromSubviewsIfNecessary(e._container)}updateComponentRole(e,t,s){}refreshElement(e){const t=e.isContainer?this._containers.get(e):this._getViewByElement(e);t&&t.refresh({force:!0})}_getSubworkflow(e){return this._workflow._getSubworkflow(function(e){return Do.ROLES_OPTIONS.members.includes(e)?"results":"answer"}(e))}_getAllSubviews(){return this._workflow._subworkflows.flatMap((e=>e._views))}_getSubviews(e){return this._getSubworkflow(e)._views}_getViewByElement(e){let{role:t}=e;if(!t)throw new Error("Component must have a role");return this.get(t)}_addContainerToSubviews(e,t){if(!e)return;const{role:s}=t,n=this._getSubviews(s);if(!n._containers.has(e)){for(const s of this._getAllSubviews())if(s!==n&&s._containers.has(e)){for(const n of e.components)if(s.containsElement(n))throw new Error(`<${e.tagName.toLowerCase()}> cannot contain both <${n.tagName.toLowerCase()}> and <${t.tagName.toLowerCase()}>, for they don't share the same data lifecycle.`);throw new Error(`Failed to add container <${e.tagName.toLowerCase()}> with child component <${t.tagName.toLowerCase()}>.`)}n.addContainer(e)}}_removeContainerFromSubviewsIfNecessary(e){if(e&&!(e.components.length>0))for(const t of this._getAllSubviews())t.removeContainer(e)}}const Bo=Object.freeze({group:s.ASK,name:n.SEARCH,payload:{...oo.DEFAULT_API_OPTIONS.payload,...Ao.DEFAULT_API_OPTIONS.payload,source_fl:["cover_image","url","created_at","updated_at","published_at","title","authors"]}}),zo=Object.freeze({...oo.DEFAULT_LAYOUTS,...Ao.DEFAULT_LAYOUTS,[rt.QUERY]:[Kn.type,{placeholder:""}],[rt.QUESTION]:[ci.type,{raw:!0}],[rt.SOURCES]:[mn.type,{incremental:!0,itemType:"article",templates:{ordered:!0,article:Ts,articleInfoBlock:$s}}]}),Ho=Object.freeze({...oo.DEFAULT_TRACKERS,...Ao.DEFAULT_TRACKERS}),Qo=Object.freeze({...Ao.DEFAULT_PAGINATION,active:!0}),Vo=Object.freeze({api:{group:s.ASK,name:n.SEARCH_AUTOCOMPLETE,payload:{completion_fields:["suggested_queries"]}}}),Go=Object.freeze({sort:{options:[{field:"relevance",text:"Relevance",default:!0},{field:"published_at",text:"Date"}]}}),Wo=Object.freeze({...oo.DEFAULT_OPTIONS,...Ao.DEFAULT_OPTIONS,api:Bo,layouts:zo,trackers:Ho,autocomplete:Vo,pagination:Qo,filters:Go}),Ko=Object.freeze({main:rt.PRODUCTS,members:Object.keys(zo),mappings:Object.freeze({...oo.ROLES_OPTIONS.mappings,...Ao.ROLES_OPTIONS.mappings})});class Yo extends Vi{constructor(e,t){super({name:"hybrid-search",plugin:e,client:t,roles:Ko,defaults:Wo})}_initProperties(e){super._initProperties(e),this._subworkflows=[this._answer=new Mo(this),this._results=new Do(this)]}_getSubworkflow(e){switch(e){case"answer":return this._answer;case"results":return this._results;default:throw new Error(`Invalid subworkflow: ${e}`)}}_initActors(){this._views=new Fo(this)}_initSession(){this._results._sessions.restart(),this._answer._sessions.restart()}useLink(e,t){return this._answer.useLink(e,t),this}get answer(){return this._answer}get results(){return this._results}get questionId(){return this._answer.questionId}get filters(){return this._results._views.filters}get autocomplete(){return this._answer.autocomplete}autoQuery(e){this._answer.autoQuery(e)}query(e){this._answer.query(e)}_defaultProcessInteraction(e,t){return e=this._answer._defaultProcessInteraction0(e,t),e=this._results._defaultProcessInteraction0(e,t)}_destroy(){for(const e of this._subworkflows)e.destroy();super._destroy()}}Bt(Yo.prototype,[yt.PAGINATION,yt.FILTERS]);const Zo=Object.freeze({group:s.SEARCH,name:n.SEARCH,payload:{fl:["*"]}}),Jo=Object.freeze({api:{group:s.SEARCH,name:n.AUTOCOMPLETE,payload:{completion_fields:["suggested_queries","title"],fl:["title","url","cover_image"]}}}),Xo=Object.freeze({...Ao.DEFAULT_LAYOUTS}),er=Object.freeze({...Ao.DEFAULT_TRACKERS}),tr=Object.freeze({...Ao.DEFAULT_OPTIONS,api:Zo,autocomplete:Jo,layouts:Xo,trackers:er}),sr=Ao.ROLES_OPTIONS;class nr extends Ao{constructor(e,t){super({name:"search",plugin:e,client:t,roles:sr,defaults:tr})}_initProperties(e){super._initProperties(e),this._initAutocomplete(e)}notifyViewUpdate(e=rt.PRODUCTS,...t){return super.notifyViewUpdate(e,...t),this}_destroy(e){this._destroyAutocomplete(),super._destroy(e)}}Lo(nr.prototype);class ir extends Qt{constructor(e,t,s){super(e,t,s),this._members=new Map}workflows(){return[...this._members.values()]}create(e=ot){if(this._members.has(e))throw new Error(`Unit already exists: ${e}`);return this._create(e)}has(e=ot){return this._members.has(e)}get(e=ot){if("string"!=typeof e)throw new Error(`Required unit ID to be a string: ${e}`);return this._members.get(e)||this._create(e)}_create(e){throw new Error("Not implemented")}}class or extends Vi{_initProperties(e){super._initProperties(e);const{id:t}=e;u(this,{id:t})}_initSession(e){this._context._members.set(e.id,this),super._initSession(e)}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=this._writeUnitIdToInteraction(e,t)}_writeUnitIdToInteraction(e){return j(e,{context:{custom_context:{unit_id:this.id,unit_instance_uuid:this.uuid}}})}_destroy(e){this._context._members.delete(this.id),super._destroy(e)}}Object.assign(or,{DEFAULT_API_OPTIONS:Vi.DEFAULT_API_OPTIONS,DEFAULT_LAYOUTS:Vi.DEFAULT_LAYOUTS,DEFAULT_TRACKERS:Vi.DEFAULT_TRACKERS,DEFAULT_OPTIONS:Vi.DEFAULT_OPTIONS,ROLES_OPTIONS:Vi.ROLES_OPTIONS});const rr=Object.freeze({...or.DEFAULT_API_OPTIONS,group:s.RECOMMENDATION,name:n.USER_TO_PRODUCTS,payload:{...or.DEFAULT_API_OPTIONS.payload,fl:["*"]}}),ar=Object.freeze({...or.DEFAULT_LAYOUTS,[rt.PRODUCTS]:pn.type}),cr=Object.freeze({...or.DEFAULT_TRACKERS,[rt.PRODUCTS]:Tt}),lr=Object.freeze({...or.DEFAULT_OPTIONS,api:rr,layouts:ar,trackers:cr}),ur=vt(or.ROLES_OPTIONS,{main:rt.PRODUCTS,members:Object.keys(ar)});class dr extends or{constructor(e,t){super({name:"recommendation",context:e,roles:ur,defaults:lr,id:t})}start(){return this._request(),this}notifyViewUpdate(e=rt.PRODUCTS,...t){return super.notifyViewUpdate(e,...t),this}}class hr extends ir{constructor(e,t){super("recommendations",e,t)}_create(e){return new dr(this,e)}}const _r=Object.freeze({...or.DEFAULT_API_OPTIONS,group:s.ASK,name:n.RELATED_QUESTIONS}),pr=Object.freeze({...or.DEFAULT_LAYOUTS,[rt.RELATED_QUESTIONS]:[pn.type,{itemType:"question",link:{rel:"noopener nofollow"}}],[rt.QUERY]:[Kn.type,{placeholder:"Ask a question"}]}),fr=Object.freeze({...or.DEFAULT_TRACKERS,[rt.RELATED_QUESTIONS]:Tt,[rt.CONTAINER]:{...Tt,itemless:!0},[rt.QUERY]:{[ut.SUBMIT]:{active:!0}}}),mr=Object.freeze({...or.DEFAULT_OPTIONS,api:_r,layouts:pr,trackers:fr}),gr=vt(or.ROLES_OPTIONS,{main:rt.RELATED_QUESTIONS,members:Object.keys(pr)});class yr extends or{constructor(e,t){super({name:"explore",context:e,roles:gr,defaults:mr,id:t})}_initProperties(e){super._initProperties(e),this._productId=void 0,this._linkFn=void 0}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._views.get(rt.RELATED_QUESTIONS).on("click",(e=>this._handleRelatedQuestionClick(e))),this._hub.on("query",(e=>this._query(e)))]}set productId(e){console.warning("DEPRECATED: use useApi() instead"),this.useApi({product_id:e})}useApi(...e){const t=("object"==typeof e[0]?e[0]:e[1])||{},{product_id:s}=t;return s&&(this._productId=s),super.useApi(...e)}useLink(e,t){return Ji.prototype.useLink.call(this,e,t),t&&this.useLayouts({[rt.RELATED_QUESTIONS]:{link:t}}),this}start({relatedQuestions:e=!0}={}){if(void 0===this._linkFn)throw new Error("Must define link mapping function with useLink(fn) before calling start()");if(e)this._request();else{const{session:e}=this;this.updateData({session:e,request:{},value:{related_questions:[]}})}return this}notifyViewUpdate(e=rt.RELATED_QUESTIONS,...t){return super.notifyViewUpdate(e,...t),this}_defaultProcessData(e,t){return e=super._defaultProcessData(e,t),e=this._addUrlToRelatedQuestions(e)}_addUrlToRelatedQuestions(e){const{value:t}=e;if(!t||!t.related_questions)return e;const s=this._linkFn&&this._linkFn[0],n=t.related_questions.map(s?e=>({text:e,url:this._getSubmitUrl({q:e,generated:!0})}):e=>({text:e}));return{...e,value:{...t,related_questions:n}}}_handleRelatedQuestionClick({value:e,...t}){this._events.emit("select",Object.freeze({...t,question:e}))}query(e){if(!e.q)throw new Error("q is required in query() call");this._hub.update("query",e)}_query(e){this._submitToPage({...e,generated:!1})}_getSubmitUrl(e){let t=Ji.prototype._getSubmitUrl.call(this,e);return e.generated&&this._productId?`${t}&qs=${encodeURIComponent(this._productId)}`:t}}Zi(yr.prototype);class br extends ir{constructor(e,t){super("explores",e,t)}_create(e){return new yr(this,e)}}let vr=class extends W{constructor({name:e,plugin:t,MisoClient:s,...n}){super(e||"combo",t),this._name=e,this._plugin=t,this._MisoClient=s,this._options=n}get MisoClient(){return this._MisoClient}get element(){return this._element}async waitForElement(){return this._element||(this._elementRes||(this._elementRes=new x)).promise}set element(e){this._element=e,this._elementRes&&this._elementRes.resolve(e)}start(e){this._started||(this._started=!0,e&&this.config(e),this._start())}_start(){throw new Error("Unimplemented")}};const wr=Object.freeze(ro),kr=Object.freeze(ao),Sr=Object.freeze(po),Er=Object.freeze(Object.defineProperty({__proto__:null,constants:wr,phrases:kr,templates:Sr,wireFollowUps:function(e,t,s){if(!e)throw new Error("client is required");!function(e,{template:t=_o,...s}={}){if("function"!=typeof t)throw new Error("template must be a function or undefined");const n=Object.keys(s).length>0;if(t===_o&&!n)return;e.ui.asks.useTemplates({followUp:n?e=>t({...s,...e}):t})}(e,s),function(e){if(!e||"miso-follow-ups"===e.tagName.toLowerCase())return;const t=document.createElement("miso-follow-ups");for(const{name:s,value:n}of e.attributes)t.setAttribute(s,n);e.parentNode.replaceChild(t,e)}(t)},wireRelatedResources:function(e,t){if(!e)throw new Error("client is required");t&&e.ui.asks.on("loading",(e=>{for(const s of t.querySelectorAll("miso-ask"))s.workflow=e.workflow}))}},Symbol.toStringTag,{value:"Module"})),{currentScript:Cr}=document,xr=Object.freeze({templates:Sr,autostart:!0}),Or=["templates","phrases","features"];class Ir{constructor(){this._defaults=xr,this._scriptSrc=function(){if(!Cr||!Cr.src)return{};const e=document.createElement("a");e.href=Cr.src;const t={};for(const[s,n]of new URLSearchParams(e.search))"q"!==s&&(t[s]=Rr(n));return t}(),this._pageUrl=function(){const e={};for(const[t,s]of new URLSearchParams(window.location.search))t.startsWith("miso_")&&t.length>5&&"miso_api_key"!==t?e[t.substring(5)]=Rr(s):"q"===t&&(e.q=s);return e}()}resolve(e){return function({api_key:e,api_host:t,templates:s,phrases:n,...i}={}){return a({apiKey:e,apiHost:t,templates:Nr(s),phrases:n,...i})}(Tr(this._defaults,this._scriptSrc,e,this._pageUrl))}}function Tr(...e){let t={};for(const s of e)s&&(t=Ar(t,s));return t}function Ar(e,t){if(!t)return e;Object.assign(e,t);for(const s of Or)s in t&&(e[s]={...e[s],...t[s]});return e}function Rr(e){return""===e||"false"!==e&&e}function Nr(e){if(null==e)return e;switch(typeof e){case"function":return e;case"string":case"number":return()=>e;case"object":return Array.isArray(e)?e.map(Nr):function(e,t){const s={};for(const[n,i]of Object.entries(e))s[n]=t(i);return s}(e,Nr);default:throw new Error(`Unsupported template type: ${e}`)}}class $r{constructor(e,{classPrefix:t=wr.CLASS_PREFIX}={}){if(!e)throw new Error("Root element is required");u(this,{root:e,followUpsSection:e.querySelector(`.${t}__follow-ups`),relatedResourcesSection:e.querySelector(`.${t}__related-resources`),relatedResourcesContainer:e.querySelector(`.${t}__related-resources miso-ask`)})}}class Pr extends vr{constructor(e,t){super({name:"ask-combo",plugin:e,MisoClient:t}),this._options=new Ir,this._localOptions={}}config(e={}){e=Tr(this._localOptions,e);const t=this._options.resolve(e);return this._localOptions=e,this._resolvedOptions=t,this}get resolvedOptions(){return this._resolvedOptions||(this._resolvedOptions=this._options.resolve(this._localOptions))}get client(){return this._client}get elements(){return this._elements}autoStart(){this.resolvedOptions.autostart&&this.start()}async _start(){await async function(){"loading"===document.readyState&&await new Promise((e=>{document.addEventListener("DOMContentLoaded",e,{once:!0})}))}(),await this.waitForElement(),await this._setupMisoClient(),this._renderRootContent(),this._createClientInstance(),this._setupWorkflows()}async _setupMisoClient(){const{MisoClient:e,resolvedOptions:t}=this,{version:s}=e;u(e,{name:"miso-ask-combo"});("dev"===s||s.indexOf("beta")>0||t.debug)&&e.plugins.use("std:debug"),t.dry_run&&e.plugins.use("std:dry-run"),t.lorem&&await e.plugins.install("std:lorem")}_renderRootContent(){const{element:e,resolvedOptions:t}=this,{templates:s={}}=t;e.innerHTML=s.root(t),this._elements=new $r(e,t)}async _createClientInstance(){this._client=new MisoClient(this.resolvedOptions)}async _setupWorkflows(){const{MisoClient:e,client:t,elements:s,resolvedOptions:n}=this,{wireFollowUps:i,wireRelatedResources:o}=e.ui.defaults.ask,{templates:r={},features:a={},api:c}=n,l=t.ui.asks,u=t.ui.ask;c&&l.useApi(c),!1!==a.followUpQuestions&&i(t,s.followUpsSection,{...n,template:r.followUp}),!1!==a.relatedResources&&!1!==a.followUpQuestions&&o(t,s.relatedResourcesSection),u.autoQuery()}}class Lr extends K{constructor(e){super("layouts",e,{libName:"layout",keyName:e=>e.type}),this._plugin=e}get(e){return this._libraries[e]}create(e,t){if(!1!==e)switch(typeof e){case"function":return{render:e};case"string":const s=this.get(e);if(!s)throw new Error(`Layout of name '${e}' not found.`);return new s(t);default:throw new Error(`Expect a string, a render function, or boolean value false: ${e}`)}}}const qr="trait",Ur=Object.freeze([qr]);class Mr extends HTMLElement{static get tagName(){return"miso-stub"}static get observedAttributes(){return Ur}constructor(){super(),this._traits=[]}connectedCallback(){this._syncTraits()}disconnectedCallback(){for(const e of this._traits)this._destroyTrait(e);this._traits=[]}attributeChangedCallback(e){if(e===qr)this._syncTraits()}_syncTraits(){const e=(this.getAttribute(qr)||"").split(/\s+/).filter(Boolean),t=[];for(const s of this._traits)e.includes(s.constructor.traitName)?t.push(s):this._destroyTrait(s);if(e.length>0){const s=function(e){const t=e.ui&&e.ui.traits||{};return Object.values(t).reduce(((e,t)=>(e[t.traitName]=t,e)),{})}(Mr.MisoClient);for(const n of e){if(this._traits.find((e=>e.constructor.traitName===n)))continue;const e=s[n];if(!e){console.warn(`Unknown trait: ${n}`);continue}const i=new e(this);t.push(i)}}this._traits=t}_destroyTrait(e){try{e._destroy&&e._destroy()}catch(t){console.error(t)}}}let jr,Dr,Fr;async function Br(e){const t=await async function(e){return e.MisoClient||window.MisoClient||jr||(jr=async function(){return new Promise((e=>{(window.misocmd||(window.misocmd=[])).push((()=>e(window.MisoClient)))}))}())}(e);var s;return Dr=Dr||t.any(),Fr=Fr||await Dr,Fr.ui||await(s=0,new Promise((e=>setTimeout(e,s)))),Fr}const zr="logo",Hr="auto",Qr=Object.freeze([...Mr.observedAttributes,zr]);function Vr(e){if(!e)return Hr;switch(e){case"true":return!0;case"false":return!1;default:throw new Error(`Invalid logo attribute value: ${e}.`)}}class Gr extends Mr{static get observedAttributes(){return Qr}constructor(){super(),this._workflow=void 0,this._components=new Set}get isContainer(){return!0}get workflow(){return this._workflow}set workflow(e){this._setWorkflow(e)}get logo(){return Vr(this.getAttribute(zr))}set logo(e){if(this.logo===e)return;const t=function(e){switch(e){case Hr:return;case!0:return"true";case!1:return"false";default:throw new Error(`Invalid logo property value: ${e}.`)}}(e);t?this.setAttribute(zr,t):this.removeAttribute(zr)}async connectedCallback(){super.connectedCallback();const e=this._client=await Br(Gr);document.body.contains(this)&&this._setWorkflow(this._getWorkflow(e))}disconnectedCallback(){this._setWorkflow(void 0),super.disconnectedCallback()}_getWorkflow(e){throw new Error("Unimplemented")}_setWorkflow(e){this._workflow!==e&&(this._workflow&&this._workflow._views.removeContainer(this),e&&e._views.addContainer(this),this._workflow=e)}attributeChangedCallback(e,t,s){if(e===zr)this._handleLogoUpdate(t,s);else super.attributeChangedCallback(e,t,s)}_handleLogoUpdate(e,t){Vr(e)!==Vr(t)&&this._workflow&&this._workflow._views.refreshElement(this)}get components(){return[...this._components]}_addComponent(e){this._components.has(e)||(this._components.add(e),this._workflow&&this._workflow._views.addComponent(e))}_removeComponent(e){this._components.has(e)&&(this._workflow&&this._workflow._views.removeComponent(e),this._components.delete(e))}_updateComponentRole(e,t,s){this._workflow&&this._workflow._views.updateComponentRole(e,t,s)}}const Wr="parent-question-id",Kr=Object.freeze([...Gr.observedAttributes,Wr]);const Yr="unit-id",Zr=Object.freeze([...Gr.observedAttributes,Yr]);class Jr extends Gr{static get observedAttributes(){return Zr}_getWorkflow(e){return this._getWorkflowByUnitId(e,this.unitId)}_getWorkflowByUnitId(e,t){throw new Error("Not implemented")}get unitId(){return this.getAttribute(Yr)||void 0}set unitId(e){(e=e&&`${e}`)?this.setAttribute(Yr,e):this.removeAttribute(Yr)}attributeChangedCallback(e,t,s){if(e===Yr)this._handleUnitIdUpdate(t,s);else super.attributeChangedCallback(e,t,s)}_handleUnitIdUpdate(e,t){e!==t&&this._client&&this._setWorkflow(this._getWorkflowByUnitId(this._client,t))}}const Xr=Object.freeze(Object.defineProperty({__proto__:null,MisoAskElement:class extends Gr{static get tagName(){return"miso-ask"}static get observedAttributes(){return Kr}_getWorkflow(e){return this._getWorkflowByParentQuestionId(e,this.parentQuestionId)}_getWorkflowByParentQuestionId(e,t){return e.ui.asks.getByParentQuestionId(t,{autoCreate:!0})}get parentQuestionId(){return this.getAttribute(Wr)||void 0}set parentQuestionId(e){(e=void 0!==e?`${e}`:void 0)!==this.parentQuestionId&&(e?this.setAttribute(Wr,e):this.removeAttribute(Wr))}get workflow(){return this._workflow}set workflow(e){this._setWorkflow(e),this.parentQuestionId=e&&e.parentQuestionId}attributeChangedCallback(e,t,s){if(e===Wr)this._handleParentQuestionIdUpdate(t,s);else super.attributeChangedCallback(e,t,s)}_handleParentQuestionIdUpdate(e,t){(e=e||void 0)!==(t=t||void 0)&&this._client&&this._setWorkflow(this._getWorkflowByParentQuestionId(this._client,t))}},MisoExploreElement:class extends Jr{static get tagName(){return"miso-explore"}static get observedAttributes(){return Jr.observedAttributes}_getWorkflowByUnitId(e,t){return e.ui.explores.get(t)}},MisoHybridSearchElement:class extends Gr{static get tagName(){return"miso-hybrid-search"}static get observedAttributes(){return Gr.observedAttributes}_getWorkflow(e){return e.ui.hybridSearch}},MisoRecommendationElement:class extends Jr{static get tagName(){return"miso-recommendation"}static get observedAttributes(){return Jr.observedAttributes}_getWorkflowByUnitId(e,t){return e.ui.recommendations.get(t)}},MisoSearchElement:class extends Gr{static get tagName(){return"miso-search"}static get observedAttributes(){return Gr.observedAttributes}_getWorkflow(e){return e.ui.search}}},Symbol.toStringTag,{value:"Module"})),ea="role",ta=Object.freeze([ea]);class sa extends HTMLElement{static get tagName(){return"miso-component"}static get observedAttributes(){return ta}constructor({role:e}={}){super(),e&&Object.defineProperty(this,"_role",{value:e,writable:!1})}get role(){return this._role}connectedCallback(){const e=function(e){for(let t=e;t;t=t.parentNode)if(t.isContainer)return t;throw new Error(`${e.tagName} needs to be placed under a workflow container element.`)}(this);this._container&&this._container!==e&&this._container._removeComponent(this),this._syncRole(),e._addComponent(this),this._container=e,this._containerResolution&&this._containerResolution.resolve(e)}_syncRole(){const e=this.getAttribute(ea);if(e)this._role?console.warn(`Element <${this.tagName}>' already has a predefined role '${this._role}', so attribute '${ea}="${e}"' is ignored.`):this._role=e;else if(!this._role)throw new Error(`An attribute '${ea}' is required for element <${this.tagName}>`)}disconnectedCallback(){this._container&&(this._container._removeComponent(this),this._container=void 0,this._containerResolution=void 0)}attributeChangedCallback(e,t,s){t!==s&&e===ea&&this._container&&this._container._updateComponentRole(this,t,s)}}const na=Object.freeze(Object.defineProperty({__proto__:null,MisoAffiliationElement:class extends sa{constructor(){super({role:rt.AFFILIATION})}static get tagName(){return"miso-affiliation"}},MisoAnswerElement:class extends sa{constructor(){super({role:rt.ANSWER})}static get tagName(){return"miso-answer"}},MisoComponentElement:sa,MisoErrorElement:class extends sa{constructor(){super({role:rt.ERROR})}static get tagName(){return"miso-error"}},MisoFacetsElement:class extends sa{constructor(){super({role:rt.FACETS})}static get tagName(){return"miso-facets"}},MisoFeedbackElement:class extends sa{constructor(){super({role:rt.FEEDBACK})}static get tagName(){return"miso-feedback"}},MisoFollowUpQuestionsElement:class extends sa{constructor(){super({role:rt.FOLLOW_UP_QUESTIONS})}static get tagName(){return"miso-follow-up-questions"}},MisoImagesElement:class extends sa{constructor(){super({role:rt.IMAGES})}static get tagName(){return"miso-images"}},MisoKeywordsElement:class extends sa{constructor(){super({role:rt.KEYWORDS})}static get tagName(){return"miso-keywords"}},MisoMoreElement:class extends sa{constructor(){super({role:rt.MORE})}static get tagName(){return"miso-more"}},MisoProductsElement:class extends sa{constructor(){super({role:rt.PRODUCTS})}static get tagName(){return"miso-products"}},MisoQueryElement:class extends sa{constructor(){super({role:rt.QUERY})}static get tagName(){return"miso-query"}},MisoQuerySuggestionsElement:class extends sa{constructor(){super({role:rt.QUERY_SUGGESTIONS})}static get tagName(){return"miso-query-suggestions"}},MisoQuestionElement:class extends sa{constructor(){super({role:rt.QUESTION})}static get tagName(){return"miso-question"}},MisoReasoningElement:class extends sa{constructor(){super({role:rt.REASONING})}static get tagName(){return"miso-reasoning"}},MisoRelatedQuestionsElement:class extends sa{constructor(){super({role:rt.RELATED_QUESTIONS})}static get tagName(){return"miso-related-questions"}},MisoRelatedResourcesElement:class extends sa{constructor(){super({role:rt.RELATED_RESOURCES})}static get tagName(){return"miso-related-resources"}},MisoResultsElement:class extends sa{constructor(){super({role:rt.PRODUCTS})}connectedCallback(){console.warn("Element <miso-results> is deprecated. Please use <miso-products> instead."),super.connectedCallback()}static get tagName(){return"miso-results"}},MisoSortElement:class extends sa{constructor(){super({role:rt.SORT})}static get tagName(){return"miso-sort"}},MisoSourcesElement:class extends sa{constructor(){super({role:rt.SOURCES})}static get tagName(){return"miso-sources"}},MisoTotalElement:class extends sa{constructor(){super({role:rt.TOTAL})}static get tagName(){return"miso-total"}}},Symbol.toStringTag,{value:"Module"}));class ia extends Mr{static get observedAttributes(){return Mr.observedAttributes}constructor(){super(),this._context=void 0}get context(){return this._context}set context(e){this._setContext(e)}async connectedCallback(){super.connectedCallback();const e=this._client=await Br(ia);document.body.contains(this)&&this._setContext(this._getContext(e))}disconnectedCallback(){this._setContext(void 0),super.disconnectedCallback()}_getContext(e){throw new Error("Unimplemented")}_setContext(e){if(this._context===e)return;const t=this._context;this._context=e,this._onContext(e,t)}_onContext(){}}const oa=Object.freeze(Object.defineProperty({__proto__:null,MisoFollowUpsElement:class extends ia{static get tagName(){return"miso-follow-ups"}static get observedAttributes(){return ia.observedAttributes}constructor(){super(),this._elementToWorkflow=new WeakMap,this._unsubscribes=[]}_getContext(e){return e.ui.asks}_onContext(e,t){e!==t&&(this._unwire(),this._wire(e))}_unwire(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[]}_wire(e){e&&(e._autoNextFn||e.autoNext(),this._unsubscribes.push(e.on("create",(e=>{const{parentQuestionId:t}=e,s=e._options.resolved.templates.followUp;if(!t||!s)return;const n=this.children.length;this.insertAdjacentHTML("beforeend",s({parentQuestionId:t}));const i=this.children.length;for(const o of Array.prototype.slice.call(this.children,n,i))this._elementToWorkflow.set(o,e)}))),this._unsubscribes.push(e.on("loading",(({workflow:e})=>{for(const t of this.children)if(this._elementToWorkflow.get(t)===e){t.scrollIntoView({behavior:"smooth",block:"start"});break}}))),this._unsubscribes.push(e.on("destroy",(({workflow:e})=>{for(const t of this.children)this._elementToWorkflow.get(t)===e&&(this._elementToWorkflow.delete(t),t.remove())}))))}}},Symbol.toStringTag,{value:"Module"}));class ra extends HTMLElement{constructor(){super()}async connectedCallback(){document.body.contains(this)&&this._setCombo(this._getCombo(ra.MisoClient))}disconnectedCallback(){}_getCombo(e){throw new Error("Unimplemented")}_setCombo(e){this._combo!==e&&(this._combo=e,e.element=this,e.autoStart())}}const aa=Object.freeze(Object.defineProperty({__proto__:null,MisoAskComboElement:class extends ra{static get tagName(){return"miso-ask-combo"}constructor(){super()}_getCombo(e){return e.ui.combo.ask}}},Symbol.toStringTag,{value:"Module"})),ca=Object.freeze(Object.defineProperty({__proto__:null,MisoBannerElement:Xs,MisoStubElement:Mr,combos:aa,containers:Xr,contexts:oa,roles:na},Symbol.toStringTag,{value:"Module"})),la="miso-hybrid-search-combo",ua=Object.freeze(Object.defineProperty({__proto__:null,CLASS_PREFIX:la,CONAINER_TAG:"miso-hybrid-search"},Symbol.toStringTag,{value:"Module"})),da="Show more",ha="Show less",_a=Object.freeze(Object.defineProperty({__proto__:null,keywords:"You searched for ${value}",question:"You asked ${value}",showLess:ha,showMore:da,sources:"Sources",total:"${value} Results"},Symbol.toStringTag,{value:"Module"}));const pa=U(new lo({...ua,DEFAULT_PHRASES:_a})),fa=U(new class extends co{constructor(){super({helpers:pa})}answer(e){const{container:t}=this._helpers;return t(e,{name:"answer",visibleWhen:"ready !unanswerable"},[...this.question(e),"<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}answerBox(e){const{element:t}=this._helpers,{classPrefix:s}=e;return t("div",{classes:[`${s}__answer-box`]},[t("div",{classes:[`${s}__answer-box-inner`]},this.answerGroup(e)),this.answerBoxToggle(e)])}question(e){const{phrase:t}=this._helpers;return t(e,{name:"question",tag:"div"}).replaceAll("${value}","<miso-question></miso-question>")}answerBoxToggle(e){const{element:t}=this._helpers,{classPrefix:s}=e;return t("div",{classes:[`${s}__answer-box-toggle-container`]},[t("div",{classes:[`${s}__answer-box-toggle`],"data-role":"answer-box-toggle"})])}searchResultsGroup(e){const{container:t}=this._helpers;return t(e,{name:"search-results",visibleWhen:"loading ready"},[this.searchResultsInfoGroup(e),this.searchResultsFilters(e),"<miso-products></miso-products>",this.more(e)])}searchResultsInfoGroup(e){const{element:t}=this._helpers,{classPrefix:s}=e;return t("div",{classes:[`${s}__search-results-info`]},[this.keywords(e),this.total(e)])}searchResultsFilters(e){const{element:t}=this._helpers,{classPrefix:s}=e;return t("div",{classes:[`${s}__search-results-filters`]},["<miso-facets></miso-facets>","<miso-sort></miso-sort>"])}keywords(e){const{phrase:t}=this._helpers;return t(e,{name:"keywords",tag:"div",inline:!0}).replaceAll("${value}","<miso-keywords></miso-keywords>")}total(e){const{phrase:t}=this._helpers;return t(e,{name:"total",tag:"div",inline:!0}).replaceAll("${value}","<miso-total></miso-total>")}more(e){if(!e.moreButton)return"";const{element:t}=this._helpers,{classPrefix:s}=e;return t("div",{classes:[`${s}__search-results-more-container`]},["<miso-more></miso-more>"])}}({helpers:pa}));const ma=Object.freeze(Object.defineProperty({__proto__:null,helpers:pa,root:function(e={}){const{normalizeOptions:t,section:s,container:n}=pa;e=t(e);const{answerBox:i,answerGroup:o,searchResultsGroup:r}=fa,{answerBox:a=!1}=e;return[s(e,{name:"question"},[n(e,{name:"query"},"<miso-query></miso-query>")]),s(e,{name:"answer"},a?[i(e)]:o(e)),s(e,{name:"search-results"},r(e))].join("")},sections:fa},Symbol.toStringTag,{value:"Module"})),ga="answer-box-open",ya="answer-box-shown",ba='[data-role="answer-box-toggle"]';class va{constructor(e,t,{classPrefix:s=la,phrases:n={},hideWhenUnanswerable:i=!0}={}){this._client=e,this._workflow=e.ui.hybridSearch,this._element=t,this._classPrefix=s,this._phrases=n,this._hideWhenUnanswerable=i,this._init()}_init(){const e=this._element,t=this._workflow;t.answerBox=this,t._unsubscribes.push((()=>{t.answerBox===this&&(this.destroy(),t.answerBox=void 0)}));const s=e=>this._handleClick(e);e.addEventListener("click",s),this._syncWofkflowStatus(),this._syncButtonText(),this._unsubscribes=[()=>e.removeEventListener("click",s),t._answer._hub.on("data",(()=>this._syncWofkflowStatus()))]}_handleClick({target:e,button:t}){0===t&&e.closest(ba)&&this.toggleOpen()}_syncWofkflowStatus(){const{status:e}=this._workflow._answer,{meta:{unanswerable:t=!1}={}}=this._workflow._answer._hub.states.data;switch(e){case ft.ERRONEOUS:case ft.READY:t&&this._hideWhenUnanswerable?this.hide():this.show();break;default:this.hide()}}_updateBoxStatus(e,t){this._element.classList[e](`${this._classPrefix}__${t}`)}_syncButtonText(){const e=this.isOpen?this._phrases.showLess||ha:this._phrases.showMore||da;for(const t of this._element.querySelectorAll(ba))t.textContent=e}_syncScroll(){this.isOpen||this._element.scrollIntoView({behavior:"smooth"})}destroy(){for(const t of this._unsubscribes)t();const e=this._workflow;e&&e.answerBox===this&&delete e.answerBox}}const wa={isOpen:ga,shown:ya},ka={toggleOpen:["toggle",ga],open:["add",ga],close:["remove",ga],toggleHidden:["toggle",ya],show:["add",ya],hide:["remove",ya]};for(const[ep,tp]of Object.entries(wa))Object.defineProperty(va.prototype,ep,{get(){return this._element.classList.contains(`${this._classPrefix}__${tp}`)}});for(const[ep,[tp,sp]]of Object.entries(ka))va.prototype[ep]=function(){this._updateBoxStatus(tp,sp),sp===ga&&(this._syncButtonText(),this._syncScroll())};const Sa=Object.freeze(ua),Ea=Object.freeze(_a),Ca=Object.freeze(ma),xa=Object.freeze(Object.defineProperty({__proto__:null,constants:Sa,phrases:Ea,templates:Ca,wireAnswerBox:function(e,t,s={}){if(!e)throw new Error("client is required");t&&new va(e,t,s)}},Symbol.toStringTag,{value:"Module"})),Oa=Object.freeze(Er),Ia=Object.freeze(xa),Ta=Object.freeze(Object.defineProperty({__proto__:null,ask:Oa,hybridSearch:Ia},Symbol.toStringTag,{value:"Module"}));function Aa(e){const t=e._element;if(!t)return()=>{};const s=t=>e._handleClick(t);return t.addEventListener("click",s),()=>t.removeEventListener("click",s)}const Ra="miso-collapsible",Na="expanded",$a=[{action:"expand",classAction:"add",className:Na},{action:"collapse",classAction:"remove",className:Na}];class Pa{static get traitName(){return"collapsible"}constructor(e){this._element=e,e.collapsible=this,e.classList.add(Ra),this._unsubscribes=[Aa(this)]}_destroy(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[],delete this._element.collapsible,this._element.classList.remove(Ra),this._element=void 0}toggle(){this.expanded?this.collapse():this.expand()}}!function(e,t){for(const s of t)Object.defineProperty(e,s,{get(){return this._element&&this._element.classList.contains(s)}})}(Pa.prototype,[Na]),function(e,t){for(const{action:s,classAction:n,className:i}of t)e[s]=function(){this._element&&this._element.classList[n](i),this[`_${s}`]&&this[`_${s}`]()}}(Pa.prototype,$a),function(e,t){e._handleClick=function(e){const{target:s,button:n}=e;if(0===n)for(let{role:i,selector:o,action:r}of t)if(o=o||`[data-role="${i}"]`,o&&s.closest(o))return this[r](),void e.stopPropagation()}}(Pa.prototype,[{role:"expand",action:"expand"},{role:"collapse",action:"collapse"},{role:"toggle-expand",action:"toggle"}]);const La=Object.freeze(Object.defineProperty({__proto__:null,CollapsibleTrait:Pa},Symbol.toStringTag,{value:"Module"}));let qa,Ua;async function Ma(){return Ua||(Ua=A(qa||(qa=R("ui"))))}class ja{constructor(e,t){this._plugin=e,this._client=t,this._contexts={}}async require(e){if(this._contexts[e])return this._contexts[e];const t=await this._plugin.requireExtension(e);return this._contexts[e]=t.getContext(this._client)}}class Da{constructor(e,t){this._plugin=e,this._client=t,u(this,{sources:{api:xs(t)}})}get recommendations(){return this._recommendations||(this._recommendations=this._plugin._getRecommendations(this._client))}get recommendation(){return this.recommendations.get()}get search(){return this._search||(this._search=new nr(this._plugin,this._client))}get asks(){return this._asks||(this._asks=this._plugin._getAsks(this._client))}get ask(){return this.asks.root}get hybridSearch(){return this._hybridSearch||(this._hybridSearch=new Yo(this._plugin,this._client))}get explores(){return this._explores||(this._explores=this._plugin._getExplores(this._client))}get explore(){return this.explores.get()}get ready(){return this._plugin._ready.promise}}class Fa{constructor(e,t){this._plugin=e,this._MisoClient=t}get ask(){return this._ask||(this._ask=new Pr(this._plugin,this._MisoClient))}}Ae.plugins.use(class extends W{static get id(){return"std:ui"}constructor(){super("ui"),this.layouts=new Lr(this),this._recommendations=new WeakMap,this._explores=new WeakMap,this._asks=new WeakMap,this._extensions=new WeakMap,this._ready=new x}async install(e,t){t.addSubtree(this),e.on("create",this._injectClient.bind(this));const s={defaults:Ta,traits:La};l(s,this,["layouts","combo","ready"]),u(this,{MisoClient:e}),u(e,{ui:s}),this.combo=new Fa(this,e);const n=Object.values(Li).filter((e=>e.type));for(const l of n)l.MisoClient=e;for(const l of n)this.layouts.register(l);const{containers:i,roles:o,combos:r,contexts:a,...c}=ca,d=[...Object.values(r),...Object.values(a),...Object.values(i),...Object.values(o),...Object.values(c)],h=[Gr,ia,ra];for(const l of[...h,...d])l.MisoClient=e;await Ma();for(const l of d)g(l);this._ready.resolve()}async requireExtension(e){if("markdown"===e)return await this.MisoClient.plugins.install("std:ui-markdown");throw new Error(`Unknown extension: ${e}`)}get ready(){return Promise.all([this._ready.promise,MisoClient.any()]).then((()=>{}))}_injectClient(e){u(e,{ui:new Da(this,e)})}_getExtensions(e){if(this._extensions.has(e))return this._extensions.get(e);const t=new ja(this,e);return this._extensions.set(e,t),t}_getRecommendations(e){let t=this._recommendations.get(e);return t||this._recommendations.set(e,t=new hr(this,e)),t}_getExplores(e){let t=this._explores.get(e);return t||this._explores.set(e,t=new br(this,e)),t}_getAsks(e){let t=this._asks.get(e);return t||this._asks.set(e,t=new So(this,e)),t}}),Ae.attach(),function(e){const t=[];function s(e){t.push(e)}I("misodev",{transform:e=>()=>e({addCmdTransform:s})});const n=e=>{for(const s of t)e=s(e);return e};setTimeout((()=>{I("misocmd",{transform:n}),e&&e()}))}((function(){xe._cmdRes.resolve()}));const Ba="B43jkUKwmy9iEz17kO5V21KoPTmORcuBTRfltOVO";
/**
  * @vue/shared v3.5.22
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/function za(e){const t=Object.create(null);for(const s of e.split(","))t[s]=1;return e=>e in t}const Ha={},Qa=[],Va=()=>{},Ga=()=>!1,Wa=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),Ka=e=>e.startsWith("onUpdate:"),Ya=Object.assign,Za=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},Ja=Object.prototype.hasOwnProperty,Xa=(e,t)=>Ja.call(e,t),ec=Array.isArray,tc=e=>"[object Map]"===cc(e),sc=e=>"function"==typeof e,nc=e=>"string"==typeof e,ic=e=>"symbol"==typeof e,oc=e=>null!==e&&"object"==typeof e,rc=e=>(oc(e)||sc(e))&&sc(e.then)&&sc(e.catch),ac=Object.prototype.toString,cc=e=>ac.call(e),lc=e=>nc(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,uc=za(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),dc=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},hc=/-\w/g,_c=dc((e=>e.replace(hc,(e=>e.slice(1).toUpperCase())))),pc=/\B([A-Z])/g,fc=dc((e=>e.replace(pc,"-$1").toLowerCase())),mc=dc((e=>e.charAt(0).toUpperCase()+e.slice(1))),gc=dc((e=>e?`on${mc(e)}`:"")),yc=(e,t)=>!Object.is(e,t),bc=(e,...t)=>{for(let s=0;s<e.length;s++)e[s](...t)},vc=(e,t,s,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:s})},wc=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let kc;const Sc=()=>kc||(kc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});function Ec(e){if(ec(e)){const t={};for(let s=0;s<e.length;s++){const n=e[s],i=nc(n)?Ic(n):Ec(n);if(i)for(const e in i)t[e]=i[e]}return t}if(nc(e)||oc(e))return e}const Cc=/;(?![^(]*\))/g,xc=/:([^]+)/,Oc=/\/\*[^]*?\*\//g;function Ic(e){const t={};return e.replace(Oc,"").split(Cc).forEach((e=>{if(e){const s=e.split(xc);s.length>1&&(t[s[0].trim()]=s[1].trim())}})),t}function Tc(e){let t="";if(nc(e))t=e;else if(ec(e))for(let s=0;s<e.length;s++){const n=Tc(e[s]);n&&(t+=n+" ")}else if(oc(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const Ac=za("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Rc(e){return!!e||""===e}
/**
  * @vue/reactivity v3.5.22
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/let Nc,$c;class Pc{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Nc,!e&&Nc&&(this.index=(Nc.scopes||(Nc.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let e,t;if(this._isPaused=!0,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){let e,t;if(this._isPaused=!1,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=Nc;try{return Nc=this,e()}finally{Nc=t}}}on(){1==++this._on&&(this.prevScope=Nc,Nc=this)}off(){this._on>0&&0==--this._on&&(Nc=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){let t,s;for(this._active=!1,t=0,s=this.effects.length;t<s;t++)this.effects[t].stop();for(this.effects.length=0,t=0,s=this.cleanups.length;t<s;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}}const Lc=new WeakSet;class qc{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Nc&&Nc.active&&Nc.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,Lc.has(this)&&(Lc.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||Dc(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,Xc(this),zc(this);const e=$c,t=Kc;$c=this,Kc=!0;try{return this.fn()}finally{Hc(this),$c=e,Kc=t,this.flags&=-3}}stop(){if(1&this.flags){for(let e=this.deps;e;e=e.nextDep)Gc(e);this.deps=this.depsTail=void 0,Xc(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?Lc.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Qc(this)&&this.run()}get dirty(){return Qc(this)}}let Uc,Mc,jc=0;function Dc(e,t=!1){if(e.flags|=8,t)return e.next=Mc,void(Mc=e);e.next=Uc,Uc=e}function Fc(){jc++}function Bc(){if(--jc>0)return;if(Mc){let e=Mc;for(Mc=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;Uc;){let s=Uc;for(Uc=void 0;s;){const n=s.next;if(s.next=void 0,s.flags&=-9,1&s.flags)try{s.trigger()}catch(t){e||(e=t)}s=n}}if(e)throw e}function zc(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Hc(e){let t,s=e.depsTail,n=s;for(;n;){const e=n.prevDep;-1===n.version?(n===s&&(s=e),Gc(n),Wc(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=e}e.deps=t,e.depsTail=s}function Qc(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Vc(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Vc(e){if(4&e.flags&&!(16&e.flags))return;if(e.flags&=-17,e.globalVersion===el)return;if(e.globalVersion=el,!e.isSSR&&128&e.flags&&(!e.deps&&!e._dirty||!Qc(e)))return;e.flags|=2;const t=e.dep,s=$c,n=Kc;$c=e,Kc=!0;try{zc(e);const s=e.fn(e._value);(0===t.version||yc(s,e._value))&&(e.flags|=128,e._value=s,t.version++)}catch(i){throw t.version++,i}finally{$c=s,Kc=n,Hc(e),e.flags&=-3}}function Gc(e,t=!1){const{dep:s,prevSub:n,nextSub:i}=e;if(n&&(n.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=n,e.nextSub=void 0),s.subs===e&&(s.subs=n,!n&&s.computed)){s.computed.flags&=-5;for(let e=s.computed.deps;e;e=e.nextDep)Gc(e,!0)}t||--s.sc||!s.map||s.map.delete(s.key)}function Wc(e){const{prevDep:t,nextDep:s}=e;t&&(t.nextDep=s,e.prevDep=void 0),s&&(s.prevDep=t,e.nextDep=void 0)}let Kc=!0;const Yc=[];function Zc(){Yc.push(Kc),Kc=!1}function Jc(){const e=Yc.pop();Kc=void 0===e||e}function Xc(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const e=$c;$c=void 0;try{t()}finally{$c=e}}}let el=0;class tl{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class sl{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!$c||!Kc||$c===this.computed)return;let t=this.activeLink;if(void 0===t||t.sub!==$c)t=this.activeLink=new tl($c,this),$c.deps?(t.prevDep=$c.depsTail,$c.depsTail.nextDep=t,$c.depsTail=t):$c.deps=$c.depsTail=t,nl(t);else if(-1===t.version&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=$c.depsTail,t.nextDep=void 0,$c.depsTail.nextDep=t,$c.depsTail=t,$c.deps===t&&($c.deps=e)}return t}trigger(e){this.version++,el++,this.notify(e)}notify(e){Fc();try{0;for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{Bc()}}}function nl(e){if(e.dep.sc++,4&e.sub.flags){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)nl(e)}const s=e.dep.subs;s!==e&&(e.prevSub=s,s&&(s.nextSub=e)),e.dep.subs=e}}const il=new WeakMap,ol=Symbol(""),rl=Symbol(""),al=Symbol("");function cl(e,t,s){if(Kc&&$c){let t=il.get(e);t||il.set(e,t=new Map);let n=t.get(s);n||(t.set(s,n=new sl),n.map=t,n.key=s),n.track()}}function ll(e,t,s,n,i,o){const r=il.get(e);if(!r)return void el++;const a=e=>{e&&e.trigger()};if(Fc(),"clear"===t)r.forEach(a);else{const i=ec(e),o=i&&lc(s);if(i&&"length"===s){const e=Number(n);r.forEach(((t,s)=>{("length"===s||s===al||!ic(s)&&s>=e)&&a(t)}))}else switch((void 0!==s||r.has(void 0))&&a(r.get(s)),o&&a(r.get(al)),t){case"add":i?o&&a(r.get("length")):(a(r.get(ol)),tc(e)&&a(r.get(rl)));break;case"delete":i||(a(r.get(ol)),tc(e)&&a(r.get(rl)));break;case"set":tc(e)&&a(r.get(ol))}}Bc()}function ul(e){const t=Wl(e);return t===e?t:(cl(t,0,al),Vl(e)?t:t.map(Kl))}function dl(e){return cl(e=Wl(e),0,al),e}const hl={__proto__:null,[Symbol.iterator](){return _l(this,Symbol.iterator,Kl)},concat(...e){return ul(this).concat(...e.map((e=>ec(e)?ul(e):e)))},entries(){return _l(this,"entries",(e=>(e[1]=Kl(e[1]),e)))},every(e,t){return fl(this,"every",e,t,void 0,arguments)},filter(e,t){return fl(this,"filter",e,t,(e=>e.map(Kl)),arguments)},find(e,t){return fl(this,"find",e,t,Kl,arguments)},findIndex(e,t){return fl(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return fl(this,"findLast",e,t,Kl,arguments)},findLastIndex(e,t){return fl(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return fl(this,"forEach",e,t,void 0,arguments)},includes(...e){return gl(this,"includes",e)},indexOf(...e){return gl(this,"indexOf",e)},join(e){return ul(this).join(e)},lastIndexOf(...e){return gl(this,"lastIndexOf",e)},map(e,t){return fl(this,"map",e,t,void 0,arguments)},pop(){return yl(this,"pop")},push(...e){return yl(this,"push",e)},reduce(e,...t){return ml(this,"reduce",e,t)},reduceRight(e,...t){return ml(this,"reduceRight",e,t)},shift(){return yl(this,"shift")},some(e,t){return fl(this,"some",e,t,void 0,arguments)},splice(...e){return yl(this,"splice",e)},toReversed(){return ul(this).toReversed()},toSorted(e){return ul(this).toSorted(e)},toSpliced(...e){return ul(this).toSpliced(...e)},unshift(...e){return yl(this,"unshift",e)},values(){return _l(this,"values",Kl)}};function _l(e,t,s){const n=dl(e),i=n[t]();return n===e||Vl(e)||(i._next=i.next,i.next=()=>{const e=i._next();return e.done||(e.value=s(e.value)),e}),i}const pl=Array.prototype;function fl(e,t,s,n,i,o){const r=dl(e),a=r!==e&&!Vl(e),c=r[t];if(c!==pl[t]){const t=c.apply(e,o);return a?Kl(t):t}let l=s;r!==e&&(a?l=function(t,n){return s.call(this,Kl(t),n,e)}:s.length>2&&(l=function(t,n){return s.call(this,t,n,e)}));const u=c.call(r,l,n);return a&&i?i(u):u}function ml(e,t,s,n){const i=dl(e);let o=s;return i!==e&&(Vl(e)?s.length>3&&(o=function(t,n,i){return s.call(this,t,n,i,e)}):o=function(t,n,i){return s.call(this,t,Kl(n),i,e)}),i[t](o,...n)}function gl(e,t,s){const n=Wl(e);cl(n,0,al);const i=n[t](...s);return-1!==i&&!1!==i||!Gl(s[0])?i:(s[0]=Wl(s[0]),n[t](...s))}function yl(e,t,s=[]){Zc(),Fc();const n=Wl(e)[t].apply(e,s);return Bc(),Jc(),n}const bl=za("__proto__,__v_isRef,__isVue"),vl=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(ic));function wl(e){ic(e)||(e=String(e));const t=Wl(this);return cl(t,0,e),t.hasOwnProperty(e)}class kl{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,s){if("__v_skip"===t)return e.__v_skip;const n=this._isReadonly,i=this._isShallow;if("__v_isReactive"===t)return!n;if("__v_isReadonly"===t)return n;if("__v_isShallow"===t)return i;if("__v_raw"===t)return s===(n?i?jl:Ml:i?Ul:ql).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(s)?e:void 0;const o=ec(e);if(!n){let e;if(o&&(e=hl[t]))return e;if("hasOwnProperty"===t)return wl}const r=Reflect.get(e,t,Zl(e)?e:s);if(ic(t)?vl.has(t):bl(t))return r;if(n||cl(e,0,t),i)return r;if(Zl(r)){const e=o&&lc(t)?r:r.value;return n&&oc(e)?Bl(e):e}return oc(r)?n?Bl(r):Fl(r):r}}class Sl extends kl{constructor(e=!1){super(!1,e)}set(e,t,s,n){let i=e[t];if(!this._isShallow){const t=Ql(i);if(Vl(s)||Ql(s)||(i=Wl(i),s=Wl(s)),!ec(e)&&Zl(i)&&!Zl(s))return t||(i.value=s),!0}const o=ec(e)&&lc(t)?Number(t)<e.length:Xa(e,t),r=Reflect.set(e,t,s,Zl(e)?e:n);return e===Wl(n)&&(o?yc(s,i)&&ll(e,"set",t,s):ll(e,"add",t,s)),r}deleteProperty(e,t){const s=Xa(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&s&&ll(e,"delete",t,void 0),n}has(e,t){const s=Reflect.has(e,t);return ic(t)&&vl.has(t)||cl(e,0,t),s}ownKeys(e){return cl(e,0,ec(e)?"length":ol),Reflect.ownKeys(e)}}class El extends kl{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Cl=new Sl,xl=new El,Ol=new Sl(!0),Il=e=>e,Tl=e=>Reflect.getPrototypeOf(e);function Al(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function Rl(e,t){const s={get(s){const n=this.__v_raw,i=Wl(n),o=Wl(s);e||(yc(s,o)&&cl(i,0,s),cl(i,0,o));const{has:r}=Tl(i),a=t?Il:e?Yl:Kl;return r.call(i,s)?a(n.get(s)):r.call(i,o)?a(n.get(o)):void(n!==i&&n.get(s))},get size(){const t=this.__v_raw;return!e&&cl(Wl(t),0,ol),t.size},has(t){const s=this.__v_raw,n=Wl(s),i=Wl(t);return e||(yc(t,i)&&cl(n,0,t),cl(n,0,i)),t===i?s.has(t):s.has(t)||s.has(i)},forEach(s,n){const i=this,o=i.__v_raw,r=Wl(o),a=t?Il:e?Yl:Kl;return!e&&cl(r,0,ol),o.forEach(((e,t)=>s.call(n,a(e),a(t),i)))}};Ya(s,e?{add:Al("add"),set:Al("set"),delete:Al("delete"),clear:Al("clear")}:{add(e){t||Vl(e)||Ql(e)||(e=Wl(e));const s=Wl(this);return Tl(s).has.call(s,e)||(s.add(e),ll(s,"add",e,e)),this},set(e,s){t||Vl(s)||Ql(s)||(s=Wl(s));const n=Wl(this),{has:i,get:o}=Tl(n);let r=i.call(n,e);r||(e=Wl(e),r=i.call(n,e));const a=o.call(n,e);return n.set(e,s),r?yc(s,a)&&ll(n,"set",e,s):ll(n,"add",e,s),this},delete(e){const t=Wl(this),{has:s,get:n}=Tl(t);let i=s.call(t,e);i||(e=Wl(e),i=s.call(t,e)),n&&n.call(t,e);const o=t.delete(e);return i&&ll(t,"delete",e,void 0),o},clear(){const e=Wl(this),t=0!==e.size,s=e.clear();return t&&ll(e,"clear",void 0,void 0),s}});return["keys","values","entries",Symbol.iterator].forEach((n=>{s[n]=function(e,t,s){return function(...n){const i=this.__v_raw,o=Wl(i),r=tc(o),a="entries"===e||e===Symbol.iterator&&r,c="keys"===e&&r,l=i[e](...n),u=s?Il:t?Yl:Kl;return!t&&cl(o,0,c?rl:ol),{next(){const{value:e,done:t}=l.next();return t?{value:e,done:t}:{value:a?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}(n,e,t)})),s}function Nl(e,t){const s=Rl(e,t);return(t,n,i)=>"__v_isReactive"===n?!e:"__v_isReadonly"===n?e:"__v_raw"===n?t:Reflect.get(Xa(s,n)&&n in t?s:t,n,i)}const $l={get:Nl(!1,!1)},Pl={get:Nl(!1,!0)},Ll={get:Nl(!0,!1)},ql=new WeakMap,Ul=new WeakMap,Ml=new WeakMap,jl=new WeakMap;function Dl(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((e=>cc(e).slice(8,-1))(e))}function Fl(e){return Ql(e)?e:zl(e,!1,Cl,$l,ql)}function Bl(e){return zl(e,!0,xl,Ll,Ml)}function zl(e,t,s,n,i){if(!oc(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const o=Dl(e);if(0===o)return e;const r=i.get(e);if(r)return r;const a=new Proxy(e,2===o?n:s);return i.set(e,a),a}function Hl(e){return Ql(e)?Hl(e.__v_raw):!(!e||!e.__v_isReactive)}function Ql(e){return!(!e||!e.__v_isReadonly)}function Vl(e){return!(!e||!e.__v_isShallow)}function Gl(e){return!!e&&!!e.__v_raw}function Wl(e){const t=e&&e.__v_raw;return t?Wl(t):e}const Kl=e=>oc(e)?Fl(e):e,Yl=e=>oc(e)?Bl(e):e;function Zl(e){return!!e&&!0===e.__v_isRef}const Jl={get:(e,t,s)=>{return"__v_raw"===t?e:Zl(n=Reflect.get(e,t,s))?n.value:n;var n},set:(e,t,s,n)=>{const i=e[t];return Zl(i)&&!Zl(s)?(i.value=s,!0):Reflect.set(e,t,s,n)}};function Xl(e){return Hl(e)?e:new Proxy(e,Jl)}class eu{constructor(e,t,s){this.fn=e,this.setter=t,this._value=void 0,this.dep=new sl(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=el-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=s}notify(){if(this.flags|=16,!(8&this.flags)&&$c!==this)return Dc(this,!0),!0}get value(){const e=this.dep.track();return Vc(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}const tu={},su=new WeakMap;let nu;function iu(e,t,s=Ha){const{immediate:n,deep:i,once:o,scheduler:r,augmentJob:a,call:c}=s,l=e=>i?e:Vl(e)||!1===i||0===i?ou(e,1):ou(e);let u,d,h,_,p=!1,f=!1;if(Zl(e)?(d=()=>e.value,p=Vl(e)):Hl(e)?(d=()=>l(e),p=!0):ec(e)?(f=!0,p=e.some((e=>Hl(e)||Vl(e))),d=()=>e.map((e=>Zl(e)?e.value:Hl(e)?l(e):sc(e)?c?c(e,2):e():void 0))):d=sc(e)?t?c?()=>c(e,2):e:()=>{if(h){Zc();try{h()}finally{Jc()}}const t=nu;nu=u;try{return c?c(e,3,[_]):e(_)}finally{nu=t}}:Va,t&&i){const e=d,t=!0===i?1/0:i;d=()=>ou(e(),t)}const m=Nc,g=()=>{u.stop(),m&&m.active&&Za(m.effects,u)};if(o&&t){const e=t;t=(...t)=>{e(...t),g()}}let y=f?new Array(e.length).fill(tu):tu;const b=e=>{if(1&u.flags&&(u.dirty||e))if(t){const e=u.run();if(i||p||(f?e.some(((e,t)=>yc(e,y[t]))):yc(e,y))){h&&h();const s=nu;nu=u;try{const s=[e,y===tu?void 0:f&&y[0]===tu?[]:y,_];y=e,c?c(t,3,s):t(...s)}finally{nu=s}}}else u.run()};return a&&a(b),u=new qc(d),u.scheduler=r?()=>r(b,!1):b,_=e=>function(e,t=!1,s=nu){if(s){let t=su.get(s);t||su.set(s,t=[]),t.push(e)}}(e,!1,u),h=u.onStop=()=>{const e=su.get(u);if(e){if(c)c(e,4);else for(const t of e)t();su.delete(u)}},t?n?b(!0):y=u.run():r?r(b.bind(null,!0),!0):u.run(),g.pause=u.pause.bind(u),g.resume=u.resume.bind(u),g.stop=g,g}function ou(e,t=1/0,s){if(t<=0||!oc(e)||e.__v_skip)return e;if(((s=s||new Map).get(e)||0)>=t)return e;if(s.set(e,t),t--,Zl(e))ou(e.value,t,s);else if(ec(e))for(let n=0;n<e.length;n++)ou(e[n],t,s);else if("[object Set]"===cc(e)||tc(e))e.forEach((e=>{ou(e,t,s)}));else if((e=>"[object Object]"===cc(e))(e)){for(const n in e)ou(e[n],t,s);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&ou(e[n],t,s)}return e}
/**
  * @vue/runtime-core v3.5.22
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/function ru(e,t,s,n){try{return n?e(...n):e()}catch(i){cu(i,t,s)}}function au(e,t,s,n){if(sc(e)){const i=ru(e,t,s,n);return i&&rc(i)&&i.catch((e=>{cu(e,t,s)})),i}if(ec(e)){const i=[];for(let o=0;o<e.length;o++)i.push(au(e[o],t,s,n));return i}}function cu(e,t,s,n=!0){t&&t.vnode;const{errorHandler:i,throwUnhandledErrorInProduction:o}=t&&t.appContext.config||Ha;if(t){let n=t.parent;const o=t.proxy,r=`https://vuejs.org/error-reference/#runtime-${s}`;for(;n;){const t=n.ec;if(t)for(let s=0;s<t.length;s++)if(!1===t[s](e,o,r))return;n=n.parent}if(i)return Zc(),ru(i,null,10,[e,o,r]),void Jc()}!function(e,t,s,n=!0,i=!1){if(i)throw e;console.error(e)}(e,0,0,n,o)}const lu=[];let uu=-1;const du=[];let hu=null,_u=0;const pu=Promise.resolve();let fu=null;function mu(e){const t=fu||pu;return e?t.then(this?e.bind(this):e):t}function gu(e){if(!(1&e.flags)){const t=wu(e),s=lu[lu.length-1];!s||!(2&e.flags)&&t>=wu(s)?lu.push(e):lu.splice(function(e){let t=uu+1,s=lu.length;for(;t<s;){const n=t+s>>>1,i=lu[n],o=wu(i);o<e||o===e&&2&i.flags?t=n+1:s=n}return t}(t),0,e),e.flags|=1,yu()}}function yu(){fu||(fu=pu.then(ku))}function bu(e,t,s=uu+1){for(;s<lu.length;s++){const t=lu[s];if(t&&2&t.flags){if(e&&t.id!==e.uid)continue;lu.splice(s,1),s--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function vu(e){if(du.length){const e=[...new Set(du)].sort(((e,t)=>wu(e)-wu(t)));if(du.length=0,hu)return void hu.push(...e);for(hu=e,_u=0;_u<hu.length;_u++){const e=hu[_u];4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}hu=null,_u=0}}const wu=e=>null==e.id?2&e.flags?-1:1/0:e.id;function ku(e){try{for(uu=0;uu<lu.length;uu++){const e=lu[uu];!e||8&e.flags||(4&e.flags&&(e.flags&=-2),ru(e,e.i,e.i?15:14),4&e.flags||(e.flags&=-2))}}finally{for(;uu<lu.length;uu++){const e=lu[uu];e&&(e.flags&=-2)}uu=-1,lu.length=0,vu(),fu=null,(lu.length||du.length)&&ku()}}let Su=null,Eu=null;function Cu(e){const t=Su;return Su=e,Eu=e&&e.type.__scopeId||null,t}function xu(e,t,s,n){const i=e.dirs,o=t&&t.dirs;for(let r=0;r<i.length;r++){const a=i[r];o&&(a.oldValue=o[r].value);let c=a.dir[n];c&&(Zc(),au(c,s,8,[e.el,a,e,t]),Jc())}}const Ou=Symbol("_vte"),Iu=Symbol("_leaveCb");function Tu(e,t){6&e.shapeFlag&&e.component?(e.transition=t,Tu(e.component.subTree,t)):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Au(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const Ru=new WeakMap;function Nu(e,t,s,n,i=!1){if(ec(e))return void e.forEach(((e,o)=>Nu(e,t&&(ec(t)?t[o]:t),s,n,i)));if(Pu(n)&&!i)return void(512&n.shapeFlag&&n.type.__asyncResolved&&n.component.subTree.component&&Nu(e,t,s,n.component.subTree));const o=4&n.shapeFlag?Fh(n.component):n.el,r=i?null:o,{i:a,r:c}=e,l=t&&t.r,u=a.refs===Ha?a.refs={}:a.refs,d=a.setupState,h=Wl(d),_=d===Ha?Ga:e=>Xa(h,e);if(null!=l&&l!==c)if($u(t),nc(l))u[l]=null,_(l)&&(d[l]=null);else if(Zl(l)){l.value=null;const e=t;e.k&&(u[e.k]=null)}if(sc(c))ru(c,a,12,[r,u]);else{const t=nc(c),n=Zl(c);if(t||n){const a=()=>{if(e.f){const s=t?_(c)?d[c]:u[c]:c.value;if(i)ec(s)&&Za(s,o);else if(ec(s))s.includes(o)||s.push(o);else if(t)u[c]=[o],_(c)&&(d[c]=u[c]);else{const t=[o];c.value=t,e.k&&(u[e.k]=t)}}else t?(u[c]=r,_(c)&&(d[c]=r)):n&&(c.value=r,e.k&&(u[e.k]=r))};if(r){const t=()=>{a(),Ru.delete(e)};t.id=-1,Ru.set(e,t),qd(t,s)}else $u(e),a()}}}function $u(e){const t=Ru.get(e);t&&(t.flags|=8,Ru.delete(e))}Sc().requestIdleCallback,Sc().cancelIdleCallback;const Pu=e=>!!e.type.__asyncLoader,Lu=e=>e.type.__isKeepAlive;function qu(e,t){Mu(e,"a",t)}function Uu(e,t){Mu(e,"da",t)}function Mu(e,t,s=Ah){const n=e.__wdc||(e.__wdc=()=>{let t=s;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(Du(t,n,s),s){let e=s.parent;for(;e&&e.parent;)Lu(e.parent.vnode)&&ju(n,t,s,e),e=e.parent}}function ju(e,t,s,n){const i=Du(t,e,n,!0);Gu((()=>{Za(n[t],i)}),s)}function Du(e,t,s=Ah,n=!1){if(s){const i=s[e]||(s[e]=[]),o=t.__weh||(t.__weh=(...n)=>{Zc();const i=Ph(s),o=au(t,s,e,n);return i(),Jc(),o});return n?i.unshift(o):i.push(o),o}}const Fu=e=>(t,s=Ah)=>{Uh&&"sp"!==e||Du(e,((...e)=>t(...e)),s)},Bu=Fu("bm"),zu=Fu("m"),Hu=Fu("bu"),Qu=Fu("u"),Vu=Fu("bum"),Gu=Fu("um"),Wu=Fu("sp"),Ku=Fu("rtg"),Yu=Fu("rtc");function Zu(e,t=Ah){Du("ec",e,t)}const Ju=Symbol.for("v-ndc"),Xu=e=>e?qh(e)?Fh(e):Xu(e.parent):null,ed=Ya(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Xu(e.parent),$root:e=>Xu(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>cd(e),$forceUpdate:e=>e.f||(e.f=()=>{gu(e.update)}),$nextTick:e=>e.n||(e.n=mu.bind(e.proxy)),$watch:e=>Gd.bind(e)}),td=(e,t)=>e!==Ha&&!e.__isScriptSetup&&Xa(e,t),sd={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:s,setupState:n,data:i,props:o,accessCache:r,type:a,appContext:c}=e;let l;if("$"!==t[0]){const a=r[t];if(void 0!==a)switch(a){case 1:return n[t];case 2:return i[t];case 4:return s[t];case 3:return o[t]}else{if(td(n,t))return r[t]=1,n[t];if(i!==Ha&&Xa(i,t))return r[t]=2,i[t];if((l=e.propsOptions[0])&&Xa(l,t))return r[t]=3,o[t];if(s!==Ha&&Xa(s,t))return r[t]=4,s[t];id&&(r[t]=0)}}const u=ed[t];let d,h;return u?("$attrs"===t&&cl(e.attrs,0,""),u(e)):(d=a.__cssModules)&&(d=d[t])?d:s!==Ha&&Xa(s,t)?(r[t]=4,s[t]):(h=c.config.globalProperties,Xa(h,t)?h[t]:void 0)},set({_:e},t,s){const{data:n,setupState:i,ctx:o}=e;return td(i,t)?(i[t]=s,!0):n!==Ha&&Xa(n,t)?(n[t]=s,!0):!Xa(e.props,t)&&(("$"!==t[0]||!(t.slice(1)in e))&&(o[t]=s,!0))},has({_:{data:e,setupState:t,accessCache:s,ctx:n,appContext:i,propsOptions:o,type:r}},a){let c,l;return!!(s[a]||e!==Ha&&"$"!==a[0]&&Xa(e,a)||td(t,a)||(c=o[0])&&Xa(c,a)||Xa(n,a)||Xa(ed,a)||Xa(i.config.globalProperties,a)||(l=r.__cssModules)&&l[a])},defineProperty(e,t,s){return null!=s.get?e._.accessCache[t]=0:Xa(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function nd(e){return ec(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let id=!0;function od(e){const t=cd(e),s=e.proxy,n=e.ctx;id=!1,t.beforeCreate&&rd(t.beforeCreate,e,"bc");const{data:i,computed:o,methods:r,watch:a,provide:c,inject:l,created:u,beforeMount:d,mounted:h,beforeUpdate:_,updated:p,activated:f,deactivated:m,beforeDestroy:g,beforeUnmount:y,destroyed:b,unmounted:v,render:w,renderTracked:k,renderTriggered:S,errorCaptured:E,serverPrefetch:C,expose:x,inheritAttrs:O,components:I,directives:T,filters:A}=t;if(l&&function(e,t){ec(e)&&(e=hd(e));for(const s in e){const n=e[s];let i;i=oc(n)?"default"in n?vd(n.from||s,n.default,!0):vd(n.from||s):vd(n),Zl(i)?Object.defineProperty(t,s,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e}):t[s]=i}}(l,n,null),r)for(const N in r){const e=r[N];sc(e)&&(n[N]=e.bind(s))}if(i){const t=i.call(s,s);oc(t)&&(e.data=Fl(t))}if(id=!0,o)for(const N in o){const e=o[N],t=sc(e)?e.bind(s,s):sc(e.get)?e.get.bind(s,s):Va,i=!sc(e)&&sc(e.set)?e.set.bind(s):Va,r=Bh({get:t,set:i});Object.defineProperty(n,N,{enumerable:!0,configurable:!0,get:()=>r.value,set:e=>r.value=e})}if(a)for(const N in a)ad(a[N],n,s,N);if(c){const e=sc(c)?c.call(s):c;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(Ah){let s=Ah.provides;const n=Ah.parent&&Ah.parent.provides;n===s&&(s=Ah.provides=Object.create(n)),s[e]=t}else;}(t,e[t])}))}function R(e,t){ec(t)?t.forEach((t=>e(t.bind(s)))):t&&e(t.bind(s))}if(u&&rd(u,e,"c"),R(Bu,d),R(zu,h),R(Hu,_),R(Qu,p),R(qu,f),R(Uu,m),R(Zu,E),R(Yu,k),R(Ku,S),R(Vu,y),R(Gu,v),R(Wu,C),ec(x))if(x.length){const t=e.exposed||(e.exposed={});x.forEach((e=>{Object.defineProperty(t,e,{get:()=>s[e],set:t=>s[e]=t,enumerable:!0})}))}else e.exposed||(e.exposed={});w&&e.render===Va&&(e.render=w),null!=O&&(e.inheritAttrs=O),I&&(e.components=I),T&&(e.directives=T),C&&Au(e)}function rd(e,t,s){au(ec(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,s)}function ad(e,t,s,n){let i=n.includes(".")?Wd(s,n):()=>s[n];if(nc(e)){const s=t[e];sc(s)&&Qd(i,s)}else if(sc(e))Qd(i,e.bind(s));else if(oc(e))if(ec(e))e.forEach((e=>ad(e,t,s,n)));else{const n=sc(e.handler)?e.handler.bind(s):t[e.handler];sc(n)&&Qd(i,n,e)}}function cd(e){const t=e.type,{mixins:s,extends:n}=t,{mixins:i,optionsCache:o,config:{optionMergeStrategies:r}}=e.appContext,a=o.get(t);let c;return a?c=a:i.length||s||n?(c={},i.length&&i.forEach((e=>ld(c,e,r,!0))),ld(c,t,r)):c=t,oc(t)&&o.set(t,c),c}function ld(e,t,s,n=!1){const{mixins:i,extends:o}=t;o&&ld(e,o,s,!0),i&&i.forEach((t=>ld(e,t,s,!0)));for(const r in t)if(n&&"expose"===r);else{const n=ud[r]||s&&s[r];e[r]=n?n(e[r],t[r]):t[r]}return e}const ud={data:dd,props:fd,emits:fd,methods:pd,computed:pd,beforeCreate:_d,created:_d,beforeMount:_d,mounted:_d,beforeUpdate:_d,updated:_d,beforeDestroy:_d,beforeUnmount:_d,destroyed:_d,unmounted:_d,activated:_d,deactivated:_d,errorCaptured:_d,serverPrefetch:_d,components:pd,directives:pd,watch:function(e,t){if(!e)return t;if(!t)return e;const s=Ya(Object.create(null),e);for(const n in t)s[n]=_d(e[n],t[n]);return s},provide:dd,inject:function(e,t){return pd(hd(e),hd(t))}};function dd(e,t){return t?e?function(){return Ya(sc(e)?e.call(this,this):e,sc(t)?t.call(this,this):t)}:t:e}function hd(e){if(ec(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function _d(e,t){return e?[...new Set([].concat(e,t))]:t}function pd(e,t){return e?Ya(Object.create(null),e,t):t}function fd(e,t){return e?ec(e)&&ec(t)?[...new Set([...e,...t])]:Ya(Object.create(null),nd(e),nd(null!=t?t:{})):t}function md(){return{app:null,config:{isNativeTag:Ga,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let gd=0;function yd(e,t){return function(t,s=null){sc(t)||(t=Ya({},t)),null==s||oc(s)||(s=null);const n=md(),i=new WeakSet,o=[];let r=!1;const a=n.app={_uid:gd++,_component:t,_props:s,_container:null,_context:n,_instance:null,version:zh,get config(){return n.config},set config(e){},use:(e,...t)=>(i.has(e)||(e&&sc(e.install)?(i.add(e),e.install(a,...t)):sc(e)&&(i.add(e),e(a,...t))),a),mixin:e=>(n.mixins.includes(e)||n.mixins.push(e),a),component:(e,t)=>t?(n.components[e]=t,a):n.components[e],directive:(e,t)=>t?(n.directives[e]=t,a):n.directives[e],mount(i,o,c){if(!r){const o=a._ceVNode||wh(t,s);return o.appContext=n,!0===c?c="svg":!1===c&&(c=void 0),e(o,i,c),r=!0,a._container=i,i.__vue_app__=a,Fh(o.component)}},onUnmount(e){o.push(e)},unmount(){r&&(au(o,a._instance,16),e(null,a._container),delete a._container.__vue_app__)},provide:(e,t)=>(n.provides[e]=t,a),runWithContext(e){const t=bd;bd=a;try{return e()}finally{bd=t}}};return a}}let bd=null;function vd(e,t,s=!1){const n=Rh();if(n||bd){let i=bd?bd._context.provides:n?null==n.parent||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return s&&sc(t)?t.call(n&&n.proxy):t}}const wd={},kd=()=>Object.create(wd),Sd=e=>Object.getPrototypeOf(e)===wd;function Ed(e,t,s,n=!1){const i={},o=kd();e.propsDefaults=Object.create(null),Cd(e,t,i,o);for(const r in e.propsOptions[0])r in i||(i[r]=void 0);s?e.props=n?i:zl(i,!1,Ol,Pl,Ul):e.type.props?e.props=i:e.props=o,e.attrs=o}function Cd(e,t,s,n){const[i,o]=e.propsOptions;let r,a=!1;if(t)for(let c in t){if(uc(c))continue;const l=t[c];let u;i&&Xa(i,u=_c(c))?o&&o.includes(u)?(r||(r={}))[u]=l:s[u]=l:Xd(e.emitsOptions,c)||c in n&&l===n[c]||(n[c]=l,a=!0)}if(o){const t=Wl(s),n=r||Ha;for(let r=0;r<o.length;r++){const a=o[r];s[a]=xd(i,t,a,n[a],e,!Xa(n,a))}}return a}function xd(e,t,s,n,i,o){const r=e[s];if(null!=r){const e=Xa(r,"default");if(e&&void 0===n){const e=r.default;if(r.type!==Function&&!r.skipFactory&&sc(e)){const{propsDefaults:o}=i;if(s in o)n=o[s];else{const r=Ph(i);n=o[s]=e.call(null,t),r()}}else n=e;i.ce&&i.ce._setProp(s,n)}r[0]&&(o&&!e?n=!1:!r[1]||""!==n&&n!==fc(s)||(n=!0))}return n}const Od=new WeakMap;function Id(e,t,s=!1){const n=s?Od:t.propsCache,i=n.get(e);if(i)return i;const o=e.props,r={},a=[];let c=!1;if(!sc(e)){const n=e=>{c=!0;const[s,n]=Id(e,t,!0);Ya(r,s),n&&a.push(...n)};!s&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}if(!o&&!c)return oc(e)&&n.set(e,Qa),Qa;if(ec(o))for(let u=0;u<o.length;u++){const e=_c(o[u]);Td(e)&&(r[e]=Ha)}else if(o)for(const u in o){const e=_c(u);if(Td(e)){const t=o[u],s=r[e]=ec(t)||sc(t)?{type:t}:Ya({},t),n=s.type;let i=!1,c=!0;if(ec(n))for(let e=0;e<n.length;++e){const t=n[e],s=sc(t)&&t.name;if("Boolean"===s){i=!0;break}"String"===s&&(c=!1)}else i=sc(n)&&"Boolean"===n.name;s[0]=i,s[1]=c,(i||Xa(s,"default"))&&a.push(e)}}const l=[r,a];return oc(e)&&n.set(e,l),l}function Td(e){return"$"!==e[0]&&!uc(e)}const Ad=e=>"_"===e||"_ctx"===e||"$stable"===e,Rd=e=>ec(e)?e.map(Eh):[Eh(e)],Nd=(e,t,s)=>{if(t._n)return t;const n=function(e,t=Su){if(!t)return e;if(e._n)return e;const s=(...n)=>{s._d&&_h(-1);const i=Cu(t);let o;try{o=e(...n)}finally{Cu(i),s._d&&_h(1)}return o};return s._n=!0,s._c=!0,s._d=!0,s}(((...e)=>Rd(t(...e))),s);return n._c=!1,n},$d=(e,t,s)=>{const n=e._ctx;for(const i in e){if(Ad(i))continue;const s=e[i];if(sc(s))t[i]=Nd(0,s,n);else if(null!=s){const e=Rd(s);t[i]=()=>e}}},Pd=(e,t)=>{const s=Rd(t);e.slots.default=()=>s},Ld=(e,t,s)=>{for(const n in t)!s&&Ad(n)||(e[n]=t[n])},qd=function(e,t){t&&t.pendingBranch?ec(e)?t.effects.push(...e):t.effects.push(e):(ec(s=e)?du.push(...s):hu&&-1===s.id?hu.splice(_u+1,0,s):1&s.flags||(du.push(s),s.flags|=1),yu());var s};function Ud(e){return function(e){Sc().__VUE__=!0;const{insert:t,remove:s,patchProp:n,createElement:i,createText:o,createComment:r,setText:a,setElementText:c,parentNode:l,nextSibling:u,setScopeId:d=Va,insertStaticContent:h}=e,_=(e,t,s,n=null,i=null,o=null,r=void 0,a=null,c=!!t.dynamicChildren)=>{if(e===t)return;e&&!gh(e,t)&&(n=F(e),q(e,i,o,!0),e=null),-2===t.patchFlag&&(c=!1,t.dynamicChildren=null);const{type:l,ref:u,shapeFlag:d}=t;switch(l){case rh:p(e,t,s,n);break;case ah:f(e,t,s,n);break;case ch:null==e&&m(t,s,n,r);break;case oh:x(e,t,s,n,i,o,r,a,c);break;default:1&d?b(e,t,s,n,i,o,r,a,c):6&d?O(e,t,s,n,i,o,r,a,c):(64&d||128&d)&&l.process(e,t,s,n,i,o,r,a,c,H)}null!=u&&i?Nu(u,e&&e.ref,o,t||e,!t):null==u&&e&&null!=e.ref&&Nu(e.ref,null,o,e,!0)},p=(e,s,n,i)=>{if(null==e)t(s.el=o(s.children),n,i);else{const t=s.el=e.el;s.children!==e.children&&a(t,s.children)}},f=(e,s,n,i)=>{null==e?t(s.el=r(s.children||""),n,i):s.el=e.el},m=(e,t,s,n)=>{[e.el,e.anchor]=h(e.children,t,s,n,e.el,e.anchor)},g=({el:e,anchor:s},n,i)=>{let o;for(;e&&e!==s;)o=u(e),t(e,n,i),e=o;t(s,n,i)},y=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=u(e),s(e),e=n;s(t)},b=(e,t,s,n,i,o,r,a,c)=>{"svg"===t.type?r="svg":"math"===t.type&&(r="mathml"),null==e?v(t,s,n,i,o,r,a,c):S(e,t,i,o,r,a,c)},v=(e,s,o,r,a,l,u,d)=>{let h,_;const{props:p,shapeFlag:f,transition:m,dirs:g}=e;if(h=e.el=i(e.type,l,p&&p.is,p),8&f?c(h,e.children):16&f&&k(e.children,h,null,r,a,Md(e,l),u,d),g&&xu(e,null,r,"created"),w(h,e,e.scopeId,u,r),p){for(const e in p)"value"===e||uc(e)||n(h,e,null,p[e],l,r);"value"in p&&n(h,"value",null,p.value,l),(_=p.onVnodeBeforeMount)&&Oh(_,r,e)}g&&xu(e,null,r,"beforeMount");const y=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(a,m);y&&m.beforeEnter(h),t(h,s,o),((_=p&&p.onVnodeMounted)||y||g)&&qd((()=>{_&&Oh(_,r,e),y&&m.enter(h),g&&xu(e,null,r,"mounted")}),a)},w=(e,t,s,n,i)=>{if(s&&d(e,s),n)for(let o=0;o<n.length;o++)d(e,n[o]);if(i){let s=i.subTree;if(t===s||ih(s.type)&&(s.ssContent===t||s.ssFallback===t)){const t=i.vnode;w(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},k=(e,t,s,n,i,o,r,a,c=0)=>{for(let l=c;l<e.length;l++){const c=e[l]=a?Ch(e[l]):Eh(e[l]);_(null,c,t,s,n,i,o,r,a)}},S=(e,t,s,i,o,r,a)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:d,dirs:h}=t;u|=16&e.patchFlag;const _=e.props||Ha,p=t.props||Ha;let f;if(s&&jd(s,!1),(f=p.onVnodeBeforeUpdate)&&Oh(f,s,t,e),h&&xu(t,e,s,"beforeUpdate"),s&&jd(s,!0),(_.innerHTML&&null==p.innerHTML||_.textContent&&null==p.textContent)&&c(l,""),d?E(e.dynamicChildren,d,l,s,i,Md(t,o),r):a||N(e,t,l,null,s,i,Md(t,o),r,!1),u>0){if(16&u)C(l,_,p,s,o);else if(2&u&&_.class!==p.class&&n(l,"class",null,p.class,o),4&u&&n(l,"style",_.style,p.style,o),8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const i=e[t],r=_[i],a=p[i];a===r&&"value"!==i||n(l,i,r,a,o,s)}}1&u&&e.children!==t.children&&c(l,t.children)}else a||null!=d||C(l,_,p,s,o);((f=p.onVnodeUpdated)||h)&&qd((()=>{f&&Oh(f,s,t,e),h&&xu(t,e,s,"updated")}),i)},E=(e,t,s,n,i,o,r)=>{for(let a=0;a<t.length;a++){const c=e[a],u=t[a],d=c.el&&(c.type===oh||!gh(c,u)||198&c.shapeFlag)?l(c.el):s;_(c,u,d,null,n,i,o,r,!0)}},C=(e,t,s,i,o)=>{if(t!==s){if(t!==Ha)for(const r in t)uc(r)||r in s||n(e,r,t[r],null,o,i);for(const r in s){if(uc(r))continue;const a=s[r],c=t[r];a!==c&&"value"!==r&&n(e,r,c,a,o,i)}"value"in s&&n(e,"value",t.value,s.value,o)}},x=(e,s,n,i,r,a,c,l,u)=>{const d=s.el=e?e.el:o(""),h=s.anchor=e?e.anchor:o("");let{patchFlag:_,dynamicChildren:p,slotScopeIds:f}=s;f&&(l=l?l.concat(f):f),null==e?(t(d,n,i),t(h,n,i),k(s.children||[],n,h,r,a,c,l,u)):_>0&&64&_&&p&&e.dynamicChildren?(E(e.dynamicChildren,p,n,r,a,c,l),(null!=s.key||r&&s===r.subTree)&&Dd(e,s,!0)):N(e,s,n,h,r,a,c,l,u)},O=(e,t,s,n,i,o,r,a,c)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?i.ctx.activate(t,s,n,r,c):I(t,s,n,i,o,r,c):T(e,t,c)},I=(e,t,s,n,i,o,r)=>{const a=e.component=function(e,t,s){const n=e.type,i=(t?t.appContext:e.appContext)||Ih,o={uid:Th++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Pc(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Id(n,i),emitsOptions:Jd(n,i),emit:null,emitted:null,propsDefaults:Ha,inheritAttrs:n.inheritAttrs,ctx:Ha,data:Ha,props:Ha,attrs:Ha,slots:Ha,refs:Ha,setupState:Ha,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};o.ctx={_:o},o.root=t?t.root:o,o.emit=Yd.bind(null,o),e.ce&&e.ce(o);return o}(e,n,i);if(Lu(e)&&(a.ctx.renderer=H),function(e,t=!1,s=!1){t&&$h(t);const{props:n,children:i}=e.vnode,o=qh(e);Ed(e,n,o,t),((e,t,s)=>{const n=e.slots=kd();if(32&e.vnode.shapeFlag){const e=t._;e?(Ld(n,t,s),s&&vc(n,"_",e,!0)):$d(t,n)}else t&&Pd(e,t)})(e,i,s||t);const r=o?function(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,sd);const{setup:n}=s;if(n){Zc();const s=e.setupContext=n.length>1?function(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,Dh),slots:e.slots,emit:e.emit,expose:t}}(e):null,i=Ph(e),o=ru(n,e,0,[e.props,s]),r=rc(o);if(Jc(),i(),!r&&!e.sp||Pu(e)||Au(e),r){if(o.then(Lh,Lh),t)return o.then((t=>{Mh(e,t)})).catch((t=>{cu(t,e,0)}));e.asyncDep=o}else Mh(e,o)}else jh(e)}(e,t):void 0;t&&$h(!1)}(a,!1,r),a.asyncDep){if(i&&i.registerDep(a,A,r),!e.el){const n=a.subTree=wh(ah);f(null,n,t,s),e.placeholder=n.el}}else A(a,e,t,s,i,o,r)},T=(e,t,s)=>{const n=t.component=e.component;if(function(e,t,s){const{props:n,children:i,component:o}=e,{props:r,children:a,patchFlag:c}=t,l=o.emitsOptions;if(t.dirs||t.transition)return!0;if(!(s&&c>=0))return!(!i&&!a||a&&a.$stable)||n!==r&&(n?!r||nh(n,r,l):!!r);if(1024&c)return!0;if(16&c)return n?nh(n,r,l):!!r;if(8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const s=e[t];if(r[s]!==n[s]&&!Xd(l,s))return!0}}return!1}(e,t,s)){if(n.asyncDep&&!n.asyncResolved)return void R(n,t,s);n.next=t,n.update()}else t.el=e.el,n.vnode=t},A=(e,t,s,n,i,o,r)=>{const a=()=>{if(e.isMounted){let{next:t,bu:s,u:n,parent:c,vnode:u}=e;{const s=Fd(e);if(s)return t&&(t.el=u.el,R(e,t,r)),void s.asyncDep.then((()=>{e.isUnmounted||a()}))}let d,h=t;jd(e,!1),t?(t.el=u.el,R(e,t,r)):t=u,s&&bc(s),(d=t.props&&t.props.onVnodeBeforeUpdate)&&Oh(d,c,t,u),jd(e,!0);const p=eh(e),f=e.subTree;e.subTree=p,_(f,p,l(f.el),F(f),e,i,o),t.el=p.el,null===h&&function({vnode:e,parent:t},s){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n!==e)break;(e=t.vnode).el=s,t=t.parent}}(e,p.el),n&&qd(n,i),(d=t.props&&t.props.onVnodeUpdated)&&qd((()=>Oh(d,c,t,u)),i)}else{let r;const{el:a,props:c}=t,{bm:l,m:u,parent:d,root:h,type:p}=e,f=Pu(t);jd(e,!1),l&&bc(l),!f&&(r=c&&c.onVnodeBeforeMount)&&Oh(r,d,t),jd(e,!0);{h.ce&&!1!==h.ce._def.shadowRoot&&h.ce._injectChildStyle(p);const r=e.subTree=eh(e);_(null,r,s,n,e,i,o),t.el=r.el}if(u&&qd(u,i),!f&&(r=c&&c.onVnodeMounted)){const e=t;qd((()=>Oh(r,d,e)),i)}(256&t.shapeFlag||d&&Pu(d.vnode)&&256&d.vnode.shapeFlag)&&e.a&&qd(e.a,i),e.isMounted=!0,t=s=n=null}};e.scope.on();const c=e.effect=new qc(a);e.scope.off();const u=e.update=c.run.bind(c),d=e.job=c.runIfDirty.bind(c);d.i=e,d.id=e.uid,c.scheduler=()=>gu(d),jd(e,!0),u()},R=(e,t,s)=>{t.component=e;const n=e.vnode.props;e.vnode=t,e.next=null,function(e,t,s,n){const{props:i,attrs:o,vnode:{patchFlag:r}}=e,a=Wl(i),[c]=e.propsOptions;let l=!1;if(!(n||r>0)||16&r){let n;Cd(e,t,i,o)&&(l=!0);for(const o in a)t&&(Xa(t,o)||(n=fc(o))!==o&&Xa(t,n))||(c?!s||void 0===s[o]&&void 0===s[n]||(i[o]=xd(c,a,o,void 0,e,!0)):delete i[o]);if(o!==a)for(const e in o)t&&Xa(t,e)||(delete o[e],l=!0)}else if(8&r){const s=e.vnode.dynamicProps;for(let n=0;n<s.length;n++){let r=s[n];if(Xd(e.emitsOptions,r))continue;const u=t[r];if(c)if(Xa(o,r))u!==o[r]&&(o[r]=u,l=!0);else{const t=_c(r);i[t]=xd(c,a,t,u,e,!1)}else u!==o[r]&&(o[r]=u,l=!0)}}l&&ll(e.attrs,"set","")}(e,t.props,n,s),((e,t,s)=>{const{vnode:n,slots:i}=e;let o=!0,r=Ha;if(32&n.shapeFlag){const e=t._;e?s&&1===e?o=!1:Ld(i,t,s):(o=!t.$stable,$d(t,i)),r=t}else t&&(Pd(e,t),r={default:1});if(o)for(const a in i)Ad(a)||null!=r[a]||delete i[a]})(e,t.children,s),Zc(),bu(e),Jc()},N=(e,t,s,n,i,o,r,a,l=!1)=>{const u=e&&e.children,d=e?e.shapeFlag:0,h=t.children,{patchFlag:_,shapeFlag:p}=t;if(_>0){if(128&_)return void P(u,h,s,n,i,o,r,a,l);if(256&_)return void $(u,h,s,n,i,o,r,a,l)}8&p?(16&d&&D(u,i,o),h!==u&&c(s,h)):16&d?16&p?P(u,h,s,n,i,o,r,a,l):D(u,i,o,!0):(8&d&&c(s,""),16&p&&k(h,s,n,i,o,r,a,l))},$=(e,t,s,n,i,o,r,a,c)=>{t=t||Qa;const l=(e=e||Qa).length,u=t.length,d=Math.min(l,u);let h;for(h=0;h<d;h++){const n=t[h]=c?Ch(t[h]):Eh(t[h]);_(e[h],n,s,null,i,o,r,a,c)}l>u?D(e,i,o,!0,!1,d):k(t,s,n,i,o,r,a,c,d)},P=(e,t,s,n,i,o,r,a,c)=>{let l=0;const u=t.length;let d=e.length-1,h=u-1;for(;l<=d&&l<=h;){const n=e[l],u=t[l]=c?Ch(t[l]):Eh(t[l]);if(!gh(n,u))break;_(n,u,s,null,i,o,r,a,c),l++}for(;l<=d&&l<=h;){const n=e[d],l=t[h]=c?Ch(t[h]):Eh(t[h]);if(!gh(n,l))break;_(n,l,s,null,i,o,r,a,c),d--,h--}if(l>d){if(l<=h){const e=h+1,d=e<u?t[e].el:n;for(;l<=h;)_(null,t[l]=c?Ch(t[l]):Eh(t[l]),s,d,i,o,r,a,c),l++}}else if(l>h)for(;l<=d;)q(e[l],i,o,!0),l++;else{const p=l,f=l,m=new Map;for(l=f;l<=h;l++){const e=t[l]=c?Ch(t[l]):Eh(t[l]);null!=e.key&&m.set(e.key,l)}let g,y=0;const b=h-f+1;let v=!1,w=0;const k=new Array(b);for(l=0;l<b;l++)k[l]=0;for(l=p;l<=d;l++){const n=e[l];if(y>=b){q(n,i,o,!0);continue}let u;if(null!=n.key)u=m.get(n.key);else for(g=f;g<=h;g++)if(0===k[g-f]&&gh(n,t[g])){u=g;break}void 0===u?q(n,i,o,!0):(k[u-f]=l+1,u>=w?w=u:v=!0,_(n,t[u],s,null,i,o,r,a,c),y++)}const S=v?function(e){const t=e.slice(),s=[0];let n,i,o,r,a;const c=e.length;for(n=0;n<c;n++){const c=e[n];if(0!==c){if(i=s[s.length-1],e[i]<c){t[n]=i,s.push(n);continue}for(o=0,r=s.length-1;o<r;)a=o+r>>1,e[s[a]]<c?o=a+1:r=a;c<e[s[o]]&&(o>0&&(t[n]=s[o-1]),s[o]=n)}}o=s.length,r=s[o-1];for(;o-- >0;)s[o]=r,r=t[r];return s}(k):Qa;for(g=S.length-1,l=b-1;l>=0;l--){const e=f+l,d=t[e],h=t[e+1],p=e+1<u?h.el||h.placeholder:n;0===k[l]?_(null,d,s,p,i,o,r,a,c):v&&(g<0||l!==S[g]?L(d,s,p,2):g--)}}},L=(e,n,i,o,r=null)=>{const{el:a,type:c,transition:l,children:u,shapeFlag:d}=e;if(6&d)return void L(e.component.subTree,n,i,o);if(128&d)return void e.suspense.move(n,i,o);if(64&d)return void c.move(e,n,i,H);if(c===oh){t(a,n,i);for(let e=0;e<u.length;e++)L(u[e],n,i,o);return void t(e.anchor,n,i)}if(c===ch)return void g(e,n,i);if(2!==o&&1&d&&l)if(0===o)l.beforeEnter(a),t(a,n,i),qd((()=>l.enter(a)),r);else{const{leave:o,delayLeave:r,afterLeave:c}=l,u=()=>{e.ctx.isUnmounted?s(a):t(a,n,i)},d=()=>{a._isLeaving&&a[Iu](!0),o(a,(()=>{u(),c&&c()}))};r?r(a,u,d):d()}else t(a,n,i)},q=(e,t,s,n=!1,i=!1)=>{const{type:o,props:r,ref:a,children:c,dynamicChildren:l,shapeFlag:u,patchFlag:d,dirs:h,cacheIndex:_}=e;if(-2===d&&(i=!1),null!=a&&(Zc(),Nu(a,null,s,e,!0),Jc()),null!=_&&(t.renderCache[_]=void 0),256&u)return void t.ctx.deactivate(e);const p=1&u&&h,f=!Pu(e);let m;if(f&&(m=r&&r.onVnodeBeforeUnmount)&&Oh(m,t,e),6&u)j(e.component,s,n);else{if(128&u)return void e.suspense.unmount(s,n);p&&xu(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,s,H,n):l&&!l.hasOnce&&(o!==oh||d>0&&64&d)?D(l,t,s,!1,!0):(o===oh&&384&d||!i&&16&u)&&D(c,t,s),n&&U(e)}(f&&(m=r&&r.onVnodeUnmounted)||p)&&qd((()=>{m&&Oh(m,t,e),p&&xu(e,null,t,"unmounted")}),s)},U=e=>{const{type:t,el:n,anchor:i,transition:o}=e;if(t===oh)return void M(n,i);if(t===ch)return void y(e);const r=()=>{s(n),o&&!o.persisted&&o.afterLeave&&o.afterLeave()};if(1&e.shapeFlag&&o&&!o.persisted){const{leave:t,delayLeave:s}=o,i=()=>t(n,r);s?s(e.el,r,i):i()}else r()},M=(e,t)=>{let n;for(;e!==t;)n=u(e),s(e),e=n;s(t)},j=(e,t,s)=>{const{bum:n,scope:i,job:o,subTree:r,um:a,m:c,a:l}=e;Bd(c),Bd(l),n&&bc(n),i.stop(),o&&(o.flags|=8,q(r,e,t,s)),a&&qd(a,t),qd((()=>{e.isUnmounted=!0}),t)},D=(e,t,s,n=!1,i=!1,o=0)=>{for(let r=o;r<e.length;r++)q(e[r],t,s,n,i)},F=e=>{if(6&e.shapeFlag)return F(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=u(e.anchor||e.el),s=t&&t[Ou];return s?u(s):t};let B=!1;const z=(e,t,s)=>{null==e?t._vnode&&q(t._vnode,null,null,!0):_(t._vnode||null,e,t,null,null,null,s),t._vnode=e,B||(B=!0,bu(),vu(),B=!1)},H={p:_,um:q,m:L,r:U,mt:I,mc:k,pc:N,pbc:E,n:F,o:e};let Q;return{render:z,hydrate:Q,createApp:yd(z)}}(e)}function Md({type:e,props:t},s){return"svg"===s&&"foreignObject"===e||"mathml"===s&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function jd({effect:e,job:t},s){s?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Dd(e,t,s=!1){const n=e.children,i=t.children;if(ec(n)&&ec(i))for(let o=0;o<n.length;o++){const e=n[o];let t=i[o];1&t.shapeFlag&&!t.dynamicChildren&&((t.patchFlag<=0||32===t.patchFlag)&&(t=i[o]=Ch(i[o]),t.el=e.el),s||-2===t.patchFlag||Dd(e,t)),t.type===rh&&-1!==t.patchFlag&&(t.el=e.el),t.type!==ah||t.el||(t.el=e.el)}}function Fd(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:Fd(t)}function Bd(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const zd=Symbol.for("v-scx"),Hd=()=>vd(zd);function Qd(e,t,s){return Vd(e,t,s)}function Vd(e,t,s=Ha){const{immediate:n,deep:i,flush:o,once:r}=s,a=Ya({},s),c=t&&n||!t&&"post"!==o;let l;if(Uh)if("sync"===o){const e=Hd();l=e.__watcherHandles||(e.__watcherHandles=[])}else if(!c){const e=()=>{};return e.stop=Va,e.resume=Va,e.pause=Va,e}const u=Ah;a.call=(e,t,s)=>au(e,u,t,s);let d=!1;"post"===o?a.scheduler=e=>{qd(e,u&&u.suspense)}:"sync"!==o&&(d=!0,a.scheduler=(e,t)=>{t?e():gu(e)}),a.augmentJob=e=>{t&&(e.flags|=4),d&&(e.flags|=2,u&&(e.id=u.uid,e.i=u))};const h=iu(e,t,a);return Uh&&(l?l.push(h):c&&h()),h}function Gd(e,t,s){const n=this.proxy,i=nc(e)?e.includes(".")?Wd(n,e):()=>n[e]:e.bind(n,n);let o;sc(t)?o=t:(o=t.handler,s=t);const r=Ph(this),a=Vd(i,o.bind(n),s);return r(),a}function Wd(e,t){const s=t.split(".");return()=>{let t=e;for(let e=0;e<s.length&&t;e++)t=t[s[e]];return t}}const Kd=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${_c(t)}Modifiers`]||e[`${fc(t)}Modifiers`];function Yd(e,t,...s){if(e.isUnmounted)return;const n=e.vnode.props||Ha;let i=s;const o=t.startsWith("update:"),r=o&&Kd(n,t.slice(7));let a;r&&(r.trim&&(i=s.map((e=>nc(e)?e.trim():e))),r.number&&(i=s.map(wc)));let c=n[a=gc(t)]||n[a=gc(_c(t))];!c&&o&&(c=n[a=gc(fc(t))]),c&&au(c,e,6,i);const l=n[a+"Once"];if(l){if(e.emitted){if(e.emitted[a])return}else e.emitted={};e.emitted[a]=!0,au(l,e,6,i)}}const Zd=new WeakMap;function Jd(e,t,s=!1){const n=s?Zd:t.emitsCache,i=n.get(e);if(void 0!==i)return i;const o=e.emits;let r={},a=!1;if(!sc(e)){const n=e=>{const s=Jd(e,t,!0);s&&(a=!0,Ya(r,s))};!s&&t.mixins.length&&t.mixins.forEach(n),e.extends&&n(e.extends),e.mixins&&e.mixins.forEach(n)}return o||a?(ec(o)?o.forEach((e=>r[e]=null)):Ya(r,o),oc(e)&&n.set(e,r),r):(oc(e)&&n.set(e,null),null)}function Xd(e,t){return!(!e||!Wa(t))&&(t=t.slice(2).replace(/Once$/,""),Xa(e,t[0].toLowerCase()+t.slice(1))||Xa(e,fc(t))||Xa(e,t))}function eh(e){const{type:t,vnode:s,proxy:n,withProxy:i,propsOptions:[o],slots:r,attrs:a,emit:c,render:l,renderCache:u,props:d,data:h,setupState:_,ctx:p,inheritAttrs:f}=e,m=Cu(e);let g,y;try{if(4&s.shapeFlag){const e=i||n,t=e;g=Eh(l.call(t,e,u,d,_,h,p)),y=a}else{const e=t;0,g=Eh(e.length>1?e(d,{attrs:a,slots:r,emit:c}):e(d,null)),y=t.props?a:th(a)}}catch(v){lh.length=0,cu(v,e,1),g=wh(ah)}let b=g;if(y&&!1!==f){const e=Object.keys(y),{shapeFlag:t}=b;e.length&&7&t&&(o&&e.some(Ka)&&(y=sh(y,o)),b=kh(b,y,!1,!0))}return s.dirs&&(b=kh(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&Tu(b,s.transition),g=b,Cu(m),g}const th=e=>{let t;for(const s in e)("class"===s||"style"===s||Wa(s))&&((t||(t={}))[s]=e[s]);return t},sh=(e,t)=>{const s={};for(const n in e)Ka(n)&&n.slice(9)in t||(s[n]=e[n]);return s};function nh(e,t,s){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const o=n[i];if(t[o]!==e[o]&&!Xd(s,o))return!0}return!1}const ih=e=>e.__isSuspense;const oh=Symbol.for("v-fgt"),rh=Symbol.for("v-txt"),ah=Symbol.for("v-cmt"),ch=Symbol.for("v-stc"),lh=[];let uh=null;function dh(e=!1){lh.push(uh=e?null:[])}let hh=1;function _h(e,t=!1){hh+=e,e<0&&uh&&t&&(uh.hasOnce=!0)}function ph(e){return e.dynamicChildren=hh>0?uh||Qa:null,lh.pop(),uh=lh[lh.length-1]||null,hh>0&&uh&&uh.push(e),e}function fh(e,t,s,n,i,o){return ph(vh(e,t,s,n,i,o,!0))}function mh(e){return!!e&&!0===e.__v_isVNode}function gh(e,t){return e.type===t.type&&e.key===t.key}const yh=({key:e})=>null!=e?e:null,bh=({ref:e,ref_key:t,ref_for:s})=>("number"==typeof e&&(e=""+e),null!=e?nc(e)||Zl(e)||sc(e)?{i:Su,r:e,k:t,f:!!s}:e:null);function vh(e,t=null,s=null,n=0,i=null,o=(e===oh?0:1),r=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&yh(t),ref:t&&bh(t),scopeId:Eu,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Su};return a?(xh(c,s),128&o&&e.normalize(c)):s&&(c.shapeFlag|=nc(s)?8:16),hh>0&&!r&&uh&&(c.patchFlag>0||6&o)&&32!==c.patchFlag&&uh.push(c),c}const wh=function(e,t=null,s=null,n=0,i=null,o=!1){e&&e!==Ju||(e=ah);if(mh(e)){const n=kh(e,t,!0);return s&&xh(n,s),hh>0&&!o&&uh&&(6&n.shapeFlag?uh[uh.indexOf(e)]=n:uh.push(n)),n.patchFlag=-2,n}r=e,sc(r)&&"__vccOpts"in r&&(e=e.__vccOpts);var r;if(t){t=function(e){return e?Gl(e)||Sd(e)?Ya({},e):e:null}(t);let{class:e,style:s}=t;e&&!nc(e)&&(t.class=Tc(e)),oc(s)&&(Gl(s)&&!ec(s)&&(s=Ya({},s)),t.style=Ec(s))}const a=nc(e)?1:ih(e)?128:(e=>e.__isTeleport)(e)?64:oc(e)?4:sc(e)?2:0;return vh(e,t,s,n,i,a,o,!0)};function kh(e,t,s=!1,n=!1){const{props:i,ref:o,patchFlag:r,children:a,transition:c}=e,l=t?function(...e){const t={};for(let s=0;s<e.length;s++){const n=e[s];for(const e in n)if("class"===e)t.class!==n.class&&(t.class=Tc([t.class,n.class]));else if("style"===e)t.style=Ec([t.style,n.style]);else if(Wa(e)){const s=t[e],i=n[e];!i||s===i||ec(s)&&s.includes(i)||(t[e]=s?[].concat(s,i):i)}else""!==e&&(t[e]=n[e])}return t}(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&yh(l),ref:t&&t.ref?s&&o?ec(o)?o.concat(bh(t)):[o,bh(t)]:bh(t):o,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==oh?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:c,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&kh(e.ssContent),ssFallback:e.ssFallback&&kh(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return c&&n&&Tu(u,c.clone(u)),u}function Sh(e=" ",t=0){return wh(rh,null,e,t)}function Eh(e){return null==e||"boolean"==typeof e?wh(ah):ec(e)?wh(oh,null,e.slice()):mh(e)?Ch(e):wh(rh,null,String(e))}function Ch(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:kh(e)}function xh(e,t){let s=0;const{shapeFlag:n}=e;if(null==t)t=null;else if(ec(t))s=16;else if("object"==typeof t){if(65&n){const s=t.default;return void(s&&(s._c&&(s._d=!1),xh(e,s()),s._c&&(s._d=!0)))}{s=32;const n=t._;n||Sd(t)?3===n&&Su&&(1===Su.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=Su}}else sc(t)?(t={default:t,_ctx:Su},s=32):(t=String(t),64&n?(s=16,t=[Sh(t)]):s=8);e.children=t,e.shapeFlag|=s}function Oh(e,t,s,n=null){au(e,t,7,[s,n])}const Ih=md();let Th=0;let Ah=null;const Rh=()=>Ah||Su;let Nh,$h;{const e=Sc(),t=(t,s)=>{let n;return(n=e[t])||(n=e[t]=[]),n.push(s),e=>{n.length>1?n.forEach((t=>t(e))):n[0](e)}};Nh=t("__VUE_INSTANCE_SETTERS__",(e=>Ah=e)),$h=t("__VUE_SSR_SETTERS__",(e=>Uh=e))}const Ph=e=>{const t=Ah;return Nh(e),e.scope.on(),()=>{e.scope.off(),Nh(t)}},Lh=()=>{Ah&&Ah.scope.off(),Nh(null)};function qh(e){return 4&e.vnode.shapeFlag}let Uh=!1;function Mh(e,t,s){sc(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:oc(t)&&(e.setupState=Xl(t)),jh(e)}function jh(e,t,s){const n=e.type;e.render||(e.render=n.render||Va);{const t=Ph(e);Zc();try{od(e)}finally{Jc(),t()}}}const Dh={get:(e,t)=>(cl(e,0,""),e[t])};function Fh(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(Xl((t=e.exposed,!Xa(t,"__v_skip")&&Object.isExtensible(t)&&vc(t,"__v_skip",!0),t)),{get:(t,s)=>s in t?t[s]:s in ed?ed[s](e):void 0,has:(e,t)=>t in e||t in ed})):e.proxy;var t}const Bh=(e,t)=>{const s=function(e,t,s=!1){let n,i;return sc(e)?n=e:(n=e.get,i=e.set),new eu(n,i,s)}(e,0,Uh);return s},zh="3.5.22";
/**
  * @vue/runtime-dom v3.5.22
  * (c) 2018-present Yuxi (Evan) You and Vue contributors
  * @license MIT
  **/
let Hh;const Qh="undefined"!=typeof window&&window.trustedTypes;if(Qh)try{Hh=Qh.createPolicy("vue",{createHTML:e=>e})}catch(X_){}const Vh=Hh?e=>Hh.createHTML(e):e=>e,Gh="undefined"!=typeof document?document:null,Wh=Gh&&Gh.createElement("template"),Kh={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,n)=>{const i="svg"===t?Gh.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?Gh.createElementNS("http://www.w3.org/1998/Math/MathML",e):s?Gh.createElement(e,{is:s}):Gh.createElement(e);return"select"===e&&n&&null!=n.multiple&&i.setAttribute("multiple",n.multiple),i},createText:e=>Gh.createTextNode(e),createComment:e=>Gh.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Gh.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,n,i,o){const r=s?s.previousSibling:t.lastChild;if(i&&(i===o||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),s),i!==o&&(i=i.nextSibling););else{Wh.innerHTML=Vh("svg"===n?`<svg>${e}</svg>`:"mathml"===n?`<math>${e}</math>`:e);const i=Wh.content;if("svg"===n||"mathml"===n){const e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,s)}return[r?r.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},Yh=Symbol("_vtc");const Zh=Symbol("_vod"),Jh=Symbol("_vsh"),Xh=Symbol(""),e_=/(?:^|;)\s*display\s*:/;const t_=/\s*!important$/;function s_(e,t,s){if(ec(s))s.forEach((s=>s_(e,t,s)));else if(null==s&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const n=function(e,t){const s=i_[t];if(s)return s;let n=_c(t);if("filter"!==n&&n in e)return i_[t]=n;n=mc(n);for(let i=0;i<n_.length;i++){const s=n_[i]+n;if(s in e)return i_[t]=s}return t}(e,t);t_.test(s)?e.setProperty(fc(n),s.replace(t_,""),"important"):e[n]=s}}const n_=["Webkit","Moz","ms"],i_={};const o_="http://www.w3.org/1999/xlink";function r_(e,t,s,n,i,o=Ac(t)){n&&t.startsWith("xlink:")?null==s?e.removeAttributeNS(o_,t.slice(6,t.length)):e.setAttributeNS(o_,t,s):null==s||o&&!Rc(s)?e.removeAttribute(t):e.setAttribute(t,o?"":ic(s)?String(s):s)}function a_(e,t,s,n,i){if("innerHTML"===t||"textContent"===t)return void(null!=s&&(e[t]="innerHTML"===t?Vh(s):s));const o=e.tagName;if("value"===t&&"PROGRESS"!==o&&!o.includes("-")){const n="OPTION"===o?e.getAttribute("value")||"":e.value,i=null==s?"checkbox"===e.type?"on":"":String(s);return n===i&&"_value"in e||(e.value=i),null==s&&e.removeAttribute(t),void(e._value=s)}let r=!1;if(""===s||null==s){const n=typeof e[t];"boolean"===n?s=Rc(s):null==s&&"string"===n?(s="",r=!0):"number"===n&&(s=0,r=!0)}try{e[t]=s}catch(X_){}r&&e.removeAttribute(i||t)}const c_=Symbol("_vei");function l_(e,t,s,n,i=null){const o=e[c_]||(e[c_]={}),r=o[t];if(n&&r)r.value=n;else{const[s,a]=function(e){let t;if(u_.test(e)){let s;for(t={};s=e.match(u_);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}const s=":"===e[2]?e.slice(3):fc(e.slice(2));return[s,t]}(t);if(n){const r=o[t]=function(e,t){const s=e=>{if(e._vts){if(e._vts<=s.attached)return}else e._vts=Date.now();au(function(e,t){if(ec(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,s.value),t,5,[e])};return s.value=e,s.attached=__(),s}(n,i);!function(e,t,s,n){e.addEventListener(t,s,n)}(e,s,r,a)}else r&&(!function(e,t,s,n){e.removeEventListener(t,s,n)}(e,s,r,a),o[t]=void 0)}}const u_=/(?:Once|Passive|Capture)$/;let d_=0;const h_=Promise.resolve(),__=()=>d_||(h_.then((()=>d_=0)),d_=Date.now());const p_=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;const f_=Ya({patchProp:(e,t,s,n,i,o)=>{const r="svg"===i;"class"===t?function(e,t,s){const n=e[Yh];n&&(t=(t?[t,...n]:[...n]).join(" ")),null==t?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}(e,n,r):"style"===t?function(e,t,s){const n=e.style,i=nc(s);let o=!1;if(s&&!i){if(t)if(nc(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==s[t]&&s_(n,t,"")}else for(const e in t)null==s[e]&&s_(n,e,"");for(const e in s)"display"===e&&(o=!0),s_(n,e,s[e])}else if(i){if(t!==s){const e=n[Xh];e&&(s+=";"+e),n.cssText=s,o=e_.test(s)}}else t&&e.removeAttribute("style");Zh in e&&(e[Zh]=o?n.display:"",e[Jh]&&(n.display="none"))}(e,s,n):Wa(t)?Ka(t)||l_(e,t,0,n,o):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,s,n){if(n)return"innerHTML"===t||"textContent"===t||!!(t in e&&p_(t)&&sc(s));if("spellcheck"===t||"draggable"===t||"translate"===t||"autocorrect"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}if(p_(t)&&nc(s))return!1;return t in e}(e,t,n,r))?(a_(e,t,n),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||r_(e,t,n,r,0,"value"!==t)):!e._isVueCE||!/[A-Z]/.test(t)&&nc(n)?("true-value"===t?e._trueValue=n:"false-value"===t&&(e._falseValue=n),r_(e,t,n,r)):a_(e,_c(t),n,0,t)}},Kh);let m_;const g_=(...e)=>{const t=(m_||(m_=Ud(f_))).createApp(...e),{mount:s}=t;return t.mount=e=>{const n=function(e){if(nc(e)){return document.querySelector(e)}return e}(e);if(!n)return;const i=t._component;sc(i)||i.render||i.template||(i.template=n.innerHTML),1===n.nodeType&&(n.textContent="");const o=s(n,!1,function(e){if(e instanceof SVGElement)return"svg";if("function"==typeof MathMLElement&&e instanceof MathMLElement)return"mathml"}(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},t};const y_=(e,t)=>{const s=e.__vccOpts||e;for(const[n,i]of t)s[n]=i;return s},b_={class:"miso-placeholder"},v_=y_({__name:"MyAnswers",props:{actionHooks:{type:Object,required:!0}},setup(e){const t=e,s=()=>{t.actionHooks.onAsk("keyword")},n=()=>{t.actionHooks.onSearch("keyword")},i=()=>{t.actionHooks.onSelectHistoryQuestion("questionId")},o=()=>{t.actionHooks.onAskTheBook("productId")};return(e,t)=>(dh(),fh("div",b_,[t[0]||(t[0]=vh("div",{class:"miso-placeholder__title"},"Miso Placeholder (My Answers)",-1)),vh("button",{class:"miso-placeholder__button",onClick:s},"onAsk"),vh("button",{class:"miso-placeholder__button",onClick:n},"onSearch"),vh("button",{class:"miso-placeholder__button",onClick:i}," onSelectHistoryQuestion "),vh("button",{class:"miso-placeholder__button",onClick:o},"onAskTheBook")]))}},[["__scopeId","data-v-96a45b61"]]),w_="miso-my-answers",k_="miso-search-bar",S_={class:"miso-placeholder"},E_=y_({__name:"MiniAnswerSummary",props:{actionHooks:{type:Object,required:!0}},setup(e){const t=e,s=()=>{t.actionHooks.onAsk("keyword")},n=()=>{t.actionHooks.onSearch("keyword")},i=()=>{t.actionHooks.onSelectHistoryQuestion("questionId")},o=()=>{t.actionHooks.onAskTheBook("productId")};return(e,t)=>(dh(),fh("div",S_,[t[0]||(t[0]=vh("div",{class:"miso-placeholder__title"},"Miso Placeholder (Mini Answer Summary)",-1)),vh("button",{class:"miso-placeholder__button",onClick:s},"onAsk"),vh("button",{class:"miso-placeholder__button",onClick:n},"onSearch"),vh("button",{class:"miso-placeholder__button",onClick:i}," onSelectHistoryQuestion "),vh("button",{class:"miso-placeholder__button",onClick:o},"onAskTheBook")]))}},[["__scopeId","data-v-ce19f90d"]]),C_={class:"miso-placeholder"},x_=y_({__name:"MiniAnswerInteraction",props:{actionHooks:{type:Object,required:!0}},setup(e){const t=e,s=()=>{t.actionHooks.onAsk("keyword")},n=()=>{t.actionHooks.onSearch("keyword")},i=()=>{t.actionHooks.onSelectHistoryQuestion("questionId")},o=()=>{t.actionHooks.onAskTheBook("productId")};return(e,t)=>(dh(),fh("div",C_,[t[0]||(t[0]=vh("div",{class:"miso-placeholder__title"},"Miso Placeholder (Mini Answer Interaction)",-1)),vh("button",{class:"miso-placeholder__button",onClick:s},"onAsk"),vh("button",{class:"miso-placeholder__button",onClick:n},"onSearch"),vh("button",{class:"miso-placeholder__button",onClick:i}," onSelectHistoryQuestion "),vh("button",{class:"miso-placeholder__button",onClick:o},"onAskTheBook")]))}},[["__scopeId","data-v-b811650e"]]),O_="miso-mini-answer__interaction",I_=({setAttribute:e},{source:t={}})=>{t.url&&e("href",t.url)},T_=({parentQuestionId:e})=>`\n<miso-ask class="mfa-card mfa-related-questions-container" visible-when="initial+nonempty" logo="false" parent-question-id="${e}">\n  <div class="mfa-card__header">Related questions you can explore</div>\n  <miso-query-suggestions></miso-query-suggestions>\n</miso-ask>\n  `,A_=({parentQuestionId:e})=>`\n<miso-ask class="mfa-ask-input" visible-when="initial" logo="false" parent-question-id="${e}">\n  <miso-query></miso-query>\n</miso-ask>\n  `,R_=({parentQuestionId:e})=>`\n<miso-ask class="mfa-answer miso-circled-citation-index" visible-when="ready" logo="false" parent-question-id="${e}">\n  <hr class="mfa-answer-divider">\n  <div class="mfa-followup-title">\n    <span class="mfa-followup-title__label">Follow-up question:</span>\n    <span class="mfa-followup-title__question">\n      <miso-question></miso-question>\n    </span>\n  </div>\n  <miso-answer></miso-answer>\n</miso-ask>\n  `,N_=({parentQuestionId:e})=>`\n<miso-ask class="mfa-source miso-circled-citation-index" visible-when="nonempty" logo="false" parent-question-id="${e}">\n  <div class="mfa-card">\n    <div class="mfa-card__header">Sources from My Bookshelf</div>\n    <miso-sources></miso-sources>\n  </div>\n</miso-ask>\n  `,$_=(e,t,s,n)=>{const{templates:{indexBlock:i,helpers:{tagPair:o,formatDate:r}}}=e,{title:a,published_at:c,created_at:l,updated_at:u,snippet:d}=s,[h,_]=o(e,s),p=c||l||u;return`\n${h}\n  <div class="mfa-source-item__main-block">\n    <div class="mfa-source-item__title">${a}</div>\n    ${p?`<div class="mfa-source-item__date">${r(p)}</div>`:""}\n    <div class="mfa-source-item__snippet">${d}</div>\n    <div class="mfa-source-item__actions">\n      \n<svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.9845 2.498C12.0529 2.498 12.919 1.63188 12.919 0.563477H13.8118C13.8118 1.63188 14.6779 2.498 15.7464 2.498V3.39086C14.6779 3.39086 13.8118 4.25698 13.8118 5.32538H12.919C12.919 4.25698 12.0529 3.39086 10.9845 3.39086V2.498ZM0.666992 7.70633C3.29692 7.70633 5.4289 5.57436 5.4289 2.94443H7.0162C7.0162 5.57436 9.14818 7.70633 11.7781 7.70633V9.29364C9.14818 9.29364 7.0162 11.4256 7.0162 14.0555H5.4289C5.4289 11.4256 3.29692 9.29364 0.666992 9.29364V7.70633ZM3.74319 8.49998C4.78379 9.07745 5.64511 9.93871 6.22255 10.9793C6.79998 9.93871 7.6613 9.07745 8.70191 8.49998C7.6613 7.92252 6.79998 7.06125 6.22255 6.02063C5.64511 7.06125 4.78379 7.92252 3.74319 8.49998ZM13.5638 10.0873C13.5638 11.5118 12.409 12.6667 10.9845 12.6667V13.8571C12.409 13.8571 13.5638 15.012 13.5638 16.4365H14.7543C14.7543 15.012 15.9091 13.8571 17.3337 13.8571V12.6667C15.9091 12.6667 14.7543 11.5118 14.7543 10.0873H13.5638Z" fill="currentColor"/>\n</svg>\n   Ask this book anything\n    </div>\n  </div>\n  ${i(e,s,n)}\n${_}\n  `},P_=(e,{text:t})=>`\n<li class="mfa-question-option" data-role="option" tabindex="0">\n  \n<svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.9845 2.498C12.0529 2.498 12.919 1.63188 12.919 0.563477H13.8118C13.8118 1.63188 14.6779 2.498 15.7464 2.498V3.39086C14.6779 3.39086 13.8118 4.25698 13.8118 5.32538H12.919C12.919 4.25698 12.0529 3.39086 10.9845 3.39086V2.498ZM0.666992 7.70633C3.29692 7.70633 5.4289 5.57436 5.4289 2.94443H7.0162C7.0162 5.57436 9.14818 7.70633 11.7781 7.70633V9.29364C9.14818 9.29364 7.0162 11.4256 7.0162 14.0555H5.4289C5.4289 11.4256 3.29692 9.29364 0.666992 9.29364V7.70633ZM3.74319 8.49998C4.78379 9.07745 5.64511 9.93871 6.22255 10.9793C6.79998 9.93871 7.6613 9.07745 8.70191 8.49998C7.6613 7.92252 6.79998 7.06125 6.22255 6.02063C5.64511 7.06125 4.78379 7.92252 3.74319 8.49998ZM13.5638 10.0873C13.5638 11.5118 12.409 12.6667 10.9845 12.6667V13.8571C12.409 13.8571 13.5638 15.012 13.5638 16.4365H14.7543C14.7543 15.012 15.9091 13.8571 17.3337 13.8571V12.6667C15.9091 12.6667 14.7543 11.5118 14.7543 10.0873H13.5638Z" fill="currentColor"/>\n</svg>\n  \n  <span class="mfa-question-option__text">${t}</span>\n</li>\n  `,L_=(e,t)=>{const s=(e=>e&&Array.isArray(e)&&e.length>0?e.join(" | "):null)(t);return s?`\n  <div class="mfa-related-resource__array-data-group">\n    <div class="mfa-related-resource__array-data-label">${e}:</div>\n    <div class="mfa-related-resource__array-data-value">${s}</div>\n  </div>\n  `:""},q_=(e,t,s)=>{const{templates:{helpers:{tagPair:n}}}=e,{title:i,authors:o,tags:r,snippet:a}=s,[c,l]=n(e,s);return`\n<div class="mfa-card mfa-related-resource">\n  ${c}\n    <div class="mfa-related-resource__main-block">\n      <div class="mfa-related-resource__tags">\n        <span class="mfa-related-resource__tag mfa-related-resource__tag--ebook">ebook</span>\n      </div>\n      <div class="mfa-related-resource__title">${i}</div>\n      ${L_("author",o)}\n      ${L_("topic",r)}\n      <div class="mfa-related-resource__snippet">\n        \n<svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.9845 2.498C12.0529 2.498 12.919 1.63188 12.919 0.563477H13.8118C13.8118 1.63188 14.6779 2.498 15.7464 2.498V3.39086C14.6779 3.39086 13.8118 4.25698 13.8118 5.32538H12.919C12.919 4.25698 12.0529 3.39086 10.9845 3.39086V2.498ZM0.666992 7.70633C3.29692 7.70633 5.4289 5.57436 5.4289 2.94443H7.0162C7.0162 5.57436 9.14818 7.70633 11.7781 7.70633V9.29364C9.14818 9.29364 7.0162 11.4256 7.0162 14.0555H5.4289C5.4289 11.4256 3.29692 9.29364 0.666992 9.29364V7.70633ZM3.74319 8.49998C4.78379 9.07745 5.64511 9.93871 6.22255 10.9793C6.79998 9.93871 7.6613 9.07745 8.70191 8.49998C7.6613 7.92252 6.79998 7.06125 6.22255 6.02063C5.64511 7.06125 4.78379 7.92252 3.74319 8.49998ZM13.5638 10.0873C13.5638 11.5118 12.409 12.6667 10.9845 12.6667V13.8571C12.409 13.8571 13.5638 15.012 13.5638 16.4365H14.7543C14.7543 15.012 15.9091 13.8571 17.3337 13.8571V12.6667C15.9091 12.6667 14.7543 11.5118 14.7543 10.0873H13.5638Z" fill="currentColor"/>\n</svg>\n  \n        <div>${a}</div>\n      </div>\n    </div>\n  ${l}\n  <div class="mfa-related-resource__actions">\n    <div class="mfa-related-resource__action">\n      \n<svg width="18" height="19" viewBox="0 0 18 19" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M2.33366 12.3333V2.33329H0.666992V0.666626H3.16699C3.38801 0.666626 3.59997 0.754423 3.75625 0.910704C3.91253 1.06698 4.00033 1.27895 4.00033 1.49996V11.5H14.3653L16.032 4.83329H5.66699V3.16663H17.1003C17.227 3.16663 17.352 3.19551 17.4658 3.25107C17.5797 3.30664 17.6793 3.38742 17.7573 3.48728C17.8352 3.58714 17.8893 3.70346 17.9156 3.82738C17.9418 3.95131 17.9394 4.07958 17.9087 4.20246L15.8253 12.5358C15.7802 12.716 15.6761 12.876 15.5297 12.9902C15.3832 13.1045 15.2028 13.1666 15.017 13.1666H3.16699C2.94598 13.1666 2.73402 13.0788 2.57774 12.9225C2.42146 12.7663 2.33366 12.5543 2.33366 12.3333ZM4.00033 18.1666C3.5583 18.1666 3.13437 17.991 2.82181 17.6785C2.50925 17.3659 2.33366 16.942 2.33366 16.5C2.33366 16.0579 2.50925 15.634 2.82181 15.3214C3.13437 15.0089 3.5583 14.8333 4.00033 14.8333C4.44235 14.8333 4.86628 15.0089 5.17884 15.3214C5.4914 15.634 5.66699 16.0579 5.66699 16.5C5.66699 16.942 5.4914 17.3659 5.17884 17.6785C4.86628 17.991 4.44235 18.1666 4.00033 18.1666ZM14.0003 18.1666C13.5583 18.1666 13.1344 17.991 12.8218 17.6785C12.5093 17.3659 12.3337 16.942 12.3337 16.5C12.3337 16.0579 12.5093 15.634 12.8218 15.3214C13.1344 15.0089 13.5583 14.8333 14.0003 14.8333C14.4424 14.8333 14.8663 15.0089 15.1788 15.3214C15.4914 15.634 15.667 16.0579 15.667 16.5C15.667 16.942 15.4914 17.3659 15.1788 17.6785C14.8663 17.991 14.4424 18.1666 14.0003 18.1666Z" fill="#001129"/>\n</svg>\n    \n      <span>Buy this Book</span>\n    </div>\n    <div class="mfa-related-resource__action">\n      \n<svg width="20" height="16" viewBox="0 0 20 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.0002 0.5C14.4935 0.5 18.2319 3.73333 19.016 8C18.2327 12.2667 14.4935 15.5 10.0002 15.5C5.50687 15.5 1.76854 12.2667 0.984375 8C1.76771 3.73333 5.50687 0.5 10.0002 0.5ZM10.0002 13.8333C11.6998 13.833 13.3489 13.2557 14.6776 12.196C16.0063 11.1363 16.936 9.65689 17.3144 8C16.9346 6.34442 16.0043 4.86667 14.6757 3.80835C13.3471 2.75004 11.6988 2.17377 10.0002 2.17377C8.30162 2.17377 6.65328 2.75004 5.32469 3.80835C3.99609 4.86667 3.06585 6.34442 2.68604 8C3.06446 9.65689 3.9941 11.1363 5.32283 12.196C6.65155 13.2557 8.30065 13.833 10.0002 13.8333ZM10.0002 11.75C9.00565 11.75 8.05182 11.3549 7.34856 10.6516C6.6453 9.94839 6.25021 8.99456 6.25021 8C6.25021 7.00544 6.6453 6.05161 7.34856 5.34835C8.05182 4.64509 9.00565 4.25 10.0002 4.25C10.9948 4.25 11.9486 4.64509 12.6519 5.34835C13.3551 6.05161 13.7502 7.00544 13.7502 8C13.7502 8.99456 13.3551 9.94839 12.6519 10.6516C11.9486 11.3549 10.9948 11.75 10.0002 11.75ZM10.0002 10.0833C10.5527 10.0833 11.0826 9.86384 11.4733 9.47314C11.864 9.08244 12.0835 8.55253 12.0835 8C12.0835 7.44747 11.864 6.91756 11.4733 6.52686C11.0826 6.13616 10.5527 5.91667 10.0002 5.91667C9.44767 5.91667 8.91777 6.13616 8.52707 6.52686C8.13637 6.91756 7.91687 7.44747 7.91687 8C7.91687 8.55253 8.13637 9.08244 8.52707 9.47314C8.91777 9.86384 9.44767 10.0833 10.0002 10.0833Z" fill="#001129"/>\n</svg>\n    \n      <span>See Free Chapter</span>\n    </div>\n    <div class="mfa-related-resource__action">\n      \n<svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M9.00116 1.77415C10.9587 0.0166499 13.9837 0.0749834 15.8695 1.96415C17.7545 3.85415 17.8195 6.86415 16.0662 8.82748L8.9995 15.9042L1.9345 8.82748C0.181164 6.86415 0.246997 3.84915 2.13116 1.96415C4.01866 0.0774834 7.03783 0.0141499 9.00116 1.77415ZM14.6895 3.14165C13.4395 1.88998 11.4228 1.83915 10.1145 3.01415L9.002 4.01248L7.88866 3.01498C6.57616 1.83832 4.56366 1.88998 3.31033 3.14332C2.06866 4.38498 2.00616 6.37248 3.15033 7.68582L9.00033 13.545L14.8503 7.68665C15.9953 6.37248 15.9328 4.38748 14.6895 3.14165Z" fill="#001129"/>\n</svg>\n    \n      <span>Add to Wishlist</span>\n    </div>\n  </div>\n</div>\n  `},U_=(e,t,{text:s})=>`\n<div class="mfa-question-option" data-role="option" tabindex="0">\n  \n<svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.9845 2.498C12.0529 2.498 12.919 1.63188 12.919 0.563477H13.8118C13.8118 1.63188 14.6779 2.498 15.7464 2.498V3.39086C14.6779 3.39086 13.8118 4.25698 13.8118 5.32538H12.919C12.919 4.25698 12.0529 3.39086 10.9845 3.39086V2.498ZM0.666992 7.70633C3.29692 7.70633 5.4289 5.57436 5.4289 2.94443H7.0162C7.0162 5.57436 9.14818 7.70633 11.7781 7.70633V9.29364C9.14818 9.29364 7.0162 11.4256 7.0162 14.0555H5.4289C5.4289 11.4256 3.29692 9.29364 0.666992 9.29364V7.70633ZM3.74319 8.49998C4.78379 9.07745 5.64511 9.93871 6.22255 10.9793C6.79998 9.93871 7.6613 9.07745 8.70191 8.49998C7.6613 7.92252 6.79998 7.06125 6.22255 6.02063C5.64511 7.06125 4.78379 7.92252 3.74319 8.49998ZM13.5638 10.0873C13.5638 11.5118 12.409 12.6667 10.9845 12.6667V13.8571C12.409 13.8571 13.5638 15.012 13.5638 16.4365H14.7543C14.7543 15.012 15.9091 13.8571 17.3337 13.8571V12.6667C15.9091 12.6667 14.7543 11.5118 14.7543 10.0873H13.5638Z" fill="currentColor"/>\n</svg>\n  \n  <span class="mfa-question-option__text">${s}</span>\n</div>\n  `,M_=({parentQuestionId:e})=>`\n<miso-ask class="mfa-related-questions-container" visible-when="initial+nonempty" logo="false" parent-question-id="${e}">\n  <div class="mfa-related-questions-container__header">Related questions you can explore</div>\n  <miso-query-suggestions></miso-query-suggestions>\n</miso-ask>\n  `,j_=["url","created_at","updated_at","published_at","authors","tags"],D_="miso-ask-combo",F_=(e,t,s)=>{document.getElementById(D_)?(async(e,t)=>{const s=e.ui.ask;await e.ui.ready;const n=MisoClient.ui.defaults.ask,i=n.wireFollowUps,o=n.wireRelatedResources,r=document.querySelector("#miso-ask-combo");r.innerHTML='\n<div class="mfa-answer-header mfa-answer-header--unready">\n  <div class="mfa-answer-header__title">\n    You asked about&nbsp;\n    <miso-ask visible-when="ready" logo="false">\n      <miso-question></miso-question>\n    </miso-ask>\n  </div>\n</div>\n<div class="mfa-answer-container">\n  <section class="mfa-answer-main-block">\n    <miso-ask class="mfa-answer miso-circled-citation-index" visible-when="ready" logo="false">\n      <div class="mfa-answer__info">\n        \n<svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.9845 2.498C12.0529 2.498 12.919 1.63188 12.919 0.563477H13.8118C13.8118 1.63188 14.6779 2.498 15.7464 2.498V3.39086C14.6779 3.39086 13.8118 4.25698 13.8118 5.32538H12.919C12.919 4.25698 12.0529 3.39086 10.9845 3.39086V2.498ZM0.666992 7.70633C3.29692 7.70633 5.4289 5.57436 5.4289 2.94443H7.0162C7.0162 5.57436 9.14818 7.70633 11.7781 7.70633V9.29364C9.14818 9.29364 7.0162 11.4256 7.0162 14.0555H5.4289C5.4289 11.4256 3.29692 9.29364 0.666992 9.29364V7.70633ZM3.74319 8.49998C4.78379 9.07745 5.64511 9.93871 6.22255 10.9793C6.79998 9.93871 7.6613 9.07745 8.70191 8.49998C7.6613 7.92252 6.79998 7.06125 6.22255 6.02063C5.64511 7.06125 4.78379 7.92252 3.74319 8.49998ZM13.5638 10.0873C13.5638 11.5118 12.409 12.6667 10.9845 12.6667V13.8571C12.409 13.8571 13.5638 15.012 13.5638 16.4365H14.7543C14.7543 15.012 15.9091 13.8571 17.3337 13.8571V12.6667C15.9091 12.6667 14.7543 11.5118 14.7543 10.0873H13.5638Z" fill="currentColor"/>\n</svg>\n   Results are generated using information from My Bookshelf\n      </div>\n      <miso-answer></miso-answer>\n    </miso-ask>\n    <div class="mfa-follow-up__answer-container"></div>\n    <div class="mfa-follow-up__input-container"></div>\n  </section>\n  <section class="mfa-answer-secondary-block">\n    <miso-ask class="mfa-source miso-circled-citation-index" visible-when="nonempty" logo="false">\n      <div class="mfa-card">\n        <div class="mfa-card__header">Sources from My Bookshelf</div>\n        <miso-sources></miso-sources>\n      </div>\n    </miso-ask>\n    <div class="mfa-follow-up__sources-container"></div>\n    <div class="mfa-follow-up__related-questions-container"></div>\n  </section>\n</div>\n<section class="mfa-answer-related">\n  <miso-ask class="miso-ask-combo__related-resources-container miso-circled-citation-index" visible-when="nonempty" logo="false">\n    <h2 class="miso-ask-combo__phrase miso-ask-combo__related-resources-phrase">Books related to this topic</h2>\n    <miso-related-resources></miso-related-resources>\n  </miso-ask>\n</section>\n<div class="mfa-answer-footer"></div>\n  ';const a=e.ui.asks;a.useApi({fq:"type:ReferenceBook",source_fl:j_,related_resource_fl:j_}),a.useLayouts({answer:{onCitationLink:I_},sources:["list",{templates:{article:$_}}],query:{placeholder:"Ask a follow-up question",buttonText:"Ask"},query_suggestions:{templates:{option:P_}},related_resources:["list",{templates:{article:q_}}]}),a.on("request",(()=>{document.querySelector(".mfa-answer-header").classList.add("mfa-answer-header--unready");const e=r.querySelectorAll(".mfa-answer"),t=r.querySelectorAll(".mfa-source");if(e.length>1&&t.length>1){const s=e.length-2,n=e[s].offsetHeight,i=t[s].offsetHeight,o=Math.max(n,i);e[s].style.height=`${o}px`,t[s].style.height=`${o}px`}})),a.on("ready",(()=>{document.querySelector(".mfa-answer-header").classList.remove("mfa-answer-header--unready")})),a.on("tracker",(({role:e,type:t})=>{if("query_suggestions"===e&&"click"===t){const e=r.querySelectorAll(".mfa-followup-title__label");e[e.length-1].textContent="Related question:"}})),i(e,r.querySelector(".mfa-follow-up__related-questions-container"),{template:T_}),i(e,r.querySelector(".mfa-follow-up__input-container"),{template:A_}),i(e,r.querySelector(".mfa-follow-up__answer-container"),{template:R_}),i(e,r.querySelector(".mfa-follow-up__sources-container"),{template:N_}),o(e,r.querySelector(".miso-ask-combo__related-resources")),s.query({q:t})})(e,s):console.warn(`[MisoForALM] Element with id '${D_}' not found.`)},B_="https://api-edge.askmiso.com/v1",z_=async(e,t)=>{if(t)try{const s=await fetch(`${B_}/ask/questions/${t}/answer?api_key=${Ba}`,{headers:e?{Authorization:e}:{}}),{data:n}=await s.json();return n}catch(s){return void console.error("Error fetching answer:",s)}},H_=async(e,t,s,n)=>{const i=n||document.querySelector("miso-user-history");if(!i)return;i.innerHTML='\n<div class="miso-loading" aria-label="Loading" data-role="loading" style="display: flex;"></div>\n  ';const o=await(async(e,t)=>{if(!e)return[];try{const s=await fetch(`${B_}/ask/alm/user_history?api_key=${Ba}`,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:t}:{}},body:JSON.stringify({user_id:e})}),{data:n}=await s.json();return n||[]}catch(s){return console.error("Error fetching user history:",s),[]}})(e,t);if(!Array.isArray(o)||0===o.length)return void(i.innerHTML='<div class="miso-user-history__empty">No history found</div>');i.innerHTML=`\n<ul class="miso-user-history__list">\n  ${o.map((e=>(({question_id:e,question:t})=>`\n<li class="miso-user-history__item" data-question-id="${e}">\n  <div class="miso-user-history__item-title">${t}</div>\n</li>\n  `)(e))).join("")}\n</ul>\n  `;const r=n.querySelectorAll(".miso-user-history__item");s&&r.forEach((e=>{e.addEventListener("click",(()=>{s(e.dataset.questionId)}))}))},Q_="miso-previously-asked",V_=(e,t)=>{document.getElementById(Q_)?((e,t)=>{const s=document.querySelector("#miso-previously-asked");if(!s)return;s.innerHTML='\n<div class="mfa-my-answers__tab-content mfa-my-answers__tab-content--active" data-tab-id="history">\n  <miso-user-history></miso-user-history>\n</div>\n  ';const n=s.querySelector("miso-user-history");n&&H_(e.context.user_id,e.context.auth,t,n)})(e,t.onSelectHistoryQuestion):console.warn(`[MisoForALM] Element with id '${Q_}' not found.`)},G_=["url","created_at","updated_at","published_at","authors","tags"],W_="miso-ask-combo",K_=(e,t,s)=>{document.getElementById(W_)?(async(e,t)=>{const s=e.ui.ask;await e.ui.ready;const n=MisoClient.ui.defaults.ask,i=n.wireFollowUps,o=n.wireRelatedResources,r=document.querySelector("#miso-ask-combo");r.innerHTML='\n<div class="mfa-answer-header mfa-answer-header--unready">\n  <div class="mfa-answer-header__title">\n    You asked about&nbsp;\n    <miso-ask visible-when="ready" logo="false">\n      <miso-question></miso-question>\n    </miso-ask>\n  </div>\n</div>\n<div class="mfa-answer-container">\n  <section class="mfa-answer-main-block">\n    <miso-ask class="mfa-answer miso-circled-citation-index" visible-when="ready" logo="false">\n      <div class="mfa-answer__info">\n        \n<svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M10.9845 2.498C12.0529 2.498 12.919 1.63188 12.919 0.563477H13.8118C13.8118 1.63188 14.6779 2.498 15.7464 2.498V3.39086C14.6779 3.39086 13.8118 4.25698 13.8118 5.32538H12.919C12.919 4.25698 12.0529 3.39086 10.9845 3.39086V2.498ZM0.666992 7.70633C3.29692 7.70633 5.4289 5.57436 5.4289 2.94443H7.0162C7.0162 5.57436 9.14818 7.70633 11.7781 7.70633V9.29364C9.14818 9.29364 7.0162 11.4256 7.0162 14.0555H5.4289C5.4289 11.4256 3.29692 9.29364 0.666992 9.29364V7.70633ZM3.74319 8.49998C4.78379 9.07745 5.64511 9.93871 6.22255 10.9793C6.79998 9.93871 7.6613 9.07745 8.70191 8.49998C7.6613 7.92252 6.79998 7.06125 6.22255 6.02063C5.64511 7.06125 4.78379 7.92252 3.74319 8.49998ZM13.5638 10.0873C13.5638 11.5118 12.409 12.6667 10.9845 12.6667V13.8571C12.409 13.8571 13.5638 15.012 13.5638 16.4365H14.7543C14.7543 15.012 15.9091 13.8571 17.3337 13.8571V12.6667C15.9091 12.6667 14.7543 11.5118 14.7543 10.0873H13.5638Z" fill="currentColor"/>\n</svg>\n   Results are generated using information from My Bookshelf\n      </div>\n      <miso-answer></miso-answer>\n    </miso-ask>\n    <div class="mfa-follow-up__answer-container"></div>\n    <div class="mfa-follow-up__input-container"></div>\n  </section>\n  <section class="mfa-answer-secondary-block">\n    <miso-ask class="mfa-source miso-circled-citation-index" visible-when="nonempty" logo="false">\n      <div class="mfa-card">\n        <div class="mfa-card__header">Sources from My Bookshelf</div>\n        <miso-sources></miso-sources>\n      </div>\n    </miso-ask>\n    <div class="mfa-follow-up__sources-container"></div>\n    <div class="mfa-follow-up__related-questions-container"></div>\n  </section>\n</div>\n<section class="mfa-answer-related">\n  <miso-ask class="miso-ask-combo__related-resources-container miso-circled-citation-index" visible-when="nonempty" logo="false">\n    <h2 class="miso-ask-combo__phrase miso-ask-combo__related-resources-phrase">Books related to this topic</h2>\n    <miso-related-resources></miso-related-resources>\n  </miso-ask>\n</section>\n<div class="mfa-answer-footer"></div>\n  ',s.useApi(!1);const a=e.ui.asks;a.useApi({fq:"type:ReferenceBook",source_fl:G_,related_resource_fl:G_}),a.useLayouts({answer:{onCitationLink:I_},sources:["list",{templates:{article:$_}}],query:{placeholder:"Ask a follow-up question",buttonText:"Ask"},query_suggestions:{templates:{option:P_}},related_resources:["list",{templates:{article:q_}}]}),a.on("request",(()=>{document.querySelector(".mfa-answer-header").classList.add("mfa-answer-header--unready");const e=r.querySelectorAll(".mfa-answer"),t=r.querySelectorAll(".mfa-source");if(e.length>1&&t.length>1){const s=e.length-2,n=e[s].offsetHeight,i=t[s].offsetHeight,o=Math.max(n,i);e[s].style.height=`${o}px`,t[s].style.height=`${o}px`}})),a.on("ready",(()=>{document.querySelector(".mfa-answer-header").classList.remove("mfa-answer-header--unready")})),a.on("tracker",(({role:e,type:t})=>{if("query_suggestions"===e&&"click"===t){const e=r.querySelectorAll(".mfa-followup-title__label");e[e.length-1].textContent="Related question:"}})),i(e,r.querySelector(".mfa-follow-up__related-questions-container"),{template:T_}),i(e,r.querySelector(".mfa-follow-up__input-container"),{template:A_}),i(e,r.querySelector(".mfa-follow-up__answer-container"),{template:R_}),i(e,r.querySelector(".mfa-follow-up__sources-container"),{template:N_}),o(e,r.querySelector(".miso-ask-combo__related-resources"));const c=await z_(e.context.auth,t);c&&s.updateData({session:s.session,value:c})})(e,s):console.warn(`[MisoForALM] Element with id '${W_}' not found.`)},Y_=e=>{e.querySelector(".mfa-ask-this-book__explore").classList.add("mfa-ask-this-book__explore--hide"),e.querySelector(".mfa-ask-this-book__info").classList.remove("mfa-ask-this-book__info--hide"),(e=>{const t=e.querySelector(".mfa-ask-this-book__tabs");t&&(t.style.display="none")})(e),(e=>{const t=e.querySelector('.mfa-ask-this-book__tab-content[data-tab-id="explore"]');t&&t.classList.add("mfa-ask-this-book__tab-content--active");const s=e.querySelector('.mfa-ask-this-book__tab-content[data-tab-id="history"]');s&&s.classList.remove("mfa-ask-this-book__tab-content--active")})(e)},Z_=async(e,t)=>{await e.ui.ready;const s=MisoClient.ui.defaults.ask.wireFollowUps,n=document.querySelector("#miso-ask-combo");n.innerHTML='\n<section class="mfa-ask-this-book">\n  <miso-ask class="mfa-ask-input miso-circled-citation-index" logo="false">\n    <miso-query></miso-query>\n    <div class="mfa-ask-this-book__info mfa-ask-this-book__info--hide">Responses generated by AI using content from this book.</div>\n  </miso-ask>\n  <div class="mfa-ask-this-book__container">\n    <miso-ask class="mfa-ask-this-book__answer miso-circled-citation-index" visible-when="ready" logo="false">\n      <div class="mfa-ask-this-book__answer-title">\n        <miso-question></miso-question>\n      </div>\n      <miso-answer></miso-answer>\n    </miso-ask>\n    <div class="mfa-follow-up__related-questions-container"></div>\n    <div class="mfa-ask-this-book__tabs">\n      <div class="mfa-ask-this-book__tab mfa-ask-this-book__tab--active" data-tab-id="explore">\n        <span>Questions you can explore</span>\n      </div>\n      <div class="mfa-ask-this-book__tab" data-tab-id="history">\n        <span>Previously asked questions</span>\n      </div>\n    </div>\n    <div class="mfa-ask-this-book__tab-content mfa-ask-this-book__tab-content--active" data-tab-id="explore">\n      <miso-explore class="mfa-ask-this-book__explore">\n        <miso-related-questions></miso-related-questions>\n      </miso-explore>\n    </div>\n    <div class="mfa-ask-this-book__tab-content" data-tab-id="history">\n      <miso-user-history></miso-user-history>\n    </div>\n  </div>\n</section>\n  ';const i=t=>{const s=e.ui.ask;n.querySelector(".miso-search-box__input").value=t,s.query({q:t})},o=e.ui.asks;o.useLayouts({query:{placeholder:"What can we answer for you?",buttonText:"Ask"},query_suggestions:{templates:{option:P_}}}),o.on("request",(()=>{Y_(n)})),o.on("tracker",(({items:e,role:t,type:s})=>{if("query_suggestions"===t&&"click"===s){const t=e[0].text;i(t)}}));const r=e.ui.explore;r.useApi({product_id:t}),r.useLink((()=>{})),r.useLayouts({related_questions:["list",{templates:{question:U_}}]}),r.on("done",(()=>{n.querySelectorAll(".mfa-question-option").forEach((e=>{e.addEventListener("click",(()=>{const t=e.querySelector(".mfa-question-option__text").textContent;i(t)}))}))})),r.start(),s(e,n.querySelector(".mfa-follow-up__related-questions-container"),{template:M_});const a=n.querySelectorAll(".mfa-ask-this-book__tab"),c=n.querySelectorAll(".mfa-ask-this-book__tab-content");a.forEach((e=>{e.addEventListener("click",(()=>{if(e.classList.contains("mfa-ask-this-book__tab--active"))return;a.forEach((e=>e.classList.remove("mfa-ask-this-book__tab--active"))),c.forEach((e=>e.classList.remove("mfa-ask-this-book__tab-content--active"))),e.classList.add("mfa-ask-this-book__tab--active");const t=n.querySelector(`.mfa-ask-this-book__tab-content[data-tab-id="${e.dataset.tabId}"]`);t&&t.classList.add("mfa-ask-this-book__tab-content--active")}))}));const l=n.querySelector("miso-user-history");l&&H_(e.context.user_id,e.context.auth,(t=>{(async t=>{if(!t)return;Y_(n);const s=e.ui.ask,i=await z_(e.context.auth,t);i&&s.updateData({session:s.session,value:i})})(t)}),l)},J_="miso-ask-combo";!function(e){const t={_client:!1,_actionHooks:{onAsk:e=>{},onSearch:e=>{},onSelectHistoryQuestion:e=>{},onAskTheBook:e=>{}},_init(){if(this._client)return;const e=new Ae(Ba);this._client=e},setUserInfo(e){const{userId:t,userType:s}=e;t&&(this._client.context.user_id=t),s&&(this._client.context.user_type=s)},setAuthToken(e){e&&(this._client.context.auth=`Bearer ${e}`)},clearAuthToken(){this._client.context.auth=void 0},setActionHooks(e){e&&(this._actionHooks={...this._actionHooks,...e})},renderMyAnswers(){((e,t)=>{const s=document.getElementById(w_);if(!s)return void console.warn(`[MisoForALM] Element with id '${w_}' not found.`);g_(v_,{actionHooks:t}).mount(s)})(this._client,this._actionHooks)},renderSearchBar(){this._client,this._actionHooks,document.getElementById(k_)||console.warn(`[MisoForALM] Element with id '${k_}' not found.`)},renderMiniAnswer(e){e&&((e,t)=>{const s=document.getElementById("miso-mini-answer__summary"),n=document.getElementById(O_);if(s||console.warn(`[MisoForALM] Element with id '${ELEMENT_ID}' not found.`),n||console.warn(`[MisoForALM] Element with id '${O_}' not found.`),!s||!n)return;g_(E_,{actionHooks:t}).mount(s),g_(x_,{actionHooks:t}).mount(n)})(this._client,this._actionHooks)},renderAnswer(e){e&&F_(this._client,this._actionHooks,e)},renderPreviouslyAsked(){V_(this._client,this._actionHooks)},renderPreviousAnswer(e){e&&K_(this._client,this._actionHooks,e)},renderAskThisBook(e){var t,s;e&&(t=this._client,this._actionHooks,s=e,document.getElementById(J_)?Z_(t,s):console.warn(`[MisoForALM] Element with id '${J_}' not found.`))}};e.MisoForALM||(e.MisoForALM=t),t._init()}(window)}();
