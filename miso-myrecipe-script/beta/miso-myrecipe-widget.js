var misoForMyR=function(n){"use strict";class t{constructor(n,t){this.widgetElement=null,this.plans=[],this.isLoading=!1,this.container=n,this.instance=t}render(){this.renderContent(),this.loadPlans()}async loadPlans(){this.isLoading=!0,this.renderContent();try{const n=this.instance.getConfig(),t=await async function(){return await new Promise(n=>setTimeout(n,300)),{data:[]}}(n.token);this.plans=t.data}catch(n){console.error("Failed to fetch plans:",n),this.plans=[]}finally{this.isLoading=!1,this.renderContent()}}renderContent(){const n=`\n      <div class="miso-plan-listing">\n        <h1 class="miso-plan-listing__title">Meal Plans</h1>\n        ${this.isLoading?this.renderLoading():this.renderPlans()}\n      </div>\n    `;this.container.innerHTML=n,this.widgetElement=this.container.firstElementChild,this.isLoading||this.attachEventListeners()}renderLoading(){return'\n      <div class="miso-plan-listing__loading">\n        Loading...\n      </div>\n    '}renderPlans(){if(0===this.plans.length)return this.renderEmptyState();return`\n      <div class="miso-plan-listing__header">\n        <div class="miso-plan-listing__count">${1===this.plans.length?"1 Plan":`${this.plans.length} Plans`}</div>\n        <button class="miso-plan-listing__new-btn" data-action="create-plan">\n          <span>New Plan</span>\n          <img src="/src/assets/imgs/icon-add.svg" alt="" class="miso-plan-listing__new-btn-icon" />\n        </button>\n      </div>\n      <div class="miso-plan-listing__list">\n        ${this.plans.map(n=>this.renderPlanCard(n)).join("")}\n      </div>\n    `}renderEmptyState(){return'\n      <div class="miso-plan-listing__empty">\n        <p class="miso-plan-listing__empty-text">No meal plan yet. Create a new plan to get started!</p>\n        <button class="miso-plan-listing__new-btn" data-action="create-plan">\n          <span>New Plan</span>\n          <img src="/src/assets/imgs/icon-add.svg" alt="" class="miso-plan-listing__new-btn-icon" />\n        </button>\n      </div>\n    '}renderPlanCard(n){const t=1===n.recipes.length?"1 RECIPE":`${n.recipes.length} RECIPES`,i=this.formatDate(n.created_at);return`\n      <div class="miso-plan-listing__card" data-plan-id="${n.id}">\n        <div class="miso-plan-listing__card-title">${this.escapeHtml(n.title)}</div>\n        <div class="miso-plan-listing__card-meta">\n          <span class="miso-plan-listing__card-recipes">${t}</span>\n          <span class="miso-plan-listing__card-date">CREATED ON ${i}</span>\n        </div>\n      </div>\n    `}formatDate(n){const t=new Date(n);return`${t.getDate()}/${t.getMonth()+1}/${t.getFullYear().toString().slice(-2)}`}escapeHtml(n){const t=document.createElement("div");return t.textContent=n,t.innerHTML}attachEventListeners(){if(!this.widgetElement)return;const n=this.widgetElement.querySelector('[data-action="create-plan"]');n&&n.addEventListener("click",()=>{this.instance.emit("create-plan")});this.widgetElement.querySelectorAll("[data-plan-id]").forEach(n=>{n.addEventListener("click",()=>{const t=n.dataset.planId;t&&this.instance.emit("view-plan",t)})})}async getPlans(){return this.plans}async refreshPlans(){await this.loadPlans()}destroy(){this.widgetElement&&(this.container.removeChild(this.widgetElement),this.widgetElement=null),this.plans=[]}}class i{constructor(n){this.eventListeners=new Map,this.planListingWidget=null,this.config=n}on(n,t){this.eventListeners.has(n)||this.eventListeners.set(n,new Set),this.eventListeners.get(n).add(t)}off(n,t){const i=this.eventListeners.get(n);i&&i.delete(t)}emit(n,...t){const i=this.eventListeners.get(n);i&&i.forEach(n=>n(...t))}renderPlanListingWidget(n){this.planListingWidget=new t(n,this),this.planListingWidget.render()}destroyPlanListingWidget(){this.planListingWidget&&(this.planListingWidget.destroy(),this.planListingWidget=null)}renderPlanEditorWidget(n,t){console.warn("renderPlanEditorWidget not implemented",n,t)}destroyPlanEditorWidget(){console.warn("destroyPlanEditorWidget not implemented")}async getPlans(){return this.planListingWidget?this.planListingWidget.getPlans():[]}async refreshPlans(){this.planListingWidget&&await this.planListingWidget.refreshPlans()}getConfig(){return this.config}}function e(n){return new i(n)}return"undefined"!=typeof window&&(window.misoForMyR={init:e}),n.init=e,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),n}({});
//# sourceMappingURL=miso-myrecipe-widget.js.map
