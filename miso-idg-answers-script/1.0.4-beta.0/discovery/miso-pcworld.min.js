!function(){"use strict";var t=Object.freeze({aff_type:"random",...function(){const t=document.currentScript;if(!t||!t.src)return{};const e=document.createElement("a");e.href=t.src;const n={};for(const[t,o]of new URLSearchParams(e.search))"q"!==t&&(n[t]=""===o||o);return n}(),...function(){const t={};for(const[e,n]of new URLSearchParams(window.location.search))e.startsWith("miso_")&&e.length>5&&"miso_api_key"!==e?t[e.substring(5)]=""===n||n:"q"!==e&&"qs"!==e||(t[e]=n);return t}()}),e="1.0.4-beta.0";function n(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}function o(t){if("object"!=typeof t)return t;const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&void 0!==t[n]&&(e[n]=t[n]);return e}Object.freeze({ASK:"ask",SEARCH:"search",RECOMMENDATION:"recommendation",INTERACTIONS:"interactions"}),Object.freeze({QUESTIONS:"questions",RELATED_QUESTIONS:"related_questions",SEARCH:"search",AUTOCOMPLETE:"autocomplete",MGET:"mget",USER_TO_PRODUCTS:"user_to_products",USER_TO_CATEGORIES:"user_to_categories",USER_TO_ATTRIBUTES:"user_to_attributes",USER_TO_TRENDING:"user_to_trending",USER_TO_HISTORY:"user_to_history",PRODUCT_TO_PRODUCTS:"product_to_products",UPLOAD:"upload"});class s{constructor(t,{duration:e=0,onDuration:n,offDuration:o,state:s}={}){if("function"!=typeof t)throw Error("Callback must be a function: "+t);i(n),i(o),i(e),this._callback=t,Object.defineProperty(this,"durations",{value:Object.freeze({on:void 0!==n?n:e,off:void 0!==o?o:e})}),this._value=this._state=!!s,this._active=!0}get active(){return this._active}get state(){return this._state}get value(){return this._value}set value(t){if(this._value===(t=!!t))return;!function(t){if(!t._timeout)return;clearTimeout(t._timeout),t._timeout=void 0}(this);const e=this.durations[t?"on":"off"];e?this._timeout=setTimeout((()=>r(this,t)),e):r(this,t),this._value=t}disconnect(){this._active=!1}}function r(t,e){t._state!==e&&(t._state=e,t._active&&t._callback(e))}function i(t,e){if(void 0!==e&&(isNaN(e)||0>e))throw Error(`${t} must be a non-negative number: ${e}`)}async function a(t,{area:e=.5,duration:n=1e3,signal:o}={}){var r;return t="string"==typeof(r=t)?document.querySelector(r):r,new Promise((r=>{const i=new s((t=>{t&&(i.disconnect(),a.disconnect(),r())}),{onDuration:n}),a=new IntersectionObserver((t=>{i.value=t[0].isIntersecting}),{threshold:e});a.observe(t),o&&o.addEventListener&&o.addEventListener("abort",(()=>{i.disconnect(),a.disconnect()}))}))}function c(){return(crypto&&crypto.randomUUID?crypto.randomUUID():void 0)||function(){if(!URL||!URL.createObjectURL||URL.revokeObjectURL||!Blob)return;const t=URL.createObjectURL(new Blob),e=""+t;return URL.revokeObjectURL(t),e.substring(e.lastIndexOf("/")+1)}()||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}class u{constructor({target:t,error:e,replays:n=[]}={}){if(this._error=e||(t=>console.error(t)),!Array.isArray(n))throw Error("Replays option must be an array of strings: "+n);this._replays=new Set(n),this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={},t&&this._injectSubscribeInterface(t)}emit(t,e){const n={data:e,meta:{name:t,ts:Date.now()}},o=this._namedCallbacks[t];if(o)for(const t of o)t(n);for(const t of this._unnamedCallbacks)t(n);this._shallStoreForReplay(t)&&(this._pastEvents[t]||(this._pastEvents[t]=[])).push(n)}on(t,e){return this._checkName(t),this._checkCallback(e),this._on(t,this._wrapCallback(e))}once(t){this._checkName(t);const e=this;return new Promise(((n,o)=>{const s=e._on(t,(t=>{setTimeout((()=>s()));try{n(t)}catch(t){o(t)}}))}))}clear(){this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={}}_checkName(t){if("string"!=typeof t)throw Error("Event name should be a string: "+t)}_checkCallback(t){if("function"!=typeof t)throw Error("Event callback should be a function: "+t)}_shallStoreForReplay(t){return this._replays.has(t)}_wrapCallback(t){const e=this;return({data:n,meta:o})=>{try{t(n,o)}catch(t){e._error(t)}}}_on(t,e){if("*"===t?this._unnamedCallbacks.push(e):(this._namedCallbacks[t]||(this._namedCallbacks[t]=[])).push(e),"*"===t)for(const t in this._pastEvents)this._pastEvents[t].forEach(e);else this._pastEvents[t]&&this._pastEvents[t].forEach(e);return()=>this._off(t,e)}_off(t,e){if("*"===t)n(this._unnamedCallbacks,e);else{const o=this._namedCallbacks[t];o&&n(o,e)}}_injectSubscribeInterface(t){!function(t,e,n){Object.defineProperties(t,(n="string"==typeof n?[n]:n).reduce(((t,n)=>(t[n]={get:()=>{const t=e[n];return"function"==typeof t?t.bind(e):t}},t)),{}))}(t,this,["on","once"])}}function l(t,e){return Object.freeze([...e&&e.meta&&e.meta.path||[],...t?[t]:[]])}function d({site:t,version:e,config:n}){const{aff_type:s}=n;return o({source:"miso-client-script",script_version:e,attribution:"miso-smart-answers",aff_type:s,site:t.key,uuid:c()})}function f(){return o({page:o({url:window.location.href,referrer:document.referrer,title:document.title}),campaign:h()})}function h(){const t=new URLSearchParams(window.location.search);let e=o({source:t.get("utm_source")||void 0,medium:t.get("utm_medium")||void 0,name:t.get("utm_campaign")||void 0,term:t.get("utm_term")||void 0,content:t.get("utm_content")||void 0});return 0===Object.keys(e).length?void 0:e}let p,_;async function m(){return p||(p=async function(){return async function(t,{interval:e=300,timeout:n}={}){const o=t();return null!=o?o:new Promise(((o,s)=>{let r,i;function a(){r&&clearInterval(r),i&&clearTimeout(i)}r=setInterval((()=>{const e=t();null!=e&&(a(),o(e))}),e),n&&n>0&&(i=setTimeout((()=>{a(),s(Error("Timeout: "+n))}),n))}))}((()=>window.ga&&window.ga.getAll&&window.ga.getAll()[0]))}())}async function y(){if(_)return _;const t=await m();return _=t.get("clientId")}!function(t,e){const n=Symbol.for(e);Object.defineProperty(t,n,{value:!0}),Object.defineProperty(t,"isTypeOf",{value:e=>e&&e instanceof t||"function"==typeof e.constructor&&!0===e.constructor[n]})}(class{constructor(t,e){const n=function(t,e){if(void 0!==t&&"string"!=typeof t&&void 0===e&&(e=t,t=void 0),void 0!==t&&("string"!=typeof t||!t))throw Error(`Invalid Component name: "${t}"`);return Object.freeze({name:t,parent:e,path:l(t,e),uuid:c()})}(t,e);!function(t,e){for(const n in e)e.hasOwnProperty(n)&&Object.defineProperty(t,n,{value:e[n]})}(this,{meta:n});const o=this._error=this._error.bind(this);(this._events=new u({error:o,replays:["child"]}))._injectSubscribeInterface(this),this._warn=this._warn.bind(this),(e=n.parent)&&e._events&&e._events.emit("child",this)}_warn(...t){const e=this.meta.parent;(e&&e._warn||console.warn)(...t)}_error(...t){const e=this.meta.parent;(e&&e._error||console.error)(...t)}},"miso:component");const v="%cMiso",w="color: #fff; background-color: #9033bb; padding: 2px 2px 1px 4px;";function b(...n){(t.debug||e.indexOf("beta")>=0||"dev"===e)&&function(...t){console.log(v,w,...t)}(...n)}const g=new Map;async function k(t){return async function(t,e,n){if(t.has(e))return t.get(e);const o=await n(e);return t.set(e,o),o}(g,t,(async t=>await async function(t,e){return async function(t,e,{fields:n}={}){let o=`https://b2c-contenthub.com/wp-json/wp/v2/${t}/${e}`;n&&(o+="?_fields="+n.join(","));return async function(t){return(await window.fetch(t)).json()}(o)}("posts",t,e)}(t,{fields:["meta"]})))}async function x(t){const e={};let n;try{n=await k(t),b("Fetched post info",[n])}catch(n){return console.error("Cannot fetch post: "+t),console.error(n),e}try{if(e.contentType=n.meta.content_type,!e.contentType)throw Error("Blank meta.content_type: "+t)}catch(e){console.error("Cannot extract story type: "+t),console.error(e)}try{const{suppress_monetization:t='""'}=n.meta||{},o=JSON.parse(t);e.adSuppression=!0===o.content_ads}catch(e){console.error("Cannot extract suppress_monetization info: "+t),console.error(e)}return e}const{currentScript:E}=document;async function S({}){await Promise.all([O()])}let $=!1;async function O(){if($)return;if($=!0,!E)throw Error("currentScript not found");const t=E.src,e=t.indexOf("?"),n=(0>e?t:t.substring(0,e)).replace(/(\.min)?\.js$/,".css");await async function(t){if(document.querySelector(`link[href="${t}"]`))return;return new Promise(((e,n)=>{const o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.onload=e,o.onerror=n,o.href=t,document.head.appendChild(o)}))}(n)}const C='<svg fill="currentColor" viewBox="0 0 16 16">\n<path d="M12.52.55l-5,5h0L.55,12.51l3,3,12-12Zm-4,6,4-4,1,1-4,4.05ZM2.77,3.18A3.85,3.85,0,0,1,5.32,5.73h0A3.85,3.85,0,0,1,7.87,3.18h0A3.82,3.82,0,0,1,5.32.64h0A3.82,3.82,0,0,1,2.77,3.18ZM8.5,2.55h0A2,2,0,0,1,9.78,1.27h0A1.92,1.92,0,0,1,8.5,0h0A1.88,1.88,0,0,1,7.23,1.27h0A1.92,1.92,0,0,1,8.5,2.55Zm-6.36,0h0A1.92,1.92,0,0,1,3.41,1.27h0A1.88,1.88,0,0,1,2.14,0h0A1.92,1.92,0,0,1,.86,1.27h0A2,2,0,0,1,2.14,2.55ZM14.73,6.22h0a1.94,1.94,0,0,1-1.28,1.27h0a1.94,1.94,0,0,1,1.28,1.27h0A1.9,1.9,0,0,1,16,7.49h0A1.9,1.9,0,0,1,14.73,6.22Z"/>\n</svg>',q='<svg fill="currentColor" viewBox="0 0 973.1 973.1">\n<path d="M502.29,788.199h-47c-33.1,0-60,26.9-60,60v64.9c0,33.1,26.9,60,60,60h47c33.101,0,60-26.9,60-60v-64.9 C562.29,815,535.391,788.199,502.29,788.199z M170.89,285.8l86.7,10.8c27.5,3.4,53.6-12.4,63.5-38.3c12.5-32.7,29.9-58.5,52.2-77.3c31.601-26.6,70.9-40,117.9-40 c48.7,0,87.5,12.8,116.3,38.3c28.8,25.6,43.1,56.2,43.1,92.1c0,25.8-8.1,49.4-24.3,70.8c-10.5,13.6-42.8,42.2-96.7,85.9 c-54,43.7-89.899,83.099-107.899,118.099c-18.4,35.801-24.8,75.5-26.4,115.301c-1.399,34.1,25.8,62.5,60,62.5h49 c31.2,0,57-23.9,59.8-54.9c2-22.299,5.7-39.199,11.301-50.699c9.399-19.701,33.699-45.701,72.699-78.1 C723.59,477.8,772.79,428.4,795.891,392c23-36.3,34.6-74.8,34.6-115.5c0-73.5-31.3-138-94-193.4c-62.6-55.4-147-83.1-253-83.1 c-100.8,0-182.1,27.3-244.1,82c-52.8,46.6-84.9,101.8-96.2,165.5C139.69,266.1,152.39,283.5,170.89,285.8z"/>\n</svg>',A='<svg fill="currentColor" viewBox="0 0 24 24">\n<path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.696-3.534c.63 0 1.332-.288 2.196-1.458l.911-1.22a.334.334 0 0 0-.074-.472.38.38 0 0 0-.505.06l-1.475 1.679a.241.241 0 0 1-.279.061.211.211 0 0 1-.12-.244l1.858-7.446a.499.499 0 0 0-.575-.613l-3.35.613a.35.35 0 0 0-.276.258l-.086.334a.25.25 0 0 0 .243.312h1.73l-1.476 5.922c-.054.234-.144.63-.144.918 0 .666.396 1.296 1.422 1.296zm1.83-10.536c.702 0 1.242-.414 1.386-1.044.036-.144.054-.306.054-.414 0-.504-.396-.972-1.134-.972-.702 0-1.242.414-1.386 1.044a1.868 1.868 0 0 0-.054.414c0 .504.396.972 1.134.972z"/>\n</svg>',R="smart-answers-discovery";function T(t){return I("home",function({site:t}){const{name:e,ref_story:n}=t;return`\n<div class="${R}__container">\n  <div class="${R}__header">\n    <div class="${R}__title">\n      Smart Answers from ${e}\n    </div>\n    ${j(n)}\n  </div>\n  <div class="${R}__body">\n    <div class="${R}__search-box">\n      <input type="text" class="${R}__search-box-input" placeholder="Ask us a question">\n      <button class="${R}__search-box-button" data-role="button">\n        <i>${C}</i>\n        <span>A.I. Search</span>\n      </button>\n    </div>\n  </div>\n  <div class="${R}__footer">\n    ${j(n)}\n  </div>\n</div>\n`}(t))}function U(t,e={}){return I("article",function(t,{questions:e=[]}){const n=0===e.length,o=n?"Ask a question...":"Ask your own question...";return`\n<div class="${R}__header">\n  <i>${q}</i>\n  <h4 class="${R}__title">${n?"Explore with a question":"Explore frequently asked questions"}</h4>\n</div>\n<div class="${R}__body">\n  <div class="${R}__questions-container">\n    <ul class="${R}__questions-list">${e.map((e=>function({page:t},{question:e}){return`\n<li class="${R}__question-item">\n  <a href="/smart-answers?q=${encodeURIComponent(e)}&qs=${encodeURIComponent(t.storyId)}" class="${R}__question-link" data-role="faq-item" target="_blank" rel="nofollow">${e}</a>\n</li>\n`}(t,{question:e}))).join("")}</ul>\n  </div>\n  <div class="${R}__search-box">\n    <input type="text" class="${R}__search-box-input" placeholder="${o}">\n    <button class="${R}__search-box-button" data-role="button">\n      <i>${C}</i>\n      <span>A.I. Search</span>\n    </button>\n  </div>\n</div>\n`}(t,e))}function I(t,e){const n=document.createElement("div");return n.classList.add(R),n.classList.add(t),n.innerHTML=e,n}function j(t){return`\n<div class="${R}__info">\n  <span>What is this?</span>\n  <a class="${R}__info-link" href="/?post_type=post&p=${t}" target="_blank">${A}</a>\n</div>\n`}const P={impression:new Set,viewable_impression:new Set,click:new Set};function L(t,e){N("click",t,e)}function N(t,e,n){n=function(t,e){const n=[],o=P[t];for(const t of e)o.has(t)||(n.push(t),o.add(t));return n}(t,n),0!==n.length&&function(t,e,n){const{config:o,site:s,page:r,session_id:i,anonymous_id:a}=e,c="staging"===o.api_host?"https://ask-api.askmiso-staging.com/v1":"https://api.askmiso.com/v1",u=["api_key="+o.api_key];!o.dry_run&&function(t){return window.location.hostname===t.hostname}(s)||u.push("&dry_run=1");const l=`${c}/interactions?${u.join("&")}`,h={data:[{type:t,anonymous_id:a,product_ids:[],context:{...f(),custom_context:{...d(e),api_group:"ask",api_name:"related_questions",property:"related_questions",page_story_id:r.storyId,session_id:i,...n}}}]};if(!window.navigator.sendBeacon(l,JSON.stringify(h)))throw Error("Send beacon unsuccessful: "+l);b("[Discovery] "+t,h.data)}(t,e,{items:n})}const D=(()=>{let t="";for(const[e,n]of new URLSearchParams(window.location.search))e.startsWith("miso_")&&(t+=`&${encodeURIComponent(e)}=${encodeURIComponent(n)}`);return t})();function M(t,e){const n=e.querySelector('input[type="text"]');if(!n)throw Error('input[type="text"] not found');n.addEventListener("keydown",(({key:e,isComposing:o})=>{o||"Enter"!==e||z(t,n.value)})),e.addEventListener("click",(({target:o})=>{for(let s=o;s&&s!==e;s=s.parentElement){if(s.matches('a[href][data-role="faq-item"]')){try{L(t,[B(s)])}catch(t){console.error(t)}return}if(s.matches('[data-role="button"]'))return void z(t,n.value)}}))}function z(t,e){if(!e)return;window.open(`/smart-answers?q=${encodeURIComponent(e)}${D}`,"_blank")}function B({href:t}){return new URL(t).searchParams.get("q")}async function Z({config:t,site:e,page:n,session_id:o}){b("[Discovery] Fetching suggested questions from Miso API...");const s=`${"staging"===t.api_host?"https://ask-api.askmiso-staging.com/v1":"https://api.askmiso.com/v1"}/ask/related_questions?api_key=${t.api_key}`;try{const t=await window.fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({_meta:{site:e.key,session_id:o},product_id:n.storyId})}),{data:r}=await t.json(),{related_questions:i}=r;return 0===i.length&&b("[Discovery] No suggested questions found."),i}catch(t){return b("[Discovery] Failed to fetch suggested questions: "+t),console.error(t),[]}}async function F(t){const{story:e}=t,{contentType:n}=e;switch((o=n)&&o.toLowerCase().replaceAll(" ","-")){case"news":case"feature":case"how-to":case"reviews":case"best-picks":await async function(t){await H(t,{paragraphs:10})}(t);break;default:b("[Discovery] No discovery block for story type: "+n)}var o}async function H(t,{paragraphs:e}={}){const n=function(t,e=!1){return document.querySelector(`#link_wrapped_content > .legacy_content > p:nth-of-type(${t})`)||document.querySelector(`#link_wrapped_content > p:nth-of-type(${t})`)||e&&(document.querySelector("#link_wrapped_content > .legacy_content > p:last-of-type")||document.querySelector("#link_wrapped_content > p:last-of-type"))}(e);if(!n)return void b("[Discovery] No block shown: cannot find the reference position for discovery block.");t={...t,session_id:c()};const[o]=await Promise.all([Z(t),S(t)]),s=U(t,{questions:o});M(t,s),n.insertAdjacentElement("afterend",s),function(t,e){N("impression",t,e)}(t,o),await a(s),function(t,e){N("viewable_impression",t,e)}(t,o)}(async(t,n)=>{if("/smart-answers"===window.location.pathname)return;if(window.miso_smart_answers_script_version)return void console.warn("Miso Smart Answers script already executed: "+window.miso_smart_answers_script_version);window.miso_smart_answers_script_version=e;const o=function(t){const e=window.location.pathname;if("/"===e)return{type:"home",site:t};const n=e.substring(1).split("/");if("article"===n[0]){const e=""+n[1];return{type:"story",site:t,postId:e,storyId:`story_${t.key}_${e}`}}return{type:"other",site:t}}(t),s={site:t,config:n,page:o,version:e};switch(o.type){case"home":await async function(t){const e=document.querySelector(".layout--right-rail");if(!e)return void console.error("[Smart Answers] No block shown: cannot find the reference position for discovery block.");await S(t);const n=T(t);M(t,n),e.insertAdjacentElement("beforebegin",n)}(s);break;case"story":const[t,e]=await Promise.all([x(o.postId),y()]);await F({...s,story:t,anonymous_id:e});break;default:b("[Discovery] No discovery block for page type: "+o.type)}})({key:"pcworld",hostname:"www.pcworld.com",name:"PCWorld",lang:"en",ref_story:"2013610"},t)}();
