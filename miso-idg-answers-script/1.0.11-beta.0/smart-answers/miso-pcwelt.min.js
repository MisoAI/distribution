!function(){"use strict";var t=Object.freeze({aff_type:"random",...function(){const t=document.currentScript;if(!t||!t.src)return{};const e=document.createElement("a");e.href=t.src;const s={};for(const[t,n]of new URLSearchParams(e.search))"q"!==t&&(s[t]=""===n||n);return s}(),...function(){const t={};for(const[e,s]of new URLSearchParams(window.location.search))e.startsWith("miso_answers_")&&e.length>13&&"miso_answers_api_key"!==e?t[e.substring(13)]=""===s||s:e.startsWith("miso_")&&e.length>5&&"miso_api_key"!==e?t[e.substring(5)]=""===s||s:"q"!==e&&"qs"!==e||(t[e]=s);return t}()}),e="1.0.11-beta.0";const s=[{key:"dell",name:"Dell",image:"image/sponsor/dell.svg"},{key:"nvidia",name:"NVIDIA",image:"image/sponsor/nvidia.svg"}];var n=function(){if(t.sponsor)return s.find((e=>e.key===t.sponsor))||void 0}(),i="1.10.1";function o(...t){const e=t.length;if(0===e)return(new AbortController).signal;if(1===e)return t[0];const s=new AbortController;for(const e of t)if(e&&e.addEventListener){if(e.aborted)return AbortSignal.abort(e.reason);e.addEventListener("abort",(()=>s.abort(e.reason)))}return s.signal}const r=Object.freeze({ASK:"ask",SEARCH:"search",RECOMMENDATION:"recommendation",INTERACTIONS:"interactions"}),a=Object.freeze({QUESTIONS:"questions",RELATED_QUESTIONS:"related_questions",SEARCH:"search",AUTOCOMPLETE:"autocomplete",MGET:"mget",USER_TO_PRODUCTS:"user_to_products",USER_TO_CATEGORIES:"user_to_categories",USER_TO_ATTRIBUTES:"user_to_attributes",USER_TO_TRENDING:"user_to_trending",USER_TO_HISTORY:"user_to_history",PRODUCT_TO_PRODUCTS:"product_to_products",UPLOAD:"upload"});var c=Object.freeze({__proto__:null,GROUP:r,NAME:a});function u(t,e){if(!t)return;const s=t.indexOf(e);s>-1&&t.splice(s,1)}function l(t){return Array.isArray(t)?t:void 0===t?[]:[t]}function h(t){return null!=t?""+t:t}function d(t){if("object"!=typeof t)return t;const e={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&void 0!==t[s]&&(e[s]=t[s]);return e}function _(t,e,s){Object.defineProperties(t,(s="string"==typeof s?[s]:s).reduce(((t,s)=>(t[s]={get:()=>{const t=e[s];return"function"==typeof t?t.bind(e):t}},t)),{}))}function p(t,e){for(const s in e)e.hasOwnProperty(s)&&Object.defineProperty(t,s,{value:e[s]})}function m(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}class f{constructor(t,{duration:e=0,onDuration:s,offDuration:n,state:i}={}){if("function"!=typeof t)throw Error("Callback must be a function: "+t);y(s),y(n),y(e),this._callback=t,Object.defineProperty(this,"durations",{value:Object.freeze({on:void 0!==s?s:e,off:void 0!==n?n:e})}),this._value=this._state=!!i,this._active=!0}get active(){return this._active}get state(){return this._state}get value(){return this._value}set value(t){if(this._value===(t=!!t))return;!function(t){if(!t._timeout)return;clearTimeout(t._timeout),t._timeout=void 0}(this);const e=this.durations[t?"on":"off"];e?this._timeout=setTimeout((()=>g(this,t)),e):g(this,t),this._value=t}disconnect(){this._active=!1}}function g(t,e){t._state!==e&&(t._state=e,t._active&&t._callback(e))}function y(t,e){if(void 0!==e&&(isNaN(e)||0>e))throw Error(`${t} must be a non-negative number: ${e}`)}function b(t,e,{root:s=t.ownerDocument}={}){for(;t&&t!==s;t=t.parentElement){const s=e(t);if(void 0!==s)return s}}function v(t){const{tagName:e}=t;customElements.define(e,t);for(const t of document.querySelectorAll(e))customElements.upgrade(t)}async function w(t){return new Promise(((e,s)=>{window.requestAnimationFrame((async n=>{try{await t(n),e()}catch(t){s(t)}}))}))}async function k(t,{area:e=.5,duration:s=1e3,signal:n}={}){var i;return t="string"==typeof(i=t)?document.querySelector(i):i,new Promise(((i,o)=>{const r=new f((t=>{t&&(r.disconnect(),a.disconnect(),i())}),{onDuration:s}),a=new IntersectionObserver((t=>{r.value=t[0].isIntersecting}),{threshold:e});a.observe(t),n&&n.addEventListener&&n.addEventListener("abort",(()=>{r.disconnect(),a.disconnect(),o(new DOMException("Aborted","AbortError"))}))}))}function E(t){return(t=""+t)&&t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function x(){return(crypto&&crypto.randomUUID?crypto.randomUUID():void 0)||function(){if(!URL||!URL.createObjectURL||URL.revokeObjectURL||!Blob)return;const t=URL.createObjectURL(new Blob),e=""+t;return URL.revokeObjectURL(t),e.substring(e.lastIndexOf("/")+1)}()||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){const e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}function C(t,e){const s=window.localStorage.getItem(t),n=function(t){const e="; "+document.cookie,s=`; ${encodeURIComponent(t)}=`,n=e.indexOf(s);if(0>n)return;const i=n+s.length,o=e.indexOf(";",i);return decodeURIComponent(0>o?e.substring(i):e.substring(i,o))}(t),i=s||n||""+e();return i&&!s&&window.localStorage.setItem(t,i),i&&!n&&function(t,e){document.cookie=`${encodeURIComponent(t)}=${encodeURIComponent(e)}; max-age=31536000; path=/`}(t,i),i}function I(t){return new O(t)}class O{constructor(t){this._value=t;const e=t=>{this._value=t};p(this,{set:e,args:(...t)=>e(t),t:()=>e(!0),f:()=>e(!1),merge:t=>e({...this._value,...t})})}get value(){return this._value}}class S{constructor(){const t=this;t.promise=new Promise(((e,s)=>{t.resolve=e,t.reject=s})),Object.freeze(this)}}class R{constructor(){this._index=-1,this._done=!1,this._aborted=!1,this._abortReason=void 0,this._error=void 0}get aborted(){return this._aborted}get abortReason(){return this._abortReason}get done(){return this._done}update(t,e=!1){this._done||(this._value=t,this._done=e,this._index++,this._resolution&&(this._resolution.resolve(),this._resolution=void 0))}error(t){this._error=t,this._resolution&&(this._resolution.reject(t),this._resolution=void 0)}abort(t){this._aborted=!0,this._abortReason=t,this._resolution&&(t instanceof Error?this._resolution.reject(t):this._resolution.resolve(),this._resolution=void 0)}async*[Symbol.asyncIterator](){for(let t=0;;t=this._index+1){if(this._error)throw this._error;if(this._aborted)break;if(t>this._index&&(this._resolution||(this._resolution=new S),await this._resolution.promise),this._aborted)break;if(yield this._value,this._done)break}}}var $="1.10.1";let A;try{A=document.currentScript}catch(t){}async function T(t){try{let e=function(t){return document.head.querySelector(`link[href="${t}"]`)}(t);return e||(e=document.createElement("link"),e.rel="stylesheet",e.href=t,document.head.appendChild(e)),async function(t){await async function(t){if(t.sheet)return;return new Promise(((e,s)=>{let n;t.onerror=()=>{n&&clearInterval(n),s()},n=setInterval((()=>{t.sheet&&(n&&clearInterval(n),e())}),100)}))}(t),await async function(t){if(N(t))return;return new Promise((e=>{let s;s=setInterval((()=>{N(t)&&(s&&clearInterval(s),e())}),100)}))}(t)}(e)}catch(t){console.error(t)}}function N(t){for(const e of document.styleSheets)if(e.ownerNode===t)return!0;return!1}function q(t){let e;return s=>{e&&clearTimeout(e),e=setTimeout((()=>{e=void 0,s()}),t)}}const U=100,P=4;function j(t){const e=function({speed:t=U,acceleration:e=P}={}){if("function"==typeof t)return t;if("number"!=typeof t)throw Error("Invalid speed: "+t);if("number"!=typeof e)throw Error("Invalid acceleration: "+e);return(s,n)=>{let i=t*(Math.random()+.5);return e>0&&void 0!==n&&s>n&&(i*=1+(s-n)*e/1e3),i}}(t);return(t,s,n,i)=>{const o=e(n,s);return t+Math.max(i-n,0)*o/1e3}}const L=Symbol.for("miso:resources");class M{constructor(){this._resources=new Map;const t=window[L]||[];for(const e of t)try{const[t,s]=e;this.push([t,s])}catch(t){}}push([t,e]){D(this._resources,t).resolve(e)}async get(t){return D(this._resources,t).promise}}function D(t,e){if(t.has(e))return t.get(e);const s=new S;return t.set(e,s),s}function z(){return window[L]||(window[L]=new M)}class B{constructor(t,e){this._dispatchRequested=!1,this._requests=[],this._run=t,this._error=e||(t=>console.error(t)),this._bulkId=0,this._dispatch=this._dispatch.bind(this)}get info(){return{bulkId:this._bulkId,index:this._requests.length}}async run(t){const e=new S;return this._requests.push({action:t,resolution:e}),this._requestDispatch(),e.promise}_requestDispatch(){this._dispatchRequested||(this._dispatchRequested=!0,setTimeout(this._dispatch))}_dispatch(){if(!this._dispatchRequested)return;this._dispatchRequested=!1;const t=this._requests,e=this._bulkId++;this._requests=[];try{this._run(t,{bulkId:e})}catch(t){this._error(t)}}}class Q{constructor({target:t,error:e,replays:s=[]}={}){if(this._error=e||(t=>console.error(t)),!Array.isArray(s))throw Error("Replays option must be an array of strings: "+s);this._replays=new Set(s),this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={},t&&this._injectSubscribeInterface(t)}emit(t,e){const s={data:e,meta:{name:t,ts:Date.now()}},n=this._namedCallbacks[t];if(n)for(const t of n)t(s);for(const t of this._unnamedCallbacks)t(s);this._shallStoreForReplay(t)&&(this._pastEvents[t]||(this._pastEvents[t]=[])).push(s)}on(t,e){return this._checkName(t),this._checkCallback(e),this._on(t,this._wrapCallback(e))}once(t){this._checkName(t);const e=this;return new Promise(((s,n)=>{const i=e._on(t,(t=>{setTimeout((()=>i()));try{s(t)}catch(t){n(t)}}))}))}clear(){this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={}}_checkName(t){if("string"!=typeof t)throw Error("Event name should be a string: "+t)}_checkCallback(t){if("function"!=typeof t)throw Error("Event callback should be a function: "+t)}_shallStoreForReplay(t){return this._replays.has(t)}_wrapCallback(t){const e=this;return({data:s,meta:n})=>{try{t(s,n)}catch(t){e._error(t)}}}_on(t,e){if("*"===t?this._unnamedCallbacks.push(e):(this._namedCallbacks[t]||(this._namedCallbacks[t]=[])).push(e),"*"===t)for(const t in this._pastEvents)this._pastEvents[t].forEach(e);else this._pastEvents[t]&&this._pastEvents[t].forEach(e);return()=>this._off(t,e)}_off(t,e){if("*"===t)u(this._unnamedCallbacks,e);else{const s=this._namedCallbacks[t];s&&u(s,e)}}_injectSubscribeInterface(t){_(t,this,["on","once"])}}function F(t,e){return Object.freeze([...e&&e.meta&&e.meta.path||[],...t?[t]:[]])}class G{constructor(t,e){const s=function(t,e){if(void 0!==t&&"string"!=typeof t&&void 0===e&&(e=t,t=void 0),void 0!==t&&("string"!=typeof t||!t))throw Error(`Invalid Component name: "${t}"`);return Object.freeze({name:t,parent:e,path:F(t,e),uuid:x()})}(t,e);p(this,{meta:s});const n=this._error=this._error.bind(this);(this._events=new Q({error:n,replays:["child"]}))._injectSubscribeInterface(this),this._warn=this._warn.bind(this),(e=s.parent)&&e._events&&e._events.emit("child",this)}_warn(...t){const e=this.meta.parent;(e&&e._warn||console.warn)(...t)}_error(...t){const e=this.meta.parent;(e&&e._error||console.error)(...t)}}!function(t,e){const s=Symbol.for(e);Object.defineProperty(t,s,{value:!0}),Object.defineProperty(t,"isTypeOf",{value:e=>e&&e instanceof t||"function"==typeof e.constructor&&!0===e.constructor[s]})}(G,"miso:component");class W extends G{constructor(t,e,{libName:s,keyName:n}={}){switch(super(t,e),this._events._replays.add("register"),this._libraries={},this._libResolutions={},this._libName=s,typeof n){case"string":this._keyFn=t=>t[n];break;case"function":this._keyFn=n;break;default:throw Error("Expect keyName to be a string or a function: "+n)}}isRegistered(t){return this._checkKey(t),!!this._libraries[t]}get registered(){return Object.values(this._libraries)}async whenRegistered(t){if(this.isRegistered(t))return this._libraries[t];const{promise:e}=this._libResolutions[t]||(this._libResolutions[t]=new S);return e}register(...t){for(const e of t)this._register(e)}_checkKey(t){if("string"!=typeof t||!t)throw Error("Expect key to be a non-empty string: "+t)}_checkLib(t){if("function"!=typeof t)throw Error("Expect lib to be a class or function: "+t)}_register(t){this._checkLib(t);const e=this._keyFn(t);this._checkKey(e);const s=this._libraries||(this._libraries={});s[e]=t,this._libResolutions[e]&&this._libResolutions[e].resolve(t),this._events.emit("register",t)}}class H{constructor(t,e){this._callback=t,this._options=e||{},!1!==e&&(this._intersection=new IntersectionObserver(this._handleIntersection.bind(this),{threshold:e.area||.5}),this._continuity=new f(this._handleContinuity.bind(this),{onDuration:e.duration||1e3})),this._displayed=void 0,this._intersecting=!1,this._triggered=new Set}observe(t){!1!==this._options&&this._intersection.observe(t)}unobserve(t){!1!==this._options&&this._intersection.unobserve(t)}display(t){!1!==this._options&&(this._triggered.has(t)&&(t=void 0),this._displayed!==t&&(this._displayed=t,this._continuity.value=!1,this._syncContinuity()))}disconnect(){!1!==this._options&&(this._continuity.disconnect(),this._intersection.disconnect())}get triggeredCount(){return this._triggered.size}get triggered(){return new Set(this._triggered)}_syncContinuity(){this._continuity.value=this._intersecting&&void 0!==this._displayed}_handleIntersection(t){this._intersecting=t[0].isIntersecting,this._syncContinuity()}_handleContinuity(t){const e=this._displayed;if(t&&void 0!==e){if(this._triggered.has(e))return;this._triggered.add(e),this._displayed=void 0,this._callback(e)}}}class V{constructor(t){this._ac=new AbortController,this._timeout=t,this.touch()}clear(){void 0!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0)}touch(){this.clear(),this._timeoutId=setTimeout((()=>this.abort()),this._timeout)}get signal(){return this._ac.signal}abort(t){this.clear(),this._ac.abort(t||Error(`Stall timeout: data stay unchanged for ${this._timeout/1e3} seconds.`))}}const K=Object.freeze({DATA_ENDPOINT:"https://api-edge.askmiso.com/v1",EVENT_ENDPOINT:"https://api.askmiso.com/v1"});class Y{constructor(t,e){this._client=t,this._root=e,this._bulk=new B(this._runBulkFetch.bind(this),t._error.bind(t))}async fetch(t,e,{method:s="POST",headers:n,timeout:i,sendApiKeyByHeader:o}={}){const{apiKey:r,request:a={}}=this._client.options;i=i||a.timeout,(o=o||a.sendApiKeyByHeader)&&(n={...n,"X-API-KEY":r});const c="GET"!==s&&null!=e?JSON.stringify(e):void 0,u=i?AbortSignal.timeout(i):void 0,l=await(this._root._customFetch||window.fetch)(t,d({method:s,headers:n,body:c,cache:"no-cache",mode:"cors",signal:u})),h=await l.json();if(l.status>=400||h.errors){var _=Error(h.message);throw _.data=h,_.status=l.status,_}return h}get bulkInfo(){return this._bulk.info}async fetchForBulk(t,e,s,{method:n}={}){if(n&&"POST"!==n)throw Error("Non-POST API is not supported in bulk mode: "+url);return this._bulk.run({apiGroup:t,apiName:e,payload:s})}async _runBulkFetch(t){const e=this.url(["bulk"]),s={requests:t.map((({action:{apiGroup:t,apiName:e,payload:s}})=>({api_name:`${t}/${e}`,body:s})))},{data:n}=await this.fetch(e,s);for(let e=0,s=t.length;s>e;e++){const{resolution:s}=t[e],{error:i,status_code:o,body:r}=n[e];o>=400||i?s.reject({status_code:o,body:r}):s.resolve(r)}}sendBeacon(t,e,{method:s}={}){if(s&&"POST"!==s)throw Error("Non-POST API is not supported in useBeacon mode: "+t);if(!(this._root._customSendBeacon?this._root._customSendBeacon(t,JSON.stringify(e)):window.navigator.sendBeacon(t,JSON.stringify(e))))throw Error("Send beacon unsuccessful: "+t)}url(t,e={}){const{apiKey:s,request:n={}}=this._client.options,i=e.sendApiKeyByHeader||n.sendApiKeyByHeader,o=t.filter((t=>t)).join("/"),r=`${this.getApiEndpoint(o)}/${o}`;return i?r:`${r}?api_key=${window.encodeURIComponent(s)}`}getApiEndpoint(t){const{dataEndpoint:e=K.DATA_ENDPOINT,eventEndpoint:s=K.EVENT_ENDPOINT}=this._client.options;return"interactions"===t?s:e}applyUrlPasses(t,{apiGroup:e,apiName:s,url:n}){const i=this._client;for(const o of this._root._urlPasses)try{n=o({client:i,apiGroup:e,apiName:s,url:n})||n}catch(e){t.error(e)}return n}applyPayloadPasses(t,{apiGroup:e,apiName:s,payload:n}){const i=this._client;for(const o of this._root._payloadPasses)try{n=o({client:i,apiGroup:e,apiName:s,payload:n})||n}catch(e){t.error(e)}return n}}class Z extends G{constructor(t,e){super(e,t),this._apiPath=e,this.helpers=t.helpers,this.clientOptions=t._client.options,this.context=t._client.context}async _run(t,e,s={}){const{bulk:n}=s,i=n?{bulk:this.helpers.bulkInfo}:void 0,o=this._apiPath,r=this._url({apiGroup:o,apiName:t,payload:e,options:s}),a={apiGroup:o,apiName:t,payload:e=this._preprocess({apiGroup:o,apiName:t,payload:e,options:s}),url:r,options:s};this._events.emit("request",{...a,...i});const c=await this._send(a),u={...a,response:c};return this._events.emit("response",{...u,...i}),this._postprocess(u)}_preprocess({apiGroup:t,apiName:e,payload:s}){return this.helpers.applyPayloadPasses(this,{apiGroup:t,apiName:e,payload:s})}_url({apiGroup:t,apiName:e,options:s}){const n=this.helpers.url([t,e],s);return this.helpers.applyUrlPasses(this,{apiGroup:t,apiName:e,url:n,options:s})}async _send({apiGroup:t,apiName:e,url:s,payload:n,options:{bulk:i,...o}={}}){return i?this.helpers.fetchForBulk(t,e,n):this.helpers.fetch(s,n,o)}_postprocess({response:t}){return t.data}}const{GROUP:X,NAME:J}=c;class tt extends Z{constructor(t){super(t,X.INTERACTIONS)}async upload(t,e){try{return await this._run(J.UPLOAD,t,e)}catch(t){if(400!==t.status||!t.message||-1>=t.message.toLowerCase().indexOf("playground"))throw t;this._warn("Ignore interactions uploaded to playground app.")}}_url({apiGroup:t,apiName:e,options:s}){const n=this.helpers.url([this._apiPath],s);return this.helpers.applyUrlPasses(this,{apiGroup:t,apiName:e,url:n,options:s})}_preprocess({apiGroup:t,apiName:e,payload:s}){return e===J.UPLOAD&&(s=this._normalizeUploadPayload(s)),super._preprocess({apiGroup:t,apiName:e,payload:s})}_normalizeUploadPayload(t){if("object"!=typeof t)throw Error("Interactions payload has to be either an object or an array of objects: "+t);return Array.isArray(t)||(t=[t]),{data:t}}async _send({options:{useBeacon:t=!0,...e}={},...s}){if(t){const{url:t,payload:n}=s;return this.helpers.sendBeacon(t,n,e),{}}return super._send({...s,options:e})}}const{GROUP:et,NAME:st}=c;class nt extends Z{constructor(t){super(t,et.ASK)}async questions(t,e={}){if("string"==typeof t&&"{"!==t.charAt(0))return new it(this,{question_id:t},e);const s=await this._run(st.QUESTIONS,t,e);return new it(this,s,e)}async _questions(t,e){return this._run(st.QUESTIONS,t,e)}async _get(t,e){return this._run(`${st.QUESTIONS}/${t}/answer`,void 0,{...e,method:"GET"})}async relatedQuestions(t,e={}){return this._run(st.RELATED_QUESTIONS,t,e)}}class it{constructor(t,{question_id:e},s={}){this._api=t,this._questionId=e,this._ac=new AbortController,this._options=s}get questionId(){return this._questionId}async get(t){return this._api._get(this._questionId,{...this._options,...t})}abort(t){this._ac.abort(t)}[Symbol.asyncIterator](){let{pollingInterval:t,signal:e,stallTimeout:s=12e4,...n}=this._options;const i=new V(s);let r;e=o(this._ac.signal,i.signal,e);return function(t,{interval:e=1e3,errorLimit:s=10,onError:n,onResponse:i,signal:o}={}){if(o&&o.aborted)return[];let r,a=0,c=-1,u=-1,l=!1;function h(){r&&clearInterval(r),l=!0}const d=new R;return r=setInterval((async()=>{const e=++c;let r,_;try{if([r,_]=await t(o?{signal:o}:{}),l||u>e)return;u=e,i&&i(r,_),a=0}catch(t){return n&&n(t),a++,void(a>s&&(h(),d.error(t)))}d.update(r,_),_&&h()}),e),o&&o.addEventListener&&o.addEventListener("abort",(()=>{h(),d.abort(o.reason)})),d}((async({}={})=>{const t=await this.get();return[t,t.finished]}),{interval:t,signal:e,onResponse:(t,e)=>{var s,n;e?i.clear():(n=t,(s=r)&&s.answer_stage===n.answer_stage&&s.answer.length===n.answer.length||i.touch()),r=t},...n})[Symbol.asyncIterator]()}}const{GROUP:ot,NAME:rt}=c;class at extends Z{constructor(t){super(t,ot.SEARCH)}async search(t,e){return this._run(rt.SEARCH,t,e)}async autocomplete(t,e){return this._run(rt.AUTOCOMPLETE,t,e)}async multipleGet(t,e){return this._run(rt.MGET,t,e)}}const{GROUP:ct,NAME:ut}=c;class lt extends Z{constructor(t){super(t,ct.RECOMMENDATION)}async userToProducts(t,e){return this._run(ut.USER_TO_PRODUCTS,t,e)}async userToCategories(t,e){return this._run(ut.USER_TO_CATEGORIES,t,e)}async userToAttributes(t,e){return this._run(ut.USER_TO_ATTRIBUTES,t,e)}async userToTrending(t,e){return this._run(ut.USER_TO_TRENDING,t,e)}async userToHistory(t,e){return this._run(ut.USER_TO_HISTORY,t,e)}async productToProducts(t,e){return this._run(ut.PRODUCT_TO_PRODUCTS,t,e)}}class ht extends G{constructor(t,e){super("api",t),this._client=t,this.helpers=new Y(t,e),this.interactions=new tt(this),this.ask=new nt(this),this.search=new at(this),this.recommendation=new lt(this)}}var dt=Object.freeze({__proto__:null,Api:ht,ApiBase:Z,ApiHelpers:Y,Interactions:tt,Ask:nt,Search:at,Recommendation:lt});class _t extends G{constructor(t){super("context",t),this._client=t}}var pt={api:dt,context:{Context:_t}};class mt{constructor(t){p(this,{install:t})}}class ft extends W{constructor(t){super("plugins",t,{libName:"plugin class",keyName:"id"}),this._root=t,this._currentScript=document.currentScript,this._events._replays.add("install").add("subtree"),this._installed={},this._installedResolutions={},this._useRequests={},this._subtrees=[],this.context=new gt(this,pt),this.plugins=new yt(this)}isInstalled(t){return this._checkKey(t),!!this._installed[t]}get installed(){return Object.values(this._installed)}get(t){return this._installed[t]}getPluginClass(t){return this._libraries[t]}use(t,e){if("function"==typeof t&&t.id&&"string"==typeof t.id)return this.register(t),void this.use(t.id,e);let s;if("string"==typeof t&&this.isInstalled(t))return s=this.get(t),void this._tryConfig(s,e);"string"!=typeof t||this.isRegistered(t)?(s=this._instantiate(t,e),this._install(s)):(this._useRequests[t]||(this._useRequests[t]=[])).push(e)}async install(t,e){return this.use(t,e),"string"!=typeof t||this.isRegistered(t)||await this._tryRegisterRemotely(t),this.whenInstalled(t)}async whenInstalled(t){if("function"==typeof t&&t.id&&"string"==typeof t.id&&(t=t.id),this.isInstalled(t))return this.get(t);const{promise:e}=this._installedResolutions[t]||(this._installedResolutions[t]=new S);return e}addSubtree(t){this._subtrees.push(t),this._events.emit("subtree",t)}addPayloadPass(t){if("function"!=typeof t)throw Error("Expect parameter to be a function: "+t);this._root._payloadPasses.push(t)}addUrlPass(t){if("function"!=typeof t)throw Error("Expect parameter to be a function: "+t);this._root._urlPasses.push(t)}setCustomFetch(t){if("function"!=typeof t)throw Error("Expect parameter to be a function: "+t);this._root._customFetch=t}setCustomSendBeacon(t){if("function"!=typeof t)throw Error("Expect parameter to be a function: "+t);this._root._customSendBeacon=t}_tryConfig(t,e){void 0!==e&&("function"==typeof t.config?(t.config(e),this._events.emit("config",[t,e])):this._warn(`Attempt to pass options to plugin "${t.id}", which offers no config() method.`))}_instantiate(t,e){switch(typeof t){case"string":this._checkKey(t);const s=this._libraries[t];if(!s)throw Error("Plugin class not found: "+t);const n=new s;return p(n,{id:t}),this._tryConfig(n,e),n;case"function":return new mt(t)}throw Error("Unexpected parameters: "+t)}_install(t){if("function"!=typeof t.install)throw Error("Expect plugin.install to be a function: "+t);try{t.installed=!1,t.install(this.MisoClient,this.context),t.installed=!0}catch(t){throw t}t.id&&(this._installed[t.id]=t,this._installedResolutions[t.id]&&(this._installedResolutions[t.id].resolve(t),delete this._installedResolutions[t.id])),this._events.emit("install",t)}_register(t){super._register(t),this._fulfillUseRequests(t.id)}_fulfillUseRequests(t){const e=this._useRequests[t];if(e){for(const s of e)try{this.use(t,s)}catch(t){this._error(t)}delete this._useRequests[t]}}async _tryRegisterRemotely(t){if(t.startsWith("std:"))try{return void await this._registerStdRemotely(t)}catch(t){console.error(t)}throw Error("Cannot register plugin remotely: "+t)}async _registerStdRemotely(t){const{version:e}=this._root,s="dev"===e?`plugin:${t}@dev:${this.MisoClient.uuid}`:`plugin:${t}@${e}`;if(!document.querySelector(`script[data-request="${s}"]`)){const n=document.createElement("script");n.async=!0,n.src=function(t,e,s){const n=t.slice(4);if("dev"===e){const t=s.src,e=t.indexOf("?"),i=0>e?t.length:e,o=t.lastIndexOf("/",i)+1,r=t.indexOf(".",o),a=0>r?"":t.slice(r,i);return`${t.slice(0,o)}plugins/${n}${a}`}return`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@${e}/dist/umd/plugins/${n}.min.js`}(t,e,this._currentScript),n.setAttribute("data-request",s),document.head.appendChild(n)}const n=await(new z).get(s);!this.isRegistered(t)&&this.register(n)}}class gt{constructor(t,e){_(this,t,["getPluginClass","addSubtree","addPayloadPass","addUrlPass","setCustomFetch","setCustomSendBeacon","whenInstalled","whenRegistered"]),p(this,{classes:e})}}class yt{constructor(t){_(this,t,["installed","registered","isInstalled","isRegistered","whenInstalled","whenRegistered","get","register","use","install"])}}const bt=new class extends G{constructor(){super(),this._events._replays.add("create"),this._pluginRoot=new ft(this),this._clients=[],this._payloadPasses=[],this._urlPasses=[],this._customFetch=void 0,this._customSendBeacon=void 0,this.version=i,this._cmdRes=new S}get instances(){return[...this._clients]}async any(){return this._clients[0]||this._any||(this._any=(await this._events.once("create")).data)}get cmdDone(){return this._cmdRes.promise}};var vt=Object.freeze({__proto__:null,viewable:k,debounce:q});const{currentScript:wt}=document;class kt extends G{static attach(){(window.MisoClients||(window.MisoClients=[])).push(kt),window.MisoClient?window.MisoClient!==kt&&console.warn(`window.MisoClient already exists: (${window.MisoClient.version}).`):window.MisoClient=kt}constructor(t){super("client",bt),this._config(t),this.context=new _t(this),this.api=new ht(this,bt),function(t){bt._clients.push(t),bt._events.emit("create",t)}(this)}get version(){return kt.version}_config(t){this.options=Object.freeze(this._normalizeOptions(t))}_normalizeOptions(t={}){if("string"==typeof t&&(t={apiKey:t}),t.readConfigFromScriptUrl&&(t={...this._readConfigFromScriptUrl(),...t}),!t.apiKey)throw Error("Require API key to initialize miso client.");return t.dataEndpoint=t.dataEndpoint||t.apiHost,t.eventEndpoint=t.eventEndpoint||t.apiHost,delete t.apiHost,d(t)}_readConfigFromScriptUrl(){return d({apiKey:new URL(new Request(wt.src||wt.href).url).searchParams.get("api_key")||void 0})}}kt.helpers=vt,p(kt,{uuid:x()});var Et=function(t){const e=bt._pluginRoot;return bt.MisoClient=e.MisoClient=t,_(t,bt,["version","instances","any","meta","on","once","cmdDone"]),_(t,e,["plugins"]),t}(kt);const{GROUP:xt,NAME:Ct}=c;class It{constructor(t){this._plugin=t}get anonymous_id(){return this._anonymousId||this._autoAnonymousId||(this._autoAnonymousId=C("miso_anonymous_id",x))}set anonymous_id(t){t=h(t),this._anonymousId=t,this._plugin._events.emit("set",`anonymous_id = '${t}'`)}get user_id(){return this._userId}set user_id(t){t=h(t),this._userId=t,this._plugin._events.emit("set",`user_id = '${t}'`)}get user_hash(){return this._userHash}set user_hash(t){if("string"!=typeof t&&void 0!==t)throw Error("User hash must be a string");this._userHash=t,this._plugin._events.emit("set",`user_hash = '${t}'`)}get user_type(){return this._userType}set user_type(t){this._userType=t,this._plugin._events.emit("set",`user_type = '${t}'`)}}function Ot(){const t=new URLSearchParams(window.location.search);let e=d({source:t.get("utm_source")||void 0,medium:t.get("utm_medium")||void 0,name:t.get("utm_campaign")||void 0,term:t.get("utm_term")||void 0,content:t.get("utm_content")||void 0});return 0===Object.keys(e).length?void 0:e}class St{constructor(t){this._plugin=t,this._config={search:!0},this.interface=Object.freeze({config:this.config.bind(this)})}config(t={}){if("object"!=typeof t)throw Error("Config options must be an object or undefined: "+t);for(const e of t){if(!this._config.hasOwnProperty(e))continue;const s=this._config[e],n=t[e];n!==s&&(this._config[e]=s,this._plugin._events.emit("config",`${e}: ${s} -> ${n}`))}return Object.freeze({...this._config})}}function Rt(t){const{context:e={}}=t,s={...e.custom_context,sdk_version:i};return s.uuid||(s.uuid=x()),{...t,context:{...e,custom_context:s}}}function $t({text:t="Miso"}={}){return"%c"+t}function At({color:t="#fff",background:e="#334cbb"}={}){return`color: ${t}; background-color: ${e}; padding: 2px 2px 1px 4px;`}function Tt(t){const e=typeof t;return"function"===e||"object"===e&&!Array.isArray(t)?[t]:t}Et.plugins.register(class{constructor(t={}){this._options=t}static get id(){return"std:debug"}install(t){this._injectComponents(t),t.debug=(...t)=>this._logr(...t)}config(t={}){this._options={...this._options,...t}}_injectComponents(t,e=[]){t.on("child",(t=>this._injectComponents(t,e))),t.on("subtree",(s=>this._injectComponents(s,e.concat(t.meta.path)))),t.on("*",((s,n)=>this._handleEvent(t,n,s,e)))}_handleEvent(t,{name:e},s,n=[]){if("child"===e||"subtree"===e)return;const i=n.concat(t.meta.path);if(i.length||"create"!==e){switch(i[0]){case"client":if("api"===i[1])return void this._handleApiEvent(e,{...s,groupName:i[2]});break;case"plugins":return void(1===i.length?this._handlePluginsEvent(e,s):this._handlePluginSpecificEvent(i[1],i.slice(2),e,s))}this._logw(i.join("."),e,s)}else this._handleCreateClient(e,s)}_handleCreateClient(t,e){this._logw("client",t,e)}_handleApiEvent(t,{groupName:e,apiName:s,url:n,bulk:i,...o}){const r=new URL(n).pathname,a=["api",t];if(i&&a.push(`(bulk ${i.bulkId})`),a.push("POST "+r),"interactions"===e){const t=o.payload.data[0],{type:e,custom_action_name:s,context:{custom_context:{property:n}={}}={}}=t,i="custom"===e&&s?`${e}:${s}`:e;a.push(n?`${i} (${n})`:""+i)}a.push([{...o,url:n}]),this._log(...a)}_handlePluginsEvent(t,e){let s=[];Array.isArray(e)&&(s=e.slice(1),e=e[0]),this._log("plugins",t,""+(e.id||"(anonymous)"),[e,...s])}_handlePluginSpecificEvent(t,e,s,n){this._logw([t,e.join(".")],s,n)}_getPath(t){const e=[];for(let s=t;s;s=s.meta.parent)s.meta.name&&e.push(s.meta.name);return e.reverse()}_logr(...t){const e=this._options.console||{};console.log($t(e),At(e),...t)}_log(t,e,...s){const n=this._options.console||{};console.log($t(n),At(n),function(t){return`<${"string"==typeof t?t:t.filter((t=>t)).join("/")}>`}(t),function(t){return`[${t}]`}(e),...s)}_logw(t,e,s){void 0===s?this._log(t,e):Array.isArray(s)?this._log(t,e,...s.map(Tt)):this._log(t,e,Tt(s))}},class{constructor(t={}){this._options=t,this.id="std:dry-run",this.name="dry-run"}static get id(){return"std:dry-run"}install(t,{addUrlPass:e}){e(this._modifyUrl.bind(this))}_modifyUrl({apiGroup:t,apiName:e,url:s}){return"interactions"===t&&"upload"===e?function(t,e,s){if("string"!=typeof e)throw Error("Expect URL parameter to be a string: "+e);return void 0===s&&(s="1"),t+(0>t.indexOf("?")?"?":"&")+encodeURIComponent(e)+"="+encodeURIComponent(""+s)}(s,"dry_run","1"):s}}),Et.plugins.use(class extends G{static get id(){return"std:user"}constructor(){super("user"),this._contexts=new WeakMap}install(t,e){e.addSubtree(this),t.on("create",this._injectClient.bind(this)),e.addPayloadPass(this._modifyPayload.bind(this))}_injectClient(t){const e=new It(this);var s,n;this._contexts.set(t,e),s=e,Object.defineProperties(t.context,(n="string"==typeof(n=["anonymous_id","user_id","user_hash"])?[n]:n).reduce(((t,e)=>(t[e]={get:()=>s[e],set:t=>{s[e]=t}},t)),{}))}_modifyPayload({client:t,apiGroup:e,apiName:s,payload:n}){return e===xt.INTERACTIONS&&s===Ct.UPLOAD?this._modifyPayloadForInteractions(t,n):e===xt.ASK&&s===Ct.QUESTIONS?this._modifyPayloadForAsk(t,n):this._modifyPayloadForOthers(t,n)}_modifyPayloadForOthers(t,e){const{user_id:s,user_hash:n,anonymous_id:i}=t.context;return{...s?{user_id:s,user_hash:n}:{anonymous_id:i},...e}}_modifyPayloadForAsk(t,e){const{user_id:s,user_hash:n,user_type:i,anonymous_id:o}=t.context,r=s?{user_id:s,user_hash:n}:{anonymous_id:o};return s&&i&&(r.user_type=i),{...r,...e}}_modifyPayloadForInteractions(t,{data:e}){const{anonymous_id:s,user_id:n}=t.context,i=d({anonymous_id:s,user_id:n});return{data:e=e.map((t=>({...i,...t})))}}}),Et.plugins.use(class{static get id(){return"std:page-info"}constructor(){}install(t,{addPayloadPass:e}){e(this._modifyPayload.bind(this))}_modifyPayload({apiGroup:t,apiName:e,payload:s}){return"interactions"===t&&"upload"===e?this._modifyPayloadForInteractions(s):s}_modifyPayloadForInteractions({data:t}){return{data:t=t.map((t=>({...t,context:{...d({page:d({url:window.location.href,referrer:document.referrer,title:document.title}),campaign:Ot()}),...t.context}})))}}}),Et.plugins.use(class extends G{static get id(){return"std:auto-events"}constructor(){super("auto-events"),this._contexts=new WeakMap}install(t,e){e.addSubtree(this),t.on("create",this._injectClient.bind(this)),e.addPayloadPass(this._captureApiRequest.bind(this))}_injectClient(t){const e=new St(this);this._contexts.set(t,e),t.autoEvents=e.interface}_captureApiRequest({client:t,apiGroup:e,apiName:s,payload:n}){if(e===r.SEARCH)if(s===a.SEARCH)this._captureSearchApiRequest(t,n)}_captureSearchApiRequest(t,{q:e}){if(!e||"*"===e)return;const s=this._contexts.get(t);s&&s._config.search&&t.api.interactions.upload({type:"search",search:{keywords:e},context:{custom_context:{channel:"miso_api"}}})}}),Et.plugins.use(class{static get id(){return"std:interactions"}constructor(){}install(t,{addPayloadPass:e}){e(this._modifyPayload.bind(this))}_modifyPayload({apiGroup:t,apiName:e,payload:s}){return"interactions"===t&&"upload"===e?this._modifyPayloadForInteractions(s):s}_modifyPayloadForInteractions({data:t}){return{data:t.map(Rt)}}});const Nt="data-miso-product-id",qt="default",Ut="_organic",Pt=Object.freeze({CONTAINER:"container",BANNER:"banner",QUERY:"query",FEEDBACK:"feedback",PRODUCTS:"products",CATEGORIES:"categories",ATTRIBUTES:"attributes",RESULTS:"results",ITEMS:"items",QUESTION:"question",ANSWER:"answer",SOURCES:"sources",RELATED_RESOURCES:"related_resources",QUERY_SUGGESTIONS:"query_suggestions",RELATED_QUESTIONS:"related_questions",AFFILIATION:"affiliation",ERROR:"error"}),jt=new Set([Pt.PRODUCTS,Pt.CATEGORIES,Pt.ATTRIBUTES,Pt.RESULTS,Pt.ITEMS,Pt.QUESTION,Pt.ANSWER,Pt.SOURCES,Pt.RELATED_RESOURCES,Pt.QUERY_SUGGESTIONS,Pt.RELATED_QUESTIONS,Pt.AFFILIATION]);function Lt(t){return jt.has(t)}const Mt=Object.freeze({CONTAINER:"container",BANNER:"banner",LIST:"list",QUERY:"query",RADIO:"radio",TEXT:"text",AFFILIATION:"affiliation",ERROR:"error"}),Dt=Object.freeze({IMPRESSION:"impression",VIEWABLE:"viewable",CLICK:"click"}),zt=[Dt.IMPRESSION,Dt.VIEWABLE,Dt.CLICK],Bt=Object.freeze({UNTRACKED:"untracked",TRACKING:"tracking",TRIGGERED:"triggered"}),Qt=Object.freeze({INITIAL:"initial",LOADING:"loading",ERRONEOUS:"erroneous",READY:"ready",ONGOING:"ongoing",DONE:"done",EMPTY:"empty",NONEMPTY:"nonempty"});function Ft(t){if(0>zt.indexOf(t))throw Error("Unrecognized event type: "+t)}function Gt(t){return t=function(t){return t.replaceAll("-","_")}(t=t.replace(/[A-Z]/g,(t=>"_"+t.toLowerCase())))}function Wt(t){if(void 0===t)return;let[e,s]=l(t);return"object"==typeof e&&(s=e,e=void 0),[e,s]}function Ht(t){t=l(t);for(const e of t)if("function"!=typeof e)throw Error("Expect data processor options to be a function: "+e);return t}function Vt(...t){return!1!==t[t.length-1]&&le(t,((t,e)=>{return Object.assign(t,{...e,payload:(s=t.payload,n=e.payload,{...s,...n,...Kt("_meta",s,n)})});var s,n}))}function Kt(t,e,s){const n=e&&e[t],i=s&&s[t],o=n?i?{...n,...i}:n:i;return void 0!==o?{[t]:o}:{}}function Yt(...t){return!1!==t[t.length-1]&&le(t,((t,e)=>{for(const[s,n]of Object.entries(e))t[s]=Zt(t[s],n);return t}))}function Zt(t,e){return!1===(e=Wt(e))[0]?e:t&&e?[e[0]||t[0],Xt(t[1],e[1])]:e||t}function Xt(t,e){return{...t,...e,link:{...t&&t.link,...e&&e.link},templates:{...t&&t.templates,...e&&e.templates}}}function Jt(...t){return t.flat().filter(Boolean)}function te(t={},e={}){return!1===e||!1===t?e:{...t,...e}}function ee(...t){return!1!==t[t.length-1]&&le(t,((t,e)=>{return Object.assign(t,{...e,preprocess:(s=t.preprocess,n=e.preprocess,s&&s.length?n&&n.length?[...s,...n]:s:n)});var s,n}))}const se=[{key:"api",normalize:function([t,e]=[]){if(!1===t)return{actor:!1};let s;if("object"==typeof t&&void 0===e&&(e=t,t=void 0),t&&-1!==t.indexOf("/")&&([s,t]=t.split("/")),t&&"string"!=typeof t||void 0!==e&&"object"!=typeof e)throw Error(`Invalid arguments for useApi(): ${t}, ${e}`);return d({group:s,name:t,payload:e})},merge:Vt},{key:"layouts",normalize:function(t={}){if(!1===t)return!1;const{[Pt.RESULTS]:e,...s}=t;void 0!==e&&(console.warn(`useLayouts({ ${[Pt.RESULTS]}: ... }) is deprecated, use useLayouts({ ${[Pt.PRODUCTS]}: ... }) instead`),t={...s,[Pt.PRODUCTS]:e});const n={};for(const[e,s]of Object.entries(t))n[Gt(e)]=Wt(s);return n},merge:Yt},{key:"dataProcessor",normalize:Ht,merge:Jt},{key:"trackers",normalize:function(t){return t},merge:function(...t){return!1!==t[t.length-1]&&le(t,((t,e)=>Object.assign(t,{...e,impression:te(t.impression,e.impression),viewable:te(t.viewable,e.viewable),click:te(t.click,e.click)})))}},{key:"interactions",normalize:function(t){if(void 0===t)return;if(!1===t)return{handle:()=>{}};const e=l(t.preprocess);for(const t of e)if("function"!=typeof t)throw Error("Expect preprocess options to be a function: "+t);if(t.handle&&"function"!=typeof t.handle)throw Error("Expect handle options to be a function: "+t.handle);return{...t,preprocess:e}},merge:ee},{key:"autocomplete",normalize:function(t){if(void 0===t)throw Error("Expect autocomplete options to be an object or a boolean value: "+t);"boolean"==typeof t&&(t={actor:t});const e=Ht(t.processData);return{...t,processData:e}},merge:function(...t){return!1!==t[t.length-1]&&le(t,((t,e)=>Object.assign(t,{...e,api:Vt(t.api,e.api),processData:Jt(t.processData,e.processData)})))}}];class ne{constructor(){this._events=new Q({target:this}),this._globals={}}_notify(t){this._events.emit(t,{name:t,value:this[t]})}}class ie{constructor(t={},e={}){this._events=new Q({target:this}),this._defaults=e,this._context=t||{},this._locals={},p(this,{resolved:new re(this),defaults:e}),t&&t.on&&(this._unsubscribes=[t.on("*",(t=>this._notify(t.name)))])}_notify(t){this._events.emit(t,{name:t,value:this.resolved[t]})}_destroy(){for(const t of this._unsubscribes||[])t();this._unsubscribes=[]}}class oe{constructor(t,e,s,n,i){this._options=t,this._store=e,this._key=s,this._normalize=t=>void 0!==t?n(t):void 0,this._merge=i}get(){return this._store[this._key]}set(t){this._set(this._normalize(t))}merge(t){this._set(this._merge(this.get(),this._normalize(t)))}_set(t){this._store[this._key]=t,this._options._notify(this._key)}}class re{constructor(t){this._options=t}}for(const{key:t,normalize:e,merge:s}of se)Object.defineProperty(ne.prototype,t,{get:function(){const n="_"+t;return this[n]||(this[n]=new oe(this,this._globals,t,e,s))}}),Object.defineProperty(ie.prototype,t,{get:function(){const n="_"+t;return this[n]||(this[n]=new oe(this,this._locals,t,e,s))}}),Object.defineProperty(re.prototype,t,{get:function(){const e=this._options,n=e._context[t];return s(e._defaults[t],n&&n.get(),e._locals[t])}});const ae=["api","layouts","dataProcessor","trackers","interactions"];function ce(t,e=ae){for(const s of e)ue(t,s)}function ue(t,e){if("api"===e)Object.assign(t,{useApi(...t){return this._options.api.merge(t),this},clearApi(){return this._options.api.set(),this}});else{const n=(s=e).charAt(0).toUpperCase()+s.slice(1);Object.assign(t,{["use"+n](t){return this._options[e].merge(t),this},["clear"+n](){return this._options[e].set(),this}})}var s}function le(t,e){let s={};for(const n of t)n&&(s=e(s,n));return d(s)}class he extends G{constructor(t,e,s){super(t,e),this._plugin=e,this._client=s,this._options=new ne}}function de(){return"data"}function _e(t){return t?"view:"+t:"view"}ce(he.prototype);class pe{constructor(){(this._events=new Q)._injectSubscribeInterface(this),this._states={},p(this,{states:new Proxy(this._states,{set(){}})})}update(t,e,{silent:s=!1}={}){this._states[t]=Object.freeze(e),s||this._events.emit(t,e)}trigger(t,e){this._events.emit(t,e)}}class me{constructor(t){this._hub=t,this._sessionIndex=0,_(t,this,["active"])}get active(){const{session:t}=this._hub.states;return!(!t||!t.active)}new({force:t=!1}={}){const e=this._hub.states.session;if(e&&!e.active&&!t)return;const s=this._create();this._hub.update("session",s)}start(){const t=this._hub.states.session||this._create();t.active||this._hub.update("session",{...t,active:!0})}restart(){this.new({force:!0}),this.start()}_create(){return Object.freeze({active:!1,uuid:x(),index:this._sessionIndex++,meta:{}})}}const fe=new Set([Pt.PRODUCTS,Pt.SOURCES,Pt.RELATED_RESOURCES]);function ge({property:t,misoId:e,request:s},{event:n,values:i,manual:o}){let r;if(e)try{r=function(t){const e=t.split("-"),s=""+e[2].substring(1)+e[1]+e[0];return Math.floor(parseInt(s,16)/1e7)-12219292800}(e)}catch(t){}const a=s&&s._meta&&s._meta.question_source,c=function(t){return fe.has(t)}(t),u=c?i.map((t=>"string"==typeof t?t:t.product_id)).filter((t=>t)):[],l=c?void 0:i.map((t=>t.text||t.id||t));return d({type:"viewable"===n?"viewable_impression":n,product_ids:u,miso_id:e,context:{custom_context:d({api_ts:r,property:t,channel:t===Pt.AFFILIATION?i[0]&&i[0].channel:void 0,items:l,positions:t===Pt.AFFILIATION?i.map((t=>t.position)):void 0,trigger:o?"manual":"auto",question_source:a})}})}function ye(t,e){if(!e)return!1;const{session:s}=t.states;return s&&s.index===e.index}class be{constructor(t,{source:e,options:s}){this._hub=t,this._source=e,this._options=s,this._unsubscribes=[t.on("session",(t=>this._handleSession(t))),t.on("request",(t=>this._handleRequest(t)))]}get active(){return!1!==this._options.resolved.api.actor}get source(){return this._source}_handleSession(t){this.active&&(this._session&&t.index===this._session.index||(this._ac&&this._ac.abort({type:"new-session",message:"A new session is created, discarding the old one."}),this._ac=new AbortController),this._session=t,this._emitResponse({session:t}))}async _handleRequest(t){if(!this.active)return;const{session:e}=this._hub.states,{session:s,...n}=t;this._emitResponse({session:e,request:n});try{const{signal:s}=this._ac||{},i={...t.options,signal:s},o=await this._source({session:e,...t,options:i});if(o&&o[Symbol.asyncIterator]){let t;for await(t of o){if(!ye(this._hub,e))break;this._emitResponse({session:e,request:n,value:t})}}else this._emitResponseWithSessionCheck({session:e,request:n,value:o})}catch(t){this._error(t),this._emitResponseWithSessionCheck({session:e,request:n,error:t})}}_emitResponseWithSessionCheck(t){ye(this._hub,t.session)&&this._emitResponse(t)}_emitResponse(t){this._hub.update("response",t)}_error(t){console.error(t)}_destroy(){this._ac&&this._ac.abort({type:"data-actor-destroy",message:"Data actor is destroyed."});for(const t of this._unsubscribes)t();this._unsubscribes=[]}}class ve{constructor(t){this._get="function"==typeof t?t:()=>t,this._handlers=[],this._elementUpdatedHandlers=[],this.sync()}get current(){return this._element}on(t,e){if("element"===t)return this._onElementUpdated(e);const s=this._get();return s&&s.addEventListener(t,e),this._handlers.push({event:t,handler:e}),()=>this._off(t,e)}_off(t,e){const s=this._get();s&&s.removeEventListener(t,e),function(t,e){if(!t)return;const s=t.findIndex(e);s>-1&&t.splice(s,1)}(this._handlers,(t=>t.handler===e))}_onElementUpdated(t){return this._elementUpdatedHandlers.push(t),()=>{u(this._elementUpdatedHandlers,t)}}sync({silent:t=!1}={}){const e=this._get();if(this._element===e)return;if(this._offAllFromCurrentElement(),e)for(const{event:t,handler:s}of this._handlers)e.addEventListener(t,s);const s=this._element;if(this._element=e,!t)for(const t of this._elementUpdatedHandlers)try{t(e,s)}catch(t){console.error(t)}}_offAllFromCurrentElement(){if(this._element)for(const{event:t,handler:e}of this._handlers)this._element.removeEventListener(t,e)}destroy(){this._offAllFromCurrentElement()}}const{IMPRESSION:we,VIEWABLE:ke,CLICK:Ee}=Dt,{UNTRACKED:xe,TRIGGERED:Ce}=Bt,Ie=Object.freeze({[we]:xe,[ke]:xe,[Ee]:xe});class Oe{constructor(t){this.sessionId=t,this._states=new Map}getFullState(t){const e=this._states.get(this._getKey(t));return e?{...e}:Ie}get(t,e){const s=this._states.get(this._getKey(t));return s&&s[e]||xe}set(t,e,s){Ft(e),function(t){if(t!==Bt.UNTRACKED&&t!==Bt.TRACKING&&t!==Bt.TRIGGERED)throw Error("Unrecognized tracking status: "+t)}(s);for(const n of l(t))this._setOne(n,e,s)}untriggered(t,e){return t.filter((t=>this.get(t,e)!==Ce))}_getKey(t){return t.product_id||t.text||t.id||t}_setOne(t,e,s){(function(t,e,s){if(t.has(e))return t.get(e);const n=s(e);return t.set(e,n),n}(this._states,this._getKey(t),(()=>({...Ie}))))[e]=s}}class Se{constructor(t){this._view=t,this._role=t.role,this._states=new Oe(this._getSessionId())}get options(){return this._view._getTrackerOptions()}getState(t){return this._states.getFullState(t)}_trigger(t,e,s={}){if(Ft(t),this._syncSession(),0===(e=this._states.untriggered(l(e),t)).length)return;this._states.set(e,t,Bt.TRIGGERED);const n="results"===this._role?"products":this._role,i=this._getMisoId(),o=this._getRequestPayload();this._view.hub.trigger("interaction",ge({property:n,misoId:i,request:o},{event:t,values:e,meta:s}))}_syncSession(){const t=this._getSessionId();t&&(this._states&&t===this._states.sessionId||(this._states=new Oe(t)))}_getSessionId(){const{session:t}=this._getViewState()||{};return t&&t.uuid}_getMisoId(){const t=this._getViewState();return t&&t.meta&&t.meta.miso_id||void 0}_getRequestPayload(){const{request:t}=this._getViewState()||{};return t&&t.payload}_getViewState(){return this._view.hub.states[_e(this._role)]}}for(const t of zt)Se.prototype[t]=function(e,s){this._trigger(t,e,s)};class Re{constructor(t,e){this._events=new Q({target:this}),this._views=t,p(this,{role:e,interface:new $e(this)})}get hub(){return this._views._hub}get element(){return this._element}set element(t){t!==this._element&&(this._element&&this._safeApplyOnLayout("unrender",this._element),this._element=t,this._proxyElement&&this._proxyElement.sync(),this._events.emit("element",t),this.refresh({force:!0}))}get proxyElement(){return this._proxyElement||(this._proxyElement=new ve((()=>this.element))),this._proxyElement}get layout(){return this._layout}set layout(t){if(t===this._layout)return;if(t&&"function"!=typeof t.render)throw Error("Render function is mandatory in a layout.");const{element:e}=this;e&&this._safeApplyOnLayout("unrender",e),this._safeApplyOnLayout("destroy"),this._layout=t,t&&"function"==typeof t.initialize&&t.initialize(this),this.refresh({force:!0})}get tracker(){return this._tracker||(this._tracker=new Se(this)),this._tracker}async refresh({force:t=!1,data:e}={}){if(!this._layout)return;const{element:s}=this;if(!s)return;const n=this._data;this._data=e=this._sliceData(e||this._views._getData());const{session:i,status:o,ongoing:r,request:a,meta:c}=e;if(!t&&!(i&&i.active))return;if(!t&&((u=e)===(l=n)||u&&l&&u.status===l.status&&u.error===l.error&&u.value===l.value&&u.ongoing===l.ongoing&&function(t,e){return t===e||t&&e&&t.uuid===e.uuid}(u.session,l.session)))return;var u,l;const h=(t={},e)=>{!1!==t&&this.updateState({session:i,status:o,ongoing:r,request:a,meta:c,...t},e)};try{await this._layout.render(s,e,{notifyUpdate:h})}catch(t){this._error(t),h({error:t})}}updateState({session:t,status:e,ongoing:s,request:n,meta:i,error:o},{silent:r=!1}={}){o&&(e=Qt.ERRONEOUS);const a=this._state=Object.freeze(d({session:t,status:e,ongoing:s,request:n,meta:i,error:o})),{role:c}=this;this.hub.update(_e(c),a,{silent:r})}_getTrackerOptions(){return this._views._getTrackerOptions(this.role)}_sliceData({value:t,error:e,status:s,meta:n,...i}){const o={value:this.role===Pt.ERROR?e:t&&t[this.role],status:s,data:t,meta:n,...i};return this.role===Pt.CONTAINER&&(o.meta={...n,empty:this._isContainerEmpty(t)}),d(o)}_isContainerEmpty(t){const{element:e}=this;if(!e)return!1;for(const{role:s}of e.components){if(!Lt(s))return!1;let e=t&&t[s];if(s===Pt.QUERY_SUGGESTIONS){const t=this.hub.states.suggestions;e=t&&t.value}if(e&&0!==e.length)return!1}return!0}_syncSize(){this._element&&this._safeApplyOnLayout("syncSize",this._element)}_safeApplyOnLayout(t,...e){if(this._layout&&"function"==typeof this._layout[t])try{this._layout[t](...e)}catch(t){this._error(t)}}_error(t){this._views._error(t)}_destroy(){this._safeApplyOnLayout("destroy"),this._proxyElement&&this._proxyElement.destroy()}}class $e{constructor(t){_(this,t,["role","layout","element","proxyElement","refresh","on","tracker"])}}const Ae=Object.freeze({impression:Object.freeze({}),viewable:Object.freeze({area:.5,duration:1e3}),click:Object.freeze({lenient:!1}),watch:!1});function Te(t,e){return!!e&&{...t,...e}}class Ne{constructor(t,{workflow:e,extensions:s,layouts:n,roles:i=[],options:o}){this._hub=t,this._workflowName=e,this._extensions=s,this._layoutFactory=n,this._options=o,this._containers=new Map,this._views={},this._trackers=new Ue(this,i);for(const t of i)this._views[t]=new Re(this,t);p(this,{interface:new qe(this)});const r=()=>this.syncSize();window.addEventListener("resize",r),this._unsubscribes=[()=>window.removeEventListener("resize",r),t.on(de(),(()=>this.refresh())),o.on("trackers",(()=>this._syncTrackers())),o.on("layouts",(()=>this._syncLayouts()))],this._syncTrackers(),this._syncLayouts()}get trackers(){return this._trackers}addContainer(t){if(this._containers.has(t))return;const e=new Re(this,Pt.CONTAINER);e.layout=this._createLayout(Pt.CONTAINER),e.element=t,this._containers.set(t,e);const{components:s}=t;for(const t of s)this.addComponent(t)}removeContainer(t){const e=this._containers.get(t);if(!e)return;const{components:s}=t;for(const t of s)this.removeComponent(t);e._destroy(),this._containers.delete(t)}addComponent(t){this._getViewByElement(t).element=t}removeComponent(t){this._getViewByElement(t).element=void 0}updateComponentRole(t,e,s){}refreshElement(t){const e=t.isContainer?this._containers.get(t):this._getViewByElement(t);e&&e.refresh({force:!0})}_getViewByElement(t){let{role:e}=t;if(!e)throw Error("Component must have a role");return this.get(e)}_syncLayouts(){const{layouts:t}=this._options.resolved;if(!1===t){for(const t of this._containers.values())t.layout=void 0;for(const t of Object.values(this._views))t.layout=void 0}else for(let[e,[s,n]]of Object.entries(t)){const t=()=>this._layoutFactory.create(s,{...n,role:e,workflow:this._workflowName});if(e===Pt.CONTAINER)for(const e of this._containers.values())e.layout=t();else this.get(e).layout=t()}}_createLayout(t){const e=this._options.resolved.layouts[t];if(!e)return;const[s,n]=e;return this._layoutFactory.create(s,{...n,role:t,workflow:this._workflowName})}get(t){return this._views[t]||(this._views[t]=new Re(this,t))}get views(){return this._getViews(!0)}_getViews(t=!0){return t?[...this._containers.values(),...Object.values(this._views)]:[...Object.values(this._views),...this._containers.values()]}syncSize(){for(const t of Object.values(this._views))t._syncSize()}async refresh({force:t}={}){const e=this._getData();await Promise.all(this._getViews(!0).map((s=>s.refresh({force:t,data:e}))))}_getData(){const{[de()]:t}=this._hub.states;if(!this._data||this._data.data!==t){const e=t&&t.session&&t.session.active?t.error?Qt.ERRONEOUS:t.value?Qt.READY:Qt.LOADING:Qt.INITIAL,s=e===Qt.READY?!!t.ongoing:void 0;this._data=Object.freeze({...t,status:e,ongoing:s})}return this._data}_syncTrackers(){this._trackerOptions=this._options.resolved.trackers}_getTrackerOptions(t){return function(t){if(!1===t)return!1;if(!0===t&&(t={}),"object"!=typeof t)throw Error("Invalid options: "+t);const{impression:e={},viewable:s={},click:n={},...i}=t;return d({...Ae,...i,impression:Te(Ae.impression,e),viewable:Te(Ae.viewable,s),click:Te(Ae.click,n)})}(this._trackerOptions&&this._trackerOptions[t]||!1)}_error(t){console.error(t)}_destroy({}={}){for(const t of this._getViews(!1))t._destroy();for(const t of this._unsubscribes)t();this._unsubscribes=[]}}class qe{constructor(t){this._actor=t,_(this,t,["syncSize","refresh","trackers"])}get(t){return this._actor.get(t).interface}get all(){return this._actor.views.map((t=>t.interface))}}class Ue{constructor(t,e){this._views=t;for(const s of e)Object.defineProperty(this,s,{get:()=>t.get(s).tracker})}}class Pe{constructor(t){this._hub=t,this._unsubscribes=[t.on("feedback",(t=>this._trigger(t)))]}_trigger(t){const{[de()]:e}=this._hub.states,{question_id:s}=e&&e.value||{};if(!s)return;const{request:n}=e||{},{payload:i}=n||{};this._hub.trigger("interaction",this._buildInteraction(t,{question_source:i&&i._meta&&i._meta.question_source}))}_buildInteraction({value:t,unselected:e},{question_source:s}){return{type:"feedback",context:{custom_context:{result_type:"answer",question_source:s,value:e?"unselected":t}}}}_destroy(){for(const t of this._unsubscribes)t();this._unsubscribes=[]}}class je{constructor(t,{source:e,options:s}){this._hub=t,this._source=e,this._options=s,this._index=-1,this._unsubscribes=[t.on("input",(()=>this._sync())),s.on("autocomplete",(()=>this._syncOptions()))],this._sync(!0)}get active(){return!1!==this._options.resolved.autocomplete.actor}get source(){return this._source}_syncOptions(){this._sync(!0)}async _sync(t=!1){if(!this.active)return;const{input:e}=this._hub.states,s=e&&e.value&&e.value.trim()||void 0;if(i=e,(!(n=this._input)&&!i||n&&i&&n.value===i.value)&&!t)return;var n,i;this._input=e;const o=++this._index;if(this._clearTimeout(),this._abortPendingRequest({type:"new-input",message:"A new input renders previous autocomplete request obsolete."}),this._emitCompletions({index:o,input:e,status:s?Qt.LOADING:Qt.INITIAL}),s)try{const t=await this._fetchCompletions(e);if(this._index!==o)return;this._emitCompletions({index:o,input:e,status:Qt.READY,value:t.completions})}catch(t){if(this._error(t),this._index!==o)return;this._emitCompletions({index:o,input:e,status:Qt.ERRONEOUS,error:t})}}async _getCompletions(t){return await this._fetchCompletions(t)}async _fetchCompletions({value:t}){const{api:e}=this._options.resolved.autocomplete,{group:s,name:n}=e,{signal:i}=this._ac||{},o={...e.options,signal:i},r={...e.payload,q:t};return await this._source({group:s,name:n,payload:r,options:o})}_clearTimeout(){this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=void 0)}_abortPendingRequest(t){this._ac&&this._ac.abort(t),this._ac=new AbortController}_emitCompletions(t){t.source="actor",this._hub.update("completions",t)}_error(t){console.error(t)}_destroy(){this._ac&&this._ac.abort({type:"autocomplete-actor-destroy",message:"Autocomplete actor is destroyed."});for(const t of this._unsubscribes)t();this._unsubscribes=[]}}class Le{constructor(t,{client:e,options:s}){this._client=e,this._options=s,this._unsubscribes=[t.on("interaction",(t=>this._handle(t)))]}_handle(t){t=l(t);const{preprocess:e=[],handle:s}=this._options.resolved.interactions;for(const s of e)t=t.map(s);0!==t.length&&(s?s(t):this._client.api.interactions.upload(t,{merge:!0}))}destroy(){for(const t of this._unsubscribes)t();this._unsubscribes=[]}}function Me(t){return async({group:e,name:s,payload:n,options:i})=>e===r.ASK&&s===a.QUESTIONS?t.api.ask.questions(n,i):t.api[e]._run(s,n,i)}class De{constructor({role:t,workflow:e,...s}={}){p(this,{role:t,workflow:e,options:s}),this._unsubscribes=[],this._rendered=new WeakMap,this._element=void 0,this._notifyUpdate=void 0,this._pending=void 0}async render(t,e,s={}){this._syncElement(t);const n=this._rendered.get(t),i=I(!1);e=this._preprocess({state:e,rendered:n},{skip:i.t})||e,this._updatePending(e,s),i.value||this._handleInput({state:e,rendered:n},s)}_syncElement(t){this._element!==t&&this._rendered.delete(this._element),this._element=t}_preprocess({state:t}){return t}_updatePending(t,e){this._pending=[Object.freeze(t),e]}_takePending(){const t=this._pending;return this._pending=void 0,t}_handleInput(){this._requestRaf()}_requestRaf(){this._requested||(this._requested=!0,w((t=>this._doRaf(t))))}_doRaf(t){this._requested&&(this._requested=!1,this._applyRender(t))}_applyRender(t,e={}){if(!this._pending)return;let[s,{notifyUpdate:n}]=this._takePending();s=Object.freeze({...s,timestamp:t});const i=this._rendered.get(this._element),o=I([]),r=I({});this._render(this._element,{state:s,rendered:i,timestamp:t},{notifyUpdate:o.args,writeToState:r.merge,...e}),this._rendered.set(this._element,Object.freeze({...s,...r.value})),n&&n(...o.value)}_render(){throw Error("Unimplemented")}destroy(){for(const t of this._unsubscribes)t();this._unsubscribes=[],this._element=void 0,this._notifyUpdate=void 0,this._pending=void 0}}function ze(...t){return t.reduce(((t,e)=>(t[e]=function(t){return()=>{throw Error(`Template '${t}' is not implemented.`)}}(e),t)),{})}function Be(t,e,s){const{className:n,templates:i}=t;return`<div class="${n}__item-info-container">${""+(i.titleBlock||Ge)(t,e,s)+(i.descriptionBlock||He)(t,e,s)+(i.priceBlock||Ke)(t,e,s)+(i.ctaBlock||Je)(t,e,s)}</div>`}function Qe(t,e,s){const{className:n,templates:i}=t;return`<div class="${n}__item-info-container">${""+(i.titleBlock||Ge)(t,e,s)+(i.descriptionBlock||He)(t,e,s)+(i.priceBlock||Ke)(t,e,s)}</div>`}function Fe(t,e,s){const{className:n,templates:i}=t;return`<div class="${n}__item-info-container">${""+(i.titleBlock||Ge)(t,e,s)+(i.dateBlock||Ve)(t,e,s)+(i.descriptionBlock||He)(t,e,s)+(i.ctaBlock||Je)(t,e,s)}</div>`}function Ge({className:t},{title:e}){return e?`<div class="${t}__item-title">${E(e)}</div>`:""}function We({className:t},{brand:e,brand_logo:s}){if(!e&&!s)return"";return`<div class="${t}__item-brand-container">${s?`<img class="${t}__item-brand-logo" src="${s}"${e?` alt="${e}"`:""}>`:`<div class="${t}__item-brand">${e}</div>`}</div>`}function He({className:t},{snippet:e,description:s}){return e?`<div class="${t}__item-snippet">${e}</div>`:s?`<div class="${t}__item-desc">${E(s)}</div>`:""}function Ve({className:t,templates:e},{created_at:s,updated_at:n,published_at:i}){const o=i||s||n;return o?`<div class="${t}__item-date">${ss(o,e.date)}</div>`:""}function Ke(t,e){const{className:s,templates:n}=t,{sale_price:i,original_price:o,currency:r="USD"}=e,a=i||o;if(!a)return"";const c=void 0!==o&&void 0!==i&&o>i,u=e.discount_rate_percent||(c?Math.floor(100*(1-i/o)):void 0);let l="";if(c&&(l+=`<span class="${s}__item-original-price miso-price" data-currency="${r}">${o}</span><br>`),l+=`<span class="${s}__item-price miso-price" data-currency="${r}">${a}</span>`,u){l+=` <span class="${s}__item-discount-rate">${(n.discountRateText||Ye)(t,{...e,discount_rate_percent:u})}</span>`}return`<div class="${s}__item-price-container">${l}</div>`}function Ye(t,{discount_rate_percent:e}){return`(${e}% off)`}function Ze(t,e,s){const{className:n,templates:i}=t,{cover_image:o}=e;if(!o)return"";return`<div class="${n}__item-cover-image-container">${`<img class="${n}__item-cover-image" src="${o}">`}${s.brand?(i.brandBlock||We)(t,e,s):""}</div>`}function Xe({className:t},e,{index:s}){return`<div class="${t}__item-index-container"><span class="${t}__item-index miso-citation-index" data-index="${s+1}"></span></div>`}function Je(t,e,s){const{className:n,templates:i}=t,o=ns.asFunction(i.cta)(t,e,s);return o?`<div class="${n}__item-cta-container">${o}</div>`:""}function ts({className:t,options:e={}},{product_id:s,url:n},{classSuffix:i="item-body",role:o="item",...r}={}){const{link:a={}}=e,{target:c="_blank",rel:u="noopener"}=a,l=!1!==r.link&&n?"a":"div";return[`<${l} class="${t}__${i}" ${o?`data-role="${o}"`:""} ${s?`${Nt}="${s}"`:""} ${!1!==r.link&&n?`href="${n}" target="${c}" rel="${u}"`:""}>`,`</${l}>`]}const es=Object.freeze({locale:"en-US",year:"numeric",month:"short",day:"numeric"});function ss(t,e=es){switch(typeof e){case"function":return e(t);case"string":return new Date(t).toLocaleDateString(e);case"object":return new Date(t).toLocaleDateString(e.locale||es.locale,e);default:throw Error("Invalid date format: "+e)}}const ns=Object.freeze({tagPair:ts,formatDate:ss,escapeHtml:E,asFunction:function(t=""){return"function"==typeof t?t:()=>t}});class is extends De{constructor({className:t,templates:e,...s}={}){super(s),p(this,{className:t,templates:{...ze("root"),...e}})}_preprocess({state:t}){const e=this.templates.root(this,t);return{...t,html:e}}_render(t,{state:e}){t.innerHTML=e.html}}class os extends HTMLElement{static get tagName(){return"miso-banner"}async connectedCallback(){os.MisoClient.ui.layouts.create("banner").render(this)}}class rs extends De{static get category(){return Mt.CONTAINER}static get type(){return"container"}constructor({logo:t="auto",...e}={}){super({logo:t,...e})}_render(t,{state:e}){this._syncBanner(t),this._syncStatus(t,{state:e})}_syncBanner(t){const e=os.tagName,s=this._shallRenderBanner(t),n=t.querySelector(e);s&&!n?t.insertAdjacentHTML("beforeend",`<${e} visible-when="ready"></${e}>`):!s&&n&&n.remove()}_shallRenderBanner(t){const{logo:e}=this.options,{logo:s}=t,n=void 0!==s&&"auto"!==s?s:e;return"auto"===n?t.components.some((({role:t})=>function(t){return t===Pt.PRODUCTS||t===Pt.ANSWER}(t))):!!n}_syncStatus(t,{state:e}){if(!t)return;const{status:s,ongoing:n,meta:{miso_id:i,empty:o=!1}={}}=e,r=[s,o?Qt.EMPTY:Qt.NONEMPTY];s===Qt.READY&&r.push(n?Qt.ONGOING:Qt.DONE),t.setAttribute("status",r.join(" ")),i?t.setAttribute("miso-id",i):t.removeAttribute("miso-id")}}const as=Object.freeze({root:function(t,e){const{className:s,templates:n}=t,{status:i,value:o}=e;return"erroneous"!==i?"":`<div class="${s}"><div class="${s}__message">${n.message(t,o)}</div></div>`},message:function(t,e){return"Error: "+(e.message||e)}});class cs extends is{static get category(){return Mt.ERROR}static get type(){return"error"}static get defaultTemplates(){return as}constructor({className:t="miso-error",templates:e,...s}={}){super({className:t,templates:{...as,...e},...s})}}const us=Object.freeze({root:function(t){const{className:e,templates:s}=t;return`<div class="${e}"><div class="${e}__logo">${s.logo(t)}</div></div>`},logo:()=>'<svg viewBox="0 0 500 200"><path d="M131.1,39.4 C144.3,39.4 155,43.8 163.2,52.7 C171.3,61.3 175.2,72.9 175.2,87.6 L175.2,159.1 L140.4,159.1 L140.4,90.6 C140.4,78.7 134.6,71.5 123.7,71.5 C112.3,71.5 105.5,79.7 105.5,93.4 L105.5,159.1 L70.7,159.1 L70.7,90.6 C70.7,78.7 64.9,71.5 54,71.5 C42.6,71.5 35.8,79.7 35.8,93.4 L35.8,159.1 L1,159.1 L1,42.7 L35.8,42.7 L35.8,53.4 C42.1,44.1 52.6,39.4 67,39.4 C80.5,39.4 90.7,44.5 97.4,54.8 C104.6,44.5 115.8,39.4 131.1,39.4 Z M202,42.4 L238.4,42.4 L238.4,159.1 L202,159.1 Z M202,0 L238.4,0 L202,36.4 Z M302.6,76.6 C302.6,81.2 311.7,83.8 323,86.8 C339.2,90.3 360.5,98.7 360.3,124 C360.3,136.6 355.6,146.1 346.2,152.6 C336.8,158.9 325.3,162.1 311.5,162.1 C286.9,162.1 270,152.8 261.1,134.5 L291.6,117.3 C294.6,126.3 301.4,131 311.5,131 C319.9,131 324.2,128.7 324.2,123.8 C324.2,119.1 315,116.3 303.8,113.5 C287.6,109.1 266.5,101.2 266.5,77.5 C266.5,65.4 270.9,56.1 279.6,49.4 C288.5,42.6 299.5,39.4 312.4,39.4 C331.9,39.4 348.6,48.2 358.2,64.3 L328.2,80.3 C324.4,73.6 319.2,70.1 312.4,70.1 C305.9,70.1 302.6,72.2 302.6,76.6 Z M480.4,144.5 C468.4,156.3 453.7,162.1 436.3,162.1 C419,162.1 404.2,156.3 392.2,144.5 C380.3,132.6 374.2,118 374.2,100.8 C374.2,83.6 380.3,69.1 392.2,57.3 C404.2,45.4 419,39.4 436.3,39.4 C453.7,39.4 468.4,45.4 480.4,57.3 C492.4,69.1 498.5,83.6 498.5,100.8 C498.5,118 492.4,132.6 480.4,144.5 Z M417.1,120.5 C422.2,125.6 428.6,128.2 436.3,128.2 C444.1,128.2 450.4,125.6 455.5,120.5 C460.7,115.4 463.3,108.9 463.3,100.8 C463.3,92.6 460.7,86.1 455.5,81 C450.4,75.9 444.1,73.3 436.3,73.3 C428.6,73.3 422.2,75.9 417.1,81 C411.9,86.1 409.3,92.6 409.3,100.8 C409.3,108.9 411.9,115.4 417.1,120.5 Z" /></svg>'});function ls(t,e){const s=[];for(const n of e.entries){const e=t.e2b.get(n.element);e&&e.key===n.key||s.push(n)}return s}class hs{constructor(){this._k2b=new Map,this._e2b=new Map,this._entries=[]}get entries(){return[...this._entries]}get(t){return this._e2b.get(t)||void 0}update(t,e,s){const n=function(t,e,s){const n=new Map,i=new Map,o=[];for(let r=0;t.length>r;r++){const a=t[r],c=s[r],u=Object.freeze({index:r,key:a,value:e[r],element:c});n.set(a,u),i.set(c,u),o.push(u)}return{k2b:n,e2b:i,entries:o}}(t,e,s),i={k2b:this._k2b,e2b:this._e2b,entries:this._entries},o=ls(i,n),r=ls(n,i);return this._k2b=n.k2b,this._e2b=n.e2b,this._entries=n.entries,{bounds:o,unbounds:r}}clear(){const t=this._entries;return this._k2b=new Map,this._e2b=new Map,this._entries=[],{bounds:[],unbounds:t}}}class ds{constructor(){this._entries=new WeakMap}isTracked(t){return this._entries.has(t)}async track(t,e={}){if(!e)return!1;if(this._entries.get(t))return!1;const s=new AbortController,{signal:n}=s;this._entries.set(t,{ac:s});let i=!1;try{await k(t,{...e,signal:n}),i=!0}catch(t){if("AbortError"!==t.name)throw t}finally{this._entries.delete(t)}return i}untrack(t){const e=this._entries.get(t);e&&(e.ac.abort(),this._entries.delete(t))}}function _s(t){!function(t,e){const s=Object.getOwnPropertyDescriptors(e);for(const e in s){if("constructor"===e)continue;const{value:n}=s[e];void 0===t[e]&&"function"==typeof n&&(t[e]=n)}}(t,ps.prototype)}class ps{_initTrackable(){this._bindings=new hs,this._viewables=new ds}_syncBindings(t,e){const s=this._getItems(e)||[],n=s.map((t=>this._getItemKey(t))),i=this._getItemElements(t),{bounds:o,unbounds:r}=this._bindings.update(n,s,i);this._onBindingsUpdate(o,r)}_clearBindings(){const{bounds:t,unbounds:e}=this._bindings.clear();this._onBindingsUpdate(t,e)}_getItemKey(t){return t.product_id||t.text||t.id||t}_getItems(t){throw Error("Not implemented.")}_getItemElements(t){throw Error("Not implemented.")}_onBindingsUpdate(t,e){this._trackImpressions(t),this._untrackViewables(e),this._trackViewables(t)}_trackImpressions(t){if(0===t.length)return;const{impression:e}=this._view.tracker.options||{};e&&this._view.tracker.impression(t.map((({value:t})=>t)))}_untrackViewables(t){for(const{element:e}of t)this._viewables.untrack(e)}_trackViewables(t){if(0===t.length)return;const{viewable:e}=this._view.tracker.options||{};if(e)for(const{value:s,element:n}of t)(async()=>{await this._viewables.track(n,e)&&this._view.tracker.viewable([s])})()}_trackClick(t,e){const{click:s}=this._view.tracker.options||{};(function(t={},e){return!!t&&("function"==typeof t.validate?t.validate(e):!!t.lenient||0===e.button&&!e.defaultPrevented&&!!b(e.target,(t=>"A"===t.tagName&&t.href||void 0)))})(s,t)&&this._view.tracker.click([e.value])}_destroyTrackable(){const{unbounds:t}=this._bindings.clear();this._untrackViewables(t)}}const ms=Object.freeze({product:function(t,e,s,n){const{templates:i}=t,[o,r]=ts(t,s);return""+o+(i.imageBlock||Ze)(t,s,n)+(i.infoBlock||i.productInfoBlock||Qe)(t,s,n)+r},article:function(t,e,s,n){const{templates:i}=t,[o,r]=ts(t,s);return""+o+(i.imageBlock||Ze)(t,s,n)+(i.infoBlock||i.articleInfoBlock||Fe)(t,s,n)+(i.indexBlock||Xe)(t,s,n)+r},question:function(t,e,s){const[n,i]=ts(t,s);return`${n}${s.value||s.text||s}${i}`},root:function(t,e){const{className:s,role:n,templates:i}=t,{status:o}=e;return`<div class="${s} ${o}" ${n?`data-role="${n}"`:""}>${o===Qt.READY?i[o](t,e):""}</div>`},[Qt.READY]:function(t,e){const{templates:s}=t,n=t._getItems(e);return n&&n.length>0||e.ongoing?s.list(t,e,n):s.empty(t,e)},empty:()=>"",list:function(t,e,s){const{className:n,templates:i,options:o}=t,r=i.ordered?"ol":"ul";return`<${r} class="${n}__list" data-role="list" data-item-type="${o.itemType}">${i.items(t,e,s)}</${r}>`},ordered:!1,items:function(t,e,s,{offset:n=0}={}){const{templates:i}=t;let o=n;return s.map((s=>i.item(t,e,s,o++))).join("")},item:function(t,e,s,n){const{className:i,templates:o,options:r}=t,{itemType:a}=r;return`<li class="${i}__item">${o[a](t,e,s,{index:n})}</li>`},productInfoBlock:Qe,articleInfoBlock:Fe,brandBlock:We,titleBlock:Ge,descriptionBlock:He,dateBlock:Ve,priceBlock:Ke,discountRateText:Ye,ctaBlock:Je,cta:function(t,e,s){const{templates:n}=t,{url:i}=e;if(!i)return"";const[o,r]=ts(t,{url:i},{classSuffix:"item-cta",role:"cta"}),a=ns.asFunction(n.ctaText)(t,e,s);return a?`${o}${a}${r}`:""},imageBlock:Ze,indexBlock:Xe,helpers:ns});class fs extends is{static get category(){return Mt.LIST}static get defaultTemplates(){return ms}constructor({templates:t,itemType:e="product",...s}){super({templates:{...ms,...t},itemType:e,...s}),this._view=void 0,this._initTrackable()}initialize(t){this._view=t,this._unsubscribes.push(t.proxyElement.on("click",this._onClick.bind(this)))}_preprocess({state:t,rendered:e}){const s=this._shallRenderIncrementally(t,e),n=this._html(t,e,s);return{...t,incremental:s,html:n}}_shallRenderIncrementally(t,e){return this.options.incremental&&e&&e.value&&e.value.length>0&&t.status===Qt.READY&&e.status===Qt.READY&&t.session&&e.session&&t.session.id===e.session.id}_html(t,e,s){if(s){const s=e.value.length,n=(this._getItems(t)||[]).slice(s);return n.length>0?this.templates.items(this,t,n,{offset:s}):""}return this.templates.root(this,t)}_render(t,{state:e},{notifyUpdate:s}){const{incremental:n,html:i}=e;if(n)if(i){this._getListElement(t).insertAdjacentHTML("beforeend",i)}else s(!1);else t.innerHTML=i;this._syncBindings(t,e)}_unrender(){this._clearBindings()}_getItems(t){return t.value}_getListElement(t){return t.querySelector('[data-role="list"]')}_getItemElements(t){return t?Array.from(t.querySelectorAll('[data-role="item"]')):[]}_onClick(t){const e=t.target.closest('[data-role="item"]');if(!e)return;const s=this._bindings.get(e);s&&(this._trackClick(t,s),this._emitClickEvent(t,s))}_emitClickEvent(t,e){const{session:s}=this._view._state,{value:n,element:i}=e;this._view._events.emit("click",{session:s,value:n,element:i,domEvent:t})}destroy(){this._destroyTrackable(),this._view=void 0,super.destroy()}}_s(fs.prototype);const gs="miso-list";class ys extends fs{static get category(){return super.category}static get type(){return"list"}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return gs}constructor({className:t=gs,...e}={}){super({className:t,...e})}}const bs="miso-cards";const vs="miso-carousel",ws=Object.freeze({ready:function(t,e){const{templates:s}=t,n=t._getItems(e),i=n&&n.length>0,o=Object.getPrototypeOf(t.constructor).defaultTemplates.ready(t,e);return i?s.carousel(t,e,o):o},carousel:function(t,e,s){const{className:n,templates:i}=t;return`<div class="${n}__control-previous" data-role="previous">${i.previous(t,e)}</div><div class="${n}__viewport">${s}</div><div class="${n}__control-next" data-role="next">${i.next(t,e)}</div>`},previous:Es,next:Es}),ks=Object.freeze({...fs.defaultTemplates,...ws});function Es(t){const{className:e}=t;return`<svg class="${e}__control-button" shape-rendering="geometricPrecision" stroke="currentColor" stroke-width="24" fill="#fff" viewBox="-30 -30 358 572"><path d="M285.77 441c16.24 16.17 16.32 42.46.15 58.7-16.16 16.24-42.45 16.32-58.69.16l-215-214.47c-16.24-16.16-16.32-42.45-.15-58.69L227.23 12.08c16.24-16.17 42.53-16.09 58.69.15 16.17 16.24 16.09 42.54-.15 58.7l-185.5 185.04L285.77 441z"/></svg>`}const xs="miso-ui-icon",Cs=xs+"-svg-1_10_1",Is=`<symbol id="${xs}-send" viewBox="0 0 32 32"><path fill="currentColor" d="M11.499,19.173l5.801,-5.849c0.389,-0.392 1.022,-0.394 1.414,-0.006c0.392,0.389 0.395,1.022 0.006,1.414l-5.798,5.847l5.306,8.002c0.207,0.313 0.572,0.483 0.945,0.441c0.373,-0.042 0.691,-0.289 0.824,-0.64l9.024,-23.904c0.138,-0.366 0.05,-0.78 -0.226,-1.058c-0.276,-0.278 -0.689,-0.369 -1.057,-0.233l-24.004,8.892c-0.353,0.13 -0.602,0.448 -0.646,0.821c-0.044,0.373 0.125,0.74 0.438,0.948l7.973,5.325Z"/></symbol>`,Os=`<symbol id="${xs}-search" viewBox="0 0 24 24"><path fill="currentColor" d="M4 11C4 7.13401 7.13401 4 11 4C14.866 4 18 7.13401 18 11C18 14.866 14.866 18 11 18C7.13401 18 4 14.866 4 11ZM11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C13.125 20 15.078 19.2635 16.6177 18.0319L20.2929 21.7071C20.6834 22.0976 21.3166 22.0976 21.7071 21.7071C22.0976 21.3166 22.0976 20.6834 21.7071 20.2929L18.0319 16.6177C19.2635 15.078 20 13.125 20 11C20 6.02944 15.9706 2 11 2Z"/></symbol>`,Ss=`<symbol id="${xs}-triangle" viewBox="-5 -5 105 105"><path d="${function(t){const e=100,s=2.414213562373095*t,n=.7071067811865475*s;return`M${t} 0L${e-s} 0A${t} ${t} 0 0 1 ${e-n} ${n}L${n} ${e-n}A${t} ${t} 0 0 1 0 ${e-s}L0 ${t}Z`}(5)}"/></symbol>`,Rs=`<svg id="${Cs}" style="display:none;">${[Is,Os,Ss].join("")}</svg>`;let $s=!1;function As(t){return`<svg class="miso-ui-icon miso-ui-icon-${t}"><use href="#${xs}-${t}"></use></svg>`}$s||document.head.querySelector("#"+Cs)||($s=!0,document.head.insertAdjacentHTML("beforeend",Rs));const Ts=As("send"),Ns=As("search"),qs=As("triangle"),Us="miso-search-box";const Ps=Object.freeze({root:function(t){const{className:e,role:s,options:n,workflow:i,autocomplete:o}=t,{placeholder:r,buttonText:a}=n;return`\n<div class="${e}" ${s?`data-role="${s}"`:""}>\n  <div class="${e}__input-group">\n    <input class="${e}__input" type="text" data-role="input" ${r?`placeholder="${r}"`:""}>\n    <button class="${e}__button" type="submit" data-role="submit">${a||"search"===i?Ns:Ts}</button>\n  </div>\n  <div class="${o.className}" data-role="autocomplete"></div>\n</div>`.trim()},completions:function(t,e){const{templates:s,workflow:n,autocomplete:i}=t;t={templates:s,workflow:n,...i};const o=[],r=[];for(const t of e)(t.product?o:r).push(t);return s.queries(t,r)+(r.length>0&&o.length>0?"<hr>":"")+s.products(t,o)},completionList:function(t,e,s){const{className:n,templates:i}=t;return`\n<ul class="${n}__${e}-list" data-role="${e}-list">\n  ${s.map((s=>i.completionItem(t,e,s))).join("")}\n</ul>`.trim()},completionItem:function(t,e,s){const{className:n,templates:i}=t;return`\n<li class="${n}__${e}-item" data-role="${e}-item" data-index="${s._index}" tabindex="0">\n  ${i[e](t,s)}\n</li>`.trim()},queries:function(t,e){const{templates:s}=t;return s.completionList(t,"query",e)},products:function(t,e){const{templates:s}=t;return s.completionList(t,"product",e)},query:function(t,{text:e,text_with_inverted_markups:s}={}){return s||E(e)},product:function(t,{product:e}){const{templates:s}=t,[n,i]=ns.tagPair(t,e,{role:!1});return""+n+s.imageBlock(t,e)+s.productInfoBlock(t,e)+i},imageBlock:Ze,productInfoBlock:Qe,helpers:ns}),js=Object.freeze({className:"miso-autocomplete",debounce:300});class Ls extends is{static get category(){return Mt.QUERY}static get type(){return"search-box"}static get defaultTemplates(){return Ps}static get defaultClassName(){return Us}constructor({className:t=Us,templates:e,autocomplete:s,...n}={}){super({className:t,templates:{...Ps,...e},...n}),p(this,{autocomplete:{...js,...s}}),this._contexts=new WeakMap,this._prevInput=void 0,this._debounce=q(this.autocomplete.debounce)}initialize(t){this._view=t;const{proxyElement:e,hub:s}=t;this._unsubscribes=[...this._unsubscribes,e.on("input",(t=>this._syncInput(t))),e.on("keydown",(t=>this._handleKeyDown(t))),e.on("click",(t=>this._handleClick(t))),e.on("focusin",(t=>this._handleFocusIn(t))),e.on("focusout",(t=>this._handleFocusOut(t)))],this._unsubscribes.push(s.on("completions",(()=>t.refresh({force:!0}))))}focus(){this._element?this._context().focus():this._focusRequested=!0}open(){this._element.classList.add("open")}close(){this._element.classList.remove("open")}set value(t){this._element?this._context().value=t:this._valueRequested=t}_preprocess({state:t}){return t=super._preprocess({state:t}),{...t,completions:this._view.hub.states.completions}}_render(t,e,s){0===t.childElementCount&&super._render(t,e,s),this._updateCompletions(t,e,s),this._fullfillFocusRequest(t),this._fullfillValueRequest(t)}_updateCompletions(t,{state:e,rendered:s},{writeToState:n}){if(!e.completions)return;const{status:i=Qt.INITIAL,index:o,value:r}=e.completions;if(s&&s.completions.index===o&&s.completions.status===i)return;const a=this._context(t),{autocompleteElement:c}=a;if(!c)return;const u=a.trackItems(r);t.classList[u.length>0?"add":"remove"]("nonempty"),c.setAttribute("data-status",i),c.innerHTML=this.templates.completions(this,u),n({completions:{index:o,status:i}})}_fullfillFocusRequest(t){t&&this._focusRequested&&(this._focusRequested=!1,this._context(t).focus())}_fullfillValueRequest(t){t&&this._valueRequested&&(this._context(t).value=this._valueRequested,this._valueRequested=void 0)}_context(t){if(!(t=t||this._view.element))return Ms.empty();let e=this._contexts.get(t);return e||this._contexts.set(t,e=new Ms(t)),e}_syncInput(){const{inputElement:t}=this._context();if(!t)return;const e=t.value.trim();if(this._prevInput===e)return;this._prevInput=e;const s=this;this._debounce((()=>s._view.hub.update("input",{value:e})))}_handleFocusIn({target:t}){this._element&&t.matches('[data-role="input"]')&&(this._syncInput(),this.open())}_handleFocusOut({relatedTarget:t}){this._element&&(t&&b(t,(t=>t===this._element||void 0))||this.close())}_handleKeyDown({key:t,target:e,isComposing:s}){!s&&"Enter"===t&&e.matches("input")&&(this._submit(e.value),e.blur())}_handleClick(t){const{target:e}=t,{inputElement:s}=this._context();for(let n=e;n&&n!==this._element;n=n.parentElement){if(n.matches('[data-role="submit"]')||n.matches('[data-role="button"]')||n.matches('[type="submit"]'))return void(s&&(s.blur(),this._submit(s.value)));if(n.matches('[data-role="query-item"]')){const e=n.getAttribute("data-index"),i=this._context().data.get(parseInt(e)),o=i&&i.text;return o&&(s&&(s.value=o),this._view._events.emit("select",Object.freeze({value:i,index:e,domEvent:t})),t.defaultPrevented||this._submit(o)),void this.close()}if(n.matches('[data-role="product-item"]'))return void this._view._events.emit("select",Object.freeze({value:item,index:index,domEvent:t}))}}async _submit(t){t&&(this.close(),this._view.hub.trigger("query",{q:t}))}}class Ms{static empty(){return Ms._empty||(Ms._empty=new Ms)}constructor(t){this._element=t,this._cache={},this._data=new Map}get inputElement(){return this._get("input")}get autocompleteElement(){return this._get("autocomplete")}get data(){return this._data}trackItems(t){let e=0;const s=this._data=new Map,n=[];for(const i in t)for(const o of t[i])o.product&&!o.product.url||(o._index=e,o._field=i,s.set(e,o),n.push(o),e++);return n}focus(){if(!this._element)return;const{inputElement:t}=this;t&&t.focus()}set value(t){if(!this._element)return;const{inputElement:e}=this;e&&(e.value=t)}_get(t){return this._element?this._cache[t]||(this._cache[t]=this._element.querySelector(`[data-role="${t}"]`)):void 0}}const Ds="miso-option-list";const zs=Object.freeze({root:function(t,e){const{className:s,role:n,templates:i}=t;return`\n<div class="${s}" ${n?`data-role="${n}"`:""}>\n  ${i.options(t,e)}\n</div>\n`},options:function(t,e){const{className:s,templates:n}=t;return`\n<ol class="${s}__options" data-role="options">\n  ${(e.value||[]).map(((e,s)=>n.option(t,e,{index:s}))).join("")}\n</ol>\n`},option:function(t,e){const{className:s}=t;return`<li class="${s}__option" data-role="option" tabindex="0">${E(e.text||e)}</li>`}});class Bs extends is{static get category(){return Mt.QUERY}static get type(){return"option-list"}static get defaultTemplates(){return zs}static get defaultClassName(){return Ds}constructor({className:t=Ds,templates:e,...s}={}){super({className:t,templates:{...zs,...e},...s}),this._initTrackable()}initialize(t){this._view=t;const{proxyElement:e,hub:s}=t;this._unsubscribes=[...this._unsubscribes,e.on("click",(t=>this._handleClick(t))),s.on("suggestions",(()=>this._handleInput()))]}_preprocess(){return super._preprocess({state:this._view.hub.states.suggestions})}_render(t,e,s){super._render(t,e,s);const{state:n}=e;this._syncBindings(t,n),this._syncOptionValues(t,n)}_unrender(){this._clearBindings()}_syncOptionValues(t,e){const s=t&&this._getOptionsElement(t);if(!s)return;const n=this._getItems(e)||[];s.classList[0===n.length?"add":"remove"]("empty")}_getItems(t){return t.value}_getOptionsElement(t){return t.querySelector('[data-role="options"]')}_getItemElements(t){return t?Array.from(t.querySelectorAll('[data-role="option"]')):[]}_handleClick(t){const e=t.target.closest('[data-role="option"]');if(!e)return;const s=this._bindings.get(e),n=s&&s.value;n&&(this._trackClick(t,s),this._submit(n.text))}async _submit(t){t&&this._view.hub.trigger("query",{q:t})}destroy(){this._destroyTrackable(),this._view=void 0,super.destroy()}}_s(Bs.prototype);const Qs=Object.freeze({...ze("options"),root:function(t){const{className:e,role:s,templates:n}=t;return`\n<div class="${e}" ${s?`data-role="${s}"`:""}>\n  ${n.options(t)}\n</div>\n`},option:function(t,e){const{className:s,templates:n}=t;return`\n<div role="button" class="${s}__option" data-value="${e.value}">\n  ${n.content(t,e)}\n</div>\n`}});class Fs extends is{static get category(){return Mt.RADIO}static get defaultTemplates(){return Qs}constructor({className:t,templates:e,field:s,defaultValue:n,...i}={}){super({className:t,templates:{...Qs,...e},...i}),this._field=s,this._defaultValue=n}initialize(t){const{proxyElement:e}=this._view=t;this._unsubscribes=[...this._unsubscribes,t.hub.on(this._field,(()=>this._refresh())),e.on("click",(t=>this._handleClick(t)))],this._defaultValue?this._select(this._defaultValue):this._clear()}_preprocess(t,e){return t.rendered&&e.skip(),super._preprocess(t,e)}_handleClick({target:t}){const e=b(t,(t=>t.hasAttribute("data-value")?t:void 0));if(!e)return;let{unselected:s,value:n}=this._view.hub.states[this._field];s=s||void 0===n;const i=e.getAttribute("data-value");s||void 0===n||n!==i?this._select(i):this._clear()}_refresh(){this._state=this._view.hub.states[this._field],w((()=>this._syncValueAttribute()))}_syncValueAttribute(){if(!this._state)return;const{element:t}=this._view,e=t&&t.children[0];if(!e)return;let{unselected:s,value:n}=this._state;s?e.removeAttribute("data-selected"):e.setAttribute("data-selected",n),this._state=void 0}_select(t){this._submit({value:t})}_clear(){this._submit({unselected:!0})}async _submit(t){this._view.hub.update(this._field,t)}}const Gs="miso-feedback",Ws=["helpful","unhelpful"];const Hs=Object.freeze({options:function(t){const{templates:e}=t;return Ws.map((s=>e.option(t,{value:s}))).join("")},content:function(t,{value:e}){const{className:s,templates:n,options:i={}}=t;return`\n${!1!==i.icon?`<i class="${s}__icon">${n.icon(t,e)}</i>`:""}\n${!1!==i.text?`<span class="${s}__text">${n.text(t,e)}</span>`:""}\n`},icon:function(t,e){switch(e){case"helpful":case"unhelpful":return'<svg viewBox="0 0 16 16"><path d="M8.342 3.652 4.979 5.708a1 1 0 0 0-.479.852v5.561a1 1 0 0 0 .87.992l6.029.79a1 1 0 0 0 1.042-.583l2.534-5.65a1 1 0 0 0-.74-1.394l-3.543-.623.9-3.1A2.097 2.097 0 0 0 10.297 0L8.719 3.237a1 1 0 0 1-.377.415ZM1 6.5a1.5 1.5 0 0 1 3 0v6a1.5 1.5 0 0 1-3 0Z"/></svg>';default:return""}},text:function(t,e){switch(e){case"helpful":return"Helpful";case"unhelpful":return"Not helpful";default:return""}}});class Vs extends Fs{static get category(){return super.category}static get type(){return"feedback"}static get defaultTemplates(){return Hs}static get defaultClassName(){return Gs}constructor({className:t=Gs,templates:e,...s}={}){if(super({className:t,templates:{...Hs,...e},field:"feedback",...s}),!1===s.text&&!1===s.icon)throw Error("At least one of options.text or options.icon must be enabled")}}const Ks="miso-text";const Ys=Object.freeze({root:function(t,e){const{className:s,role:n,options:{tag:i}}=t;return`<${i} class="${s}" ${n?`data-role="${n}"`:""}>${E(e.value||"")}</${i}>`}});class Zs extends is{static get category(){return Mt.TEXT}static get type(){return"text"}static get defaultTemplates(){return Ys}static get defaultClassName(){return Ks}constructor({className:t=Ks,templates:e,tag:s="p",...n}={}){super({className:t,templates:{...Ys,...e},tag:s,...n})}}class Xs extends De{constructor(t){super(t)}_takePending(){return this._pending}_applyRender(t,e={}){const s=I(!1);super._applyRender(t,{...e,loop:s.t}),s.value&&this._requestRaf()}}class Js{clear(t){return t.innerText="",{cursor:0,done:!1}}update(t,{value:e,cursor:s},{value:n,cursor:i,done:o}){const r=n.length;i=Math.min(i,r);const a=!!o&&i===r,c=e.substring(0,s),u=!n.startsWith(c);return a||u?t.innerText=n:t.insertAdjacentText("beforeend",n.substring(s,i)),a&&t.classList.add("done"),{cursor:i,done:a}}}function tn(t,e,{status:s}){if(!e)return;0===e.children.length&&(e.innerHTML=function(t){let{className:e,role:s,options:{tag:n,format:i,builtInStyles:o=!0}}=t;"auto"===n&&(n="markdown"===i?"div":"p");const r=s?`data-role="${s}"`:"",a=[e,en(e)];o&&"markdown"===i&&a.push("miso-markdown");return`<${n} class="${a.join(" ")}" ${r} data-format="${i}"></${n}>`}(t));const n=e.children[0];return n.setAttribute("data-status",s||Qt.INITIAL),n}function en(t){return t+"__cursor"}const sn="miso-typewriter";class nn extends Xs{static get category(){return Mt.TEXT}static get type(){return"typewriter"}static get defaultClassName(){return sn}constructor({className:t=sn,tag:e="auto",format:s="markdown",tooltip:n=!1,speed:i,acceleration:o,nextCursorFn:r,...a}={}){super({tag:e,format:s,tooltip:n,...a}),p(this,{className:t}),this._prevState=void 0,this._getNextCursor="function"==typeof r?r:j({speed:i,acceleration:o}),this._readiness=new S,"markdown"===s&&nn.MisoClient.plugins.install("std:ui-markdown")}initialize(t){this._view=t,this._setup()}async _setup(){try{if("plaintext"===this.options.format)await this._setupForPlaintext();else await this._setupForMarkdown();this._readiness.resolve()}catch(t){this._readiness.reject(t)}}async _setupForMarkdown(){const t=await this._view._views._extensions.require("markdown"),e=en(this.className),{onDebug:s,onCitationLink:n}=this.options;this._renderer=t.createRenderer({cursorClass:e,getSource:t=>this._getSource(t),onCitationLink:n,onDebug:s}),this._unsubscribes.push(this._view.proxyElement.on("click",(t=>this._onClick(t))))}_getSource(t){const{data:e={}}=this._view._data,{sources:s=[]}=e;return s[t]}async _setupForPlaintext(){this._renderer=new Js}async _ready(){return this._readiness.promise}async render(...t){await this._ready(),await super.render(...t)}_preprocess({state:t}){const e=this._prevState,{value:s="",meta:n,session:i,status:o,ongoing:r}=t,a=n&&n.answer_stage||"result",c=(l=t,(u=e)&&l&&u.session&&l.session&&u.session.uuid===l.session.uuid);var u,l;const h=e?c&&a===e.stage?e.streak:e.streak+1:0,_=c&&e&&e.doneAt||(o!==Qt.READY||r?void 0:Date.now());return this._prevState=Object.freeze(d({session:i,status:o,value:s,stage:a,streak:h,doneAt:_,done:void 0!==_}))}_render(t,{state:e,rendered:s},{notifyUpdate:n,writeToState:i,loop:o}){const r=tn(this,t,e);let a;if(s&&e.streak===s.streak){const t=this._getNextCursor(s.cursor,e.doneAt,s.timestamp,e.timestamp);a=this._renderer.update(r,s,{...e,cursor:t})}else a=this._renderer.clear(r,s);i(a);const c=e.status===Qt.READY&&!a.done;n({ongoing:c},{silent:c&&(!s||s.status===Qt.READY)}),c&&o()}_onClick({target:t}){const e=t.closest('[data-role="citation-link"]');if(!e)return;const s=parseInt(e.dataset.index);Number.isNaN(s)||this._view._events.emit("citation-click",{index:s})}}const on="miso-affiliation";const rn=Object.freeze({root:function(t,e){const{className:s,role:n,templates:i}=t,{status:o}=e,r=n?` data-role="${n}"`:"",a=e.value||{},c=a.channel?` data-channel="${a.channel}"`:"",u=t._getItems(e),l=u?u.length:void 0;return`<div class="${s} ${o}"${r}${c}${void 0!==l?` data-item-count="${l}"`:""}>${o===Qt.READY?i[o](t,e):""}</div>`},[Qt.READY]:function(t,e){const{templates:s}=t,n=t._getItems(e);return n&&n.length>0?s.controlContainer(t,e,"previous")+s.body(t,e)+s.controlContainer(t,e,"next"):s.empty(t,e)},controlContainer:function(t,e,s){const{className:n,templates:i}=t;return`<div class="${n}__control-${s}-container">${i.control(t,e,s)}</div>`},control:function(t,e,s){const{className:n,templates:i}=t;return`<div class="${n}__control-${s}" data-role="${s}">${i.controlIcon(t,e,s)}</div>`},controlIcon:function(t,e,s){return qs},body:function(t,e){const{className:s,templates:n}=t,i=t._getItems(e);return`<div class="${s}__body">${n.list(t,e,i)}</div>`},item:function(t,e,s,n){const{className:i,templates:o,options:r}=t,{itemType:a}=r;return`<li class="${i}__item"><div class="${i}__item-inner">${o.itemHeader(t,e,s,{index:n})}${o[a](t,e,s,{index:n})}</div></li>`},itemHeader:function(t,e,s,n){const{className:i,templates:o}=t;let{itemHeaderLeftText:r,itemHeaderRightText:a}=o;return r=ns.asFunction(r)(t,e,s,n),a=ns.asFunction(a)(t,e,s,n),`<div class="${i}__item-header">\n  <div class="${i}__item-header-left">${r}</div>\n  <div class="${i}__item-header-right">${a}</div>\n</div>`},affiliation:function(t,e,s,n){const{templates:i}=t,[o,r]=ts(t,s,{link:!1});return""+o+(i.infoBlock||i.affiliationInfoBlock||Be)(t,s,n)+(i.imageBlock||Ze)(t,s,{brand:!0,...n})+r},ctaText:"View deal",itemHeaderLeftText:"Today's best deals",itemHeaderRightText:function(t,e,s,n){const{className:i,templates:o}=t,r=ns.asFunction(o.logoText)(t,e,s,n)||"",a=ns.asFunction(o.logoImg)(t,e,s,n);return a?`<span class="${i}__item-header-logo-text">${r}</span>${a}`:""},logoImg:function(t,e,s,n){const{className:i,templates:o}=t,r=ns.asFunction(o.logoUrl)(t,e,s,n);if(!r)return"";const a=ns.asFunction(o.logoAltText)(t,e,s,n);return`<img class="${i}__item-header-logo" src="${r}"${a?` alt="${a}"`:""}>`},logoText:"Selected by"}),an=Object.freeze({...fs.defaultTemplates,...rn});class cn extends fs{static get category(){return Mt.AFFILIATION}static get type(){return"affiliation"}static get defaultTemplates(){return an}static get defaultClassName(){return on}constructor({className:t=on,templates:e,autoplay:s,...n}={}){super({className:t,itemType:"affiliation",templates:{...rn,...e},...n}),this._itemCount=void 0,this._itemIndex=0,this._displayedCount=void 0,this._displayedIndex=void 0,this._viewable=void 0}initialize(t){super.initialize(t);const{viewable:e}=this._view.tracker.options||{};this._viewable=new H(this._onViewable.bind(this),e)}get itemIndex(){return this._itemIndex}set itemIndex(t){void 0!==this._itemCount&&(0>t?t=this._itemCount-1:this._itemCount>t||(t=0),this._itemIndex=t,w((()=>this._syncItemIndex())))}next(){void 0!==this._itemCount&&this.itemIndex++}previous(){void 0!==this._itemCount&&this.itemIndex--}_getItems(t){const{products:e}=t.value||{};return e}_render(t,e,s){super._render(t,e,s),this._syncItemCount(e),this._syncItemIndex()}_syncElement(t){const e=this._element;super._syncElement(t),this._syncViewableElement(e,t)}_syncViewableElement(t,e){t!==e&&(t&&this._viewable.unobserve(t),e&&this._viewable.observe(e))}_syncItemCount({state:t}={}){const e=this._getItems(t),s=this._itemCount=e?e.length:void 0;if(s===this._displayedCount)return;let{element:n}=this._view;n=n.firstElementChild,n&&(this._displayedCount=s,void 0===s?n.removeAttribute("data-item-count"):n.setAttribute("data-item-count",s))}_syncItemIndex(){const t=this._itemIndex;if(t===this._displayedIndex)return;const{element:e}=this._view,s=e&&this._getListElement(e);s&&(this._displayedIndex=t,s.style.left=100*-t+"%",this._viewable.display(t),this._view._events.emit("display",{index:t}))}_onViewable(t){const e=this._getRenderedItemData(t);e&&this._view.tracker.viewable([e])}_getRenderedItemData(t){const{value:e}=this._rendered.get(this._element)||{};if(!e)return;const{products:s=[]}=e;return s[t]}_trackViewables(){}_onClick(t){const e=t.target;e.closest('[data-role="previous"]')?this.previous():e.closest('[data-role="next"]')?this.next():super._onClick(t)}}var un=Object.freeze({__proto__:null,TemplateBasedLayout:is,ContainerLayout:rs,ErrorLayout:cs,BannerLayout:class extends is{static get category(){return Mt.BANNER}static get type(){return"banner"}static get defaultTemplates(){return us}constructor({className:t="miso-banner",templates:e,...s}={}){super({className:t,templates:{...us,...e},...s})}},CollectionLayout:fs,ListLayout:ys,CardsLayout:class extends fs{static get category(){return super.category}static get type(){return"cards"}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return bs}constructor({className:t=bs,...e}={}){super({className:t,...e})}},CarouselLayout:class extends fs{static get category(){return super.category}static get type(){return"carousel"}static get defaultTemplates(){return ks}static get defaultClassName(){return vs}constructor({className:t=vs,templates:e,...s}={}){super({className:t,templates:{...ws,...e},...s}),window.addEventListener("resize",this.syncSize=this.syncSize.bind(this)),this._page=0,this._unsubscribes=[]}_render(t,e,s){super._render(t,e,s);const{state:n}=e,i=this._getItems(n);this._itemCount=i?i.length:void 0,this.syncSize()}get page(){return this._page}get pageSize(){return this._pageSize}next(){this._setPage(this._page+1)}previous(){this._setPage(this._page-1)}syncSize(){if(void 0===this._itemCount)return;const t=this._findGridElement();if(!t)return;const e=void 0===this._pageSize?0:this._page*this._pageSize,s=this._pageSize=window.getComputedStyle(t).getPropertyValue("grid-template-columns").split(" ").length;this._pageCount=Math.ceil(this._itemCount/this._pageSize),this._setPage(Math.floor(e/s))}_setPage(t){if(0>t?t=this._pageCount-1:this._pageCount>t||(t=0),t===this._page)return;this._page=t;const e=this._findGridElement();if(e){e.style.setProperty("grid-template-rows",(0===t?"":`repeat(${t}, 0)`)+" 1fr repeat(10, 0)")}}_findGridElement(){const{element:t}=this._view;return t&&t.querySelector(`.${this.className}__list`)}_onClick(t){super._onClick(t);const e=t.target;e.closest('[data-role="previous"]')?this.previous():e.closest('[data-role="next"]')&&this.next()}destroy(){window.removeEventListener("resize",this.syncSize),super.destroy()}},SearchBoxLayout:Ls,OptionListLayout:Bs,FeedbackLayout:Vs,TextLayout:Zs,TypewriterLayout:nn,AffiliationLayout:cn});const ln=Object.freeze({[Pt.CONTAINER]:rs.type,[Pt.ERROR]:cs.type});class hn extends G{constructor({name:t,context:e,plugin:s,client:n,roles:i,defaults:o}){super(t||"workflow",s),this._context=e,this._plugin=s=s||e._plugin,this._client=n=n||e._client,this._name=t,this._roles=i;const r=this._extensions=s._getExtensions(n),a=this._options=new ie(e&&e._options,function(t,{layouts:e,interactions:s,...n}={}){const i={preprocess:[e=>t._preprocessInteraction(e)]};return{...n,layouts:Yt(ln,e),interactions:ee(i,s)}}(this,o)),c=this._hub=function(t,e){const{update:s,trigger:n}=t;return t.update=(n,i,o)=>(o&&o.silent||e("update",n,i,o),s.call(t,n,i,o)),t.trigger=(...s)=>(e("trigger",...s),n.apply(t,s)),t}(new pe,((...t)=>this._log(...t))),u=s.layouts;this._sessions=new me(c),this._data=new be(c,{source:Me(n),options:a}),this._views=new Ne(c,{extensions:r,layouts:u,roles:i,options:a,workflow:t}),this._interactions=new Le(c,{client:n,options:a}),this._unsubscribes=[this._hub.on("response",(t=>this.updateData(t)))]}get uuid(){return this.session&&this.session.uuid}get session(){return this._hub.states.session}get active(){const{session:t}=this;return!!t&&t.active}get states(){return this._hub.states}get views(){return this._views.interface}reset(){return this._sessions.new(),this}start(){return this._sessions.start(),this}restart(){return this.reset(),this.start(),this}updateData(t){if(!t)throw Error("Data is required.");const{session:e}=t;if(!e)throw Error("Session is required to update data.");if(!this.session)throw Error("No session is created yet. Call workflow.restart() to start a new session.");if(e.uuid===this.session.uuid){this._sessions.start(),t=this._defaultProcessData(t);for(const e of this._options.resolved.dataProcessor)t=e(t);return this._hub.update(de(),t),this}}_defaultProcessData(t){const{value:e}=t;return e&&e.miso_id?{...t,meta:{...t.meta,miso_id:e.miso_id}}:t}notifyViewUpdate(t,e){return this._assertActive(),e={status:Qt.READY,session:this.session,...e},this._hub.update(_e(t),e),this}get trackers(){return this._views.trackers}_preprocessInteraction({context:{custom_context:t,...e}={},...s}={}){const{group:n,name:i}=this._options.resolved.api;return{...s,context:{...e,custom_context:{api_group:n,api_name:i,...t}}}}destroy(t){this._events.emit("destroy"),this._destroy(t)}_destroy({dom:t}={}){for(const t of this._unsubscribes||[])t();this._unsubscribes=[],this._views._destroy({dom:t}),this._data._destroy()}_log(t,e,s){this._emit(e,{_action:t,...s})}_emit(t,e){this._events.emit(t,e),this._context&&this._context._events.emit(t,{workflow:this,...e})}_assertActive(){if(!this.active)throw Error("Unit is not active yet. Call unit.start() to activate it.")}}function dn(t){if(t.sovrn_aff){const{sovrn_aff:e,...s}=t;t={...s,affiliation:_n(e)}}return function(t){const{affiliation:e}=t;if(!e)return t;let{channel:s,products:n}=e;if(!n)return t;n=n.map((t=>({...t})));let i=0;for(const t of n)s&&(t.channel=s),t.position=i++;return{...t,affiliation:{...e,products:n}}}(t)}function _n({products:t,...e}){return{channel:"sovrn",...e,products:t.map(pn)}}function pn({id:t,deeplink:e,headline:s,description:n,currency:i,retailPrice:o,salePrice:r,discountRate:a,image:c,thumbnail:u,merchant:l,...h}){return d({id:"sovrn-"+t,title:s,description:n,cover_image:c,url:e,currency:i,original_price:o,sale_price:r,discount_rate_percent:a,brand:l&&l.name,brand_logo:l&&l.logo,custom_attributes:mn({sovrn_id:t,thumbnail:u,merchant:l,...h})})}function mn(t,e=""){return Object.keys(t).reduce(((s,n)=>{const i=t[n];if(void 0===i)return s;const o=e?`${e}_${n}`:n;return"object"==typeof i?{...s,...mn(i,o)}:{...s,[o]:i}}),{})}ce(hn.prototype);const fn=Object.freeze({group:r.ASK,name:a.QUESTIONS,payload:{source_fl:["cover_image","url","created_at","updated_at","published_at"],related_resource_fl:["cover_image","url","created_at","updated_at","published_at"],cite_link:1,cite_start:"[",cite_end:"]"}}),gn=Object.freeze({actor:!1,api:{group:r.ASK,name:a.AUTOCOMPLETE}}),yn=Object.freeze({[Pt.QUERY]:[Ls.type,{placeholder:"Ask a question"}],[Pt.QUESTION]:[Zs.type,{tag:"h2"}],[Pt.ANSWER]:nn.type,[Pt.FEEDBACK]:Vs.type,[Pt.SOURCES]:[ys.type,{incremental:!0,itemType:"article",templates:{ordered:!0}}],[Pt.RELATED_RESOURCES]:[ys.type,{incremental:!0,itemType:"article"}],[Pt.QUERY_SUGGESTIONS]:Bs.type,[Pt.AFFILIATION]:[cn.type,{incremental:!0,itemType:"affiliation",link:{rel:"noopener nofollow"}}]}),bn=Object.freeze({[Pt.SOURCES]:{},[Pt.RELATED_RESOURCES]:{},[Pt.AFFILIATION]:{},[Pt.QUERY_SUGGESTIONS]:{click:{validate:t=>0===t.button}}}),vn=Object.freeze({api:fn,autocomplete:gn,layouts:yn,trackers:bn});class wn extends hn{constructor(t,e){super({name:"ask",context:t,roles:Object.keys(yn),defaults:vn}),this._context=t,this._autoQuery=!1,p(this,{parentQuestionId:e}),this._feedback=new Pe(this._hub),this._setSuggestedQuestions(),this._unsubscribes=[...this._unsubscribes,this._hub.on("query",(t=>this.query(t))),this._hub.on(_e(Pt.ANSWER),(t=>this._onAnswerViewUpdate(t))),this._views.get(Pt.ANSWER).on("citation-click",(t=>this._onCitationClick(t)))],e&&t._byPqid.set(e,this),t._events.emit("create",this),this.reset()}get questionId(){return this._questionId}get rootQuestionId(){return this._context.root.questionId}get previous(){const{parentQuestionId:t}=this;return t?this._context.getByQuestionId(t):void 0}get next(){const{questionId:t}=this;return t?this._context.getByParentQuestionId(t):void 0}getOrCreateNext(){const{questionId:t}=this;return t?this._context.getByParentQuestionId(t,{autoCreate:!0}):void 0}autoQuery(t={}){const{setValue:e=!0,focus:s=!0}=this._autoQuery=t,n=new URLSearchParams(window.location.search),i=n.get("q"),o=n.get("qs"),{layout:r}=this._views.get(Pt.QUERY);r&&(i&&e&&(r.value=i),!i&&s&&r.focus()),i&&this.query({q:i,qs:o})}query({q:t,qs:e,...s}={}){s={...s,question:t},e=e||Ut,this.parentQuestionId&&(s.parent_question_id=this.parentQuestionId),(s._meta||(s._meta={})).question_source=e,this._questionId&&(this._context._byQid.delete(this._questionId),this._questionId=void 0),this.restart();const{session:n}=this;return n.meta.question_source=e,this._hub.update("request",Vt(this._options.resolved.api,{payload:s,session:n})),this}restart(){const{session:t,status:e,ongoing:s}=this._hub.states[_e(Pt.ANSWER)]||{};if(t&&e!==Qt.INITIAL&&(e!==Qt.READY||s)){const n=Object.freeze({session:t,status:e,ongoing:s});this._emit("interrupt",n),this._emit("finally",n)}super.restart()}_defaultProcessData(t){t=super._defaultProcessData(t);const{value:e,request:s}=t;if(!e)return t;const{question_id:n,question:i}=e,o=s&&s.payload&&s.payload._meta&&s.payload._meta.question_source===Ut;if(!this._questionId&&n&&(this._questionId=n,this._context._byQid.set(n,this)),this._autoQuery&&!1!==this._autoQuery.updateUrl){const t=new URL(window.location);i===t.searchParams.get("q")||o&&!0!==this._autoQuery.updateUrl||(t.searchParams.set("q",i),window.history.replaceState({},"",t))}return t=function(t){if(!t||!t.value)return t;const{value:e}=t;return{...t,value:dn(e)}}(t),{...t,ongoing:!e.finished,meta:{...t.meta,answer_stage:e.answer_stage}}}_onAnswerViewUpdate({session:t,status:e,ongoing:s}){if(e===Qt.INITIAL)return;const n=e===Qt.READY&&!s,i=e===Qt.ERRONEOUS,o=n?"done":i?"error":e,r=Object.freeze({session:t,status:e,ongoing:s});this._emit(o,r),(n||i)&&this._emit("finally",r)}_setSuggestedQuestions(){const{previous:t}=this;if(!t)return;const e=t.states[de()].value;this._hub.update("suggestions",{value:(e.suggested_followup_questions||e.followup_questions||[]).map((t=>({text:t})))})}_onCitationClick({index:t}){const{value:e}=this.states[de()]||{},{sources:s}=e||{},n=s&&s[t-1];n&&n.product_id&&this._trackers.sources.click([n.product_id],{manual:!1})}_preprocessInteraction(t){t=super._preprocessInteraction(t)||{};const{context:e={}}=t,{custom_context:s={}}=e;let{rootQuestionId:n,parentQuestionId:i,questionId:o}=this;return s.property===Pt.QUERY_SUGGESTIONS&&(o=i,i=this.previous&&this.previous.parentQuestionId,s.property="suggested_followup_questions",s.question_source=this.previous&&this.previous.session.meta.question_source),t.context={...e,custom_context:d({root_question_id:n,parent_question_id:i,question_id:o,...s})},t}_destroy(t){const{parentQuestionId:e,questionId:s}=this;e&&this._context._byPqid.delete(e),s&&this._context._byQid.delete(s),this._feedback._destroy(),super._destroy(t)}}class kn extends he{constructor(t,e){super("asks",t,e),this._byQid=new Map,this._byPqid=new Map,this._root=new wn(this)}get root(){return this._root}get workflows(){return[this._root,...this._byPqid.values()]}getByQuestionId(t){if("string"!=typeof t)throw Error("Required ID to be a string: "+t);return this._byQid.get(t)}getByParentQuestionId(t,{autoCreate:e=!1}={}){if(void 0===t)return this._root;if("string"!=typeof t)throw Error("Required ID to be a string: "+t);let s=this._byPqid.get(t);return!s&&e&&(s=new wn(this,t)),s}reset({root:t=!0,events:e,...s}={}){void 0===e&&(e=!!t),e&&this._events.clear();for(const t of this._byPqid.values())t.destroy(s);t&&this._root.reset()}}const En=Object.freeze({group:r.ASK,name:a.RELATED_QUESTIONS}),xn=Object.freeze({[Pt.RELATED_QUESTIONS]:[ys.type,{itemType:"question",link:{rel:"noopener nofollow"}}],[Pt.QUERY]:[Ls.type,{placeholder:"Ask a question"}]}),Cn=Object.freeze({[Pt.RELATED_QUESTIONS]:{}}),In=Object.freeze({api:En,layouts:xn,trackers:Cn});class On extends hn{constructor(t,e){super({name:"explore",plugin:t,client:e,roles:Object.keys(xn),defaults:In}),this._productId=void 0,this._linkFn=void 0,this._unsubscribes=[...this._unsubscribes,this._views.get(Pt.RELATED_QUESTIONS).on("click",(t=>this._handleRelatedQuestionClick(t))),this._hub.on("query",(t=>this.query(t)))]}set productId(t){console.warning("DEPRECATED: use useApi() instead"),this.useApi({product_id:t})}useApi(t){const{product_id:e}=t;return e&&(this._productId=e),super.useApi(t)}useLink(t){if("function"!=typeof t&&!1!==t)throw Error("useLink(fn) expects fn to be a function or false");return this._linkFn=t,this}start(){if(void 0===this._linkFn)throw Error("Define link mapping function before calling start()");this._sessions.start();const{session:t}=this;return this._hub.update("request",Vt(this._options.resolved.api,{session:t})),this}notifyViewUpdate(t=Pt.RELATED_QUESTIONS,...e){return super.notifyViewUpdate(t,...e),this}_defaultProcessData(t){t=super._defaultProcessData(t);let{value:e}=t;if(!e)return t;const s=e.related_questions.map(this._linkFn?t=>({text:t,url:this._getAnswersUrl(t,!0)}):t=>({text:t}));return{...t,value:{...e,related_questions:s}}}_handleRelatedQuestionClick({value:t,...e}){this._events.emit("select",Object.freeze({...e,question:t}))}query({q:t}={}){if(!this._linkFn)return;const e=this._getAnswersUrl(t);window.open(e,"_blank")}_getAnswersUrl(t,e=!1){if(!this._linkFn)return;const s=this._linkFn(t);return e&&this._productId?`${s}&qs=${encodeURIComponent(this._productId)}`:s}}const Sn=Object.freeze({group:r.SEARCH,name:a.SEARCH,payload:{fl:["*"]}}),Rn=Object.freeze({actor:!1,api:{group:r.SEARCH,name:a.AUTOCOMPLETE,payload:{completion_fields:["suggested_queries","title"],fl:["title","url","cover_image"]}},throttle:300}),$n=Object.freeze({[Pt.QUERY]:Ls.type,[Pt.PRODUCTS]:ys.type}),An=Object.freeze({[Pt.PRODUCTS]:{}}),Tn=Object.freeze({api:Sn,autocomplete:Rn,layouts:$n,trackers:An});class Nn extends hn{constructor(t,e){super({name:"search",plugin:t,client:e,roles:Object.keys($n),defaults:Tn}),this._autocomplete=new je(this._hub,{source:Me(this._client),options:this._options}),this._unsubscribes.push(this._hub.on("query",(t=>this.query(t))))}autoQuery({setValue:t=!0,focus:e=!0}={}){const s=new URLSearchParams(window.location.search).get("q"),{layout:n}=this._views.get(Pt.QUERY);n&&(s&&t&&(n.value=s),!s&&e&&n.focus()),s&&this.query({q:s})}query(t){this.restart();const{session:e}=this;return this._hub.update("request",Vt(this._options.resolved.api,{payload:t,session:e})),this}updateCompletions(t){return this._hub.update("completions",{...t,source:"manual"}),this}notifyViewUpdate(t=Pt.PRODUCTS,...e){return super.notifyViewUpdate(t,...e),this}}ce(Nn.prototype,["autocomplete"]);const qn=Object.freeze({group:r.RECOMMENDATION,name:a.USER_TO_PRODUCTS,payload:{fl:["*"]}}),Un=Object.freeze({[Pt.PRODUCTS]:ys.type}),Pn=Object.freeze({[Pt.PRODUCTS]:{}}),jn=Object.freeze({api:qn,layouts:Un,trackers:Pn});class Ln extends hn{constructor(t,e){super({name:"recommendation",context:t,roles:Object.keys(Un),defaults:jn}),p(this,{id:e}),this._context=t,t._members.set(e,this)}start(){this._sessions.start();const{session:t}=this;return this._hub.update("request",Vt(this._options.resolved.api,{session:t})),this}startTracker(){return this.useApi(!1),this.useLayouts(!1),this._sessions.start(),this.notifyViewUpdate(Pt.CONTAINER),this.notifyViewUpdate(Pt.PRODUCTS),this}notifyViewUpdate(t=Pt.PRODUCTS,...e){return super.notifyViewUpdate(t,...e),this}_preprocessInteraction(t){t=super._preprocessInteraction(t)||{};const{context:e={}}=t,{custom_context:s={}}=e;return{...t,context:{...e,custom_context:d({unit_id:this.id,unit_instance_uuid:this.uuid,...s})}}}_destroy(t){this._context._members.delete(this.id),super._destroy(t)}}class Mn extends he{constructor(t,e){super("recommendations",t,e),this._members=new Map}workflows(){return[...this._members.values()]}create(t=qt){if(this._members.has(t))throw Error("Unit already exists: "+t);return new Ln(this,t)}has(t=qt){return this._members.has(t)}get(t=qt){if("string"!=typeof t)throw Error("Required unit ID to be a string: "+t);return this._members.get(t)||new Ln(this,t)}}class Dn extends G{constructor({name:t,plugin:e,MisoClient:s,...n}){super(t||"combo",e),this._name=t,this._plugin=e,this._MisoClient=s,this._options=n}get MisoClient(){return this._MisoClient}get element(){return this._element}async waitForElement(){return this._element||(this._elementRes||(this._elementRes=new S)).promise}set element(t){this._element=t,this._elementRes&&this._elementRes.resolve(t)}start(t){this._started||(this._started=!0,t&&this.config(t),this._start())}_start(){throw Error("Unimplemented")}}const zn="miso-ask-combo";var Bn=Object.freeze({__proto__:null,CLASS_PREFIX:zn});var Qn=Object.freeze({__proto__:null,question:"You asked...",sources:"This reply is based on the following articles",querySuggestions:"Related questions you can explore",relatedResources:"Go beyond, and learn more about this topic"});function Fn(t={}){return oi(t=Hn(t),{name:"follow-up"},[Xn(t),ri(t,{name:"query",visibleWhen:"initial loading"},"<miso-query></miso-query>"),...Jn(t)])}const Gn=Object.freeze({followUps:Yn,relatedResources:Zn,querySuggestions:Xn,answerGroup:Jn,answer:ti,sources:ei}),Wn=Object.freeze({normalizeOptions:Hn,normalizePhraseOptions:Vn,normalizePhraseOptionKey:Kn,phrase:ni,phraseText:ii,section:oi,container:ri,element:ai,attrs:ci});function Hn({classPrefix:t=zn,circledCitationIndex:e=!0,phrases:s,...n}={}){return{classPrefix:t,circledCitationIndex:e,phrases:s=Vn(s),...n}}function Vn(t={}){if(!t)return{};const e={};for(const s in t)e[Kn(s)]=t[s];return e}function Kn(t){return"relatedQuestions"===(t=t.replace(/[-_][a-z]/g,(t=>t[1].toUpperCase())))?"querySuggestions":t}function Yn(t){const{classPrefix:e,features:s={}}=t;return!1===s.followUpQuestions?"":`<div id="${e}__follow-ups" class="${e}__follow-ups"></div>`}function Zn(t){const{features:e={},logo:s=!0}=t;return oi(t,{name:"related-resources"},!1===e.relatedResources?"":ri(t,{name:"related-resources",visibleWhen:"nonempty",logo:s},[ni(t,{name:"related-resources",tag:"h2"}),"<miso-related-resources></miso-related-resources>"]))}function Xn(t){const{features:e={}}=t;return!1===e.querySuggestions?"":ri(t,{name:"query-suggestions",visibleWhen:"initial+nonempty"},[ni(t,{name:"query-suggestions",tag:"h3"}),"<miso-query-suggestions></miso-query-suggestions>"])}function Jn(t){return[ti(t),si(t),ei(t),ri(t,{name:"bottom-spacing",visibleWhen:"ongoing"})]}function ti(t){return ri(t,{name:"answer",visibleWhen:"ready"},[t.parentQuestionId?"<hr>":"",ni(t,{name:"question",tag:"div"}),"<miso-question></miso-question>","<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}function ei(t){return ri(t,{name:"sources",visibleWhen:"nonempty"},["<hr>",ni(t,{name:"sources",tag:"h3"}),"<miso-sources></miso-sources>"])}function si(t){const{affiliation:e=!0}=t||{};return e?ri(t,{name:"affiliation",visibleWhen:"nonempty"},["<miso-affiliation></miso-affiliation>"]):""}function ni(t,{name:e,tag:s="div"}){const{classPrefix:n}=t;return`<${s} class="${n}__phrase ${n}__${e}-phrase">${ii(t,(i=e,i.replace(/-([a-z])/g,(t=>t[1].toUpperCase()))))}</${s}>`;var i}function ii(t,e){const{phrases:s={}}=t,n=s[e]||Qn[e];switch(typeof n){case"function":return n(t);case"string":return n;default:return""}}function oi({classPrefix:t},{name:e},s){return ai("section",{classes:[t+"__section",`${t}__${e}`]},s)}function ri({classPrefix:t,circledCitationIndex:e,parentQuestionId:s},{name:n,visibleWhen:i,logo:o=!1},r){const a=[`${t}__${n}-container`];return e&&a.push("miso-circled-citation-index"),ai("miso-ask",{classes:a,visibleWhen:i,logo:o,parentQuestionId:s},r)}function ai(t,e={},s=""){return("string"==typeof e||Array.isArray(e))&&(s=e,e={}),`<${t}${ci(e)}>${Array.isArray(s)?s.join(""):s}</${t}>`}function ci({classes:t=[],...e}={}){let s="";t.length&&(s+=` class="${t.join(" ")}"`);for(const t in e){const n=e[t];void 0!==n&&(s+=` ${m(t)}="${n}"`)}return s}var ui=Object.freeze({__proto__:null,root:function(t={}){return""+oi(t=Hn(t),{name:"question"},[ri(t,{name:"query"},"<miso-query></miso-query>")])+oi(t,{name:"answer"},Jn(t))+Yn(t)+Zn(t)},followUp:Fn,sections:Gn,helpers:Wn});const li=Object.freeze(Bn),hi=Object.freeze(Qn),di=Object.freeze(ui);var _i=Object.freeze({__proto__:null,constants:li,phrases:hi,templates:di,wireFollowUps:function(t,e,{template:s=Fn,...n}={}){if(!t)throw Error("client is required");if("function"!=typeof s)throw Error("template must be a function or undefined");if(!e)return;const i=t.ui.asks,o=t.ui.ask;i.on("done",(t=>{e.insertAdjacentHTML("beforeend",s({...n,parentQuestionId:t.workflow.questionId}))})),o.on("loading",(()=>{e.innerHTML="",i.reset({root:!1})}))},wireRelatedResources:function(t,e){if(!t)throw Error("client is required");e&&t.ui.asks.on("loading",(t=>{for(const s of e.querySelectorAll("miso-ask"))s.workflow=t.workflow}))}});const{currentScript:pi}=document,mi=Object.freeze({templates:di,autostart:!0}),fi=["templates","phrases","features"];class gi{constructor(){this._defaults=mi,this._scriptSrc=function(){if(!pi||!pi.src)return{};const t=document.createElement("a");t.href=pi.src;const e={};for(const[s,n]of new URLSearchParams(t.search))"q"!==s&&(e[s]=vi(n));return e}(),this._pageUrl=function(){const t={};for(const[e,s]of new URLSearchParams(window.location.search))e.startsWith("miso_")&&e.length>5&&"miso_api_key"!==e?t[e.substring(5)]=vi(s):"q"===e&&(t.q=s);return t}()}resolve(t){return function({api_key:t,api_host:e,templates:s,phrases:n,...i}={}){return d({apiKey:t,apiHost:e,templates:wi(s),phrases:n,...i})}(yi(this._defaults,this._scriptSrc,t,this._pageUrl))}}function yi(...t){let e={};for(const s of t)s&&(e=bi(e,s));return e}function bi(t,e){if(!e)return t;Object.assign(t,e);for(const s of fi)s in e&&(t[s]={...t[s],...e[s]});return t}function vi(t){return""===t||"false"!==t&&t}function wi(t){if(null==t)return t;switch(typeof t){case"function":return t;case"string":case"number":return()=>t;case"object":return Array.isArray(t)?t.map(wi):function(t,e){const s={};for(const[n,i]of Object.entries(t))s[n]=e(i);return s}(t,wi);default:throw Error("Unsupported template type: "+t)}}class ki{constructor(t,{classPrefix:e=li.CLASS_PREFIX}={}){if(!t)throw Error("Root element is required");p(this,{root:t,followUpsSection:t.querySelector(`.${e}__follow-ups`),relatedResourcesSection:t.querySelector(`.${e}__related-resources`),relatedResourcesContainer:t.querySelector(`.${e}__related-resources miso-ask`)})}}class Ei extends Dn{constructor(t,e){super({name:"ask-combo",plugin:t,MisoClient:e}),this._options=new gi,this._localOptions={}}config(t={}){t=yi(this._localOptions,t);const e=this._options.resolve(t);return this._localOptions=t,this._resolvedOptions=e,this}get resolvedOptions(){return this._resolvedOptions||(this._resolvedOptions=this._options.resolve(this._localOptions))}get client(){return this._client}get elements(){return this._elements}autoStart(){this.resolvedOptions.autostart&&this.start()}async _start(){await async function(){"loading"===document.readyState&&await new Promise((t=>{document.addEventListener("DOMContentLoaded",t,{once:!0})}))}(),await this.waitForElement(),await this._setupMisoClient(),this._renderRootContent(),this._createClientInstance(),this._setupWorkflows()}async _setupMisoClient(){const{MisoClient:t,resolvedOptions:e}=this,{version:s}=t;p(t,{name:"miso-ask-combo"});("dev"===s||s.indexOf("beta")>0||e.debug)&&t.plugins.use("std:debug"),e.dry_run&&t.plugins.use("std:dry-run"),e.lorem&&await t.plugins.install("std:lorem")}_renderRootContent(){const{element:t,resolvedOptions:e}=this,{templates:s={}}=e;t.innerHTML=s.root(e),this._elements=new ki(t,e)}async _createClientInstance(){this._client=new MisoClient(this.resolvedOptions)}async _setupWorkflows(){const{MisoClient:t,client:e,elements:s,resolvedOptions:n}=this,{wireFollowUps:i,wireRelatedResources:o}=t.ui.defaults.ask,{templates:r={},features:a={},api:c}=n,u=e.ui.ask;c&&e.ui.asks.useApi(c),!1!==a.followUpQuestions&&i(e,s.followUpsSection,{...n,template:r.followUp}),!1!==a.relatedResources&&!1!==a.followUpQuestions&&o(e,s.relatedResourcesSection),u.autoQuery()}}class xi extends W{constructor(t){super("layouts",t,{libName:"layout",keyName:t=>t.type}),this._plugin=t}get(t){return this._libraries[t]}create(t,e){if(!1!==t)switch(typeof t){case"function":return{render:t};case"string":const s=this.get(t);if(!s)throw Error(`Layout of name '${t}' not found.`);return new s(e);default:throw Error("Expect a string, a render function, or boolean value false: "+t)}}}let Ci,Ii,Oi;async function Si(t){const e=await async function(t){return t.MisoClient||window.MisoClient||Ci||(Ci=async function(){return new Promise((t=>{(window.misocmd||(window.misocmd=[])).push((()=>t(window.MisoClient)))}))}())}(t);var s;return Ii=Ii||e.any(),Oi=Oi||await Ii,Oi.ui||await(s=0,new Promise((t=>setTimeout(t,s)))),Oi}const Ri="logo",$i="auto",Ai=Object.freeze([Ri]);function Ti(t){if(!t)return $i;switch(t){case"true":return!0;case"false":return!1;default:throw Error(`Invalid logo attribute value: ${t}.`)}}class Ni extends HTMLElement{static get observedAttributes(){return Ai}constructor(){super(),this._workflow=void 0,this._components=new Set}get isContainer(){return!0}get workflow(){return this._workflow}set workflow(t){this._setWorkflow(t)}get logo(){return Ti(this.getAttribute(Ri))}set logo(t){if(this.logo===t)return;const e=function(t){switch(t){case $i:return;case!0:return"true";case!1:return"false";default:throw Error(`Invalid logo property value: ${t}.`)}}(t);e?this.setAttribute(Ri,e):this.removeAttribute(Ri)}async connectedCallback(){const t=this._client=await Si(Ni);document.body.contains(this)&&this._setWorkflow(this._getWorkflow(t))}disconnectedCallback(){this._setWorkflow(void 0)}_getWorkflow(t){throw Error("Unimplemented")}_setWorkflow(t){this._workflow!==t&&(this._workflow&&this._workflow._views.removeContainer(this),t&&t._views.addContainer(this),this._workflow=t)}attributeChangedCallback(t,e,s){if(t===Ri)this._handleLogoUpdate(e,s)}_handleLogoUpdate(t,e){Ti(t)!==Ti(e)&&this._workflow&&this._workflow._views.refreshElement(this)}get components(){return[...this._components]}_addComponent(t){this._components.has(t)||(this._components.add(t),this._workflow&&this._workflow._views.addComponent(t))}_removeComponent(t){this._components.has(t)&&(this._workflow&&this._workflow._views.removeComponent(t),this._components.delete(t))}_updateComponentRole(t,e,s){this._workflow&&this._workflow._views.updateComponentRole(t,e,s)}}const qi="parent-question-id",Ui=Object.freeze([...Ni.observedAttributes,qi]);const Pi="unit-id",ji=Object.freeze([...Ni.observedAttributes,Pi]);var Li=Object.freeze({__proto__:null,MisoAskElement:class extends Ni{static get tagName(){return"miso-ask"}static get observedAttributes(){return Ui}_getWorkflow(t){return this._getWorkflowByParentQuestionId(t,this.parentQuestionId)}_getWorkflowByParentQuestionId(t,e){return t.ui.asks.getByParentQuestionId(e,{autoCreate:!0})}get parentQuestionId(){return this.getAttribute(qi)||void 0}set parentQuestionId(t){(t=void 0!==t?""+t:void 0)!==this.parentQuestionId&&(t?this.setAttribute(qi,t):this.removeAttribute(qi))}get workflow(){return this._workflow}set workflow(t){this._setWorkflow(t),this.parentQuestionId=t&&t.parentQuestionId}attributeChangedCallback(t,e,s){if(t===qi)this._handleParentQuestionIdUpdate(e,s);else super.attributeChangedCallback(t,e,s)}_handleParentQuestionIdUpdate(t,e){(t=t||void 0)!==(e=e||void 0)&&this._client&&this._setWorkflow(this._getWorkflowByParentQuestionId(this._client,e))}},MisoExploreElement:class extends Ni{static get observedAttributes(){return Ni.observedAttributes}static get tagName(){return"miso-explore"}_getWorkflow(t){return t.ui.explore}},MisoSearchElement:class extends Ni{static get observedAttributes(){return Ni.observedAttributes}static get tagName(){return"miso-search"}_getWorkflow(t){return t.ui.search}},MisoRecommendationElement:class extends Ni{static get tagName(){return"miso-recommendation"}static get observedAttributes(){return ji}_getWorkflow(t){return this._getWorkflowByUnitId(t,this.unitId)}_getWorkflowByUnitId(t,e){return t.ui.recommendations.get(e)}get unitId(){return this.getAttribute(Pi)||void 0}set unitId(t){(t=t&&""+t)?this.setAttribute(Pi,t):this.removeAttribute(Pi)}attributeChangedCallback(t,e,s){if(t===Pi)this._handleUnitIdUpdate(e,s);else super.attributeChangedCallback(t,e,s)}_handleUnitIdUpdate(t,e){t!==e&&this._client&&this._setWorkflow(this._getWorkflowByUnitId(this._client,e))}}});const Mi="role",Di=Object.freeze([Mi]);class zi extends HTMLElement{static get tagName(){return"miso-component"}static get observedAttributes(){return Di}constructor({role:t}={}){super(),t&&Object.defineProperty(this,"_role",{value:t,writable:!1})}get role(){return this._role}connectedCallback(){const t=function(t){for(let e=t;e;e=e.parentNode)if(e.isContainer)return e;throw Error(t.tagName+" needs to be placed under a workflow container element.")}(this);this._container&&this._container!==t&&this._container._removeComponent(this),this._syncRole(),t._addComponent(this),this._container=t,this._containerResolution&&this._containerResolution.resolve(t)}_syncRole(){const t=this.getAttribute(Mi);if(t)this._role?console.warn(`Element <${this.tagName}>' already has a predefined role '${this._role}', so attribute '${Mi}="${t}"' is ignored.`):this._role=t;else if(!this._role)throw Error(`An attribute '${Mi}' is required for element <${this.tagName}>`)}disconnectedCallback(){this._container&&(this._container._removeComponent(this),this._container=void 0,this._containerResolution=void 0)}attributeChangedCallback(t,e,s){e!==s&&t===Mi&&this._container&&this._container._updateComponentRole(this,e,s)}}var Bi=Object.freeze({__proto__:null,MisoComponentElement:zi,MisoQueryElement:class extends zi{constructor(){super({role:Pt.QUERY})}static get tagName(){return"miso-query"}},MisoQuerySuggestionsElement:class extends zi{constructor(){super({role:Pt.QUERY_SUGGESTIONS})}static get tagName(){return"miso-query-suggestions"}},MisoFeedbackElement:class extends zi{constructor(){super({role:Pt.FEEDBACK})}static get tagName(){return"miso-feedback"}},MisoResultsElement:class extends zi{constructor(){super({role:Pt.PRODUCTS})}connectedCallback(){console.warn("Element <miso-results> is deprecated. Please use <miso-products> instead."),super.connectedCallback()}static get tagName(){return"miso-results"}},MisoProductsElement:class extends zi{constructor(){super({role:Pt.PRODUCTS})}static get tagName(){return"miso-products"}},MisoQuestionElement:class extends zi{constructor(){super({role:Pt.QUESTION})}static get tagName(){return"miso-question"}},MisoAnswerElement:class extends zi{constructor(){super({role:Pt.ANSWER})}static get tagName(){return"miso-answer"}},MisoSourcesElement:class extends zi{constructor(){super({role:Pt.SOURCES})}static get tagName(){return"miso-sources"}},MisoRelatedResourcesElement:class extends zi{constructor(){super({role:Pt.RELATED_RESOURCES})}static get tagName(){return"miso-related-resources"}},MisoRelatedQuestionsElement:class extends zi{constructor(){super({role:Pt.RELATED_QUESTIONS})}static get tagName(){return"miso-related-questions"}},MisoSovrnAffiliationElement:class extends zi{constructor(){super({role:Pt.AFFILIATION})}static get tagName(){return"miso-affiliation"}},MisoErrorElement:class extends zi{constructor(){super({role:Pt.ERROR})}static get tagName(){return"miso-error"}}});class Qi extends HTMLElement{constructor(){super()}async connectedCallback(){document.body.contains(this)&&this._setCombo(this._getCombo(Qi.MisoClient))}disconnectedCallback(){}_getCombo(t){throw Error("Unimplemented")}_setCombo(t){this._combo!==t&&(this._combo=t,t.element=this,t.autoStart())}}var Fi=Object.freeze({__proto__:null,containers:Li,roles:Bi,combos:Object.freeze({__proto__:null,MisoAskComboElement:class extends Qi{static get tagName(){return"miso-ask-combo"}constructor(){super()}_getCombo(t){return t.ui.combo.ask}}}),MisoBannerElement:os});const Gi=Object.freeze(_i);var Wi=Object.freeze({__proto__:null,ask:Gi});const Hi="ui";let Vi,Ki;async function Yi(){return Ki||(Ki=T(Vi||(Vi=`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@${$}/dist/css/${Hi}.css`)))}class Zi{constructor(t,e){this._plugin=t,this._client=e,this._contexts={}}async require(t){if(this._contexts[t])return this._contexts[t];const e=await this._plugin.requireExtension(t);return this._contexts[t]=e.getContext(this._client)}}class Xi{constructor(t,e){this._plugin=t,this._client=e,p(this,{sources:{api:Me(e)}})}get recommendations(){return this._recommendations||(this._recommendations=this._plugin._getRecommendations(this._client))}get recommendation(){return this.recommendations.get()}get search(){return this._search||(this._search=new Nn(this._plugin,this._client))}get asks(){return this._asks||(this._asks=this._plugin._getAsks(this._client))}get ask(){return this.asks.root}get explore(){return this._explore||(this._explore=new On(this._plugin,this._client))}get ready(){return this._plugin._ready.promise}}class Ji{constructor(t,e){this._plugin=t,this._MisoClient=e}get ask(){return this._ask||(this._ask=new Ei(this._plugin,this._MisoClient))}}Et.plugins.use(class extends G{static get id(){return"std:ui"}constructor(){super("ui"),this.layouts=new xi(this),this._recommendations=new WeakMap,this._asks=new WeakMap,this._extensions=new WeakMap,this._ready=new S}async install(t,e){e.addSubtree(this),t.on("create",this._injectClient.bind(this));const s={defaults:Wi};_(s,this,["layouts","combo","ready"]),p(this,{MisoClient:t}),p(t,{ui:s}),this.combo=new Ji(this,t);const n=Object.values(un).filter((t=>t.type));for(const e of n)e.MisoClient=t;for(const t of n)this.layouts.register(t);const{containers:i,roles:o,combos:r,...a}=Fi,c=[...Object.values(r),...Object.values(i),...Object.values(o),...Object.values(a)];Ni.MisoClient=t,Qi.MisoClient=t;for(const e of c)e.MisoClient=t;await Yi();for(const t of c)v(t);this._ready.resolve()}async requireExtension(t){if("markdown"===t)return await this.MisoClient.plugins.install("std:ui-markdown");throw Error("Unknown extension: "+t)}get ready(){return Promise.all([this._ready.promise,MisoClient.any()]).then((()=>{}))}_injectClient(t){p(t,{ui:new Xi(this,t)})}_getExtensions(t){if(this._extensions.has(t))return this._extensions.get(t);const e=new Zi(this,t);return this._extensions.set(t,e),e}_getRecommendations(t){let e=this._recommendations.get(t);return e||this._recommendations.set(t,e=new Mn(this,t)),e}_getAsks(t){let e=this._asks.get(t);return e||this._asks.set(t,e=new kn(this,t)),e}});let to;const eo=(()=>{if((""+window.fetch).indexOf("[native code]")>-1)return to="original",window.fetch;const t=document.createElement("iframe");return t.style.display="none",document.body.appendChild(t),to="restored",t.contentWindow.fetch})();class so extends G{static get id(){return"idg"}constructor(){super("idg")}install(t,e){navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(e.setCustomFetch(eo),function(...t){console.log("%cMiso","color: #fff; background-color: #9033bb; padding: 2px 2px 1px 4px;","<plugin:idg>","[info]",...t)}(`Using ${to} native fetch`))}}function no(t){const e=new Date;return new Date(e.getFullYear()-t,e.getMonth(),e.getDate()).toISOString().substring(0,10)}function io({site:t,version:e,config:s}){const{aff_type:n}=s;return d({source:"miso-client-script",script_version:e,attribution:"miso-smart-answers",aff_type:n,site:t.key,uuid:x()})}let oo,ro;async function ao(){return oo||(oo=async function(){return async function(t,{interval:e=300,timeout:s}={}){const n=t();return null!=n?n:new Promise(((n,i)=>{let o,r;function a(){o&&clearInterval(o),r&&clearTimeout(r)}o=setInterval((()=>{const e=t();null!=e&&(a(),n(e))}),e),s&&s>0&&(r=setTimeout((()=>{a(),i(Error("Timeout: "+s))}),s))}))}((()=>window.ga&&window.ga.getAll&&window.ga.getAll()[0]))}())}async function co(){if(ro)return ro;const t=await ao();return ro=t.get("clientId")}async function uo(t){const e=await async function(t){let e=t.instances[0];if(e)return e;return new Promise((e=>{t.on("create",(()=>{e(t.instances[0])}))}))}(t);!function(t,e){t._logs=[];const s=e.meta.parent._pluginRoot.get("std:debug");for(const e of["_log","_logr"]){const n=s[e];s[e]=function(){n.apply(this,arguments),t._logs.push("_log"===e?ho(arguments):arguments)}}}(t,e),function(t,e){const s=Date.now();function n({summary:e,timestamp:n,elapsed:i,operation:o,conflict:r}){t.debug("<progressive-markdown>",`[${(n-s)/1e3}](${i[0]/1e3}, ${i[1]/1e3})`,e,""+o,r)}e.ui.asks.useLayouts({answer:{onDebug:n}})}(t,e),function(t){const e=document.body,s=document.createElement("div");s.textContent="Miso Log",s.classList.add("miso-log-download-btn");const n=document.createElement("div");n.textContent=function(t){return"dev"===t||t.startsWith("v")?t:"v"+t}(window.miso_smart_answers_script_version),n.classList.add("miso-version");const i=document.createElement("div");i.classList.add("miso-log-container"),i.appendChild(n),i.appendChild(s),e.appendChild(i),s.addEventListener("click",(()=>function(t){const e=t._logs,s=new Blob([lo(e)],{type:"application/json"}),n=URL.createObjectURL(s),i=document.createElement("a");i.href=n,i.download=`miso-log.${(new Date).toISOString().replaceAll(/[\:\.]/g,"-")}.jsonl`,i.click()}(t)))}(t),t.debug("<custom>","[ua]",""+navigator.userAgent)}function lo(t){return t.map((t=>JSON.stringify(mo(t)))).join("\n")}function ho(t){const[e,s,...n]=t;return[_o(e),po(s),...n]}function _o(t){return`<${"string"==typeof t?t:t.filter((t=>t)).join("/")}>`}function po(t){return`[${t}]`}function mo(t,e=5){return"object"==typeof t&&t?void 0!==t.length?Array.prototype.map.call(t,(t=>mo(t,e-1))):function(t,e){const s=t.constructor.name,n="Object"===s?{}:{__type:s};if(0>=e)return n;for(const s in t){const i=t[s];"function"!=typeof i&&(s.startsWith("_")&&"object"==typeof i&&"Object"!==i.constructor.name||(n[s]=mo(i,e-1)))}return n}(t,e):t}function fo({site:t,config:e,version:s}){Object.defineProperty(Et,"name",{value:"smart-answers"});const n=s.indexOf("beta")>0,i=("dev"===s||n)&&e.logging;return("dev"===s||n||e.debug)&&Et.plugins.use("std:debug",{console:{background:"#9033bb"}}),i&&uo(Et),Et.plugins.use(so),e.test_product?(Et.plugins.use("std:dry-run"),Et.debug&&Et.debug("[Answers] Test product: "+e.test_product)):!e.dry_run&&function(t){return window.location.hostname===t.hostname}(t)||Et.plugins.use("std:dry-run"),window.MisoClientSA=Et,Et}async function go({MisoClient:t,config:e}){const s={readConfigFromScriptUrl:!0};"staging"===e.api_host&&(s.apiHost="https://ask-api.askmiso-staging.com/v1");const n=window.misoSA=new t(s);return n.context.anonymous_id=await co(),n}const yo='<svg fill="currentColor" viewBox="0 0 24 24">\n<path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.696-3.534c.63 0 1.332-.288 2.196-1.458l.911-1.22a.334.334 0 0 0-.074-.472.38.38 0 0 0-.505.06l-1.475 1.679a.241.241 0 0 1-.279.061.211.211 0 0 1-.12-.244l1.858-7.446a.499.499 0 0 0-.575-.613l-3.35.613a.35.35 0 0 0-.276.258l-.086.334a.25.25 0 0 0 .243.312h1.73l-1.476 5.922c-.054.234-.144.63-.144.918 0 .666.396 1.296 1.422 1.296zm1.83-10.536c.702 0 1.242-.414 1.386-1.044.036-.144.054-.306.054-.414 0-.504-.396-.972-1.134-.972-.702 0-1.242.414-1.386 1.044a1.868 1.868 0 0 0-.054.414c0 .504.396.972 1.134.972z"/>\n</svg>';var bo={queryButton:"A.I. Search",home:{title:"Smart Answers from ${name}",queryPlaceholder:"Ask us a question",info:"What is this?"},story:{title:{nonempty:"Explore frequently asked questions",empty:"Explore with a question"},queryPlaceholder:{nonempty:"Ask your own question...",empty:"Ask a question..."}},answers:{title:"Smart Answers",subtitle:"Get your tech questions answered by AI,<br>based only on stories and reviews by our experts.",feedback:{helpful:"Helpful",unhelpful:"Not Helpful"},sources:"My reply is based on the following",relatedResources:"Go beyond, and learn more about this topic",querySuggestions:"Related questions you can explore",followUp:{queryPlaceholder:"Ask a follow-up question",queryButton:"Ask"},affiliation:{title:"Best Prices Today: ${title}"},error:{title:"Oops!",description:"We are currently experiencing some difficulties. Would you please trying again later?"}},sponsor:{phrase:"Supported by",tooltip:"Our sponsors help keep Smart Answers running,<br>but do not influence our editorial independence."}},vo=Object.freeze({__proto__:null,default:bo,queryButton:bo.queryButton,home:bo.home,story:bo.story,answers:bo.answers,sponsor:bo.sponsor}),wo={queryButton:"KI-Suche",home:{title:"Smart Answers von ${name}",queryPlaceholder:"Stellen Sie uns eine Frage",info:"Was ist das?"},story:{title:{nonempty:"Häufig gestellte fragen entdecken",empty:"Häufig gestellte fragen entdecken"},queryPlaceholder:{nonempty:"Stellen Sie Ihre eigene Frage...",empty:"Stellen Sie Ihre eigene Frage..."}},answers:{title:"Smart Answers",subtitle:"Erhalten Sie Antworten auf Ihre Technikfragen durch KI, die ausschließlich auf Berichten und Tests unserer Experten basieren.",feedback:{helpful:"Hilfreich",unhelpful:"Nicht hilfreich"},sources:"Meine Antwort basiert auf folgenden Inhalten",relatedResources:"Erfahren Sie mehr über dieses Thema",querySuggestions:"Verwandte Fragen, die Sie erforschen können",followUp:{queryPlaceholder:"Stellen Sie eine Anschlussfrage",queryButton:"Fragen Sie"},affiliation:{title:"Beste Preise heute: ${title}"},error:{title:"Hoppla!",description:"Wir erleben derzeit einige Schwierigkeiten. Würden Sie es bitte später noch einmal versuchen?"}},sponsor:{phrase:"Unterstützt von",tooltip:"Unsere Sponsoren helfen, Smart Answers am Leben zu halten, haben aber keinen Einfluss auf unsere redaktionelle Unabhängigkeit."}},ko=Object.freeze({__proto__:null,default:wo,queryButton:wo.queryButton,home:wo.home,story:wo.story,answers:wo.answers,sponsor:wo.sponsor});const Eo=function(t){if("de"===t)return ko;return vo}("de");const{currentScript:xo}=document,Co=xo.src.replace(/\/[^/]+$/,"").replace(/\/smart-answers$/,"").replace(/\/discovery$/,"");const Io="miso-smart-answers";function Oo({sponsor:t}){return t?`\n<div class="${Io}__sponsor" data-brand="${t.key}">\n  <div class="${Io}__sponsor-text">${Eo.sponsor.phrase}</div>\n  <div class="${Io}__sponsor-logo">\n    <img src="${function(t){if(t)return t.indexOf("//")>=0||t.startsWith("/")?t:`${Co}/${t}`}(t.image)}" alt="${t.name}">\n  </div>\n  <div class="${Io}__sponsor-info" tabindex="-1">\n    ${yo}\n    <div class="${Io}__sponsor-info-tooltip">${Eo.sponsor.tooltip}</div>\n  </div>\n</div>`.trim():""}function So({title:t,block:e},s={}){return`\n<div class="affiliation">\n  ${s.title?function(t){return`<h4 class="title">${Eo.answers.affiliation.title.replace("${title}",t)}</h4>`}(t):""}\n  ${e}\n</div>\n`}function Ro({parentQuestionId:t}={}){return`\n<miso-ask class="error-container" visible-when="erroneous" logo="false" ${To(t)}>\n  ${t?"<hr>":""}\n  <h2 class="miso-error-header">${Eo.answers.error.title}</h2>\n  <p class="miso-error-description">\n    ${Eo.answers.error.description}\n  </p>\n  <miso-error></miso-error>\n</miso-ask>`}function $o({parentQuestionId:t}={}){return`\n<miso-ask visible-when="ready" logo="false" class="miso-circled-citation-index" ${To(t)}>\n${t?"<hr>":""}\n  <miso-question></miso-question>\n  <miso-answer></miso-answer>\n  <miso-affiliation></miso-affiliation>\n  <miso-feedback></miso-feedback>\n</miso-ask>`}function Ao({parentQuestionId:t}={}){return`\n<miso-ask class="sources-container miso-circled-citation-index" visible-when="ready" logo="false" ${To(t)}>\n  <div class="phrase sources">${Eo.answers.sources}</div>\n  <miso-sources></miso-sources>\n</miso-ask>`}function To(t){return t?`parent-question-id="${t}"`:""}const No=new Map,qo=new Map;function Uo(t){return t.startsWith("product_")?t.slice(8):t}async function Po(t){return Lo(No,t,Do)}async function jo(t){return Lo(No,t,zo)}async function Lo(t,e,s,...n){const i=e.filter((e=>!t.has(e)));if(i.length>0){const e=await s(i,...n);for(const s of i)t.set(s,e[s])}return e.reduce(((e,s)=>(e[s]=t.get(s),e)),{})}const Mo="111111";async function Do(t){return await Qo("products-view",t,{product_block:"price-comparison",article_id:Mo})}async function zo(t){const e=await Qo("products-view",t,{article_id:Mo});for(const t in e)e[t]=Ho(e[t]);return e}async function Bo(t){const e=await async function(t,e,{fields:s}={}){if(0===e.length)return[];let n=`https://b2c-contenthub.com/wp-json/wp/v2/${t}?include=${e.join(",")}&per_page=100`;s&&(n+="&_fields="+s.join(","));const i=await window.fetch(n);return await i.json()}("product",t,{fields:["id","title"]});return function(t,e){const s={};for(const n of t)s[n[e]]=n;return s}(e,"id")}async function Qo(t,e,s={}){if(0===e.length)return[];let n=`/wp-json/idg/v2/${t}?include=${e.join(",")}&per_page=100&_embed=1`;for(const[t,e]of Object.entries(s))n+=`&${encodeURIComponent(t)}=${encodeURIComponent(e)}`;const i=await window.fetch(n);return await i.json()}const Fo='data-vars-outbound-link="',Go='data-vars-outbound-link="',Wo='data-miso-attribution="miso-smart-answers" data-miso-product-type="product" ';function Ho(t,e){return!!function({html:t}){return t.indexOf(Fo)>=0}(t)&&(t=function(t){try{const{html:e}=t,s=e.indexOf(Go);if(0>s)throw Error(`Cannot find '${Go}' in product view HTML.`);t.html=e.substring(0,s)+Wo+e.substring(s)}catch(t){console.error("Failed to add miso attribution attribute on anchor element."),console.error(t)}return t}(t))}class Vo{constructor(t,e){this._workflow=t,this._context=Object.freeze({...e}),this._element=void 0,this._session=void 0,this._products=[],this._html=void 0,this._syncIndex=0,this._clicked=!1,t.on("data",(t=>this.updateData(t)))}async updateData({session:t,value:e}={}){if(!t)return;if(this._products.length>0&&this._session&&this._session.uuid===t.uuid)return;const s=this._getProducts(e);var n,i;(i=s,0===(n=this._products).length&&0===i.length||(n[0]&&n[0].product_id)===(i[0]&&i[0].product_id))||(this._session=t,this._products=s,this._sendInteraction("custom",{custom_action_name:"affiliation_response"}),this._syncView())}get element(){if(!this._element){const{parentQuestionId:t}=this._workflow,e=`.miso-smart-answers ${t?`miso-ask[parent-question-id="${CSS.escape(t)}"]`:"miso-ask:not([parent-question-id])"} miso-affiliation`;if(this._element=document.querySelector(e),!this._element)throw Error("Element not found: "+e);this._element.addEventListener("click",(t=>this._handleClick(t)))}return this._element}_getProducts(t){const{test_product:e}=this._context.config;if(e)return[{product_id:"product_"+e}];const{affiliation_products:s=[]}=t||{};return s||[]}async _syncView(){const t=this._syncIndex++;if(this._selected=await async function(t,e){const{debug:s}=e;if(0===t.length)return void s("[Affiliation] No affiliated products.");const[n,i]=await Promise.all([Ko(t,e),Yo(t)]),o=[];for(const{product_id:e}of t){const t=n[e],s=i[e];if(t&&s){const n=Uo(e);o.push({product_id:e,id:n,title:s,block:t})}}if(o.length>0)return Object.freeze(o[0]);return void s("[Affiliation] No non-empty views for affiliated products: "+t.map((({product_id:t})=>Uo(t))).join(", "))}(this._products,this._context),this._syncIndex!==t+1)return;this._selected||this._sendInteraction("custom",{custom_action_name:"product_view_empty_response"});this._html=this._selected?So(this._selected,{title:"product"!==this._context.config.aff_type}):"",this._requestRender(t)}async _requestRender(t){this._render(),this._selected&&(this._sendInteraction("impression"),this._measureViewable())}_render(){this.element.innerHTML=this._html}async _measureViewable(){await this._context.MisoClient.helpers.viewable(this.element),this._sendInteraction("viewable_impression")}_handleClick({target:t}){if(this._clicked)return;const e=function(t,e,{root:s}){if("string"==typeof e){const t=e;e=e=>e.matches(t)?e:void 0}for(let n=t;n&&n!==s;n=n.parentElement){const t=e(n);if(t)return t}}(t,"a[href]",{root:this.element});e&&(this._sendInteraction("click"),this._clicked=!0)}_sendInteraction(t,e={}){const{client:s}=this._context,{questionId:n,parentQuestionId:i,rootQuestionId:o,session:r}=this._workflow,{question_source:a="_organic"}=r.meta||{},c=this._selected?[this._selected.product_id]:void 0,u=this._products.map((({product_id:t})=>t));s.api.interactions.upload(d({type:t,...e,product_ids:c,context:{custom_context:d({...io(this._context),api_group:"ask",api_name:"questions",property:"affiliation_products",root_question_id:o,parent_question_id:i,question_id:n,question_source:a,candidate_product_ids:u})}}))}}async function Ko(t,{config:e}){const s=t.map((({product_id:t})=>Uo(t))),n=await("product"===e.aff_type?jo:Po)(s),i={};for(const{product_id:e}of t){const t=n[Uo(e)];i[e]=t&&t.html&&t.html.trim()||""}return i}async function Yo(t){const e={},s=[];for(const{product_id:n,title:i}of t)i?e[n]=i:s.push(n);if(s.length>0){const t=await async function(t){return Lo(qo,t,Bo)}(s.map(Uo));for(const n of s)e[n]=t[Uo(n)].title}return e}const Zo="miso-smart-answers";let Xo,Jo,tr;function er(t){const{config:e,site:s,client:n}=t,{aff_type:i}=e;Xo=document.querySelector(`.${Zo} #follow-ups`),Jo=document.querySelector(`.${Zo} #related-resources`),tr=document.querySelector(`.${Zo} #related-resources miso-ask`);const o=n.ui.asks,r=n.ui.ask;o.useApi("questions",{_meta:{site:s.key,aff_type:i},yearly_decay:.93,fq:sr(t)}),o.useLayouts({feedback:{templates:{text:(t,e)=>Eo.answers.feedback["helpful"===e?"helpful":"unhelpful"]}}}),"de"===s.lang&&o.useLayouts({sources:{templates:{date:"de-DE"}},related_resources:{templates:{date:"de-DE"}}}),o.on("data",(({workflow:t,value:e})=>{const{sources:s,related_resources:n}=e||{};tr.workflow===t&&ar(Jo,n),ar(rr(t,"sources-container"),s)})),o.useDataProcessor(ir),o.useInteractions({preprocess:e=>function(t,e){return{...e,context:{...e.context,custom_context:{...io(t),...e.context&&e.context.custom_context}}}}(t,e)}),o.on("done",(({workflow:t})=>{Xo.insertAdjacentHTML("beforeend",function({parentQuestionId:t}){return`\n<div class="session">\n  <miso-ask class="query-suggestions-container" visible-when="initial" parent-question-id="${t}">\n    <div class="phrase query-suggestions">${Eo.answers.querySuggestions}</div>\n    <miso-query-suggestions></miso-query-suggestions>\n  </miso-ask>\n  <miso-ask class="query-container" visible-when="initial loading" parent-question-id="${t}">\n    <miso-query>\n      <input class="input" data-role="input" placeholder="${Eo.answers.followUp.queryPlaceholder}">\n      <button class="button" data-role="button">\n        <span>${Eo.answers.followUp.queryButton}</span>\n      </button>\n    </miso-query>\n  </miso-ask>\n  ${Ro({parentQuestionId:t})}\n  ${$o({parentQuestionId:t})}\n  ${Ao({parentQuestionId:t})}\n</div>`}({parentQuestionId:t.questionId}))})),o.on("loading",(({workflow:t})=>{tr.workflow=t})),nr(r,t),o.on("create",(e=>nr(e,t))),r.on("loading",(()=>{Xo.innerHTML="",o.reset({root:!1})})),r.autoQuery()}function sr(t){const{site:e}=t;return"de"===e.lang?`created_at:[${no(2)} TO *] AND type:story AND -custom_attributes.content_type:(DealPost BrandPost SponsoredContent) AND custom_attributes.languages:German`:`created_at:[${no(2)} TO *] AND type:story AND -custom_attributes.content_type:(DealPost BrandPost SponsoredContent) AND (custom_attributes.languages:English OR NOT _exists_:custom_attributes.languages)`}function nr(t,e){t._affiliation=new Vo(t,e),ar(rr(t,"query-suggestions-container"),t.states.suggestions)}function ir({value:t,...e}){if(!t)return e;const{sources:s=[],related_resources:n=[]}=t;return{value:{...t,sources:s.map(or),related_resources:n.map(or)},...e}}function or({url:t,...e}){const{product_id:s}=e;if(t&&s&&t.indexOf("//b2c-contenthub.com/")>=0){const[e,n]=s.split("_");t=t.replace("//b2c-contenthub.com/",`//www.${n}.com/`)}return{url:t+=(0>t.indexOf("?")?"?":"&")+"utm=smart_answers",...e}}function rr(t,e){const{parentQuestionId:s}=t,n=s?`[parent-question-id="${CSS.escape(s)}"]`:":not([parent-question-id])";return document.querySelector(`.${Zo} miso-ask.${e}${n}`)}function ar(t,e){t&&t.classList[e&&0!==e.length?"remove":"add"]("empty")}const{currentScript:cr}=document;async function ur({MisoClient:t}){await Promise.all([lr(t),dr()])}async function lr(t){await _r(`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@${t.version}/dist/css/ui.css`)}let hr=!1;async function dr(){if(hr)return;if(hr=!0,!cr)throw Error("currentScript not found");const t=cr.src,e=t.indexOf("?"),s=(0>e?t:t.substring(0,e)).replace(/(\.min)?\.js$/,".css");await _r(s)}async function _r(t){if(!document.querySelector(`link[href="${t}"]`))return new Promise(((e,s)=>{const n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.onload=e,n.onerror=s,n.href=t,document.head.appendChild(n)}))}const pr=".layout--right-rail .wp-block-column";function mr(t,e){const{aff_type:s}=t;return"random"!==s?s:function(t){let e=0;for(let s=0,n=t.length;n>s;s++)e=(e<<5)-e+t.charCodeAt(s)|0;return e/2**32+.5}(e)>.2?"price_comparison":"product"}(async(t,s)=>{if("/smart-answers"!==window.location.pathname)return;if(window.miso_smart_answers_script_version)return void console.warn("Miso Smart Answers script already executed: "+window.miso_smart_answers_script_version);window.miso_smart_answers_script_version=e;const i=fo({site:t,config:s,version:e,sponsor:n}),o=i.debug||(()=>{});o("Miso Smart Answers script version: "+e);const r=document.querySelector(pr);if(!r)return void console.error("Container not found: "+pr);i.plugins.use("std:ui");const[a,c]=await Promise.all([go({config:s,MisoClient:i}),co(),ur({site:t,MisoClient:i})]);s={...s,aff_type:mr(s,c)},r.innerHTML=`\n<div class="miso-smart-answers">\n  ${Oo({sponsor:n})}\n  <section class="question">\n    <div class="hero">\n      <div class="hero-inner">\n        <h2 class="title">${Eo.answers.title}</h2>\n        <h4 class="slogan">${Eo.answers.subtitle}</h4>\n      </div>\n    </div>\n    <miso-ask class="query-container">\n      <miso-query>\n        <input class="input" data-role="input">\n        <button class="button" data-role="button">\n          <i><svg fill="currentColor" viewBox="0 0 16 16">\n<path d="M12.52.55l-5,5h0L.55,12.51l3,3,12-12Zm-4,6,4-4,1,1-4,4.05ZM2.77,3.18A3.85,3.85,0,0,1,5.32,5.73h0A3.85,3.85,0,0,1,7.87,3.18h0A3.82,3.82,0,0,1,5.32.64h0A3.82,3.82,0,0,1,2.77,3.18ZM8.5,2.55h0A2,2,0,0,1,9.78,1.27h0A1.92,1.92,0,0,1,8.5,0h0A1.88,1.88,0,0,1,7.23,1.27h0A1.92,1.92,0,0,1,8.5,2.55Zm-6.36,0h0A1.92,1.92,0,0,1,3.41,1.27h0A1.88,1.88,0,0,1,2.14,0h0A1.92,1.92,0,0,1,.86,1.27h0A2,2,0,0,1,2.14,2.55ZM14.73,6.22h0a1.94,1.94,0,0,1-1.28,1.27h0a1.94,1.94,0,0,1,1.28,1.27h0A1.9,1.9,0,0,1,16,7.49h0A1.9,1.9,0,0,1,14.73,6.22Z"/>\n</svg></i>\n          <span>${Eo.queryButton}</span>\n        </button>\n        </miso-query>\n    </miso-ask>\n  </section>\n  <section class="answer">\n    ${Ro()}\n    ${$o()}\n    ${Ao()}\n  </section>\n  <section id="follow-ups" class="follow-ups">\n  </section>\n  <section id="related-resources" class="related-resources empty">\n    <miso-ask visible-when="ready" logo="false">\n      <div class="phrase related-resources">${Eo.answers.relatedResources}</div>\n      <miso-related-resources></miso-related-resources>\n    </miso-ask>\n  </section>\n</div>`,er({site:t,config:s,client:a,MisoClient:i,debug:o,version:e,sponsor:n})})({key:"pcwelt",hostname:"www.pcwelt.de",name:"PC-WELT",lang:"de",regions:[],ref_story:"2385340"},t)}();
