(function(){"use strict";/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Pn(s){const e=Object.create(null);for(const t of s.split(","))e[t]=1;return t=>t in e}const q={},Ct=[],ke=()=>{},pr=()=>!1,Ls=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&(s.charCodeAt(2)>122||s.charCodeAt(2)<97),Nn=s=>s.startsWith("onUpdate:"),ce=Object.assign,Ln=(s,e)=>{const t=s.indexOf(e);t>-1&&s.splice(t,1)},_a=Object.prototype.hasOwnProperty,F=(s,e)=>_a.call(s,e),P=Array.isArray,Vt=s=>Us(s)==="[object Map]",da=s=>Us(s)==="[object Set]",k=s=>typeof s=="function",J=s=>typeof s=="string",xt=s=>typeof s=="symbol",Y=s=>s!==null&&typeof s=="object",mr=s=>(Y(s)||k(s))&&k(s.then)&&k(s.catch),pa=Object.prototype.toString,Us=s=>pa.call(s),ma=s=>Us(s).slice(8,-1),ga=s=>Us(s)==="[object Object]",Un=s=>J(s)&&s!=="NaN"&&s[0]!=="-"&&""+parseInt(s,10)===s,Kt=Pn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Ds=s=>{const e=Object.create(null);return(t=>e[t]||(e[t]=s(t)))},ba=/-\w/g,nt=Ds(s=>s.replace(ba,e=>e.slice(1).toUpperCase())),wa=/\B([A-Z])/g,dt=Ds(s=>s.replace(wa,"-$1").toLowerCase()),gr=Ds(s=>s.charAt(0).toUpperCase()+s.slice(1)),Dn=Ds(s=>s?`on${gr(s)}`:""),pt=(s,e)=>!Object.is(s,e),Fn=(s,...e)=>{for(let t=0;t<s.length;t++)s[t](...e)},br=(s,e,t,n=!1)=>{Object.defineProperty(s,e,{configurable:!0,enumerable:!1,writable:n,value:t})},ya=s=>{const e=parseFloat(s);return isNaN(e)?s:e};let wr;const Fs=()=>wr||(wr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Mn(s){if(P(s)){const e={};for(let t=0;t<s.length;t++){const n=s[t],i=J(n)?Oa(n):Mn(n);if(i)for(const r in i)e[r]=i[r]}return e}else if(J(s)||Y(s))return s}const Ea=/;(?![^(]*\))/g,Ta=/:([^]+)/,Sa=/\/\*[^]*?\*\//g;function Oa(s){const e={};return s.replace(Sa,"").split(Ea).forEach(t=>{if(t){const n=t.split(Ta);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function jn(s){let e="";if(J(s))e=s;else if(P(s))for(let t=0;t<s.length;t++){const n=jn(s[t]);n&&(e+=n+" ")}else if(Y(s))for(const t in s)s[t]&&(e+=t+" ");return e.trim()}const Aa=Pn("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function yr(s){return!!s||s===""}/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let de;class va{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=de,!e&&de&&(this.index=(de.scopes||(de.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,t;if(this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=de;try{return de=this,e()}finally{de=t}}}on(){++this._on===1&&(this.prevScope=de,de=this)}off(){this._on>0&&--this._on===0&&(de=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let t,n;for(t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.parent=void 0}}}function Ia(){return de}let B;const qn=new WeakSet;class Er{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,de&&de.active&&de.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,qn.has(this)&&(qn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||Sr(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Cr(this),Or(this);const e=B,t=Ce;B=this,Ce=!0;try{return this.fn()}finally{Ar(this),B=e,Ce=t,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)Gn(e);this.deps=this.depsTail=void 0,Cr(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?qn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Hn(this)&&this.run()}get dirty(){return Hn(this)}}let Tr=0,Yt,Zt;function Sr(s,e=!1){if(s.flags|=8,e){s.next=Zt,Zt=s;return}s.next=Yt,Yt=s}function Bn(){Tr++}function zn(){if(--Tr>0)return;if(Zt){let e=Zt;for(Zt=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let s;for(;Yt;){let e=Yt;for(Yt=void 0;e;){const t=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){s||(s=n)}e=t}}if(s)throw s}function Or(s){for(let e=s.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function Ar(s){let e,t=s.depsTail,n=t;for(;n;){const i=n.prevDep;n.version===-1?(n===t&&(t=i),Gn(n),Ca(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=i}s.deps=e,s.depsTail=t}function Hn(s){for(let e=s.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(vr(e.dep.computed)||e.dep.version!==e.version))return!0;return!!s._dirty}function vr(s){if(s.flags&4&&!(s.flags&16)||(s.flags&=-17,s.globalVersion===Jt)||(s.globalVersion=Jt,!s.isSSR&&s.flags&128&&(!s.deps&&!s._dirty||!Hn(s))))return;s.flags|=2;const e=s.dep,t=B,n=Ce;B=s,Ce=!0;try{Or(s);const i=s.fn(s._value);(e.version===0||pt(i,s._value))&&(s.flags|=128,s._value=i,e.version++)}catch(i){throw e.version++,i}finally{B=t,Ce=n,Ar(s),s.flags&=-3}}function Gn(s,e=!1){const{dep:t,prevSub:n,nextSub:i}=s;if(n&&(n.nextSub=i,s.prevSub=void 0),i&&(i.prevSub=n,s.nextSub=void 0),t.subs===s&&(t.subs=n,!n&&t.computed)){t.computed.flags&=-5;for(let r=t.computed.deps;r;r=r.nextDep)Gn(r,!0)}!e&&!--t.sc&&t.map&&t.map.delete(t.key)}function Ca(s){const{prevDep:e,nextDep:t}=s;e&&(e.nextDep=t,s.prevDep=void 0),t&&(t.prevDep=e,s.nextDep=void 0)}let Ce=!0;const Ir=[];function Pe(){Ir.push(Ce),Ce=!1}function Ne(){const s=Ir.pop();Ce=s===void 0?!0:s}function Cr(s){const{cleanup:e}=s;if(s.cleanup=void 0,e){const t=B;B=void 0;try{e()}finally{B=t}}}let Jt=0;class xa{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class xr{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!B||!Ce||B===this.computed)return;let t=this.activeLink;if(t===void 0||t.sub!==B)t=this.activeLink=new xa(B,this),B.deps?(t.prevDep=B.depsTail,B.depsTail.nextDep=t,B.depsTail=t):B.deps=B.depsTail=t,Rr(t);else if(t.version===-1&&(t.version=this.version,t.nextDep)){const n=t.nextDep;n.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=n),t.prevDep=B.depsTail,t.nextDep=void 0,B.depsTail.nextDep=t,B.depsTail=t,B.deps===t&&(B.deps=n)}return t}trigger(e){this.version++,Jt++,this.notify(e)}notify(e){Bn();try{for(let t=this.subs;t;t=t.prevSub)t.sub.notify()&&t.sub.dep.notify()}finally{zn()}}}function Rr(s){if(s.dep.sc++,s.sub.flags&4){const e=s.dep.computed;if(e&&!s.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)Rr(n)}const t=s.dep.subs;t!==s&&(s.prevSub=t,t&&(t.nextSub=s)),s.dep.subs=s}}const Qn=new WeakMap,mt=Symbol(""),Wn=Symbol(""),Xt=Symbol("");function ne(s,e,t){if(Ce&&B){let n=Qn.get(s);n||Qn.set(s,n=new Map);let i=n.get(t);i||(n.set(t,i=new xr),i.map=n,i.key=t),i.track()}}function We(s,e,t,n,i,r){const o=Qn.get(s);if(!o){Jt++;return}const c=u=>{u&&u.trigger()};if(Bn(),e==="clear")o.forEach(c);else{const u=P(s),h=u&&Un(t);if(u&&t==="length"){const a=Number(n);o.forEach((_,m)=>{(m==="length"||m===Xt||!xt(m)&&m>=a)&&c(_)})}else switch((t!==void 0||o.has(void 0))&&c(o.get(t)),h&&c(o.get(Xt)),e){case"add":u?h&&c(o.get("length")):(c(o.get(mt)),Vt(s)&&c(o.get(Wn)));break;case"delete":u||(c(o.get(mt)),Vt(s)&&c(o.get(Wn)));break;case"set":Vt(s)&&c(o.get(mt));break}}zn()}function Rt(s){const e=M(s);return e===s?e:(ne(e,"iterate",Xt),Le(s)?e:e.map(we))}function Vn(s){return ne(s=M(s),"iterate",Xt),s}const Ra={__proto__:null,[Symbol.iterator](){return Kn(this,Symbol.iterator,we)},concat(...s){return Rt(this).concat(...s.map(e=>P(e)?Rt(e):e))},entries(){return Kn(this,"entries",s=>(s[1]=we(s[1]),s))},every(s,e){return Ve(this,"every",s,e,void 0,arguments)},filter(s,e){return Ve(this,"filter",s,e,t=>t.map(we),arguments)},find(s,e){return Ve(this,"find",s,e,we,arguments)},findIndex(s,e){return Ve(this,"findIndex",s,e,void 0,arguments)},findLast(s,e){return Ve(this,"findLast",s,e,we,arguments)},findLastIndex(s,e){return Ve(this,"findLastIndex",s,e,void 0,arguments)},forEach(s,e){return Ve(this,"forEach",s,e,void 0,arguments)},includes(...s){return Yn(this,"includes",s)},indexOf(...s){return Yn(this,"indexOf",s)},join(s){return Rt(this).join(s)},lastIndexOf(...s){return Yn(this,"lastIndexOf",s)},map(s,e){return Ve(this,"map",s,e,void 0,arguments)},pop(){return es(this,"pop")},push(...s){return es(this,"push",s)},reduce(s,...e){return $r(this,"reduce",s,e)},reduceRight(s,...e){return $r(this,"reduceRight",s,e)},shift(){return es(this,"shift")},some(s,e){return Ve(this,"some",s,e,void 0,arguments)},splice(...s){return es(this,"splice",s)},toReversed(){return Rt(this).toReversed()},toSorted(s){return Rt(this).toSorted(s)},toSpliced(...s){return Rt(this).toSpliced(...s)},unshift(...s){return es(this,"unshift",s)},values(){return Kn(this,"values",we)}};function Kn(s,e,t){const n=Vn(s),i=n[e]();return n!==s&&!Le(s)&&(i._next=i.next,i.next=()=>{const r=i._next();return r.done||(r.value=t(r.value)),r}),i}const $a=Array.prototype;function Ve(s,e,t,n,i,r){const o=Vn(s),c=o!==s&&!Le(s),u=o[e];if(u!==$a[e]){const _=u.apply(s,r);return c?we(_):_}let h=t;o!==s&&(c?h=function(_,m){return t.call(this,we(_),m,s)}:t.length>2&&(h=function(_,m){return t.call(this,_,m,s)}));const a=u.call(o,h,n);return c&&i?i(a):a}function $r(s,e,t,n){const i=Vn(s);let r=t;return i!==s&&(Le(s)?t.length>3&&(r=function(o,c,u){return t.call(this,o,c,u,s)}):r=function(o,c,u){return t.call(this,o,we(c),u,s)}),i[e](r,...n)}function Yn(s,e,t){const n=M(s);ne(n,"iterate",Xt);const i=n[e](...t);return(i===-1||i===!1)&&ei(t[0])?(t[0]=M(t[0]),n[e](...t)):i}function es(s,e,t=[]){Pe(),Bn();const n=M(s)[e].apply(s,t);return zn(),Ne(),n}const ka=Pn("__proto__,__v_isRef,__isVue"),kr=new Set(Object.getOwnPropertyNames(Symbol).filter(s=>s!=="arguments"&&s!=="caller").map(s=>Symbol[s]).filter(xt));function Pa(s){xt(s)||(s=String(s));const e=M(this);return ne(e,"has",s),e.hasOwnProperty(s)}class Pr{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if(t==="__v_skip")return e.__v_skip;const i=this._isReadonly,r=this._isShallow;if(t==="__v_isReactive")return!i;if(t==="__v_isReadonly")return i;if(t==="__v_isShallow")return r;if(t==="__v_raw")return n===(i?r?Mr:Fr:r?Dr:Ur).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const o=P(e);if(!i){let u;if(o&&(u=Ra[t]))return u;if(t==="hasOwnProperty")return Pa}const c=Reflect.get(e,t,ie(e)?e:n);if((xt(t)?kr.has(t):ka(t))||(i||ne(e,"get",t),r))return c;if(ie(c)){const u=o&&Un(t)?c:c.value;return i&&Y(u)?Xn(u):u}return Y(c)?i?Xn(c):Jn(c):c}}class Nr extends Pr{constructor(e=!1){super(!1,e)}set(e,t,n,i){let r=e[t];if(!this._isShallow){const u=$t(r);if(!Le(n)&&!$t(n)&&(r=M(r),n=M(n)),!P(e)&&ie(r)&&!ie(n))return u||(r.value=n),!0}const o=P(e)&&Un(t)?Number(t)<e.length:F(e,t),c=Reflect.set(e,t,n,ie(e)?e:i);return e===M(i)&&(o?pt(n,r)&&We(e,"set",t,n):We(e,"add",t,n)),c}deleteProperty(e,t){const n=F(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&We(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(!xt(t)||!kr.has(t))&&ne(e,"has",t),n}ownKeys(e){return ne(e,"iterate",P(e)?"length":mt),Reflect.ownKeys(e)}}class Lr extends Pr{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const Na=new Nr,La=new Lr,Ua=new Nr(!0),Da=new Lr(!0),Zn=s=>s,Ms=s=>Reflect.getPrototypeOf(s);function Fa(s,e,t){return function(...n){const i=this.__v_raw,r=M(i),o=Vt(r),c=s==="entries"||s===Symbol.iterator&&o,u=s==="keys"&&o,h=i[s](...n),a=t?Zn:e?ti:we;return!e&&ne(r,"iterate",u?Wn:mt),{next(){const{value:_,done:m}=h.next();return m?{value:_,done:m}:{value:c?[a(_[0]),a(_[1])]:a(_),done:m}},[Symbol.iterator](){return this}}}}function js(s){return function(...e){return s==="delete"?!1:s==="clear"?void 0:this}}function Ma(s,e){const t={get(i){const r=this.__v_raw,o=M(r),c=M(i);s||(pt(i,c)&&ne(o,"get",i),ne(o,"get",c));const{has:u}=Ms(o),h=e?Zn:s?ti:we;if(u.call(o,i))return h(r.get(i));if(u.call(o,c))return h(r.get(c));r!==o&&r.get(i)},get size(){const i=this.__v_raw;return!s&&ne(M(i),"iterate",mt),i.size},has(i){const r=this.__v_raw,o=M(r),c=M(i);return s||(pt(i,c)&&ne(o,"has",i),ne(o,"has",c)),i===c?r.has(i):r.has(i)||r.has(c)},forEach(i,r){const o=this,c=o.__v_raw,u=M(c),h=e?Zn:s?ti:we;return!s&&ne(u,"iterate",mt),c.forEach((a,_)=>i.call(r,h(a),h(_),o))}};return ce(t,s?{add:js("add"),set:js("set"),delete:js("delete"),clear:js("clear")}:{add(i){!e&&!Le(i)&&!$t(i)&&(i=M(i));const r=M(this);return Ms(r).has.call(r,i)||(r.add(i),We(r,"add",i,i)),this},set(i,r){!e&&!Le(r)&&!$t(r)&&(r=M(r));const o=M(this),{has:c,get:u}=Ms(o);let h=c.call(o,i);h||(i=M(i),h=c.call(o,i));const a=u.call(o,i);return o.set(i,r),h?pt(r,a)&&We(o,"set",i,r):We(o,"add",i,r),this},delete(i){const r=M(this),{has:o,get:c}=Ms(r);let u=o.call(r,i);u||(i=M(i),u=o.call(r,i)),c&&c.call(r,i);const h=r.delete(i);return u&&We(r,"delete",i,void 0),h},clear(){const i=M(this),r=i.size!==0,o=i.clear();return r&&We(i,"clear",void 0,void 0),o}}),["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=Fa(i,s,e)}),t}function qs(s,e){const t=Ma(s,e);return(n,i,r)=>i==="__v_isReactive"?!s:i==="__v_isReadonly"?s:i==="__v_raw"?n:Reflect.get(F(t,i)&&i in n?t:n,i,r)}const ja={get:qs(!1,!1)},qa={get:qs(!1,!0)},Ba={get:qs(!0,!1)},za={get:qs(!0,!0)},Ur=new WeakMap,Dr=new WeakMap,Fr=new WeakMap,Mr=new WeakMap;function Ha(s){switch(s){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ga(s){return s.__v_skip||!Object.isExtensible(s)?0:Ha(ma(s))}function Jn(s){return $t(s)?s:Bs(s,!1,Na,ja,Ur)}function Qa(s){return Bs(s,!1,Ua,qa,Dr)}function Xn(s){return Bs(s,!0,La,Ba,Fr)}function lT(s){return Bs(s,!0,Da,za,Mr)}function Bs(s,e,t,n,i){if(!Y(s)||s.__v_raw&&!(e&&s.__v_isReactive))return s;const r=Ga(s);if(r===0)return s;const o=i.get(s);if(o)return o;const c=new Proxy(s,r===2?n:t);return i.set(s,c),c}function ts(s){return $t(s)?ts(s.__v_raw):!!(s&&s.__v_isReactive)}function $t(s){return!!(s&&s.__v_isReadonly)}function Le(s){return!!(s&&s.__v_isShallow)}function ei(s){return s?!!s.__v_raw:!1}function M(s){const e=s&&s.__v_raw;return e?M(e):s}function Wa(s){return!F(s,"__v_skip")&&Object.isExtensible(s)&&br(s,"__v_skip",!0),s}const we=s=>Y(s)?Jn(s):s,ti=s=>Y(s)?Xn(s):s;function ie(s){return s?s.__v_isRef===!0:!1}function Va(s){return ie(s)?s.value:s}const Ka={get:(s,e,t)=>e==="__v_raw"?s:Va(Reflect.get(s,e,t)),set:(s,e,t,n)=>{const i=s[e];return ie(i)&&!ie(t)?(i.value=t,!0):Reflect.set(s,e,t,n)}};function jr(s){return ts(s)?s:new Proxy(s,Ka)}class Ya{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new xr(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Jt-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&B!==this)return Sr(this,!0),!0}get value(){const e=this.dep.track();return vr(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Za(s,e,t=!1){let n,i;return k(s)?n=s:(n=s.get,i=s.set),new Ya(n,i,t)}const zs={},Hs=new WeakMap;let gt;function Ja(s,e=!1,t=gt){if(t){let n=Hs.get(t);n||Hs.set(t,n=[]),n.push(s)}}function Xa(s,e,t=q){const{immediate:n,deep:i,once:r,scheduler:o,augmentJob:c,call:u}=t,h=x=>i?x:Le(x)||i===!1||i===0?it(x,1):it(x);let a,_,m,T,$=!1,N=!1;if(ie(s)?(_=()=>s.value,$=Le(s)):ts(s)?(_=()=>h(s),$=!0):P(s)?(N=!0,$=s.some(x=>ts(x)||Le(x)),_=()=>s.map(x=>{if(ie(x))return x.value;if(ts(x))return h(x);if(k(x))return u?u(x,2):x()})):k(s)?e?_=u?()=>u(s,2):s:_=()=>{if(m){Pe();try{m()}finally{Ne()}}const x=gt;gt=a;try{return u?u(s,3,[T]):s(T)}finally{gt=x}}:_=ke,e&&i){const x=_,X=i===!0?1/0:i;_=()=>it(x(),X)}const he=Ia(),D=()=>{a.stop(),he&&he.active&&Ln(he.effects,a)};if(r&&e){const x=e;e=(...X)=>{x(...X),D()}}let Q=N?new Array(s.length).fill(zs):zs;const K=x=>{if(!(!(a.flags&1)||!a.dirty&&!x))if(e){const X=a.run();if(i||$||(N?X.some((ht,Be)=>pt(ht,Q[Be])):pt(X,Q))){m&&m();const ht=gt;gt=a;try{const Be=[X,Q===zs?void 0:N&&Q[0]===zs?[]:Q,T];Q=X,u?u(e,3,Be):e(...Be)}finally{gt=ht}}}else a.run()};return c&&c(K),a=new Er(_),a.scheduler=o?()=>o(K,!1):K,T=x=>Ja(x,!1,a),m=a.onStop=()=>{const x=Hs.get(a);if(x){if(u)u(x,4);else for(const X of x)X();Hs.delete(a)}},e?n?K(!0):Q=a.run():o?o(K.bind(null,!0),!0):a.run(),D.pause=a.pause.bind(a),D.resume=a.resume.bind(a),D.stop=D,D}function it(s,e=1/0,t){if(e<=0||!Y(s)||s.__v_skip||(t=t||new Map,(t.get(s)||0)>=e))return s;if(t.set(s,e),e--,ie(s))it(s.value,e,t);else if(P(s))for(let n=0;n<s.length;n++)it(s[n],e,t);else if(da(s)||Vt(s))s.forEach(n=>{it(n,e,t)});else if(ga(s)){for(const n in s)it(s[n],e,t);for(const n of Object.getOwnPropertySymbols(s))Object.prototype.propertyIsEnumerable.call(s,n)&&it(s[n],e,t)}return s}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const ss=[];let si=!1;function aT(s,...e){if(si)return;si=!0,Pe();const t=ss.length?ss[ss.length-1].component:null,n=t&&t.appContext.config.warnHandler,i=ef();if(n)kt(n,t,11,[s+e.map(r=>{var o,c;return(c=(o=r.toString)==null?void 0:o.call(r))!=null?c:JSON.stringify(r)}).join(""),t&&t.proxy,i.map(({vnode:r})=>`at <${No(t,r.type)}>`).join(`
`),i]);else{const r=[`[Vue warn]: ${s}`,...e];i.length&&r.push(`
`,...tf(i)),console.warn(...r)}Ne(),si=!1}function ef(){let s=ss[ss.length-1];if(!s)return[];const e=[];for(;s;){const t=e[0];t&&t.vnode===s?t.recurseCount++:e.push({vnode:s,recurseCount:0});const n=s.component&&s.component.parent;s=n&&n.vnode}return e}function tf(s){const e=[];return s.forEach((t,n)=>{e.push(...n===0?[]:[`
`],...sf(t))}),e}function sf({vnode:s,recurseCount:e}){const t=e>0?`... (${e} recursive calls)`:"",n=s.component?s.component.parent==null:!1,i=` at <${No(s.component,s.type,n)}`,r=">"+t;return s.props?[i,...nf(s.props),r]:[i+r]}function nf(s){const e=[],t=Object.keys(s);return t.slice(0,3).forEach(n=>{e.push(...qr(n,s[n]))}),t.length>3&&e.push(" ..."),e}function qr(s,e,t){return J(e)?(e=JSON.stringify(e),t?e:[`${s}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?t?e:[`${s}=${e}`]:ie(e)?(e=qr(s,M(e.value),!0),t?e:[`${s}=Ref<`,e,">"]):k(e)?[`${s}=fn${e.name?`<${e.name}>`:""}`]:(e=M(e),t?e:[`${s}=`,e])}function kt(s,e,t,n){try{return n?s(...n):s()}catch(i){Gs(i,e,t)}}function Ue(s,e,t,n){if(k(s)){const i=kt(s,e,t,n);return i&&mr(i)&&i.catch(r=>{Gs(r,e,t)}),i}if(P(s)){const i=[];for(let r=0;r<s.length;r++)i.push(Ue(s[r],e,t,n));return i}}function Gs(s,e,t,n=!0){const i=e?e.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:o}=e&&e.appContext.config||q;if(e){let c=e.parent;const u=e.proxy,h=`https://vuejs.org/error-reference/#runtime-${t}`;for(;c;){const a=c.ec;if(a){for(let _=0;_<a.length;_++)if(a[_](s,u,h)===!1)return}c=c.parent}if(r){Pe(),kt(r,null,10,[s,u,h]),Ne();return}}rf(s,t,i,n,o)}function rf(s,e,t,n=!0,i=!1){if(i)throw s;console.error(s)}const ue=[];let De=-1;const Pt=[];let rt=null,Nt=0;const Br=Promise.resolve();let Qs=null;function of(s){const e=Qs||Br;return s?e.then(this?s.bind(this):s):e}function cf(s){let e=De+1,t=ue.length;for(;e<t;){const n=e+t>>>1,i=ue[n],r=ns(i);r<s||r===s&&i.flags&2?e=n+1:t=n}return e}function ni(s){if(!(s.flags&1)){const e=ns(s),t=ue[ue.length-1];!t||!(s.flags&2)&&e>=ns(t)?ue.push(s):ue.splice(cf(e),0,s),s.flags|=1,zr()}}function zr(){Qs||(Qs=Br.then(Qr))}function uf(s){P(s)?Pt.push(...s):rt&&s.id===-1?rt.splice(Nt+1,0,s):s.flags&1||(Pt.push(s),s.flags|=1),zr()}function Hr(s,e,t=De+1){for(;t<ue.length;t++){const n=ue[t];if(n&&n.flags&2){if(s&&n.id!==s.uid)continue;ue.splice(t,1),t--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function Gr(s){if(Pt.length){const e=[...new Set(Pt)].sort((t,n)=>ns(t)-ns(n));if(Pt.length=0,rt){rt.push(...e);return}for(rt=e,Nt=0;Nt<rt.length;Nt++){const t=rt[Nt];t.flags&4&&(t.flags&=-2),t.flags&8||t(),t.flags&=-2}rt=null,Nt=0}}const ns=s=>s.id==null?s.flags&2?-1:1/0:s.id;function Qr(s){try{for(De=0;De<ue.length;De++){const e=ue[De];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),kt(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;De<ue.length;De++){const e=ue[De];e&&(e.flags&=-2)}De=-1,ue.length=0,Gr(),Qs=null,(ue.length||Pt.length)&&Qr()}}let Fe=null,Wr=null;function Ws(s){const e=Fe;return Fe=s,Wr=s&&s.type.__scopeId||null,e}function lf(s,e=Fe,t){if(!e||s._n)return s;const n=(...i)=>{n._d&&vo(-1);const r=Ws(e);let o;try{o=s(...i)}finally{Ws(r),n._d&&vo(1)}return o};return n._n=!0,n._c=!0,n._d=!0,n}function bt(s,e,t,n){const i=s.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const c=i[o];r&&(c.oldValue=r[o].value);let u=c.dir[n];u&&(Pe(),Ue(u,t,8,[s.el,c,s,e]),Ne())}}const af=Symbol("_vte"),ff=s=>s.__isTeleport,hf=Symbol("_leaveCb");function ii(s,e){s.shapeFlag&6&&s.component?(s.transition=e,ii(s.component.subTree,e)):s.shapeFlag&128?(s.ssContent.transition=e.clone(s.ssContent),s.ssFallback.transition=e.clone(s.ssFallback)):s.transition=e}function Vr(s){s.ids=[s.ids[0]+s.ids[2]+++"-",0,0]}const Vs=new WeakMap;function is(s,e,t,n,i=!1){if(P(s)){s.forEach(($,N)=>is($,e&&(P(e)?e[N]:e),t,n,i));return}if(rs(n)&&!i){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&is(s,e,t,n.component.subTree);return}const r=n.shapeFlag&4?gi(n.component):n.el,o=i?null:r,{i:c,r:u}=s,h=e&&e.r,a=c.refs===q?c.refs={}:c.refs,_=c.setupState,m=M(_),T=_===q?pr:$=>F(m,$);if(h!=null&&h!==u){if(Kr(e),J(h))a[h]=null,T(h)&&(_[h]=null);else if(ie(h)){h.value=null;const $=e;$.k&&(a[$.k]=null)}}if(k(u))kt(u,c,12,[o,a]);else{const $=J(u),N=ie(u);if($||N){const he=()=>{if(s.f){const D=$?T(u)?_[u]:a[u]:u.value;if(i)P(D)&&Ln(D,r);else if(P(D))D.includes(r)||D.push(r);else if($)a[u]=[r],T(u)&&(_[u]=a[u]);else{const Q=[r];u.value=Q,s.k&&(a[s.k]=Q)}}else $?(a[u]=o,T(u)&&(_[u]=o)):N&&(u.value=o,s.k&&(a[s.k]=o))};if(o){const D=()=>{he(),Vs.delete(s)};D.id=-1,Vs.set(s,D),ye(D,t)}else Kr(s),he()}}}function Kr(s){const e=Vs.get(s);e&&(e.flags|=8,Vs.delete(s))}Fs().requestIdleCallback,Fs().cancelIdleCallback;const rs=s=>!!s.type.__asyncLoader,Yr=s=>s.type.__isKeepAlive;function _f(s,e){Zr(s,"a",e)}function df(s,e){Zr(s,"da",e)}function Zr(s,e,t=ae){const n=s.__wdc||(s.__wdc=()=>{let i=t;for(;i;){if(i.isDeactivated)return;i=i.parent}return s()});if(Ks(e,n,t),t){let i=t.parent;for(;i&&i.parent;)Yr(i.parent.vnode)&&pf(n,e,t,i),i=i.parent}}function pf(s,e,t,n){const i=Ks(e,s,n,!0);Xr(()=>{Ln(n[e],i)},t)}function Ks(s,e,t=ae,n=!1){if(t){const i=t[s]||(t[s]=[]),r=e.__weh||(e.__weh=(...o)=>{Pe();const c=fs(t),u=Ue(e,t,s,o);return c(),Ne(),u});return n?i.unshift(r):i.push(r),r}}const Ke=s=>(e,t=ae)=>{(!hs||s==="sp")&&Ks(s,(...n)=>e(...n),t)},mf=Ke("bm"),Jr=Ke("m"),gf=Ke("bu"),bf=Ke("u"),wf=Ke("bum"),Xr=Ke("um"),yf=Ke("sp"),Ef=Ke("rtg"),Tf=Ke("rtc");function Sf(s,e=ae){Ks("ec",s,e)}const Of=Symbol.for("v-ndc"),ri=s=>s?$o(s)?gi(s):ri(s.parent):null,os=ce(Object.create(null),{$:s=>s,$el:s=>s.vnode.el,$data:s=>s.data,$props:s=>s.props,$attrs:s=>s.attrs,$slots:s=>s.slots,$refs:s=>s.refs,$parent:s=>ri(s.parent),$root:s=>ri(s.root),$host:s=>s.ce,$emit:s=>s.emit,$options:s=>no(s),$forceUpdate:s=>s.f||(s.f=()=>{ni(s.update)}),$nextTick:s=>s.n||(s.n=of.bind(s.proxy)),$watch:s=>Qf.bind(s)}),oi=(s,e)=>s!==q&&!s.__isScriptSetup&&F(s,e),Af={get({_:s},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:n,data:i,props:r,accessCache:o,type:c,appContext:u}=s;let h;if(e[0]!=="$"){const T=o[e];if(T!==void 0)switch(T){case 1:return n[e];case 2:return i[e];case 4:return t[e];case 3:return r[e]}else{if(oi(n,e))return o[e]=1,n[e];if(i!==q&&F(i,e))return o[e]=2,i[e];if((h=s.propsOptions[0])&&F(h,e))return o[e]=3,r[e];if(t!==q&&F(t,e))return o[e]=4,t[e];ci&&(o[e]=0)}}const a=os[e];let _,m;if(a)return e==="$attrs"&&ne(s.attrs,"get",""),a(s);if((_=c.__cssModules)&&(_=_[e]))return _;if(t!==q&&F(t,e))return o[e]=4,t[e];if(m=u.config.globalProperties,F(m,e))return m[e]},set({_:s},e,t){const{data:n,setupState:i,ctx:r}=s;return oi(i,e)?(i[e]=t,!0):n!==q&&F(n,e)?(n[e]=t,!0):F(s.props,e)||e[0]==="$"&&e.slice(1)in s?!1:(r[e]=t,!0)},has({_:{data:s,setupState:e,accessCache:t,ctx:n,appContext:i,propsOptions:r,type:o}},c){let u,h;return!!(t[c]||s!==q&&c[0]!=="$"&&F(s,c)||oi(e,c)||(u=r[0])&&F(u,c)||F(n,c)||F(os,c)||F(i.config.globalProperties,c)||(h=o.__cssModules)&&h[c])},defineProperty(s,e,t){return t.get!=null?s._.accessCache[e]=0:F(t,"value")&&this.set(s,e,t.value,null),Reflect.defineProperty(s,e,t)}};function eo(s){return P(s)?s.reduce((e,t)=>(e[t]=null,e),{}):s}let ci=!0;function vf(s){const e=no(s),t=s.proxy,n=s.ctx;ci=!1,e.beforeCreate&&to(e.beforeCreate,s,"bc");const{data:i,computed:r,methods:o,watch:c,provide:u,inject:h,created:a,beforeMount:_,mounted:m,beforeUpdate:T,updated:$,activated:N,deactivated:he,beforeDestroy:D,beforeUnmount:Q,destroyed:K,unmounted:x,render:X,renderTracked:ht,renderTriggered:Be,errorCaptured:_t,serverPrefetch:Cn,expose:At,inheritAttrs:Rs,components:xn,directives:Rn,filters:_r}=e;if(h&&If(h,n,null),o)for(const V in o){const z=o[V];k(z)&&(n[V]=z.bind(t))}if(i){const V=i.call(t,t);Y(V)&&(s.data=Jn(V))}if(ci=!0,r)for(const V in r){const z=r[V],vt=k(z)?z.bind(t,t):k(z.get)?z.get.bind(t,t):ke,$n=!k(z)&&k(z.set)?z.set.bind(t):ke,It=Eh({get:vt,set:$n});Object.defineProperty(n,V,{enumerable:!0,configurable:!0,get:()=>It.value,set:ze=>It.value=ze})}if(c)for(const V in c)so(c[V],n,t,V);if(u){const V=k(u)?u.call(t):u;Reflect.ownKeys(V).forEach(z=>{Pf(z,V[z])})}a&&to(a,s,"c");function _e(V,z){P(z)?z.forEach(vt=>V(vt.bind(t))):z&&V(z.bind(t))}if(_e(mf,_),_e(Jr,m),_e(gf,T),_e(bf,$),_e(_f,N),_e(df,he),_e(Sf,_t),_e(Tf,ht),_e(Ef,Be),_e(wf,Q),_e(Xr,x),_e(yf,Cn),P(At))if(At.length){const V=s.exposed||(s.exposed={});At.forEach(z=>{Object.defineProperty(V,z,{get:()=>t[z],set:vt=>t[z]=vt,enumerable:!0})})}else s.exposed||(s.exposed={});X&&s.render===ke&&(s.render=X),Rs!=null&&(s.inheritAttrs=Rs),xn&&(s.components=xn),Rn&&(s.directives=Rn),Cn&&Vr(s)}function If(s,e,t=ke){P(s)&&(s=ui(s));for(const n in s){const i=s[n];let r;Y(i)?"default"in i?r=Zs(i.from||n,i.default,!0):r=Zs(i.from||n):r=Zs(i),ie(r)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[n]=r}}function to(s,e,t){Ue(P(s)?s.map(n=>n.bind(e.proxy)):s.bind(e.proxy),e,t)}function so(s,e,t,n){let i=n.includes(".")?Eo(t,n):()=>t[n];if(J(s)){const r=e[s];k(r)&&_i(i,r)}else if(k(s))_i(i,s.bind(t));else if(Y(s))if(P(s))s.forEach(r=>so(r,e,t,n));else{const r=k(s.handler)?s.handler.bind(t):e[s.handler];k(r)&&_i(i,r,s)}}function no(s){const e=s.type,{mixins:t,extends:n}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=s.appContext,c=r.get(e);let u;return c?u=c:!i.length&&!t&&!n?u=e:(u={},i.length&&i.forEach(h=>Ys(u,h,o,!0)),Ys(u,e,o)),Y(e)&&r.set(e,u),u}function Ys(s,e,t,n=!1){const{mixins:i,extends:r}=e;r&&Ys(s,r,t,!0),i&&i.forEach(o=>Ys(s,o,t,!0));for(const o in e)if(!(n&&o==="expose")){const c=Cf[o]||t&&t[o];s[o]=c?c(s[o],e[o]):e[o]}return s}const Cf={data:io,props:ro,emits:ro,methods:cs,computed:cs,beforeCreate:le,created:le,beforeMount:le,mounted:le,beforeUpdate:le,updated:le,beforeDestroy:le,beforeUnmount:le,destroyed:le,unmounted:le,activated:le,deactivated:le,errorCaptured:le,serverPrefetch:le,components:cs,directives:cs,watch:Rf,provide:io,inject:xf};function io(s,e){return e?s?function(){return ce(k(s)?s.call(this,this):s,k(e)?e.call(this,this):e)}:e:s}function xf(s,e){return cs(ui(s),ui(e))}function ui(s){if(P(s)){const e={};for(let t=0;t<s.length;t++)e[s[t]]=s[t];return e}return s}function le(s,e){return s?[...new Set([].concat(s,e))]:e}function cs(s,e){return s?ce(Object.create(null),s,e):e}function ro(s,e){return s?P(s)&&P(e)?[...new Set([...s,...e])]:ce(Object.create(null),eo(s),eo(e??{})):e}function Rf(s,e){if(!s)return e;if(!e)return s;const t=ce(Object.create(null),s);for(const n in e)t[n]=le(s[n],e[n]);return t}function oo(){return{app:null,config:{isNativeTag:pr,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $f=0;function kf(s,e){return function(n,i=null){k(n)||(n=ce({},n)),i!=null&&!Y(i)&&(i=null);const r=oo(),o=new WeakSet,c=[];let u=!1;const h=r.app={_uid:$f++,_component:n,_props:i,_container:null,_context:r,_instance:null,version:Th,get config(){return r.config},set config(a){},use(a,..._){return o.has(a)||(a&&k(a.install)?(o.add(a),a.install(h,..._)):k(a)&&(o.add(a),a(h,..._))),h},mixin(a){return r.mixins.includes(a)||r.mixins.push(a),h},component(a,_){return _?(r.components[a]=_,h):r.components[a]},directive(a,_){return _?(r.directives[a]=_,h):r.directives[a]},mount(a,_,m){if(!u){const T=h._ceVNode||yt(n,i);return T.appContext=r,m===!0?m="svg":m===!1&&(m=void 0),s(T,a,m),u=!0,h._container=a,a.__vue_app__=h,gi(T.component)}},onUnmount(a){c.push(a)},unmount(){u&&(Ue(c,h._instance,16),s(null,h._container),delete h._container.__vue_app__)},provide(a,_){return r.provides[a]=_,h},runWithContext(a){const _=Lt;Lt=h;try{return a()}finally{Lt=_}}};return h}}let Lt=null;function Pf(s,e){if(ae){let t=ae.provides;const n=ae.parent&&ae.parent.provides;n===t&&(t=ae.provides=Object.create(n)),t[s]=e}}function Zs(s,e,t=!1){const n=hh();if(n||Lt){let i=Lt?Lt._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(i&&s in i)return i[s];if(arguments.length>1)return t&&k(e)?e.call(n&&n.proxy):e}}const co={},uo=()=>Object.create(co),lo=s=>Object.getPrototypeOf(s)===co;function Nf(s,e,t,n=!1){const i={},r=uo();s.propsDefaults=Object.create(null),ao(s,e,i,r);for(const o in s.propsOptions[0])o in i||(i[o]=void 0);t?s.props=n?i:Qa(i):s.type.props?s.props=i:s.props=r,s.attrs=r}function Lf(s,e,t,n){const{props:i,attrs:r,vnode:{patchFlag:o}}=s,c=M(i),[u]=s.propsOptions;let h=!1;if((n||o>0)&&!(o&16)){if(o&8){const a=s.vnode.dynamicProps;for(let _=0;_<a.length;_++){let m=a[_];if(Js(s.emitsOptions,m))continue;const T=e[m];if(u)if(F(r,m))T!==r[m]&&(r[m]=T,h=!0);else{const $=nt(m);i[$]=li(u,c,$,T,s,!1)}else T!==r[m]&&(r[m]=T,h=!0)}}}else{ao(s,e,i,r)&&(h=!0);let a;for(const _ in c)(!e||!F(e,_)&&((a=dt(_))===_||!F(e,a)))&&(u?t&&(t[_]!==void 0||t[a]!==void 0)&&(i[_]=li(u,c,_,void 0,s,!0)):delete i[_]);if(r!==c)for(const _ in r)(!e||!F(e,_))&&(delete r[_],h=!0)}h&&We(s.attrs,"set","")}function ao(s,e,t,n){const[i,r]=s.propsOptions;let o=!1,c;if(e)for(let u in e){if(Kt(u))continue;const h=e[u];let a;i&&F(i,a=nt(u))?!r||!r.includes(a)?t[a]=h:(c||(c={}))[a]=h:Js(s.emitsOptions,u)||(!(u in n)||h!==n[u])&&(n[u]=h,o=!0)}if(r){const u=M(t),h=c||q;for(let a=0;a<r.length;a++){const _=r[a];t[_]=li(i,u,_,h[_],s,!F(h,_))}}return o}function li(s,e,t,n,i,r){const o=s[t];if(o!=null){const c=F(o,"default");if(c&&n===void 0){const u=o.default;if(o.type!==Function&&!o.skipFactory&&k(u)){const{propsDefaults:h}=i;if(t in h)n=h[t];else{const a=fs(i);n=h[t]=u.call(null,e),a()}}else n=u;i.ce&&i.ce._setProp(t,n)}o[0]&&(r&&!c?n=!1:o[1]&&(n===""||n===dt(t))&&(n=!0))}return n}const Uf=new WeakMap;function fo(s,e,t=!1){const n=t?Uf:e.propsCache,i=n.get(s);if(i)return i;const r=s.props,o={},c=[];let u=!1;if(!k(s)){const a=_=>{u=!0;const[m,T]=fo(_,e,!0);ce(o,m),T&&c.push(...T)};!t&&e.mixins.length&&e.mixins.forEach(a),s.extends&&a(s.extends),s.mixins&&s.mixins.forEach(a)}if(!r&&!u)return Y(s)&&n.set(s,Ct),Ct;if(P(r))for(let a=0;a<r.length;a++){const _=nt(r[a]);ho(_)&&(o[_]=q)}else if(r)for(const a in r){const _=nt(a);if(ho(_)){const m=r[a],T=o[_]=P(m)||k(m)?{type:m}:ce({},m),$=T.type;let N=!1,he=!0;if(P($))for(let D=0;D<$.length;++D){const Q=$[D],K=k(Q)&&Q.name;if(K==="Boolean"){N=!0;break}else K==="String"&&(he=!1)}else N=k($)&&$.name==="Boolean";T[0]=N,T[1]=he,(N||F(T,"default"))&&c.push(_)}}const h=[o,c];return Y(s)&&n.set(s,h),h}function ho(s){return s[0]!=="$"&&!Kt(s)}const ai=s=>s==="_"||s==="_ctx"||s==="$stable",fi=s=>P(s)?s.map(Me):[Me(s)],Df=(s,e,t)=>{if(e._n)return e;const n=lf((...i)=>fi(e(...i)),t);return n._c=!1,n},_o=(s,e,t)=>{const n=s._ctx;for(const i in s){if(ai(i))continue;const r=s[i];if(k(r))e[i]=Df(i,r,n);else if(r!=null){const o=fi(r);e[i]=()=>o}}},po=(s,e)=>{const t=fi(e);s.slots.default=()=>t},mo=(s,e,t)=>{for(const n in e)(t||!ai(n))&&(s[n]=e[n])},Ff=(s,e,t)=>{const n=s.slots=uo();if(s.vnode.shapeFlag&32){const i=e._;i?(mo(n,e,t),t&&br(n,"_",i,!0)):_o(e,n)}else e&&po(s,e)},Mf=(s,e,t)=>{const{vnode:n,slots:i}=s;let r=!0,o=q;if(n.shapeFlag&32){const c=e._;c?t&&c===1?r=!1:mo(i,e,t):(r=!e.$stable,_o(e,i)),o=e}else e&&(po(s,e),o={default:1});if(r)for(const c in i)!ai(c)&&o[c]==null&&delete i[c]},ye=eh;function jf(s){return qf(s)}function qf(s,e){const t=Fs();t.__VUE__=!0;const{insert:n,remove:i,patchProp:r,createElement:o,createText:c,createComment:u,setText:h,setElementText:a,parentNode:_,nextSibling:m,setScopeId:T=ke,insertStaticContent:$}=s,N=(l,f,p,w=null,g=null,b=null,O=void 0,S=null,E=!!f.dynamicChildren)=>{if(l===f)return;l&&!as(l,f)&&(w=kn(l),ze(l,g,b,!0),l=null),f.patchFlag===-2&&(E=!1,f.dynamicChildren=null);const{type:y,ref:I,shapeFlag:A}=f;switch(y){case Xs:he(l,f,p,w);break;case Ut:D(l,f,p,w);break;case di:l==null&&Q(f,p,w,O);break;case Ye:xn(l,f,p,w,g,b,O,S,E);break;default:A&1?X(l,f,p,w,g,b,O,S,E):A&6?Rn(l,f,p,w,g,b,O,S,E):(A&64||A&128)&&y.process(l,f,p,w,g,b,O,S,E,ks)}I!=null&&g?is(I,l&&l.ref,b,f||l,!f):I==null&&l&&l.ref!=null&&is(l.ref,null,b,l,!0)},he=(l,f,p,w)=>{if(l==null)n(f.el=c(f.children),p,w);else{const g=f.el=l.el;f.children!==l.children&&h(g,f.children)}},D=(l,f,p,w)=>{l==null?n(f.el=u(f.children||""),p,w):f.el=l.el},Q=(l,f,p,w)=>{[l.el,l.anchor]=$(l.children,f,p,w,l.el,l.anchor)},K=({el:l,anchor:f},p,w)=>{let g;for(;l&&l!==f;)g=m(l),n(l,p,w),l=g;n(f,p,w)},x=({el:l,anchor:f})=>{let p;for(;l&&l!==f;)p=m(l),i(l),l=p;i(f)},X=(l,f,p,w,g,b,O,S,E)=>{f.type==="svg"?O="svg":f.type==="math"&&(O="mathml"),l==null?ht(f,p,w,g,b,O,S,E):Cn(l,f,g,b,O,S,E)},ht=(l,f,p,w,g,b,O,S)=>{let E,y;const{props:I,shapeFlag:A,transition:v,dirs:R}=l;if(E=l.el=o(l.type,b,I&&I.is,I),A&8?a(E,l.children):A&16&&_t(l.children,E,null,w,g,hi(l,b),O,S),R&&bt(l,null,w,"created"),Be(E,l,l.scopeId,O,w),I){for(const H in I)H!=="value"&&!Kt(H)&&r(E,H,null,I[H],b,w);"value"in I&&r(E,"value",null,I.value,b),(y=I.onVnodeBeforeMount)&&je(y,w,l)}R&&bt(l,null,w,"beforeMount");const U=Bf(g,v);U&&v.beforeEnter(E),n(E,f,p),((y=I&&I.onVnodeMounted)||U||R)&&ye(()=>{y&&je(y,w,l),U&&v.enter(E),R&&bt(l,null,w,"mounted")},g)},Be=(l,f,p,w,g)=>{if(p&&T(l,p),w)for(let b=0;b<w.length;b++)T(l,w[b]);if(g){let b=g.subTree;if(f===b||Ao(b.type)&&(b.ssContent===f||b.ssFallback===f)){const O=g.vnode;Be(l,O,O.scopeId,O.slotScopeIds,g.parent)}}},_t=(l,f,p,w,g,b,O,S,E=0)=>{for(let y=E;y<l.length;y++){const I=l[y]=S?ot(l[y]):Me(l[y]);N(null,I,f,p,w,g,b,O,S)}},Cn=(l,f,p,w,g,b,O)=>{const S=f.el=l.el;let{patchFlag:E,dynamicChildren:y,dirs:I}=f;E|=l.patchFlag&16;const A=l.props||q,v=f.props||q;let R;if(p&&wt(p,!1),(R=v.onVnodeBeforeUpdate)&&je(R,p,f,l),I&&bt(f,l,p,"beforeUpdate"),p&&wt(p,!0),(A.innerHTML&&v.innerHTML==null||A.textContent&&v.textContent==null)&&a(S,""),y?At(l.dynamicChildren,y,S,p,w,hi(f,g),b):O||z(l,f,S,null,p,w,hi(f,g),b,!1),E>0){if(E&16)Rs(S,A,v,p,g);else if(E&2&&A.class!==v.class&&r(S,"class",null,v.class,g),E&4&&r(S,"style",A.style,v.style,g),E&8){const U=f.dynamicProps;for(let H=0;H<U.length;H++){const j=U[H],ge=A[j],be=v[j];(be!==ge||j==="value")&&r(S,j,ge,be,g,p)}}E&1&&l.children!==f.children&&a(S,f.children)}else!O&&y==null&&Rs(S,A,v,p,g);((R=v.onVnodeUpdated)||I)&&ye(()=>{R&&je(R,p,f,l),I&&bt(f,l,p,"updated")},w)},At=(l,f,p,w,g,b,O)=>{for(let S=0;S<f.length;S++){const E=l[S],y=f[S],I=E.el&&(E.type===Ye||!as(E,y)||E.shapeFlag&198)?_(E.el):p;N(E,y,I,null,w,g,b,O,!0)}},Rs=(l,f,p,w,g)=>{if(f!==p){if(f!==q)for(const b in f)!Kt(b)&&!(b in p)&&r(l,b,f[b],null,g,w);for(const b in p){if(Kt(b))continue;const O=p[b],S=f[b];O!==S&&b!=="value"&&r(l,b,S,O,g,w)}"value"in p&&r(l,"value",f.value,p.value,g)}},xn=(l,f,p,w,g,b,O,S,E)=>{const y=f.el=l?l.el:c(""),I=f.anchor=l?l.anchor:c("");let{patchFlag:A,dynamicChildren:v,slotScopeIds:R}=f;R&&(S=S?S.concat(R):R),l==null?(n(y,p,w),n(I,p,w),_t(f.children||[],p,I,g,b,O,S,E)):A>0&&A&64&&v&&l.dynamicChildren?(At(l.dynamicChildren,v,p,g,b,O,S),(f.key!=null||g&&f===g.subTree)&&go(l,f,!0)):z(l,f,p,I,g,b,O,S,E)},Rn=(l,f,p,w,g,b,O,S,E)=>{f.slotScopeIds=S,l==null?f.shapeFlag&512?g.ctx.activate(f,p,w,O,E):_r(f,p,w,g,b,O,E):ca(l,f,E)},_r=(l,f,p,w,g,b,O)=>{const S=l.component=fh(l,w,g);if(Yr(l)&&(S.ctx.renderer=ks),_h(S,!1,O),S.asyncDep){if(g&&g.registerDep(S,_e,O),!l.el){const E=S.subTree=yt(Ut);D(null,E,f,p),l.placeholder=E.el}}else _e(S,l,f,p,g,b,O)},ca=(l,f,p)=>{const w=f.component=l.component;if(Jf(l,f,p))if(w.asyncDep&&!w.asyncResolved){V(w,f,p);return}else w.next=f,w.update();else f.el=l.el,w.vnode=f},_e=(l,f,p,w,g,b,O)=>{const S=()=>{if(l.isMounted){let{next:A,bu:v,u:R,parent:U,vnode:H}=l;{const Ge=bo(l);if(Ge){A&&(A.el=H.el,V(l,A,O)),Ge.asyncDep.then(()=>{l.isUnmounted||S()});return}}let j=A,ge;wt(l,!1),A?(A.el=H.el,V(l,A,O)):A=H,v&&Fn(v),(ge=A.props&&A.props.onVnodeBeforeUpdate)&&je(ge,U,A,H),wt(l,!0);const be=So(l),He=l.subTree;l.subTree=be,N(He,be,_(He.el),kn(He),l,g,b),A.el=be.el,j===null&&Xf(l,be.el),R&&ye(R,g),(ge=A.props&&A.props.onVnodeUpdated)&&ye(()=>je(ge,U,A,H),g)}else{let A;const{el:v,props:R}=f,{bm:U,m:H,parent:j,root:ge,type:be}=l,He=rs(f);wt(l,!1),U&&Fn(U),!He&&(A=R&&R.onVnodeBeforeMount)&&je(A,j,f),wt(l,!0);{ge.ce&&ge.ce._def.shadowRoot!==!1&&ge.ce._injectChildStyle(be);const Ge=l.subTree=So(l);N(null,Ge,p,w,l,g,b),f.el=Ge.el}if(H&&ye(H,g),!He&&(A=R&&R.onVnodeMounted)){const Ge=f;ye(()=>je(A,j,Ge),g)}(f.shapeFlag&256||j&&rs(j.vnode)&&j.vnode.shapeFlag&256)&&l.a&&ye(l.a,g),l.isMounted=!0,f=p=w=null}};l.scope.on();const E=l.effect=new Er(S);l.scope.off();const y=l.update=E.run.bind(E),I=l.job=E.runIfDirty.bind(E);I.i=l,I.id=l.uid,E.scheduler=()=>ni(I),wt(l,!0),y()},V=(l,f,p)=>{f.component=l;const w=l.vnode.props;l.vnode=f,l.next=null,Lf(l,f.props,w,p),Mf(l,f.children,p),Pe(),Hr(l),Ne()},z=(l,f,p,w,g,b,O,S,E=!1)=>{const y=l&&l.children,I=l?l.shapeFlag:0,A=f.children,{patchFlag:v,shapeFlag:R}=f;if(v>0){if(v&128){$n(y,A,p,w,g,b,O,S,E);return}else if(v&256){vt(y,A,p,w,g,b,O,S,E);return}}R&8?(I&16&&$s(y,g,b),A!==y&&a(p,A)):I&16?R&16?$n(y,A,p,w,g,b,O,S,E):$s(y,g,b,!0):(I&8&&a(p,""),R&16&&_t(A,p,w,g,b,O,S,E))},vt=(l,f,p,w,g,b,O,S,E)=>{l=l||Ct,f=f||Ct;const y=l.length,I=f.length,A=Math.min(y,I);let v;for(v=0;v<A;v++){const R=f[v]=E?ot(f[v]):Me(f[v]);N(l[v],R,p,null,g,b,O,S,E)}y>I?$s(l,g,b,!0,!1,A):_t(f,p,w,g,b,O,S,E,A)},$n=(l,f,p,w,g,b,O,S,E)=>{let y=0;const I=f.length;let A=l.length-1,v=I-1;for(;y<=A&&y<=v;){const R=l[y],U=f[y]=E?ot(f[y]):Me(f[y]);if(as(R,U))N(R,U,p,null,g,b,O,S,E);else break;y++}for(;y<=A&&y<=v;){const R=l[A],U=f[v]=E?ot(f[v]):Me(f[v]);if(as(R,U))N(R,U,p,null,g,b,O,S,E);else break;A--,v--}if(y>A){if(y<=v){const R=v+1,U=R<I?f[R].el:w;for(;y<=v;)N(null,f[y]=E?ot(f[y]):Me(f[y]),p,U,g,b,O,S,E),y++}}else if(y>v)for(;y<=A;)ze(l[y],g,b,!0),y++;else{const R=y,U=y,H=new Map;for(y=U;y<=v;y++){const Te=f[y]=E?ot(f[y]):Me(f[y]);Te.key!=null&&H.set(Te.key,y)}let j,ge=0;const be=v-U+1;let He=!1,Ge=0;const Ps=new Array(be);for(y=0;y<be;y++)Ps[y]=0;for(y=R;y<=A;y++){const Te=l[y];if(ge>=be){ze(Te,g,b,!0);continue}let Qe;if(Te.key!=null)Qe=H.get(Te.key);else for(j=U;j<=v;j++)if(Ps[j-U]===0&&as(Te,f[j])){Qe=j;break}Qe===void 0?ze(Te,g,b,!0):(Ps[Qe-U]=y+1,Qe>=Ge?Ge=Qe:He=!0,N(Te,f[Qe],p,null,g,b,O,S,E),ge++)}const aa=He?zf(Ps):Ct;for(j=aa.length-1,y=be-1;y>=0;y--){const Te=U+y,Qe=f[Te],fa=f[Te+1],ha=Te+1<I?fa.el||fa.placeholder:w;Ps[y]===0?N(null,Qe,p,ha,g,b,O,S,E):He&&(j<0||y!==aa[j]?It(Qe,p,ha,2):j--)}}},It=(l,f,p,w,g=null)=>{const{el:b,type:O,transition:S,children:E,shapeFlag:y}=l;if(y&6){It(l.component.subTree,f,p,w);return}if(y&128){l.suspense.move(f,p,w);return}if(y&64){O.move(l,f,p,ks);return}if(O===Ye){n(b,f,p);for(let A=0;A<E.length;A++)It(E[A],f,p,w);n(l.anchor,f,p);return}if(O===di){K(l,f,p);return}if(w!==2&&y&1&&S)if(w===0)S.beforeEnter(b),n(b,f,p),ye(()=>S.enter(b),g);else{const{leave:A,delayLeave:v,afterLeave:R}=S,U=()=>{l.ctx.isUnmounted?i(b):n(b,f,p)},H=()=>{b._isLeaving&&b[hf](!0),A(b,()=>{U(),R&&R()})};v?v(b,U,H):H()}else n(b,f,p)},ze=(l,f,p,w=!1,g=!1)=>{const{type:b,props:O,ref:S,children:E,dynamicChildren:y,shapeFlag:I,patchFlag:A,dirs:v,cacheIndex:R}=l;if(A===-2&&(g=!1),S!=null&&(Pe(),is(S,null,p,l,!0),Ne()),R!=null&&(f.renderCache[R]=void 0),I&256){f.ctx.deactivate(l);return}const U=I&1&&v,H=!rs(l);let j;if(H&&(j=O&&O.onVnodeBeforeUnmount)&&je(j,f,l),I&6)cT(l.component,p,w);else{if(I&128){l.suspense.unmount(p,w);return}U&&bt(l,null,f,"beforeUnmount"),I&64?l.type.remove(l,f,p,ks,w):y&&!y.hasOnce&&(b!==Ye||A>0&&A&64)?$s(y,f,p,!1,!0):(b===Ye&&A&384||!g&&I&16)&&$s(E,f,p),w&&ua(l)}(H&&(j=O&&O.onVnodeUnmounted)||U)&&ye(()=>{j&&je(j,f,l),U&&bt(l,null,f,"unmounted")},p)},ua=l=>{const{type:f,el:p,anchor:w,transition:g}=l;if(f===Ye){oT(p,w);return}if(f===di){x(l);return}const b=()=>{i(p),g&&!g.persisted&&g.afterLeave&&g.afterLeave()};if(l.shapeFlag&1&&g&&!g.persisted){const{leave:O,delayLeave:S}=g,E=()=>O(p,b);S?S(l.el,b,E):E()}else b()},oT=(l,f)=>{let p;for(;l!==f;)p=m(l),i(l),l=p;i(f)},cT=(l,f,p)=>{const{bum:w,scope:g,job:b,subTree:O,um:S,m:E,a:y}=l;wo(E),wo(y),w&&Fn(w),g.stop(),b&&(b.flags|=8,ze(O,l,f,p)),S&&ye(S,f),ye(()=>{l.isUnmounted=!0},f)},$s=(l,f,p,w=!1,g=!1,b=0)=>{for(let O=b;O<l.length;O++)ze(l[O],f,p,w,g)},kn=l=>{if(l.shapeFlag&6)return kn(l.component.subTree);if(l.shapeFlag&128)return l.suspense.next();const f=m(l.anchor||l.el),p=f&&f[af];return p?m(p):f};let dr=!1;const la=(l,f,p)=>{l==null?f._vnode&&ze(f._vnode,null,null,!0):N(f._vnode||null,l,f,null,null,null,p),f._vnode=l,dr||(dr=!0,Hr(),Gr(),dr=!1)},ks={p:N,um:ze,m:It,r:ua,mt:_r,mc:_t,pc:z,pbc:At,n:kn,o:s};return{render:la,hydrate:void 0,createApp:kf(la)}}function hi({type:s,props:e},t){return t==="svg"&&s==="foreignObject"||t==="mathml"&&s==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function wt({effect:s,job:e},t){t?(s.flags|=32,e.flags|=4):(s.flags&=-33,e.flags&=-5)}function Bf(s,e){return(!s||s&&!s.pendingBranch)&&e&&!e.persisted}function go(s,e,t=!1){const n=s.children,i=e.children;if(P(n)&&P(i))for(let r=0;r<n.length;r++){const o=n[r];let c=i[r];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=i[r]=ot(i[r]),c.el=o.el),!t&&c.patchFlag!==-2&&go(o,c)),c.type===Xs&&c.patchFlag!==-1&&(c.el=o.el),c.type===Ut&&!c.el&&(c.el=o.el)}}function zf(s){const e=s.slice(),t=[0];let n,i,r,o,c;const u=s.length;for(n=0;n<u;n++){const h=s[n];if(h!==0){if(i=t[t.length-1],s[i]<h){e[n]=i,t.push(n);continue}for(r=0,o=t.length-1;r<o;)c=r+o>>1,s[t[c]]<h?r=c+1:o=c;h<s[t[r]]&&(r>0&&(e[n]=t[r-1]),t[r]=n)}}for(r=t.length,o=t[r-1];r-- >0;)t[r]=o,o=e[o];return t}function bo(s){const e=s.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:bo(e)}function wo(s){if(s)for(let e=0;e<s.length;e++)s[e].flags|=8}const Hf=Symbol.for("v-scx"),Gf=()=>Zs(Hf);function _i(s,e,t){return yo(s,e,t)}function yo(s,e,t=q){const{immediate:n,deep:i,flush:r,once:o}=t,c=ce({},t),u=e&&n||!e&&r!=="post";let h;if(hs){if(r==="sync"){const T=Gf();h=T.__watcherHandles||(T.__watcherHandles=[])}else if(!u){const T=()=>{};return T.stop=ke,T.resume=ke,T.pause=ke,T}}const a=ae;c.call=(T,$,N)=>Ue(T,a,$,N);let _=!1;r==="post"?c.scheduler=T=>{ye(T,a&&a.suspense)}:r!=="sync"&&(_=!0,c.scheduler=(T,$)=>{$?T():ni(T)}),c.augmentJob=T=>{e&&(T.flags|=4),_&&(T.flags|=2,a&&(T.id=a.uid,T.i=a))};const m=Xa(s,e,c);return hs&&(h?h.push(m):u&&m()),m}function Qf(s,e,t){const n=this.proxy,i=J(s)?s.includes(".")?Eo(n,s):()=>n[s]:s.bind(n,n);let r;k(e)?r=e:(r=e.handler,t=e);const o=fs(this),c=yo(i,r.bind(n),t);return o(),c}function Eo(s,e){const t=e.split(".");return()=>{let n=s;for(let i=0;i<t.length&&n;i++)n=n[t[i]];return n}}const Wf=(s,e)=>e==="modelValue"||e==="model-value"?s.modelModifiers:s[`${e}Modifiers`]||s[`${nt(e)}Modifiers`]||s[`${dt(e)}Modifiers`];function Vf(s,e,...t){if(s.isUnmounted)return;const n=s.vnode.props||q;let i=t;const r=e.startsWith("update:"),o=r&&Wf(n,e.slice(7));o&&(o.trim&&(i=t.map(a=>J(a)?a.trim():a)),o.number&&(i=t.map(ya)));let c,u=n[c=Dn(e)]||n[c=Dn(nt(e))];!u&&r&&(u=n[c=Dn(dt(e))]),u&&Ue(u,s,6,i);const h=n[c+"Once"];if(h){if(!s.emitted)s.emitted={};else if(s.emitted[c])return;s.emitted[c]=!0,Ue(h,s,6,i)}}const Kf=new WeakMap;function To(s,e,t=!1){const n=t?Kf:e.emitsCache,i=n.get(s);if(i!==void 0)return i;const r=s.emits;let o={},c=!1;if(!k(s)){const u=h=>{const a=To(h,e,!0);a&&(c=!0,ce(o,a))};!t&&e.mixins.length&&e.mixins.forEach(u),s.extends&&u(s.extends),s.mixins&&s.mixins.forEach(u)}return!r&&!c?(Y(s)&&n.set(s,null),null):(P(r)?r.forEach(u=>o[u]=null):ce(o,r),Y(s)&&n.set(s,o),o)}function Js(s,e){return!s||!Ls(e)?!1:(e=e.slice(2).replace(/Once$/,""),F(s,e[0].toLowerCase()+e.slice(1))||F(s,dt(e))||F(s,e))}function fT(){}function So(s){const{type:e,vnode:t,proxy:n,withProxy:i,propsOptions:[r],slots:o,attrs:c,emit:u,render:h,renderCache:a,props:_,data:m,setupState:T,ctx:$,inheritAttrs:N}=s,he=Ws(s);let D,Q;try{if(t.shapeFlag&4){const x=i||n,X=x;D=Me(h.call(X,x,a,_,T,m,$)),Q=c}else{const x=e;D=Me(x.length>1?x(_,{attrs:c,slots:o,emit:u}):x(_,null)),Q=e.props?c:Yf(c)}}catch(x){us.length=0,Gs(x,s,1),D=yt(Ut)}let K=D;if(Q&&N!==!1){const x=Object.keys(Q),{shapeFlag:X}=K;x.length&&X&7&&(r&&x.some(Nn)&&(Q=Zf(Q,r)),K=Dt(K,Q,!1,!0))}return t.dirs&&(K=Dt(K,null,!1,!0),K.dirs=K.dirs?K.dirs.concat(t.dirs):t.dirs),t.transition&&ii(K,t.transition),D=K,Ws(he),D}const Yf=s=>{let e;for(const t in s)(t==="class"||t==="style"||Ls(t))&&((e||(e={}))[t]=s[t]);return e},Zf=(s,e)=>{const t={};for(const n in s)(!Nn(n)||!(n.slice(9)in e))&&(t[n]=s[n]);return t};function Jf(s,e,t){const{props:n,children:i,component:r}=s,{props:o,children:c,patchFlag:u}=e,h=r.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&u>=0){if(u&1024)return!0;if(u&16)return n?Oo(n,o,h):!!o;if(u&8){const a=e.dynamicProps;for(let _=0;_<a.length;_++){const m=a[_];if(o[m]!==n[m]&&!Js(h,m))return!0}}}else return(i||c)&&(!c||!c.$stable)?!0:n===o?!1:n?o?Oo(n,o,h):!0:!!o;return!1}function Oo(s,e,t){const n=Object.keys(e);if(n.length!==Object.keys(s).length)return!0;for(let i=0;i<n.length;i++){const r=n[i];if(e[r]!==s[r]&&!Js(t,r))return!0}return!1}function Xf({vnode:s,parent:e},t){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===s&&(n.el=s.el),n===s)(s=e.vnode).el=t,e=e.parent;else break}}const Ao=s=>s.__isSuspense;function eh(s,e){e&&e.pendingBranch?P(s)?e.effects.push(...s):e.effects.push(s):uf(s)}const Ye=Symbol.for("v-fgt"),Xs=Symbol.for("v-txt"),Ut=Symbol.for("v-cmt"),di=Symbol.for("v-stc"),us=[];let Ee=null;function th(s=!1){us.push(Ee=s?null:[])}function sh(){us.pop(),Ee=us[us.length-1]||null}let ls=1;function vo(s,e=!1){ls+=s,s<0&&Ee&&e&&(Ee.hasOnce=!0)}function nh(s){return s.dynamicChildren=ls>0?Ee||Ct:null,sh(),ls>0&&Ee&&Ee.push(s),s}function ih(s,e,t,n,i,r){return nh(xo(s,e,t,n,i,r,!0))}function Io(s){return s?s.__v_isVNode===!0:!1}function as(s,e){return s.type===e.type&&s.key===e.key}const Co=({key:s})=>s??null,en=({ref:s,ref_key:e,ref_for:t})=>(typeof s=="number"&&(s=""+s),s!=null?J(s)||ie(s)||k(s)?{i:Fe,r:s,k:e,f:!!t}:s:null);function xo(s,e=null,t=null,n=0,i=null,r=s===Ye?0:1,o=!1,c=!1){const u={__v_isVNode:!0,__v_skip:!0,type:s,props:e,key:e&&Co(e),ref:e&&en(e),scopeId:Wr,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:Fe};return c?(pi(u,t),r&128&&s.normalize(u)):t&&(u.shapeFlag|=J(t)?8:16),ls>0&&!o&&Ee&&(u.patchFlag>0||r&6)&&u.patchFlag!==32&&Ee.push(u),u}const yt=rh;function rh(s,e=null,t=null,n=0,i=null,r=!1){if((!s||s===Of)&&(s=Ut),Io(s)){const c=Dt(s,e,!0);return t&&pi(c,t),ls>0&&!r&&Ee&&(c.shapeFlag&6?Ee[Ee.indexOf(s)]=c:Ee.push(c)),c.patchFlag=-2,c}if(yh(s)&&(s=s.__vccOpts),e){e=oh(e);let{class:c,style:u}=e;c&&!J(c)&&(e.class=jn(c)),Y(u)&&(ei(u)&&!P(u)&&(u=ce({},u)),e.style=Mn(u))}const o=J(s)?1:Ao(s)?128:ff(s)?64:Y(s)?4:k(s)?2:0;return xo(s,e,t,n,i,o,r,!0)}function oh(s){return s?ei(s)||lo(s)?ce({},s):s:null}function Dt(s,e,t=!1,n=!1){const{props:i,ref:r,patchFlag:o,children:c,transition:u}=s,h=e?uh(i||{},e):i,a={__v_isVNode:!0,__v_skip:!0,type:s.type,props:h,key:h&&Co(h),ref:e&&e.ref?t&&r?P(r)?r.concat(en(e)):[r,en(e)]:en(e):r,scopeId:s.scopeId,slotScopeIds:s.slotScopeIds,children:c,target:s.target,targetStart:s.targetStart,targetAnchor:s.targetAnchor,staticCount:s.staticCount,shapeFlag:s.shapeFlag,patchFlag:e&&s.type!==Ye?o===-1?16:o|16:o,dynamicProps:s.dynamicProps,dynamicChildren:s.dynamicChildren,appContext:s.appContext,dirs:s.dirs,transition:u,component:s.component,suspense:s.suspense,ssContent:s.ssContent&&Dt(s.ssContent),ssFallback:s.ssFallback&&Dt(s.ssFallback),placeholder:s.placeholder,el:s.el,anchor:s.anchor,ctx:s.ctx,ce:s.ce};return u&&n&&ii(a,u.clone(a)),a}function ch(s=" ",e=0){return yt(Xs,null,s,e)}function Me(s){return s==null||typeof s=="boolean"?yt(Ut):P(s)?yt(Ye,null,s.slice()):Io(s)?ot(s):yt(Xs,null,String(s))}function ot(s){return s.el===null&&s.patchFlag!==-1||s.memo?s:Dt(s)}function pi(s,e){let t=0;const{shapeFlag:n}=s;if(e==null)e=null;else if(P(e))t=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),pi(s,i()),i._c&&(i._d=!0));return}else{t=32;const i=e._;!i&&!lo(e)?e._ctx=Fe:i===3&&Fe&&(Fe.slots._===1?e._=1:(e._=2,s.patchFlag|=1024))}else k(e)?(e={default:e,_ctx:Fe},t=32):(e=String(e),n&64?(t=16,e=[ch(e)]):t=8);s.children=e,s.shapeFlag|=t}function uh(...s){const e={};for(let t=0;t<s.length;t++){const n=s[t];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=jn([e.class,n.class]));else if(i==="style")e.style=Mn([e.style,n.style]);else if(Ls(i)){const r=e[i],o=n[i];o&&r!==o&&!(P(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=n[i])}return e}function je(s,e,t,n=null){Ue(s,e,7,[t,n])}const lh=oo();let ah=0;function fh(s,e,t){const n=s.type,i=(e?e.appContext:s.appContext)||lh,r={uid:ah++,vnode:s,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new va(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:fo(n,i),emitsOptions:To(n,i),emit:null,emitted:null,propsDefaults:q,inheritAttrs:n.inheritAttrs,ctx:q,data:q,props:q,attrs:q,slots:q,refs:q,setupState:q,setupContext:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=Vf.bind(null,r),s.ce&&s.ce(r),r}let ae=null;const hh=()=>ae||Fe;let tn,mi;{const s=Fs(),e=(t,n)=>{let i;return(i=s[t])||(i=s[t]=[]),i.push(n),r=>{i.length>1?i.forEach(o=>o(r)):i[0](r)}};tn=e("__VUE_INSTANCE_SETTERS__",t=>ae=t),mi=e("__VUE_SSR_SETTERS__",t=>hs=t)}const fs=s=>{const e=ae;return tn(s),s.scope.on(),()=>{s.scope.off(),tn(e)}},Ro=()=>{ae&&ae.scope.off(),tn(null)};function $o(s){return s.vnode.shapeFlag&4}let hs=!1;function _h(s,e=!1,t=!1){e&&mi(e);const{props:n,children:i}=s.vnode,r=$o(s);Nf(s,n,r,e),Ff(s,i,t||e);const o=r?dh(s,e):void 0;return e&&mi(!1),o}function dh(s,e){const t=s.type;s.accessCache=Object.create(null),s.proxy=new Proxy(s.ctx,Af);const{setup:n}=t;if(n){Pe();const i=s.setupContext=n.length>1?mh(s):null,r=fs(s),o=kt(n,s,0,[s.props,i]),c=mr(o);if(Ne(),r(),(c||s.sp)&&!rs(s)&&Vr(s),c){if(o.then(Ro,Ro),e)return o.then(u=>{ko(s,u)}).catch(u=>{Gs(u,s,0)});s.asyncDep=o}else ko(s,o)}else Po(s)}function ko(s,e,t){k(e)?s.type.__ssrInlineRender?s.ssrRender=e:s.render=e:Y(e)&&(s.setupState=jr(e)),Po(s)}function Po(s,e,t){const n=s.type;s.render||(s.render=n.render||ke);{const i=fs(s);Pe();try{vf(s)}finally{Ne(),i()}}}const ph={get(s,e){return ne(s,"get",""),s[e]}};function mh(s){const e=t=>{s.exposed=t||{}};return{attrs:new Proxy(s.attrs,ph),slots:s.slots,emit:s.emit,expose:e}}function gi(s){return s.exposed?s.exposeProxy||(s.exposeProxy=new Proxy(jr(Wa(s.exposed)),{get(e,t){if(t in e)return e[t];if(t in os)return os[t](s)},has(e,t){return t in e||t in os}})):s.proxy}const gh=/(?:^|[-_])\w/g,bh=s=>s.replace(gh,e=>e.toUpperCase()).replace(/[-_]/g,"");function wh(s,e=!0){return k(s)?s.displayName||s.name:s.name||e&&s.__name}function No(s,e,t=!1){let n=wh(e);if(!n&&e.__file){const i=e.__file.match(/([^/\\]+)\.\w+$/);i&&(n=i[1])}if(!n&&s&&s.parent){const i=r=>{for(const o in r)if(r[o]===e)return o};n=i(s.components||s.parent.type.components)||i(s.appContext.components)}return n?bh(n):t?"App":"Anonymous"}function yh(s){return k(s)&&"__vccOpts"in s}const Eh=(s,e)=>Za(s,e,hs),Th="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let bi;const Lo=typeof window<"u"&&window.trustedTypes;if(Lo)try{bi=Lo.createPolicy("vue",{createHTML:s=>s})}catch{}const Uo=bi?s=>bi.createHTML(s):s=>s,Sh="http://www.w3.org/2000/svg",Oh="http://www.w3.org/1998/Math/MathML",Ze=typeof document<"u"?document:null,Do=Ze&&Ze.createElement("template"),Ah={insert:(s,e,t)=>{e.insertBefore(s,t||null)},remove:s=>{const e=s.parentNode;e&&e.removeChild(s)},createElement:(s,e,t,n)=>{const i=e==="svg"?Ze.createElementNS(Sh,s):e==="mathml"?Ze.createElementNS(Oh,s):t?Ze.createElement(s,{is:t}):Ze.createElement(s);return s==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:s=>Ze.createTextNode(s),createComment:s=>Ze.createComment(s),setText:(s,e)=>{s.nodeValue=e},setElementText:(s,e)=>{s.textContent=e},parentNode:s=>s.parentNode,nextSibling:s=>s.nextSibling,querySelector:s=>Ze.querySelector(s),setScopeId(s,e){s.setAttribute(e,"")},insertStaticContent(s,e,t,n,i,r){const o=t?t.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),t),!(i===r||!(i=i.nextSibling)););else{Do.innerHTML=Uo(n==="svg"?`<svg>${s}</svg>`:n==="mathml"?`<math>${s}</math>`:s);const c=Do.content;if(n==="svg"||n==="mathml"){const u=c.firstChild;for(;u.firstChild;)c.appendChild(u.firstChild);c.removeChild(u)}e.insertBefore(c,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},vh=Symbol("_vtc");function Ih(s,e,t){const n=s[vh];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?s.removeAttribute("class"):t?s.setAttribute("class",e):s.className=e}const Fo=Symbol("_vod"),Ch=Symbol("_vsh"),xh=Symbol(""),Rh=/(?:^|;)\s*display\s*:/;function $h(s,e,t){const n=s.style,i=J(t);let r=!1;if(t&&!i){if(e)if(J(e))for(const o of e.split(";")){const c=o.slice(0,o.indexOf(":")).trim();t[c]==null&&sn(n,c,"")}else for(const o in e)t[o]==null&&sn(n,o,"");for(const o in t)o==="display"&&(r=!0),sn(n,o,t[o])}else if(i){if(e!==t){const o=n[xh];o&&(t+=";"+o),n.cssText=t,r=Rh.test(t)}}else e&&s.removeAttribute("style");Fo in s&&(s[Fo]=r?n.display:"",s[Ch]&&(n.display="none"))}const Mo=/\s*!important$/;function sn(s,e,t){if(P(t))t.forEach(n=>sn(s,e,n));else if(t==null&&(t=""),e.startsWith("--"))s.setProperty(e,t);else{const n=kh(s,e);Mo.test(t)?s.setProperty(dt(n),t.replace(Mo,""),"important"):s[n]=t}}const jo=["Webkit","Moz","ms"],wi={};function kh(s,e){const t=wi[e];if(t)return t;let n=nt(e);if(n!=="filter"&&n in s)return wi[e]=n;n=gr(n);for(let i=0;i<jo.length;i++){const r=jo[i]+n;if(r in s)return wi[e]=r}return e}const qo="http://www.w3.org/1999/xlink";function Bo(s,e,t,n,i,r=Aa(e)){n&&e.startsWith("xlink:")?t==null?s.removeAttributeNS(qo,e.slice(6,e.length)):s.setAttributeNS(qo,e,t):t==null||r&&!yr(t)?s.removeAttribute(e):s.setAttribute(e,r?"":xt(t)?String(t):t)}function zo(s,e,t,n,i){if(e==="innerHTML"||e==="textContent"){t!=null&&(s[e]=e==="innerHTML"?Uo(t):t);return}const r=s.tagName;if(e==="value"&&r!=="PROGRESS"&&!r.includes("-")){const c=r==="OPTION"?s.getAttribute("value")||"":s.value,u=t==null?s.type==="checkbox"?"on":"":String(t);(c!==u||!("_value"in s))&&(s.value=u),t==null&&s.removeAttribute(e),s._value=t;return}let o=!1;if(t===""||t==null){const c=typeof s[e];c==="boolean"?t=yr(t):t==null&&c==="string"?(t="",o=!0):c==="number"&&(t=0,o=!0)}try{s[e]=t}catch{}o&&s.removeAttribute(i||e)}function Ph(s,e,t,n){s.addEventListener(e,t,n)}function Nh(s,e,t,n){s.removeEventListener(e,t,n)}const Ho=Symbol("_vei");function Lh(s,e,t,n,i=null){const r=s[Ho]||(s[Ho]={}),o=r[e];if(n&&o)o.value=n;else{const[c,u]=Uh(e);if(n){const h=r[e]=Mh(n,i);Ph(s,c,h,u)}else o&&(Nh(s,c,o,u),r[e]=void 0)}}const Go=/(?:Once|Passive|Capture)$/;function Uh(s){let e;if(Go.test(s)){e={};let n;for(;n=s.match(Go);)s=s.slice(0,s.length-n[0].length),e[n[0].toLowerCase()]=!0}return[s[2]===":"?s.slice(3):dt(s.slice(2)),e]}let yi=0;const Dh=Promise.resolve(),Fh=()=>yi||(Dh.then(()=>yi=0),yi=Date.now());function Mh(s,e){const t=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=t.attached)return;Ue(jh(n,t.value),e,5,[n])};return t.value=s,t.attached=Fh(),t}function jh(s,e){if(P(e)){const t=s.stopImmediatePropagation;return s.stopImmediatePropagation=()=>{t.call(s),s._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const Qo=s=>s.charCodeAt(0)===111&&s.charCodeAt(1)===110&&s.charCodeAt(2)>96&&s.charCodeAt(2)<123,qh=(s,e,t,n,i,r)=>{const o=i==="svg";e==="class"?Ih(s,n,o):e==="style"?$h(s,t,n):Ls(e)?Nn(e)||Lh(s,e,t,n,r):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Bh(s,e,n,o))?(zo(s,e,n),!s.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Bo(s,e,n,o,r,e!=="value")):s._isVueCE&&(/[A-Z]/.test(e)||!J(n))?zo(s,nt(e),n,r,e):(e==="true-value"?s._trueValue=n:e==="false-value"&&(s._falseValue=n),Bo(s,e,n,o))};function Bh(s,e,t,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in s&&Qo(e)&&k(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&s.tagName==="INPUT"||e==="type"&&s.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const i=s.tagName;if(i==="IMG"||i==="VIDEO"||i==="CANVAS"||i==="SOURCE")return!1}return Qo(e)&&J(t)?!1:e in s}const zh=ce({patchProp:qh},Ah);let Wo;function Hh(){return Wo||(Wo=jf(zh))}const Gh=((...s)=>{const e=Hh().createApp(...s),{mount:t}=e;return e.mount=n=>{const i=Wh(n);if(!i)return;const r=e._component;!k(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.nodeType===1&&(i.textContent="");const o=t(i,!1,Qh(i));return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e});function Qh(s){if(s instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&s instanceof MathMLElement)return"mathml"}function Wh(s){return J(s)?document.querySelector(s):s}const Vo="1.12.7";function Vh(){return new AbortController().signal}function Kh(...s){const e=s.length;if(e===0)return Vh();if(e===1)return s[0];const t=new AbortController;for(const n of s)if(!(!n||!n.addEventListener)){if(n.aborted)return AbortSignal.abort(n.reason);n.addEventListener("abort",()=>t.abort(n.reason))}return t.signal}const te=Object.freeze({ASK:"ask",SEARCH:"search",RECOMMENDATION:"recommendation",INTERACTIONS:"interactions"}),Se=Object.freeze({QUESTIONS:"questions",RELATED_QUESTIONS:"related_questions",TRENDING_QUESTIONS:"trending_questions",SEARCH:"search",AUTOCOMPLETE:"autocomplete",SEARCH_AUTOCOMPLETE:"search_autocomplete",MGET:"mget",USER_TO_PRODUCTS:"user_to_products",USER_TO_CATEGORIES:"user_to_categories",USER_TO_ATTRIBUTES:"user_to_attributes",USER_TO_TRENDING:"user_to_trending",USER_TO_HISTORY:"user_to_history",PRODUCT_TO_PRODUCTS:"product_to_products",UPLOAD:"upload"}),_s=Object.freeze(Object.defineProperty({__proto__:null,GROUP:te,NAME:Se},Symbol.toStringTag,{value:"Module"}));function Ei(s,e){if(!s)return;const t=s.indexOf(e);t>-1&&s.splice(t,1)}function Yh(s,e){if(!s)return;const t=s.findIndex(e);t>-1&&s.splice(t,1)}function Et(s){return Array.isArray(s)?s:s===void 0?[]:[s]}function L(s){if(typeof s!="object")return s;const e={};for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&s[t]!==void 0&&(e[t]=s[t]);return e}function nn(s){return s==null}function Zh(s,e,t){if(s.has(e))return s.get(e);const n=t(e);return s.set(e,n),n}function ct(s,e,t){t=typeof t=="string"?[t]:t,Object.defineProperties(s,t.reduce((n,i)=>(n[i]={get:()=>{const r=e[i];return typeof r=="function"?r.bind(e):r}},n),{}))}function Jh(s,e,t){t=typeof t=="string"?[t]:t,Object.defineProperties(s,t.reduce((n,i)=>(n[i]={get:()=>e[i],set:r=>{e[i]=r}},n),{}))}function G(s,e){for(const t in e)e.hasOwnProperty(t)&&Object.defineProperty(s,t,{value:e[t]})}function Xh(s,e){const t=Symbol.for(e);Object.defineProperty(s,t,{value:!0}),Object.defineProperty(s,"isTypeOf",{value:n=>n&&n instanceof s||typeof n.constructor=="function"&&n.constructor[t]===!0})}function Ko(s){return s.replace(/-([a-z])/g,e=>e[1].toUpperCase())}function Yo(s){return s.replace(/[-_][a-z]/g,e=>e[1].toUpperCase())}function Zo(s){return s.replace(/([A-Z])/g,"-$1").toLowerCase()}function e_(s){return s.replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`)}function t_(s){return s.replaceAll("-","_")}function s_(s){return s.replace(/[-_]([a-zA-Z])/g,(e,t)=>` ${t}`)}class Jo{constructor(e,{duration:t=0,onDuration:n,offDuration:i,state:r}={}){if(typeof e!="function")throw new Error(`Callback must be a function: ${e}`);this._callback=e,Object.defineProperty(this,"durations",{value:Object.freeze({on:n!==void 0?n:t,off:i!==void 0?i:t})}),this._value=this._state=!!r,this._active=!0}get active(){return this._active}get state(){return this._state}get value(){return this._value}set value(e){if(e=!!e,this._value===e)return;n_(this);const t=this.durations[e?"on":"off"];t?this._timeout=setTimeout(()=>Xo(this,e),t):Xo(this,e),this._value=e}disconnect(){this._active=!1}}function n_(s){s._timeout&&(clearTimeout(s._timeout),s._timeout=void 0)}function Xo(s,e){s._state!==e&&(s._state=e,s._active&&s._callback(e))}function i_(s){return typeof s=="string"?document.querySelector(s):s}function Ti(s,e,{root:t=s.ownerDocument}={}){for(;s&&s!==t;s=s.parentElement){const n=e(s);if(n!==void 0)return n}}function r_(s){const{tagName:e}=s;customElements.define(e,s);for(const t of document.querySelectorAll(e))customElements.upgrade(t)}async function rn(s){return new Promise((e,t)=>{window.requestAnimationFrame(async n=>{try{await s(n),e()}catch(i){t(i)}})})}async function Si(s,{area:e=.5,duration:t=1e3,signal:n}={}){return s=i_(s),new Promise((i,r)=>{const o=new Jo(u=>{u&&(o.disconnect(),c.disconnect(),i())},{onDuration:t}),c=new IntersectionObserver(u=>{o.value=u[0].isIntersecting},{threshold:e});c.observe(s),n&&n.addEventListener&&n.addEventListener("abort",()=>{o.disconnect(),c.disconnect(),r(new DOMException("Aborted","AbortError"))})})}async function o_(){document.readyState==="loading"&&await new Promise(s=>{document.addEventListener("DOMContentLoaded",s,{once:!0})})}function xe(s){return s=`${s}`,s&&s.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function ds(){return c_()||u_()||l_()}function c_(){return crypto&&crypto.randomUUID?crypto.randomUUID():void 0}function u_(){if(!URL||!URL.createObjectURL||URL.revokeObjectURL||!Blob)return;const s=URL.createObjectURL(new Blob),e=s.toString();return URL.revokeObjectURL(s),e.substring(e.lastIndexOf("/")+1)}function l_(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}function a_(s,e){const t=on(()=>window.localStorage.getItem(s)),n=on(()=>f_(s)),i=t||n||`${e()}`;return i&&!t&&on(()=>window.localStorage.setItem(s,i)),i&&!n&&on(()=>h_(s,i)),i}function f_(s){const e=`; ${document.cookie}`,t=`; ${encodeURIComponent(s)}=`,n=e.indexOf(t);if(n<0)return;const i=n+t.length,r=e.indexOf(";",i);return decodeURIComponent(r<0?e.substring(i):e.substring(i,r))}function h_(s,e){document.cookie=`${encodeURIComponent(s)}=${encodeURIComponent(e)}; max-age=31536000; path=/`}function on(s){try{return s()}catch(e){if(!__(e))throw e}}function __(s){return s.name==="SecurityError"}function d_(s,e,t){return s+(s.indexOf("?")<0?"?":"&")+encodeURIComponent(e)+"="+encodeURIComponent(`${t}`)}function cn(s){return new p_(s)}class p_{constructor(e){this._value=e;const t=n=>{this._value=n};G(this,{set:t,args:(...n)=>t(n),t:()=>t(!0),f:()=>t(!1),merge:n=>t({...this._value,...n})})}get value(){return this._value}}class Je{constructor(){const e=this;e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),Object.freeze(this)}}class m_{constructor(){this._index=-1,this._done=!1,this._aborted=!1,this._abortReason=void 0,this._error=void 0}get aborted(){return this._aborted}get abortReason(){return this._abortReason}get done(){return this._done}update(e,t=!1){this._done||(this._value=e,this._done=t,this._index++,this._resolution&&(this._resolution.resolve(),this._resolution=void 0))}error(e){this._error=e,this._resolution&&(this._resolution.reject(e),this._resolution=void 0)}abort(e){this._aborted=!0,this._abortReason=e,this._resolution&&(e instanceof Error?this._resolution.reject(e):this._resolution.resolve(),this._resolution=void 0)}async*[Symbol.asyncIterator](){let e=0;for(;;){if(this._error)throw this._error;if(this._aborted||(e>this._index&&(this._resolution||(this._resolution=new Je),await this._resolution.promise),this._aborted))break;const t=this._done,n=this._index+1;if(yield this._value,this._aborted||t)break;e=n}}}function g_(s,{interval:e=1e3,errorLimit:t=10,onError:n,onResponse:i,signal:r}={}){if(r&&r.aborted)return[];let o=0,c,u=!1,h;function a(){c&&clearInterval(c),u=!0}const _=new m_;return c=setInterval(async()=>{let m,T,$;try{if([m,T,$]=await s(r?{signal:r}:{}),u||!nn(h)&&$<=h)return;nn($)||(h=$),i&&i(m,T,$),o=0}catch(N){n&&n(N),o++,o>t&&(a(),_.error(N));return}_.update(m,T),T&&a()},e),r&&r.addEventListener&&r.addEventListener("abort",()=>{a(),_.abort(r.reason)}),_}function b_(s,{onError:e=n=>console.error(n),transform:t=n=>n}={}){try{t(s)()}catch(n){e(n)}}function ec(s,e){const t=window[s]||(window[s]=[]);if(t._processed)return;t._processed=!0;const n=i=>b_(i,e);Object.defineProperty(t,"push",{value:n});for(const i of t)n(i)}const w_="1.12.7";let y_;try{y_=document.currentScript}catch{}async function tc(s){try{let e=E_(s);return e||(e=document.createElement("link"),e.rel="stylesheet",e.href=s,document.head.appendChild(e)),T_(e)}catch(e){console.error(e)}}function sc(s){return`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@${w_}/dist/css/${s}.css`}function E_(s){return document.head.querySelector(`link[href="${s}"]`)}async function T_(s){await S_(s),await O_(s)}async function S_(s){if(!s.sheet)return new Promise((e,t)=>{let n;s.onerror=()=>{n&&clearInterval(n),t()},n=setInterval(()=>{s.sheet&&(n&&clearInterval(n),e())},100)})}async function O_(s){if(!nc(s))return new Promise(e=>{let t;t=setInterval(()=>{nc(s)&&(t&&clearInterval(t),e())},100)})}function nc(s){for(const e of document.styleSheets)if(e.ownerNode===s)return!0;return!1}function ic(s){let e;return t=>{e&&clearTimeout(e),e=setTimeout(()=>{e=void 0,t()},s)}}function rc(s,{depth:e=5,...t}={}){return Oi(s,e)}function Oi(s,e,t){if(e<=0)return"(...)";switch(typeof s){case"object":if(s)return s.length!==void 0?Array.prototype.map.call(s,n=>Oi(n,e-1)):s instanceof Node?v_(s):A_(s,e);default:return s}}function A_(s,e,t){const n={};if(e<=0)return n;for(const i in s){const r=s[i];typeof r!="function"&&(i.startsWith("_")&&typeof r=="object"&&r.constructor.name!=="Object"||(n[i]=Oi(r,e-1)))}return n}function v_(s){return s instanceof Element?`<${s.tagName.toLowerCase()}${s.id?` id="${s.id}"`:""}${s.className?` class="${s.className}"`:""}>`:`[TextNode](${s.length})`}function ps(s,e){const t=Object.getOwnPropertyDescriptors(e),n=Object.getOwnPropertyDescriptors(s);for(const[i,r]of Object.entries(t))i!=="constructor"&&n[i]===void 0&&Object.defineProperty(s,i,r)}function un(s){const e={},t=new Set;for(let n=s;n!==Object.prototype;n=Object.getPrototypeOf(n)){const i=Object.getOwnPropertyDescriptors(n);for(const r in i){if(r==="constructor"||r.startsWith("_")||t.has(r))continue;t.add(r);const{value:o}=i[r];o&&(e[r]=typeof o=="function"?o.bind(s):o)}}return Object.freeze(e)}function ln(s={},e={}){const t=s.metadata||e.metadata?L({...s.metadata,...e.metadata}):void 0,n=s._meta||e._meta?L({...s._meta,...e._meta}):void 0;return L({...s,...e,metadata:t,_meta:n})}function Oe(s={},e={}){const t=s.context&&s.context.custom_context||e.context&&e.context.custom_context?L({...s.context&&s.context.custom_context,...e.context&&e.context.custom_context}):void 0,n=s.context||e.context?L({...s.context,...e.context,custom_context:t}):void 0;return L({...s,...e,context:n})}const I_=100,C_=4;function x_(s){const e=R_(s);return(t,n,i,r)=>{const o=e(i,n);return t+Math.max(r-i,0)*o/1e3}}function R_({speed:s=I_,acceleration:e=C_}={}){if(typeof s=="function")return s;if(typeof s!="number")throw new Error(`Invalid speed: ${s}`);if(typeof e!="number")throw new Error(`Invalid acceleration: ${e}`);return(t,n)=>{let i=s*(Math.random()+.5);return e>0&&n!==void 0&&t>n&&(i*=1+(t-n)*e/1e3),i}}const Ai=Symbol.for("miso:resources");class $_{constructor(){this._resources=new Map;const e=window[Ai]||[];for(const t of e)try{const[n,i]=t;this.push([n,i])}catch{}}push([e,t]){oc(this._resources,e).resolve(t)}async get(e){return oc(this._resources,e).promise}}function oc(s,e){if(s.has(e))return s.get(e);const t=new Je;return s.set(e,t),t}function k_(){return window[Ai]||(window[Ai]=new $_)}class P_{constructor(e,t){this._dispatchRequested=!1,this._requests=[],this._run=e,this._error=t||(n=>console.error(n)),this._bulkId=0,this._dispatch=this._dispatch.bind(this)}get info(){return{bulkId:this._bulkId,index:this._requests.length}}async run(e){const t=new Je;return this._requests.push({action:e,resolution:t}),this._requestDispatch(),t.promise}_requestDispatch(){this._dispatchRequested||(this._dispatchRequested=!0,setTimeout(this._dispatch))}_dispatch(){if(!this._dispatchRequested)return;this._dispatchRequested=!1;const e=this._requests,t=this._bulkId++;this._requests=[];try{this._run(e,{bulkId:t})}catch(n){this._error(n)}}}class Ft{constructor({target:e,error:t,replays:n=[]}={}){if(this._error=t||(i=>console.error(i)),!Array.isArray(n))throw new Error(`Replays option must be an array of strings: ${n}`);this._replays=new Set(n),this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={},e&&this._injectSubscribeInterface(e)}emit(e,t){const n={data:t,meta:{name:e,ts:Date.now()}},i=this._namedCallbacks[e];if(i)for(const r of i)r(n);for(const r of this._unnamedCallbacks)r(n);this._shallStoreForReplay(e)&&(this._pastEvents[e]||(this._pastEvents[e]=[])).push(n)}on(e,t){return this._checkName(e),this._checkCallback(t),this._on(e,this._wrapCallback(t))}once(e){this._checkName(e);const t=this;return new Promise((n,i)=>{const r=t._on(e,o=>{setTimeout(()=>r());try{n(o)}catch(c){i(c)}})})}clear(){this._namedCallbacks={},this._unnamedCallbacks=[],this._pastEvents={}}_checkName(e){if(typeof e!="string")throw new Error(`Event name should be a string: ${e}`)}_checkCallback(e){if(typeof e!="function")throw new Error(`Event callback should be a function: ${e}`)}_shallStoreForReplay(e){return this._replays.has(e)}_wrapCallback(e){const t=this;return({data:n,meta:i})=>{try{e(n,i)}catch(r){t._error(r)}}}_on(e,t){if(e==="*"?this._unnamedCallbacks.push(t):(this._namedCallbacks[e]||(this._namedCallbacks[e]=[])).push(t),e==="*")for(const n in this._pastEvents)this._pastEvents[n].forEach(t);else this._pastEvents[e]&&this._pastEvents[e].forEach(t);return()=>this._off(e,t)}_off(e,t){if(e==="*")Ei(this._unnamedCallbacks,t);else{const n=this._namedCallbacks[e];n&&Ei(n,t)}}_injectSubscribeInterface(e){ct(e,this,["on","once"])}}function N_(s,e){if(s!==void 0&&typeof s!="string"&&e===void 0&&(e=s,s=void 0),s!==void 0&&(typeof s!="string"||!s))throw new Error(`Invalid Component name: "${s}"`);return Object.freeze({name:s,parent:e,path:L_(s,e),uuid:ds()})}function L_(s,e){return Object.freeze([...e&&e.meta&&e.meta.path||[],...s?[s]:[]])}class pe{constructor(e,t){const n=N_(e,t);G(this,{meta:n});const i=this._error=this._error.bind(this);this._events=new Ft({target:this,error:i,replays:["child"]}),this._warn=this._warn.bind(this),t=n.parent,t&&t._events&&t._events.emit("child",this)}_warn(...e){const t=this.meta.parent;(t&&t._warn||console.warn)(...e)}_error(...e){const t=this.meta.parent;(t&&t._error||console.error)(...e)}}Xh(pe,"miso:component");class cc extends pe{constructor(e,t,{libName:n,keyName:i}={}){switch(super(e,t),this._events._replays.add("register"),this._libraries={},this._libResolutions={},this._libName=n,typeof i){case"string":this._keyFn=(r=>r[i]);break;case"function":this._keyFn=i;break;default:throw new Error(`Expect keyName to be a string or a function: ${i}`)}}isRegistered(e){return this._checkKey(e),!!this._libraries[e]}get registered(){return Object.values(this._libraries)}async whenRegistered(e){if(this.isRegistered(e))return this._libraries[e];const{promise:t}=this._libResolutions[e]||(this._libResolutions[e]=new Je);return t}register(...e){for(const t of e)this._register(t)}_checkKey(e){if(typeof e!="string"||!e)throw new Error(`Expect key to be a non-empty string: ${e}`)}_checkLib(e){if(typeof e!="function")throw new Error(`Expect lib to be a class or function: ${e}`)}_register(e){this._checkLib(e);const t=this._keyFn(e);this._checkKey(t);const n=this._libraries||(this._libraries={});n[t],n[t]=e,this._libResolutions[t]&&this._libResolutions[t].resolve(e),this._events.emit("register",e)}}class U_{constructor(e,t){this._callback=e,this._options=t||{},t!==!1&&(this._intersection=new IntersectionObserver(this._handleIntersection.bind(this),{threshold:t.area||.5}),this._continuity=new Jo(this._handleContinuity.bind(this),{onDuration:t.duration||1e3})),this._displayed=void 0,this._intersecting=!1,this._triggered=new Set}observe(e){this._options!==!1&&this._intersection.observe(e)}unobserve(e){this._options!==!1&&this._intersection.unobserve(e)}display(e){this._options!==!1&&(this._triggered.has(e)&&(e=void 0),this._displayed!==e&&(this._displayed=e,this._continuity.value=!1,this._syncContinuity()))}disconnect(){this._options!==!1&&(this._continuity.disconnect(),this._intersection.disconnect())}get triggeredCount(){return this._triggered.size}get triggered(){return new Set(this._triggered)}_syncContinuity(){this._continuity.value=this._intersecting&&this._displayed!==void 0}_handleIntersection(e){this._intersecting=e[0].isIntersecting,this._syncContinuity()}_handleContinuity(e){const t=this._displayed;if(e&&t!==void 0){if(this._triggered.has(t))return;this._triggered.add(t),this._displayed=void 0,this._callback(t)}}}class D_{constructor(e){this._ac=new AbortController,this._timeout=e,this.touch()}clear(){this._timeoutId!==void 0&&(clearTimeout(this._timeoutId),this._timeoutId=void 0)}touch(){this.clear(),this._timeoutId=setTimeout(()=>this.abort(),this._timeout)}get signal(){return this._ac.signal}abort(e){this.clear(),this._ac.abort(e||new Error(`Stall timeout: data stay unchanged for ${this._timeout/1e3} seconds.`))}}const uc=Object.freeze({DATA_ENDPOINT:"https://api-edge.askmiso.com/v1",EVENT_ENDPOINT:"https://api.askmiso.com/v1"});class lc{constructor(e,t){this._client=e,this._root=t,this._bulk=new P_(this._runBulkFetch.bind(this),e._error.bind(e))}async fetch(e,t,{method:n="POST",headers:i,timeout:r}={}){const{apiKey:o,request:c={}}=this._client.options;r=r||c.timeout;const u=n!=="GET"&&t!=null?JSON.stringify(t):void 0,h=r?AbortSignal.timeout(r):void 0,a=await(this._root._customFetch||window.fetch)(e,L({method:n,headers:i,body:u,cache:"no-cache",mode:"cors",signal:h})),_=await a.json();if(a.status>=400||_.errors){var m=new Error(_.message);throw m.data=_,m.status=a.status,m}return _}get bulkInfo(){return this._bulk.info}async fetchForBulk(e,t,n,{method:i}={}){if(i&&i!=="POST")throw new Error(`Non-POST API is not supported in bulk mode: ${url}`);return this._bulk.run({apiGroup:e,apiName:t,payload:n})}async _runBulkFetch(e){const t=this.url(["bulk"]),n={requests:e.map(({action:{apiGroup:r,apiName:o,payload:c}})=>({api_name:`${r}/${o}`,body:c}))},{data:i}=await this.fetch(t,n);for(let r=0,o=e.length;r<o;r++){const{resolution:c}=e[r],{error:u,status_code:h,body:a}=i[r];h>=400||u?c.reject({status_code:h,body:a}):c.resolve(a)}}sendBeacon(e,t,{method:n}={}){if(n&&n!=="POST")throw new Error(`Non-POST API is not supported in useBeacon mode: ${e}`);if(!(this._root._customSendBeacon?this._root._customSendBeacon(e,JSON.stringify(t)):window.navigator.sendBeacon(e,JSON.stringify(t))))throw new Error(`Send beacon unsuccessful: ${e}`)}url(e){const{apiKey:t}=this._client.options,n=e.filter(r=>r).join("/");return`${`${this.getApiEndpoint(n)}/${n}`}?api_key=${window.encodeURIComponent(t)}`}getApiEndpoint(e){const{dataEndpoint:t=uc.DATA_ENDPOINT,eventEndpoint:n=uc.EVENT_ENDPOINT}=this._client.options;return e==="interactions"?n:t}applyUrlPasses(e,{apiGroup:t,apiName:n,url:i}){const r=this._client;for(const o of this._root._urlPasses)try{i=o({client:r,apiGroup:t,apiName:n,url:i})||i}catch(c){(e._error||console.error)(c)}return i}applyPayloadPasses(e,{apiGroup:t,apiName:n,payload:i}){const r=this._client;for(const o of this._root._payloadPasses)try{i=o({client:r,apiGroup:t,apiName:n,payload:i})||i}catch(c){(e._error||console.error)(c)}return i}applyHeaderPasses(e,{apiGroup:t,apiName:n,payload:i,headers:r,options:o}){const c=this._client;for(const u of this._root._headersPasses)try{r=u({client:c,apiGroup:t,apiName:n,payload:i,headers:r,options:o})||r}catch(h){(e._error||console.error)(h)}return r}}class ms extends pe{constructor(e,t){super(t,e),this._apiPath=t,this.helpers=e.helpers,this.clientOptions=e._client.options,this.context=e._client.context}async _run(e,t,n={}){const{bulk:i}=n,r=i?{bulk:this.helpers.bulkInfo}:void 0,o=this._apiPath,c=this._url({apiGroup:o,apiName:e,payload:t,options:n}),u=this._headers({apiGroup:o,apiName:e,payload:t,options:n});t=this._preprocess({apiGroup:o,apiName:e,payload:t,options:n});const h={apiGroup:o,apiName:e,payload:t,url:c,headers:u,options:n};this._events.emit("request",{...h,...r});const a=await this._send(h),_={...h,response:a};return this._events.emit("response",{..._,...r}),this._postprocess(_)}_headers({apiGroup:e,apiName:t,payload:n,options:i}){return this.helpers.applyHeaderPasses(this,{apiGroup:e,apiName:t,payload:n,headers:{},options:i})}_preprocess({apiGroup:e,apiName:t,payload:n,options:i}){return this.helpers.applyPayloadPasses(this,{apiGroup:e,apiName:t,payload:n,options:i})}_url({apiGroup:e,apiName:t,options:n}){const i=this.helpers.url([e,t],n);return this.helpers.applyUrlPasses(this,{apiGroup:e,apiName:t,url:i,options:n})}async _send({apiGroup:e,apiName:t,url:n,headers:i,payload:r,options:{bulk:o,...c}={}}){return o?this.helpers.fetchForBulk(e,t,r):this.helpers.fetch(n,r,{...c,headers:i})}_postprocess({response:e}){return e.data}}const{GROUP:F_,NAME:ac}=_s;class fc extends ms{constructor(e){super(e,F_.INTERACTIONS)}async upload(e,t){try{return await this._run(ac.UPLOAD,e,t)}catch(n){if(n.status===400&&n.message&&n.message.toLowerCase().indexOf("playground")>-1)this._warn("Ignore interactions uploaded to playground app.");else throw n}}_url({apiGroup:e,apiName:t,options:n}){const i=this.helpers.url([this._apiPath],n);return this.helpers.applyUrlPasses(this,{apiGroup:e,apiName:t,url:i,options:n})}_preprocess({apiGroup:e,apiName:t,payload:n}){return t===ac.UPLOAD&&(n=this._normalizeUploadPayload(n)),super._preprocess({apiGroup:e,apiName:t,payload:n})}_normalizeUploadPayload(e){if(typeof e!="object")throw new Error(`Interactions payload has to be either an object or an array of objects: ${e}`);return Array.isArray(e)||(e=[e]),{data:e}}async _send({options:{useBeacon:e=!0,...t}={},...n}){if(e){const{url:i,payload:r}=n;return this.helpers.sendBeacon(i,r,t),{}}else return super._send({...n,options:t})}}class M_{constructor(e={}){this._ac=new AbortController,this._options=e}async get(e){return this._get({...this._options,...e})}_get(e){throw new Error("Not implemented")}abort(e){this._ac.abort(e)}[Symbol.asyncIterator](){const e=async({signal:h}={})=>{const a=await this.get();return[a,this._isFinished(a),this._revisionOf(a)]};let{pollingInterval:t,signal:n,stallTimeout:i=12e4,...r}=this._options;const o=new D_(i);n=Kh(this._ac.signal,o.signal,n);let c;return g_(e,{interval:t,signal:n,onResponse:(h,a)=>{a?o.clear():this._isUpdated(c,h)&&o.touch(),c=h},...r})[Symbol.asyncIterator]()}_isFinished(e){return!!(e&&e.finished)}_isUpdated(e,t){return!e||e.answer_stage!==t.answer_stage||an(e.answer)!==an(t.answer)||an(e.reasoning)!==an(t.reasoning)}_revisionOf(e){return e&&e.revision}}class hc extends M_{constructor(e,t,n,i){super(i),this._api=e,this._method=t,this._id=n}async _get(e){return this._api[this._method](this._id,e)}}function an(s=""){return s.length}const{GROUP:j_,NAME:Xe}=_s;let _c=class extends ms{constructor(e){super(e,j_.ASK)}async questions(e,t={}){if(mc(e)&&(e={question_id:e}),e.question_id)return new dc(this,e,t);const n=await this._run(Xe.QUESTIONS,e,t);return new dc(this,n,t)}async _questions(e,t){return this._run(Xe.QUESTIONS,e,t)}async _questionGet(e,t){return this._run(`${Xe.QUESTIONS}/${e}/answer`,void 0,{...t,method:"GET"})}async relatedQuestions(e,t={}){return this._run(Xe.RELATED_QUESTIONS,e,t)}async trendingQuestions(e,t={}){return this._run(Xe.TRENDING_QUESTIONS,e,t)}async search(e,t={}){if(mc(e)&&(e={question_id:e}),e.question_id)return new pc(this,e,t);const n=await this._run(Xe.SEARCH,e,t);return n.question_id?new pc(this,n,t):n}async _searchGet(e,t){return this._run(`${Xe.QUESTIONS}/${e}/answer`,void 0,{...t,method:"GET"})}async autocomplete(e,t){return this._run(Xe.AUTOCOMPLETE,e,t)}async searchAutocomplete(e,t){return this._run(Xe.SEARCH_AUTOCOMPLETE,e,t)}};class dc extends hc{constructor(e,t,n={}){super(e,"_questionGet",t.question_id,n),this._response=t}get questionId(){return this._id}}class pc extends hc{constructor(e,t,n={}){super(e,"_searchGet",t.question_id,n),G(this,t),this._response=t}get questionId(){return this._id}}function mc(s){return typeof s=="string"&&s.charAt(0)!=="{"}const{GROUP:q_,NAME:vi}=_s;let gc=class extends ms{constructor(e){super(e,q_.SEARCH)}async search(e,t){return this._run(vi.SEARCH,e,t)}async autocomplete(e,t){return this._run(vi.AUTOCOMPLETE,e,t)}async multipleGet(e,t){return this._run(vi.MGET,e,t)}};const{GROUP:B_,NAME:Mt}=_s;let bc=class extends ms{constructor(e){super(e,B_.RECOMMENDATION)}async userToProducts(e,t){return this._run(Mt.USER_TO_PRODUCTS,e,t)}async userToCategories(e,t){return this._run(Mt.USER_TO_CATEGORIES,e,t)}async userToAttributes(e,t){return this._run(Mt.USER_TO_ATTRIBUTES,e,t)}async userToTrending(e,t){return this._run(Mt.USER_TO_TRENDING,e,t)}async userToHistory(e,t){return this._run(Mt.USER_TO_HISTORY,e,t)}async productToProducts(e,t){return this._run(Mt.PRODUCT_TO_PRODUCTS,e,t)}};class wc extends pe{constructor(e,t){super("api",e),this._client=e,this.helpers=new lc(e,t),this.interactions=new fc(this),this.ask=new _c(this),this.search=new gc(this),this.recommendation=new bc(this)}}const z_=Object.freeze(Object.defineProperty({__proto__:null,Api:wc,ApiBase:ms,ApiHelpers:lc,Ask:_c,Interactions:fc,Recommendation:bc,Search:gc},Symbol.toStringTag,{value:"Module"}));let yc=class extends pe{constructor(e){super("context",e),this._client=e}};const H_={api:z_,context:{Context:yc}};class G_{constructor(e){G(this,{install:e})}}function Q_(s,e,t){const n=s.slice(4);if(e==="dev"){const i=t.src,r=i.indexOf("?"),o=r<0?i.length:r,c=i.lastIndexOf("/",o)+1,u=i.indexOf(".",c),h=u<0?"":i.slice(u,o);return`${i.slice(0,c)}plugins/${n}${h}`}else return`https://cdn.jsdelivr.net/npm/@miso.ai/client-sdk@${e}/dist/umd/plugins/${n}.min.js`}class W_ extends cc{constructor(e){super("plugins",e,{libName:"plugin class",keyName:"id"}),this._root=e,this._currentScript=document.currentScript,this._events._replays.add("install").add("subtree"),this._installed={},this._installedResolutions={},this._useRequests={},this._subtrees=[],this.context=new V_(this,H_),this.plugins=new K_(this)}isInstalled(e){return this._checkKey(e),!!this._installed[e]}get installed(){return Object.values(this._installed)}get(e){return this._installed[e]}getPluginClass(e){return this._libraries[e]}use(e,t){if(typeof e=="function"&&e.id&&typeof e.id=="string"){this.register(e),this.use(e.id,t);return}let n;if(typeof e=="string"&&this.isInstalled(e)){n=this.get(e),this._tryConfig(n,t);return}if(typeof e=="string"&&!this.isRegistered(e)){(this._useRequests[e]||(this._useRequests[e]=[])).push(t);return}n=this._instantiate(e,t),this._install(n)}async install(e,t){return this.use(e,t),typeof e=="string"&&!this.isRegistered(e)&&await this._tryRegisterRemotely(e),this.whenInstalled(e)}async whenInstalled(e){if(typeof e=="function"&&e.id&&typeof e.id=="string"&&(e=e.id),this.isInstalled(e))return this.get(e);const{promise:t}=this._installedResolutions[e]||(this._installedResolutions[e]=new Je);return t}addSubtree(e){this._subtrees.push(e),this._events.emit("subtree",e)}addPayloadPass(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._payloadPasses.push(e)}addHeadersPass(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._headersPasses.push(e)}addUrlPass(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._urlPasses.push(e)}setCustomFetch(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._customFetch=e}setCustomSendBeacon(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._customSendBeacon=e}onHubUpdate(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._hubUpdateCallbacks.push(e)}onHubEmit(e){if(typeof e!="function")throw new Error(`Expect parameter to be a function: ${e}`);this._root._hubEmitCallbacks.push(e)}_tryConfig(e,t){t!==void 0&&(typeof e.config=="function"?(e.config(t),this._events.emit("config",[e,t])):this._warn(`Attempt to pass options to plugin "${e.id}", which offers no config() method.`))}_instantiate(e,t){switch(typeof e){case"string":this._checkKey(e);const n=this._libraries[e];if(!n)throw new Error(`Plugin class not found: ${e}`);const i=new n;return G(i,{id:e}),this._tryConfig(i,t),i;case"function":return new G_(e)}throw new Error(`Unexpected parameters: ${e}`)}_install(e){if(typeof e.install!="function")throw new Error(`Expect plugin.install to be a function: ${e}`);try{e.installed=!1,e.install(this.MisoClient,this.context),e.installed=!0}catch(t){throw t}e.id&&(this._installed[e.id]=e,this._installedResolutions[e.id]&&(this._installedResolutions[e.id].resolve(e),delete this._installedResolutions[e.id])),this._events.emit("install",e)}_register(e){super._register(e),this._fulfillUseRequests(e.id)}_fulfillUseRequests(e){const t=this._useRequests[e];if(t){for(const n of t)try{this.use(e,n)}catch(i){this._error(i)}delete this._useRequests[e]}}async _tryRegisterRemotely(e){if(e.startsWith("std:"))try{await this._registerStdRemotely(e);return}catch(t){console.error(t)}throw new Error(`Cannot register plugin remotely: ${e}`)}async _registerStdRemotely(e){const{version:t}=this._root,n=t==="dev"?`plugin:${e}@dev:${this.MisoClient.uuid}`:`plugin:${e}@${t}`;if(!document.querySelector(`script[data-request="${n}"]`)){const r=document.createElement("script");r.async=!0,r.src=Q_(e,t,this._currentScript),r.setAttribute("data-request",n),document.head.appendChild(r)}const i=await new k_().get(n);!this.isRegistered(e)&&this.register(i)}}class V_{constructor(e,t){ct(this,e,["getPluginClass","addSubtree","addPayloadPass","addHeadersPass","addUrlPass","setCustomFetch","setCustomSendBeacon","onHubUpdate","onHubEmit","whenInstalled","whenRegistered"]),G(this,{classes:t})}}class K_{constructor(e){ct(this,e,["installed","registered","isInstalled","isRegistered","whenInstalled","whenRegistered","get","register","use","install"])}}class Y_ extends pe{constructor(){super(),this._events._replays.add("create"),this._pluginRoot=new W_(this),this._clients=[],this._payloadPasses=[],this._headersPasses=[],this._urlPasses=[],this._customFetch=void 0,this._customSendBeacon=void 0,this._hubUpdateCallbacks=[],this._hubEmitCallbacks=[],this.version=Vo,this._cmdRes=new Je}get instances(){return[...this._clients]}async any(){return this._clients[0]||this._any||(this._any=(await this._events.once("create")).data)}get cmdDone(){return this._cmdRes.promise}}const ut=new Y_;function Z_(s){const e=ut._pluginRoot;return ut.MisoClient=e.MisoClient=s,ct(s,ut,["version","instances","any","meta","on","once","cmdDone"]),ct(s,e,["plugins"]),s}function J_(s){ut._clients.push(s),ut._events.emit("create",s)}function X_(){ut._cmdRes.resolve()}const ed=Object.freeze(Object.defineProperty({__proto__:null,debounce:ic,viewable:Si},Symbol.toStringTag,{value:"Module"})),{currentScript:Ec}=document;let Ii=class Ns extends pe{static attach(){if((window.MisoClients||(window.MisoClients=[])).push(Ns),window.MisoClient){window.MisoClient!==Ns&&console.warn(`window.MisoClient already exists: (${window.MisoClient.version}).`);return}window.MisoClient=Ns}static debug(){}constructor(e){super("client",ut),this._config(e),this.context=new yc(this),this.api=new wc(this,ut),J_(this)}get version(){return Ns.version}_config(e){this.options=Object.freeze(this._normalizeOptions(e))}_normalizeOptions(e={}){if(typeof e=="string"&&(e={apiKey:e}),e.readConfigFromScriptUrl&&(e={...this._readConfigFromScriptUrl(),...e}),!e.apiKey)throw new Error("Require API key to initialize miso client.");return e.request&&e.request.sendApiKeyByHeader&&console.warn('`sendApiKeyByHeader` option is deprecated. Please call `MisoClient.plugins.use("std:header-api-key");` instead.'),e.dataEndpoint=e.dataEndpoint||e.apiHost,e.eventEndpoint=e.eventEndpoint||e.apiHost,delete e.apiHost,L(e)}_readConfigFromScriptUrl(){const e=Ec.src||Ec.href,t=new URL(new Request(e).url).searchParams;return L({apiKey:t.get("api_key")||void 0})}};Ii.helpers=ed,G(Ii,{uuid:ds()});const qe=Z_(Ii),{GROUP:td,NAME:sd}=_s,nd="std:context";class id extends pe{static get id(){return nd}constructor(){super("context")}install(e,t){t.addSubtree(this),e.on("create",this._injectClient.bind(this)),t.addHeadersPass(this._modifyHeaders.bind(this)),t.addPayloadPass(this._modifyPayload.bind(this))}_injectClient(e){const t=new od(this);Jh(e.context,t,["anonymous_id","user_id","user_hash","user_type","site","auth"])}_modifyHeaders({client:e,headers:t}){const{auth:n}=e.context;return n&&(t={...t,Authorization:n}),t}_modifyPayload({client:e,apiGroup:t,apiName:n,payload:i}){if(!i)return i;switch(t){case td.INTERACTIONS:return n===sd.UPLOAD?this._modifyPayloadForInteractions(e,i):i;default:return this._modifyPayloadForQueries(e,i)}}_modifyPayloadForQueries(e,t){const{user_id:n,user_hash:i,user_type:r,anonymous_id:o,site:c}=e.context;return ln(t,{...n?{user_id:n,user_type:r,user_hash:i}:{anonymous_id:o},metadata:c?{site:c}:void 0})}_modifyPayloadForInteractions(e,{data:t}){const{anonymous_id:n,user_id:i,site:r}=e.context,o={anonymous_id:n,user_id:i},c=r?{site:r}:void 0,u=c?{custom_context:c}:void 0;return t=t.map(h=>Oe(h,{...o,context:u})),{data:t}}}let Tc;function rd(){return Tc||(Tc=a_("miso_anonymous_id",ds))}class od{constructor(e){this._plugin=e,this._props={}}get anonymous_id(){return this._props.anonymous_id||rd()}set anonymous_id(e){this._requireString("anonymous_id",e),this._set("anonymous_id",e)}get user_id(){return this._props.user_id}set user_id(e){this._requireString("user_id",e),this._set("user_id",e)}get user_hash(){return this._props.user_hash}set user_hash(e){this._requireString("user_hash",e),this._set("user_hash",e)}get user_type(){return this._props.user_type}set user_type(e){this._requireString("user_type",e),this._set("user_type",e)}get site(){return this._props.site}set site(e){this._requireString("site",e),this._set("site",e)}get auth(){return this._props.auth}set auth(e){this._requireString("auth",e),this._set("auth",e)}_set(e,t){this._props[e]=t,this._plugin._events.emit("set",`${e} = '${t}'`)}_requireString(e,t){if(typeof t!="string"&&typeof t<"u")throw new Error(`${e} must be a string`);return t}}const cd="std:page-info";class ud{static get id(){return cd}constructor(){}install(e,{addPayloadPass:t}){t(this._modifyPayload.bind(this))}_modifyPayload({apiGroup:e,apiName:t,payload:n}){return e==="interactions"&&t==="upload"?this._modifyPayloadForInteractions(n):n}_modifyPayloadForInteractions({data:e}){return e=e.map(t=>({...t,context:{...ld(),...t.context}})),{data:e}}}function ld(){return L({page:ad(),campaign:fd()})}function ad(){return L({url:window.location.href,referrer:document.referrer||void 0,title:document.title})}function fd(){const s=new URLSearchParams(window.location.search);let e=L({source:s.get("utm_source")||void 0,medium:s.get("utm_medium")||void 0,name:s.get("utm_campaign")||void 0,term:s.get("utm_term")||void 0,content:s.get("utm_content")||void 0});return Object.keys(e).length===0?void 0:e}const hd="std:auto-events";class _d extends pe{static get id(){return hd}constructor(){super("auto-events"),this._contexts=new WeakMap}install(e,t){t.addSubtree(this),e.on("create",this._injectClient.bind(this)),t.addPayloadPass(this._captureApiRequest.bind(this))}_injectClient(e){const t=new dd(this);this._contexts.set(e,t),e.autoEvents=t.interface}_captureApiRequest({client:e,apiGroup:t,apiName:n,payload:i}){switch(t){case te.SEARCH:switch(n){case Se.SEARCH:this._captureSearchApiRequest(e,i);break}break}}_captureSearchApiRequest(e,{q:t}){if(!t||t==="*")return;const n=this._contexts.get(e);!n||!n._config.search||e.api.interactions.upload({type:"search",search:{keywords:t},context:{custom_context:{channel:"miso_api"}}})}}class dd{constructor(e){this._plugin=e,this._config={search:!0},this.interface=Object.freeze({config:this.config.bind(this)})}config(e={}){if(typeof e!="object")throw new Error(`Config options must be an object or undefined: ${e}`);for(const t of e){if(!this._config.hasOwnProperty(t))continue;const n=this._config[t],i=e[t];i!==n&&(this._config[t]=n,this._plugin._events.emit("config",`${t}: ${n} -> ${i}`))}return Object.freeze({...this._config})}}const pd="std:interactions";class md{static get id(){return pd}constructor(){}install(e,{addPayloadPass:t}){t(this._modifyPayload.bind(this))}_modifyPayload({apiGroup:e,apiName:t,payload:n}){return e==="interactions"&&t==="upload"?this._modifyPayloadForInteractions(n):n}_modifyPayloadForInteractions({data:e}){return{data:e.map(gd)}}}function gd(s){const{context:e={}}=s,t={...e.custom_context,sdk_version:Vo};return t.uuid||(t.uuid=ds()),{...s,context:{...e,custom_context:t}}}const Ci="std:native-fetch";function bd(s){return s.toString().indexOf("[native code]")>-1}let xi,Sc;const Oc=(()=>{if(bd(window.fetch))return xi="original",window.fetch;try{const s=document.createElement("iframe");return s.style.display="none",document.head.appendChild(s),xi="borrowed",s.contentWindow.fetch}catch(s){Sc=s}})();class wd{static get id(){return Ci}install(e,t){if(!Oc){e.debug(`<plugin:${Ci}>`,"[error]",`Failed to obtain native fetch: ${Sc.message}`);return}t.setCustomFetch(Oc),e.debug(`<plugin:${Ci}>`,"[info]",`Using ${xi} native fetch`)}}const yd="std:api-patch";class Ed extends pe{static get id(){return yd}constructor(){super("api-patch")}install(e,t){t.addSubtree(this),t.addPayloadPass(this._patchApiPayload.bind(this))}_patchApiPayload(e){let{payload:t,...n}=e;return t&&(t=this._copyMetadataToMeta(t,n),t=this._suppressMetadata(t,n),t=this._suppressUserType(t,n),t)}_copyMetadataToMeta(e,{apiGroup:t}){switch(t){case te.ASK:return e.metadata?{...e,_meta:e.metadata}:e;default:return e}}_suppressMetadata(e,{apiGroup:t}){switch(t){case te.SEARCH:case te.RECOMMENDATION:const{_meta:n,metadata:i,...r}=e;return r;default:return e}}_suppressUserType(e,{apiGroup:t}){switch(t){case te.SEARCH:case te.RECOMMENDATION:const{user_type:n,...i}=e;return i;default:return e}}}const Ac="std:header-api-key";class Td{static get id(){return Ac}install(e,t){t.addUrlPass(this._modifyUrl.bind(this)),t.addHeadersPass(this._modifyHeaders.bind(this)),e.debug(`<plugin:${Ac}>`,"[info]","Send API key in header")}_modifyUrl({url:e}){return e.replace(/[?&]api_key=[^&]*/g,"")}_modifyHeaders({client:e,headers:t}){const{apiKey:n}=e.options;return n?{...t,"X-API-KEY":n}:t}}const fn="miso-logdump",vc="miso-logdump",Ic=`${vc}__download-btn`,Cc="Miso Log";class Sd{constructor(e={}){this._options=e,this._logs=[]}config(e={}){this._options={...this._options,...e}}async showDownloadButton(){await Cd();let e=document.getElementById(fn);if(!e){const t=document.createElement("div");t.textContent=this._options.logDownloadButtonText||Cc,t.classList.add(Ic),t.addEventListener("click",()=>this.download()),e=document.createElement("div"),e.id=fn,e.classList.add(vc),e.appendChild(t),document.body.appendChild(e)}e.style.display="block"}_syncUi(){const e=document.getElementById(fn),t=e&&e.querySelector(`.${Ic}`);t&&(t.textContent=this._options.logDownloadButtonText||Cc)}hideDownloadButton(){const e=document.getElementById(fn);e&&(e.style.display="none")}download(){const e=this._logs,t=new Blob([Ad(e)],{type:"application/json"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=this._filename(),i.click()}_filename(){let{logFilename:e}=this._options;if(typeof e=="function"){const t=xc();e=e({timestamp:t})}return e&&typeof e=="string"?e:Od()}clear(){this._logs=[]}}function Od(){return`miso-log.${xc()}.jsonl`}function xc(){return new Date().toISOString().replaceAll(/[\:\.]/g,"-")}function Ad(s){return s.map(e=>JSON.stringify(rc(vd(e),{depth:10}))).join(`
`)}function vd(s){if(s[0]==="<progressive-markdown>"){const e=s.length;return[...s.slice(0,e-1),Id(s[e-1])]}return s}function Id(s){return s&&rc(s,{depth:2})}let Rc;async function Cd(){return Rc||(Rc=tc(sc("logdump")))}const $c="std:debug";class xd{constructor(e={}){this._options=e,this._logs=new Sd(e)}static get id(){return $c}install(e){this._injectComponents(e),e.debug=(...t)=>this._logr(...t),e.logs=this._logs}config(e={}){this._options={...this._options,...e},this._logs.config(e),e.preserveLog&&this._log($c,"ua",window.navigator.userAgent)}_injectComponents(e,t=[]){e.on("child",n=>this._injectComponents(n,t)),e.on("subtree",n=>this._injectComponents(n,t.concat(e.meta.path))),e.on("*",(n,i)=>this._handleEvent(e,i,n,t))}_handleEvent(e,{name:t},n,i=[]){if(t==="child"||t==="subtree")return;const r=i.concat(e.meta.path);if(!r.length)switch(t){case"create":this._handleCreateClient(t,n);return}switch(r[0]){case"client":switch(r[1]){case"api":this._handleApiEvent(t,{...n,groupName:r[2]});return}break;case"plugins":r.length===1?this._handlePluginsEvent(t,n):this._handlePluginSpecificEvent(r[1],r.slice(2),t,n);return}this._logw(r.join("."),t,n)}_handleCreateClient(e,t){this._logw("client",e,t)}_handleApiEvent(e,{groupName:t,apiName:n,url:i,bulk:r,...o}){const c=new URL(i).pathname,u=["api",e];if(r&&u.push(`(bulk ${r.bulkId})`),u.push(`POST ${c}`),t==="interactions"){const h=o.payload.data[0],{type:a,custom_action_name:_,context:{custom_context:{property:m}={}}={}}=h,T=a==="custom"&&_?`${a}:${_}`:a;u.push(m?`${T} (${m})`:`${T}`)}u.push([{...o,url:i}]),this._log(...u)}_handlePluginsEvent(e,t){let n=[];Array.isArray(t)&&(n=t.slice(1),t=t[0]),this._log("plugins",e,`${t.id||"(anonymous)"}`,[t,...n])}_handlePluginSpecificEvent(e,t,n,i){this._logw([e,t.join(".")],n,i)}_getPath(e){const t=[];for(let n=e;n;n=n.meta.parent)n.meta.name&&t.push(n.meta.name);return t.reverse()}_logw(e,t,n){n===void 0?this._log(e,t):Array.isArray(n)?this._log(e,t,...n.map(kc)):this._log(e,t,kc(n))}_log(e,t,...n){this._logr(kd(e),Pd(t),...n)}_logr(...e){const t=this._options.console||{};this._options.preserveLog&&this._logs._logs.push(e),console.log(Rd(t),$d(t),...e)}}function Rd({text:s="Miso"}={}){return`%c${s}`}function $d({color:s="#fff",background:e="#334cbb"}={}){return`color: ${s}; background-color: ${e}; padding: 2px 2px 1px 4px;`}function kd(s){return`<${typeof s=="string"?s:s.filter(e=>e).join("/")}>`}function Pd(s){return`[${s}]`}function kc(s){const e=typeof s;return e==="function"||e==="object"&&!Array.isArray(s)?[s]:s}const Nd="std:dry-run";class Ld{constructor(e={}){this._options=e,this.id="std:dry-run",this.name="dry-run"}static get id(){return Nd}install(e,{addUrlPass:t}){t(this._modifyUrl.bind(this))}_modifyUrl({apiGroup:e,apiName:t,url:n}){return e==="interactions"&&t==="upload"?d_(n,"dry_run","1"):n}}function Pc(s,e){return e==null||e<=s?s:s+Math.floor(Math.random()*(e-s+1))}const Ud={"code-span":()=>["`","`"],"emphasis-1":()=>$i(Ri(1),2),"emphasis-2":()=>$i(Ri(2),2),"emphasis-3":()=>$i(Ri(3),2),strikethrough:()=>["~","~"],link:({url:s="https://miso.ai"}={})=>["[",`](${s})`]};function Ri(s=[1,3]){return s=typeof s=="number"?s:Pc(...s),"_*".charAt(Pc(0,1)).repeat(s)}const Dd=Object.keys(Ud);new Set(Dd);function $i(s,e){const t=[];for(let n=0;n<e;n++)t.push(typeof s=="function"?s():s);return t}qe.plugins.register(xd,Ld,wd,Td),qe.plugins.use(id),qe.plugins.use(ud),qe.plugins.use(_d),qe.plugins.use(md),qe.plugins.use(Ed);const Fd="data-miso-product-id",ki="default",d=Object.freeze({CONTAINER:"container",BANNER:"banner",QUERY:"query",FEEDBACK:"feedback",PRODUCTS:"products",CATEGORIES:"categories",ATTRIBUTES:"attributes",RESULTS:"results",ITEMS:"items",QUESTION:"question",ANSWER:"answer",REASONING:"reasoning",IMAGES:"images",SOURCES:"sources",RELATED_RESOURCES:"related_resources",FOLLOW_UP_QUESTIONS:"follow_up_questions",QUERY_SUGGESTIONS:"query_suggestions",RELATED_QUESTIONS:"related_questions",AFFILIATION:"affiliation",KEYWORDS:"keywords",FACETS:"facets",TOTAL:"total",MORE:"more",SORT:"sort",ERROR:"error"}),Md=new Set([d.PRODUCTS,d.CATEGORIES,d.ATTRIBUTES,d.RESULTS,d.ITEMS,d.QUESTION,d.ANSWER,d.REASONING,d.IMAGES,d.SOURCES,d.RELATED_RESOURCES,d.FOLLOW_UP_QUESTIONS,d.QUERY_SUGGESTIONS,d.RELATED_QUESTIONS,d.AFFILIATION,d.FACETS,d.TOTAL]);function jd(s){return Md.has(s)}const qd=new Set([d.PRODUCTS,d.IMAGES,d.SOURCES,d.RELATED_RESOURCES]);function Bd(s){return qd.has(s)}const fe=Object.freeze({IMPRESSION:"impression",VIEWABLE:"viewable",CLICK:"click",SUBMIT:"submit",FEEDBACK:"feedback"}),Nc=[fe.IMPRESSION,fe.VIEWABLE,fe.CLICK,fe.SUBMIT,fe.FEEDBACK],Lc=[fe.IMPRESSION,fe.VIEWABLE,fe.CLICK],zd=new Set(Lc);function Hd(s){return zd.has(s)}const gs=Object.freeze({UNTRACKED:"untracked",TRACKING:"tracking",TRIGGERED:"triggered"}),C=Object.freeze({INITIAL:"initial",LOADING:"loading",ERRONEOUS:"erroneous",READY:"ready",ONGOING:"ongoing",DONE:"done",EMPTY:"empty",NONEMPTY:"nonempty",UNANSWERABLE:"unanswerable"}),Tt=Object.freeze({ORGANIC:"_organic",SUGGESTED_QUESTIONS:"_suggested_questions",INLINE_QUESTION_LINK:"_inline_question_link"});function Uc(s){if(Nc.indexOf(s)<0)throw new Error(`Unrecognized event type: ${s}`)}function Gd(s){if(s!==gs.UNTRACKED&&s!==gs.TRACKING&&s!==gs.TRIGGERED)throw new Error(`Unrecognized tracking status: ${s}`)}const ee=Object.freeze({API:"api",LAYOUTS:"layouts",DATA_PROCESSOR:"dataProcessor",TRACKERS:"trackers",INTERACTIONS:"interactions",FILTERS:"filters",PAGINATION:"pagination",TEMPLATES:"templates"}),lt=Object.freeze({QUERY:"query",REFINE:"refine",MORE:"more"});function bs(s,e){return Object.freeze({...s,...e,members:Qd(s.members,e.members),mappings:Object.freeze({...s.mappings,...e.mappings})})}function Qd(s=[],e=[]){return[...new Set([...s,...e])]}function Wd(s,e){return s&&s.length?e&&e.length?[...s,...e]:s:e}function St(s,e){let t={};for(const n of s)n&&(t=e(t,n));return L(t)}function hn(s){if(s===void 0)throw new Error(`Expect options to be an object or a boolean value: ${s}`);return typeof s=="boolean"&&(s={active:s}),s}function Vd([s,e]=[]){if(s===!1)return{actor:!1};typeof s=="object"&&e===void 0&&(e=s,s=void 0);let t;if(s&&s.indexOf("/")!==-1&&([t,s]=s.split("/")),s&&typeof s!="string"||e!==void 0&&typeof e!="object")throw new Error(`Invalid arguments for useApi(): ${s}, ${e}`);return L({group:t,name:s,payload:e})}function Dc(...s){return s[s.length-1]===!1?!1:St(s,(e,t)=>Object.assign(e,{...t,payload:ln(e.payload,t.payload)}))}function Kd(s={}){if(s===!1)return!1;const{results:e,...t}=s;e!==void 0&&(console.warn(`useLayouts({ results: ... }) is deprecated, use useLayouts({ ${d.PRODUCTS}: ... }) instead`),s={...t,[d.PRODUCTS]:e});const n={};for(const[i,r]of Object.entries(s))n[Yd(i)]=Fc(r);return n}function Yd(s){return s=e_(s),s=t_(s),s}function Fc(s){if(s===void 0)return;let[e,t]=Et(s);return typeof e=="object"&&(t=e,e=void 0),[e,t]}function Zd(...s){return s[s.length-1]===!1?!1:St(s,(e,t)=>{for(const[n,i]of Object.entries(t))e[n]=Jd(e[n],i);return e})}function Jd(s,e){return e=Fc(e),e[0]===!1?e:s&&e?[e[0]||s[0],Xd(s[1],e[1])]:e||s}function Xd(s,e){return{...s,...e,link:{...s&&s.link,...e&&e.link},templates:{...s&&s.templates,...e&&e.templates}}}function ep(s){s=Et(s);for(const e of s)if(typeof e!="function")throw new Error(`Expect data processor options to be a function: ${e}`);return s}function tp(...s){return s.flat().filter(Boolean)}const Ae=Object.freeze({active:!0,impression:Object.freeze({active:!0}),viewable:Object.freeze({active:!0,area:.5,duration:1e3}),click:Object.freeze({active:!0,lenient:!1})});function sp(s={}){s=hn(s);const{active:e,...t}=s,n={};for(const[i,r]of Object.entries(t))n[i]=np(r);return{active:e,...n}}function np(s={}){s=hn(s);const{active:e,...t}=s;for(const[n,i]of Object.entries(t))ip(i);return s}function ip(s={}){return s=hn(s),s}function rp(...s){return s[s.length-1]===!1?!1:St(s,(e,t)=>{for(const[n,i]of Object.entries(t))i!==void 0&&(e[n]=n==="active"?i:op(e[n],i));return e})}function op(s={},e={}){const t={...s};for(const[n,i]of Object.entries(e))i!==void 0&&(t[n]=Nc.includes(n)?cp(s[n],i):i);return t}function cp(s={},e={}){return{...s,...e}}function up(s){if(s===void 0)return;if(s===!1)return{handle:()=>{}};const e=Et(s.preprocess);for(const t of e)if(typeof t!="function")throw new Error(`Expect preprocess options to be a function: ${t}`);if(s.handle&&typeof s.handle!="function")throw new Error(`Expect handle options to be a function: ${s.handle}`);return{...s,preprocess:e}}function lp(...s){return s[s.length-1]===!1?!1:St(s,(e,t)=>Object.assign(e,{...t,preprocess:Wd(e.preprocess,t.preprocess)}))}const ap=hn;function fp(...s){return s[s.length-1]===!1?!1:St(s,(e,t)=>Object.assign(e,t))}function hp(s){if(s===void 0)throw new Error(`Expect pagination options to be an object or a boolean value: ${s}`);return typeof s=="boolean"&&(s={active:s}),s}function _p(...s){return s[s.length-1]===!1?!1:St(s,(e,t)=>Object.assign(e,t))}function dp(s={}){const e={};for(const[t,n]of Object.entries(s))e[t]=Mc(n);return e}function Mc(s){return s===void 0?void 0:typeof s!="function"?()=>s:s}function pp(...s){return St(s,(e,t)=>{for(const[n,i]of Object.entries(t))e[n]=mp(e[n],i);return e})}function mp(s,e){return Mc(e)||s}const gp=[{key:ee.API,normalize:Vd,merge:Dc},{key:ee.LAYOUTS,normalize:Kd,merge:Zd},{key:ee.DATA_PROCESSOR,normalize:ep,merge:tp},{key:ee.TRACKERS,normalize:sp,merge:rp},{key:ee.INTERACTIONS,normalize:up,merge:lp},{key:ee.FILTERS,normalize:ap,merge:fp},{key:ee.PAGINATION,normalize:hp,merge:_p},{key:ee.TEMPLATES,normalize:dp,merge:pp}];class jc{constructor(){this._events=new Ft({target:this}),this._globals={}}_notify(e){this._events.emit(e),this._events.emit("_update",e)}}class qc{constructor(e={},t={}){this._events=new Ft({target:this}),this._defaults=t,this._context=e||{},this._locals={},G(this,{resolved:new Bc(this),defaults:t}),e&&e.on&&(this._unsubscribes=[e.on("_update",n=>this._notify(n))])}_notify(e){this.resolved._invalidate(e),this._events.emit(e)}_destroy(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[]}}class Bc{constructor(e){this._options=e,this._cache={}}_invalidate(e){this._cache[e]=void 0}_get({key:e,merge:t}){if(this._cache[e]===void 0){const n=this._options,i=n._context[e];this._cache[e]=t(n._defaults[e],i&&i.get(),n._locals[e])}return this._cache[e]}}class zc{constructor(e,t,n,i,r){this._options=e,this._store=t,this._key=n,this._normalize=o=>o!==void 0?i(o):void 0,this._merge=r}get(){return this._store[this._key]}set(e){this._set(this._normalize(e))}merge(e){this._set(this._merge(this.get(),this._normalize(e)))}_set(e){this._store[this._key]=e,this._options._notify(this._key)}}for(const s of gp){const{key:e,normalize:t,merge:n}=s;Object.defineProperty(jc.prototype,e,{get:function(){const i=`_${e}`;return this[i]||(this[i]=new zc(this,this._globals,e,t,n))}}),Object.defineProperty(qc.prototype,e,{get:function(){const i=`_${e}`;return this[i]||(this[i]=new zc(this,this._locals,e,t,n))}}),Object.defineProperty(Bc.prototype,e,{get:function(){return this._get(s)}})}const bp=[ee.API,ee.LAYOUTS,ee.DATA_PROCESSOR,ee.TRACKERS,ee.INTERACTIONS];function ws(s,e=bp){for(const t of e)wp(s,t)}function wp(s,e){if(e==="api")Object.assign(s,{useApi(...t){return this._options.api.merge(t),this},clearApi(){return this._options.api.set(),this}});else{const t=yp(e);Object.assign(s,{[`use${t}`](n){return this._options[e].merge(n),this},[`clear${t}`](){return this._options[e].set(),this}})}}function yp(s){return s.charAt(0).toUpperCase()+s.slice(1)}const Hc="q",Ep="qs";function Tp({setValue:s=!0,focus:e=!0,updateUrl:t=!0,param:n=Hc,sourceParam:i=Ep,...r}={}){return{setValue:s,focus:e,updateUrl:t,param:n,sourceParam:i,...r}}function Gc(s={}){const{setValue:e,focus:t,param:n,sourceParam:i}=this._autoQuery=Tp(s),r=new URLSearchParams(window.location.search),o=r.get(n),c=r.get(i)||void 0,{layout:u}=this._views.get(d.QUERY);u&&(o&&e&&(u.value=o),!o&&t&&u.focus()),o&&this.query(L({q:o,qs:c}))}function Qc({value:s,request:e}){if(!this._autoQuery||!this._autoQuery.updateUrl)return;const{param:t,sourceParam:n}=this._autoQuery,i=s&&(s.question||s.keyword)||e&&e.payload&&(e.payload.question||e.payload.q),r=e&&e.payload&&e.payload.metadata&&e.payload.metadata.question_source;if(!i)return;const o=new URL(window.location),c=o.searchParams.get(t),u=o.searchParams.get(n)||Tt.ORGANIC;i===c&&r===u||(o.searchParams.set(t,i),r===Tt.ORGANIC?o.searchParams.delete(n):o.searchParams.set(n,r),window.history.replaceState({},"",o))}class Pi extends pe{constructor(e,t,n){super(e,t),this._name=e,this._plugin=t,this._client=n,this._options=new jc}}ws(Pi.prototype);function _n(){return"session"}function Ni(){return"completions"}function jt(){return"filters"}function at(){return"query"}function Li(){return"request"}function Wc(){return"response"}function re(){return"data"}function et(s){return s?`view:${s}`:"view"}function Ui(){return"tracker"}function Vc(){return"interaction"}function Kc(){return"feedback"}function Yc(){return"input"}function Di(){return"more"}class Sp{constructor(e={}){(this._events=new Ft)._injectSubscribeInterface(this),this._options=e,this._states={},G(this,{states:new Proxy(this._states,{set(){}})})}update(e,t,n={}){this._states[e]=Object.freeze(t);const i=Object.freeze({action:"update",name:e,state:t,...n});typeof this._options.onUpdate=="function"&&this._options.onUpdate(i),n.silent||this._events.emit(e,t),typeof this._options.onEmit=="function"&&this._options.onEmit(i)}trigger(e,t){const n=Object.freeze({action:"trigger",name:e,state:t});typeof this._options.onUpdate=="function"&&this._options.onUpdate(n),this._events.emit(e,t),typeof this._options.onEmit=="function"&&this._options.onEmit(n)}}class Op{constructor(e){this._hub=e,this._sessionIndex=0}restart(){const e=Object.freeze({uuid:ds(),index:this._sessionIndex++,meta:{}});this._hub.update(_n(),e)}}function Zc(s,e){if(!e)return!1;const{session:t}=s.states;return t&&t.index===e.index}class Ap{constructor(e,{source:t,options:n,polling:i=!0}){this._hub=e,this._source=t,this._options=n,this._polling=i,this._unsubscribes=[e.on(_n(),r=>this._handleSession(r)),e.on(Li(),r=>this._handleRequest(r))]}get active(){return this._options.resolved.api.actor!==!1}get source(){return this._source}_handleSession(e){(!this._session||e.index!==this._session.index)&&(this._ac&&this._ac.abort({type:"new-session",message:"A new session is created, discarding the old one."}),this._ac=new AbortController),this._session=e}async _handleRequest(e){if(!this.active)return;const{session:t,...n}=e;try{const{signal:i}=this._ac||{},r={...e.options,signal:i},o=await this._source({session:t,...n,options:r});if(o&&o[Symbol.asyncIterator]){if(o._response&&this._emitResponseWithSessionCheck({session:t,request:n,value:o._response}),this._polling){let c;for await(c of o){if(!Zc(this._hub,t))break;this._emitResponse({session:t,request:n,value:c})}}}else this._emitResponseWithSessionCheck({session:t,request:n,value:o})}catch(i){this._error(i),this._emitResponseWithSessionCheck({session:t,request:n,error:i})}}_emitResponseWithSessionCheck(e){Zc(this._hub,e.session)&&this._emitResponse(e)}_emitResponse(e){this._hub.update(Wc(),e)}_error(e){console.error(e)}_destroy(){this._ac&&this._ac.abort({type:"data-actor-destroy",message:"Data actor is destroyed."});for(const e of this._unsubscribes)e();this._unsubscribes=[]}}class vp{constructor(e){this._get=typeof e=="function"?e:()=>e,this._handlers=[],this._elementUpdatedHandlers=[],this.sync()}get current(){return this._element}on(e,t){if(e==="element")return this._onElementUpdated(t);const n=this._get();return n&&n.addEventListener(e,t),this._handlers.push({event:e,handler:t}),()=>this._off(e,t)}_off(e,t){const n=this._get();n&&n.removeEventListener(e,t),Yh(this._handlers,i=>i.handler===t)}_onElementUpdated(e){return this._elementUpdatedHandlers.push(e),()=>{Ei(this._elementUpdatedHandlers,e)}}sync({silent:e=!1}={}){const t=this._get();if(this._element===t)return;if(this._offAllFromCurrentElement(),t)for(const{event:i,handler:r}of this._handlers)t.addEventListener(i,r);const n=this._element;if(this._element=t,!e)for(const i of this._elementUpdatedHandlers)try{i(t,n)}catch(r){console.error(r)}}_offAllFromCurrentElement(){if(this._element)for(const{event:e,handler:t}of this._handlers)this._element.removeEventListener(e,t)}destroy(){this._offAllFromCurrentElement()}}const{IMPRESSION:Ip,VIEWABLE:Cp,CLICK:xp}=fe,{UNTRACKED:dn,TRIGGERED:Rp}=gs,Jc=Object.freeze({[Ip]:dn,[Cp]:dn,[xp]:dn});class Xc{constructor(e){this.sessionId=e,this._states=new Map}getFullState(e){const t=this._states.get(this._getKey(e));return t?{...t}:Jc}get(e,t){const n=this._states.get(this._getKey(e));return n&&n[t]||dn}set(e,t,n){Uc(t),Gd(n);for(const i of Et(e))this._setOne(i,t,n)}untriggered(e,t){return e.filter(n=>this.get(n,t)!==Rp)}_getKey(e){return e.product_id||e.text||e.id||e}_setOne(e,t,n){Zh(this._states,this._getKey(e),()=>({...Jc}))[t]=n}}const $p=[Symbol("itemless")];class Fi{constructor({hub:e,role:t,options:n}){this._hub=e,this._role=t,this._options=n,this._states=new Xc(this._getSessionId())}get options(){return typeof this._options=="function"?this._options():this._options}getState(e){return this._states.getFullState(e)}_trigger(e,t,n){Uc(e);const{options:i}=this;if(!i||i.active===!1)return;this._syncSession();const{deduplicated:r=!0,itemless:o=!1}=i;if(r){if(o&&(t=$p),t=this._states.untriggered(Et(t),e),t.length===0)return;this._states.set(t,e,gs.TRIGGERED)}this._sendToHub({type:e,items:o?void 0:t,...n})}submit({value:e}){this._syncSession(),this._sendToHub({type:fe.SUBMIT,value:e})}_sendToHub(e){this._hub.trigger(Ui(),Object.freeze(L({role:this._role,...e})))}_syncSession(){const e=this._getSessionId();e&&(!this._states||e!==this._states.sessionId)&&(this._states=new Xc(e))}_getSessionId(){const{session:e}=this._getViewState()||{};return e&&e.uuid}_getMisoId(){const e=this._getViewState();return e&&e.meta&&e.meta.miso_id||void 0}_getRequestPayload(){const{request:e}=this._getViewState()||{};return e&&e.payload}_getViewState(){return this._hub.states[et(this._role)]}}for(const s of Lc)Fi.prototype[s]=function(e,t){this._trigger(s,e,t)};function kp(s,e){return s===e||s&&e&&s.status===e.status&&s.error===e.error&&s.value===e.value&&s.ongoing===e.ongoing&&eu(s)===eu(e)&&Pp(s.session,e.session)}function Pp(s,e){return s===e||s&&e&&s.uuid===e.uuid}function eu(s){return s&&s.meta&&s.meta.empty}class tu{constructor(e,t){this._events=new Ft({target:this}),this._views=e,this._mapping=su((e._roles.mappings||{})[t]||t),G(this,{role:t,interface:new Np(this)})}get hub(){return this._views._hub}get element(){return this._element}set element(e){e!==this._element&&(this._element&&this._safeApplyOnLayout("unrender",this._element),this._element=e,this._proxyElement&&this._proxyElement.sync(),this._events.emit("element",e),this.refresh({force:!0}))}get proxyElement(){return this._proxyElement||(this._proxyElement=new vp(()=>this.element)),this._proxyElement}get layout(){return this._layout}set layout(e){if(e===this._layout)return;if(e&&typeof e.render!="function")throw new Error("Render function is mandatory in a layout.");const{element:t}=this;t&&this._safeApplyOnLayout("unrender",t),this._safeApplyOnLayout("destroy"),this._layout=e,e&&(e._view=this,typeof e.initialize=="function"&&e.initialize(this)),this.refresh({force:!0})}get tracker(){const{role:e}=this;if(e===d.CONTAINER)return this._views._getContainerTracker();if(!this._tracker){const{hub:t}=this;this._tracker=new Fi({hub:t,role:e,options:()=>this.trackerOptions})}return this._tracker}get workflow(){return this._views._workflow}get workflowOptions(){return this._views._options.resolved}get trackerOptions(){return this._views._getTrackerOptions(this.role)}get filters(){return this._views.filters}async refresh({force:e=!1,data:t}={}){if(!this._layout)return;const{element:n}=this;if(!n)return;const i=this._data;if(this._data=t=this._sliceData(t||this._views._getData()),!e&&kp(t,i))return;const{session:r,status:o,ongoing:c,request:u,meta:h,value:a}=t,_={session:r,status:o,ongoing:c,request:u,meta:h,data:a,...Lp(this.role,t)},m=(T={},$)=>{T!==!1&&this.updateState({..._,...T},$)};try{await this._layout.render(n,t,{notifyUpdate:m})}catch(T){this._error(T),m({error:T})}}updateState(e,{silent:t=!1}={}){const n=e.error?C.ERRONEOUS:e.status;e=this._state=Object.freeze(L({...e,status:n}));const{role:i}=this;this.hub.update(et(i),e,{silent:t})}_sliceData(e){const{value:t,error:n,status:i,meta:r,...o}=e,c={value:this._mapping(e,this),status:i,data:t,meta:r,...o};return this.role===d.CONTAINER&&(c.meta={...r,empty:this._isContainerEmpty(e)}),L(c)}_isContainerEmpty(e){const{element:t}=this;if(!t)return!1;for(const{role:n}of t.components){if(!jd(n))continue;const r=su((this._views._roles.mappings||{})[n]||n)(e,this);if(!nu(n,r))return!1}return!0}_syncSize(){this._element&&this._safeApplyOnLayout("syncSize",this._element)}_safeApplyOnLayout(e,...t){if(!(!this._layout||typeof this._layout[e]!="function"))try{this._layout[e](...t)}catch(n){this._error(n)}}_error(e){this._views._error(e)}_destroy(){this._safeApplyOnLayout("destroy"),this._proxyElement&&this._proxyElement.destroy()}}class Np{constructor(e){ct(this,e,["role","layout","element","proxyElement","refresh","on","tracker"])}}function su(s){switch(typeof s){case"function":return s;case"string":return e=>e.value&&e.value[s];default:throw new Error(`Invalid mapping function: ${s}`)}}function Lp(s,e){return Up(e)?{empty:!!nu(s,e&&e.value)}:{}}function Up(s){return s.status===C.READY&&!s.ongoing}function nu(s,e){switch(s){case d.ANSWER:case d.REASONING:return!e||!e.value;default:return e===void 0||(Array.isArray(e)||typeof e=="string")&&!e.length}}function Dp(s={},e={}){return Object.freeze(L({...s,...e,facets:Object.freeze(L({...s.facets,...e.facets}))}))}function Fp({sort:s}={}){return L({facets:Object.freeze({}),sort:Mp(s)})}function Mp(s){if(!s)return;const{options:e=[]}=s;for(const t of e)if(t.default)return Object.freeze(t);return Object.freeze(e[0])}class jp{constructor(e,{facets:t}={}){this._views=e,this._hub=e._hub;const n=this._error=this._error.bind(this);this._events=new Ft({target:this,error:n}),G(this,{facets:new qp(this,t)}),this._unsubscribes=[e._options.on("filters",()=>this._syncOptions())],this._syncOptions(),this._states=void 0}_syncOptions(){const e=this._views._options.resolved.filters;this._initialStates=Fp(e),this.apply({silent:!0})}_getStates(){return this._states||this._initialStates}update(e){const t=this._getStates();this._states=Dp({...t,...e});const n=this._getStates();this._events.emit("update",{updates:e,states:n,oldStates:t})}reset({silent:e=!1}={}){const t=this._states;this._states=void 0;const n=this._getStates();this._hub.update(jt(),n,{silent:e}),this._events.emit("reset",{states:n,oldStates:t})}apply({silent:e=!1}={}){const t=this._getStates();this._hub.update(jt(),t,{silent:e}),!e&&this._events.emit("apply")}_error(e){this._views._error(e)}_destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[]}}class qp{constructor(e,t={}){this._filters=e,this._options=t}isSelected(e,t){return this._getFieldValues(e).includes(t)}select(e,t){this.isSelected(e,t)||this._select(e,t)}unselect(e,t){this.isSelected(e,t)&&this._unselect(e,t)}toggle(e,t){this.isSelected(e,t)?this._unselect(e,t):this._select(e,t)}_getFieldValues(e){return this._filters._getStates().facets[e]||[]}_select(e,t){const n=this._options.multivalued?[...this._getFieldValues(e),t]:[t];n.sort(),this._filters.update({facets:{[e]:n}})}_unselect(e,t){let n=this._getFieldValues(e).filter(i=>i!==t);n.length===0&&(n=void 0),this._filters.update({facets:{[e]:n}})}}const iu=Symbol.for("miso:tracked");function Mi(s){return!!s[iu]}function ji(s){s[iu]=!0}const pn=Object.freeze({impression:Object.freeze({}),viewable:Object.freeze({area:.5,duration:1e3}),click:Object.freeze({lenient:!1})});function qi(s,e){return!!e&&{...s,...e}}function Bp(s){if(s===!1)return!1;if(s===!0&&(s={}),typeof s!="object")throw new Error(`Invalid options: ${s}`);const{impression:e={},viewable:t={},click:n={},...i}=s;return L({...pn,...i,impression:qi(pn.impression,e),viewable:qi(pn.viewable,t),click:qi(pn.click,n)})}function zp(s={},e){return s?typeof s.validate=="function"?s.validate(e):s.lenient?!0:!(Mi(e)||e.button!==0||e.defaultPrevented||!Ti(e.target,t=>t.tagName==="A"&&t.href||void 0)):!1}class Hp{constructor(e,{workflow:t,extensions:n,layouts:i,roles:r,options:o}){this._hub=e,this._workflow=t,this._workflowName=t._name,this._extensions=n,this._layoutFactory=i,this._options=o,this._roles=r,this._containers=new Map,this._containerTracker=void 0,this._views={},this._filters=new jp(this);for(const u of r.members)u!==d.CONTAINER&&(this._views[u]=new tu(this,u));G(this,{interface:new Gp(this),trackers:new Qp(this,r.members)});const c=()=>this.syncSize();window.addEventListener("resize",c),this._unsubscribes=[()=>window.removeEventListener("resize",c),e.on(re(),u=>this.refresh({data:u})),o.on("layouts",()=>this._syncLayouts())],this._syncLayouts()}get filters(){return this._filters}addContainer(e){if(this._containers.has(e))return;const t=new tu(this,d.CONTAINER);t.layout=this._createLayout(d.CONTAINER),t.element=e,this._containers.set(e,t);const{components:n}=e;for(const i of n)this.addComponent(i)}removeContainer(e){const t=this._containers.get(e);if(!t)return;const{components:n}=e;for(const i of n)this.removeComponent(i);t._destroy(),this._containers.delete(e)}addComponent(e){this._getViewByElement(e).element=e}removeComponent(e){this._getViewByElement(e).element=void 0}updateComponentRole(e,t,n){}containsElement(e){return this._containers.has(e)||this._views[e.role]}refreshElement(e){const t=e.isContainer?this._containers.get(e):this._getViewByElement(e);t&&t.refresh({force:!0})}_getViewByElement(e){let{role:t}=e;if(!t)throw new Error("Component must have a role");return this.get(t)}_syncLayouts(){const{layouts:e}=this._options.resolved;if(e===!1){for(const t of this._containers.values())t.layout=void 0;for(const t of Object.values(this._views))t.layout=void 0}else for(let[t,[n,i]]of Object.entries(e)){const r=()=>this._layoutFactory.create(n,{...i,role:t,workflow:this._workflowName});if(t===d.CONTAINER)for(const o of this._containers.values())o.layout=r();else{const o=this.get(t);o&&(o.layout=r())}}}_createLayout(e){const t=this._options.resolved.layouts[e];if(!t)return;const[n,i]=t;return this._layoutFactory.create(n,{...i,role:e,workflow:this._workflowName})}get(e){return this._views[e]}get views(){return this._getViews(!0)}_getViews(e=!0){return e?[...this._containers.values(),...Object.values(this._views)]:[...Object.values(this._views),...this._containers.values()]}syncSize(){for(const e of Object.values(this._views))e._syncSize()}async refresh({force:e,data:t}={}){t=this._getData(t);let n=this._getViews(!0);await Promise.all(n.map(i=>i.refresh({force:e,data:t})))}_getData(e){return e||this._hub.states[re()]}_getTrackerOptions(e){const t=this._options.resolved.trackers;return Bp(t&&t[e]||!1)}_getContainerTracker(){if(!this._containerTracker){const e=this._hub,t=d.CONTAINER;this._containerTracker=new Fi({hub:e,role:t,itemless:!0,options:()=>this._getTrackerOptions(t)})}return this._containerTracker}_error(e){console.error(e)}_destroy({dom:e}={}){for(const t of this._getViews(!1))t._destroy();for(const t of this._unsubscribes)t();this._unsubscribes=[],this._filters._destroy()}}class Gp{constructor(e){this._actor=e,ct(this,e,["syncSize","refresh","trackers","filters"])}get(e){return this._actor.get(e).interface}get all(){return this._actor.views.map(e=>e.interface)}}class Qp{constructor(e,t){this._views=e;for(const n of t)n!==d.CONTAINER&&Object.defineProperty(this,n,{get:()=>e.get(n).tracker});Object.defineProperty(this,d.CONTAINER,{get:()=>e._getContainerTracker()})}}class Wp{constructor(e){this._hub=e,this._unsubscribes=[e.on(Kc(),t=>this._trigger(t))]}_trigger(e){this._hub.trigger(Ui(),{type:fe.FEEDBACK,result_type:"answer",value:e.unselected?"unselected":e.value})}_destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[]}}class Vp{constructor(e,{client:t,options:n}){this._client=t,this._options=n,this._unsubscribes=[e.on(Vc(),i=>this._handle(i))]}_handle(e){e=Et(e),e.length!==0&&this._client.api.interactions.upload(e,{merge:!0})}destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[]}}function ru(s){return async({group:e,name:t,payload:n,options:i})=>{if(e===te.ASK)switch(t){case Se.QUESTIONS:return s.api.ask.questions(n,i);case Se.SEARCH:return s.api.ask.search(n,i)}return s.api[e]._run(t,n,i)}}class Bi{constructor({role:e,workflow:t,...n}={}){G(this,{role:e,workflow:t,options:n}),this._unsubscribes=[],this._rendered=new WeakMap,this._element=void 0,this._notifyUpdate=void 0,this._pending=void 0}async render(e,t,n={}){this._syncElement(e);const i=this._rendered.get(e),r=cn(!1);t=this._preprocess({state:t,rendered:i},{skip:r.t})||t,this._updatePending(t,n),r.value||this._handleInput({state:t,rendered:i},n)}_syncElement(e){this._element!==e&&this._rendered.delete(this._element),this._element=e}_preprocess({state:e}){return e}_updatePending(e,t){this._pending=[Object.freeze(e),t]}_takePending(){const e=this._pending;return this._pending=void 0,e}_handleInput(){this._requestRaf()}_requestRaf(){this._requested||(this._requested=!0,rn(e=>this._doRaf(e)))}_doRaf(e){this._requested&&(this._requested=!1,this._applyRender(e))}_applyRender(e,t={}){if(!this._pending)return;let[n,{notifyUpdate:i}]=this._takePending();n=Object.freeze({...n,timestamp:e});const r=this._rendered.get(this._element),o=cn([]),c=cn({});this._render(this._element,{state:n,rendered:r,timestamp:e},{notifyUpdate:o.args,writeToState:c.merge,...t}),n=Object.freeze({...n,...c.value}),this._rendered.set(this._element,n),i&&i(...o.value),this._afterRender(this._element,n)}_render(){throw new Error("Unimplemented")}_afterRender(){}destroy(){for(const e of this._unsubscribes)e();this._unsubscribes=[],this._view=void 0,this._element=void 0,this._notifyUpdate=void 0,this._pending=void 0}}function ou(...s){return s.reduce((e,t)=>(e[t]=Kp(t),e),{})}function Kp(s){return()=>{throw new Error(`Template '${s}' is not implemented.`)}}function Yp(s,e,t,n){const{templates:i}=s,[r,o]=ft(s,t);return[r,(i.imageBlock||Bt)(s,t,n),(i.infoBlock||i.productInfoBlock||zi)(s,t,n),o].join("")}function Zp(s,e,t){const[n,i]=ft(s,t);return`${n}${t.value||t.text||t}${i}`}function Jp(s,e,t,n){const{templates:i}=s,[r,o]=ft(s,t);return[r,(i.imageBlock||Bt)(s,t,n),(i.infoBlock||i.articleInfoBlock||uu)(s,t,n),(i.indexBlock||Wi)(s,t,n),o].join("")}function cu(s,e,t,n){const{templates:i}=s,[r,o]=ft(s,t);return[r,(i.indexBlock||Wi)(s,t,n),(i.infoBlock||i.articleInfoBlock||Hi)(s,t,n),o].join("")}function Xp(s,e,t,n){const{templates:i}=s,[r,o]=ft(s,t);return[r,(i.imageBlock||Bt)(s,t,n),(i.infoBlock||i.imageInfoBlock||lu)(s,t,n),o].join("")}function em(s,e,t,n){const{templates:i}=s,[r,o]=ft(s,t,{link:!1});return[r,(i.infoBlock||i.affiliationInfoBlock||tm)(s,t,n),(i.imageBlock||Bt)(s,t,{brand:!0,...n}),o].join("")}function tm(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__item-info-container">${[(i.titleBlock||qt)(s,e,t),(i.descriptionBlock||mn)(s,e,t),(i.priceBlock||Qi)(s,e,t),(i.ctaBlock||Vi)(s,e,t)].join("")}</div>`}function zi(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__item-info-container">${[(i.titleBlock||qt)(s,e,t),(i.descriptionBlock||mn)(s,e,t),(i.priceBlock||Qi)(s,e,t)].join("")}</div>`}function uu(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__item-info-container">${[(i.titleBlock||qt)(s,e,t),(i.dateBlock||Gi)(s,e,t),(i.descriptionBlock||mn)(s,e,t),(i.ctaBlock||Vi)(s,e,t)].join("")}</div>`}function Hi(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__item-info-container">${[(i.titleBlock||qt)(s,e,t),(i.authorsAndDateBlock||hu)(s,e,t)].join("")}</div>`}function lu(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__item-info-container">${[(i.titleBlock||qt)(s,e,t)].join("")}</div>`}function qt({className:s},{title:e,_title_with_markups:t}){const n=Ki(t)||xe(e);return n?`<div class="${s}__item-title">${n}</div>`:""}function au({className:s},{brand:e,brand_logo:t}){if(!e&&!t)return"";const n=t?`<img class="${s}__item-brand-logo" src="${t}"${e?` alt="${e}"`:""}>`:`<div class="${s}__item-brand">${e}</div>`;return`<div class="${s}__item-brand-container">${n}</div>`}function mn({className:s},{snippet:e,description:t}){return e?`<div class="${s}__item-snippet">${Ki(e)}</div>`:t?`<div class="${s}__item-desc">${xe(t)}</div>`:""}function Gi({className:s,templates:e},{created_at:t,updated_at:n,published_at:i}){const r=i||t||n;return r?`<div class="${s}__item-date">${mu(r,e.date)}</div>`:""}function fu({className:s},{authors:e}){return e&&Array.isArray(e)&&e.length?`<div class="${s}__item-authors">${e.join(", ")}</div>`:""}function hu(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__item-authors-and-date-container">${[(i.authorsBlock||fu)(s,e,t),(i.dateBlock||Gi)(s,e,t)].join("")}</div>`}function Qi(s,e){const{className:t,templates:n}=s,{sale_price:i,original_price:r,currency:o="USD"}=e,c=i||r;if(!c)return"";const u=r!==void 0&&i!==void 0&&i<r,h=e.discount_rate_percent||(u?Math.floor((1-i/r)*100):void 0);let a="";if(u&&(a+=`<span class="${t}__item-original-price miso-price" data-currency="${o}">${r}</span><br>`),a+=`<span class="${t}__item-price miso-price" data-currency="${o}">${c}</span>`,h){const _=(n.discountRateText||_u)(s,{...e,discount_rate_percent:h});a+=` <span class="${t}__item-discount-rate">${_}</span>`}return`<div class="${t}__item-price-container">${a}</div>`}function _u(s,{discount_rate_percent:e}){return`(${e}% off)`}function Bt(s,e,t={}){const{className:n,templates:i}=s,{cover_image:r,image_src:o,image_alt:c}=e;if(!r&&!o)return"";const u=o?"image":"cover-image",h=u==="image"?`<img class="${n}__item-${u}" src="${o}"${c?` alt="${c}"`:""}>`:`<img class="${n}__item-${u}" src="${r}">`,a=u==="cover-image"&&t.brand?(i.brandBlock||au)(s,e,t):"";return`<div class="${n}__item-${u}-container">${h}${a}</div>`}function Wi({className:s},e,{index:t}){return`<div class="${s}__item-index-container"><span class="${s}__item-index miso-citation-index" data-index="${t+1}"></span></div>`}function Vi(s,e,t){const{className:n,templates:i}=s,r=tt.asFunction(i.cta)(s,e,t);return r?`<div class="${n}__item-cta-container">${r}</div>`:""}function sm(s,e,t){const{templates:n}=s,{url:i}=e;if(!i)return"";const[r,o]=ft(s,{url:i},{classSuffix:"item-cta",role:"cta"}),c=tt.asFunction(n.ctaText)(s,e,t);return c?`${r}${c}${o}`:""}function ft({className:s,options:e={}},{product_id:t,url:n},{classSuffix:i="item-body",role:r="item",...o}={}){const c=o.link!==!1&&n?"a":"div",u=o.link!==!1&&n?`href="${n}" ${nm(e.link)}`:"",h=t?`${Fd}="${t}"`:"",a=r?`data-role="${r}"`:"";return[`<${c} class="${s}__${i}" ${a} ${h} ${u}>`,`</${c}>`]}function nm(s={}){const{target:e="_blank",rel:t="noopener",open:n=!0}=s;let i="";return n&&(e&&(i+=` target="${e}"`),t&&(i+=` rel="${t}"`)),i}const du=Object.freeze({locale:"en-US",year:"numeric",month:"short",day:"numeric"}),pu="en-US";function mu(s,e=du){switch(typeof e){case"function":return e(s);case"string":return new Date(s).toLocaleDateString(e);case"object":return new Date(s).toLocaleDateString(e.locale||du.locale,e);default:throw new Error(`Invalid date format: ${e}`)}}function im(s,e=pu){switch(typeof e){case"function":return e(s);case"string":return new Intl.NumberFormat(e).format(s);case"object":return new Intl.NumberFormat(e.locale||pu.locale,e).format(s);default:throw new Error(`Invalid number format: ${e}`)}}function Ki(s){return s&&s.replace(/<\/mark>\s+<mark>/g,"</mark>&nbsp;<mark>")}function rm(s=""){return typeof s=="function"?s:()=>s}const tt=Object.freeze({tagPair:ft,formatDate:mu,formatNumber:im,formatHtmlWithMarkup:Ki,escapeHtml:xe,asFunction:rm});class Re extends Bi{constructor({className:e,templates:t,...n}={}){super(n),G(this,{className:e,templates:{...ou("root"),...t,helpers:tt}})}_preprocess({state:e}){const t=this.templates.root(this,e);return{...e,html:t}}_render(e,{state:t}){e.innerHTML=t.html}}const om="miso-banner";class gn extends HTMLElement{static get tagName(){return om}async connectedCallback(){gn.MisoClient.ui.layouts.create("banner").render(this)}}class gu{constructor(){this._entries=new WeakMap}isTracked(e){return this._entries.has(e)}async track(e,t={}){if(!t||this._entries.get(e))return!1;const i=new AbortController,{signal:r}=i;this._entries.set(e,{ac:i});let o=!1;try{await Si(e,{...t,signal:r}),o=!0}catch(c){if(c.name!=="AbortError")throw c}finally{this._entries.delete(e)}return o}untrack(e){const t=this._entries.get(e);t&&(t.ac.abort(),this._entries.delete(e))}}const cm="container";class bu extends Bi{static get type(){return cm}constructor({logo:e="auto",...t}={}){super({logo:e,...t}),this._impression=!1,this._viewables=new gu}_syncElement(e){this._element!==e&&this._viewables.untrack(this._element),super._syncElement(e)}_render(e,t){this._syncBanner(e),this._syncStatus(e,t),this._trackInteractions(e,t)}_afterRender(e,t){this._trackInteractions(e,t)}_syncBanner(e){const t=gn.tagName,n=this._shallRenderBanner(e),i=e.querySelector(t);n&&!i?e.insertAdjacentHTML("beforeend",`<${t} visible-when="ready"></${t}>`):!n&&i&&i.remove()}_shallRenderBanner(e){const{logo:t}=this.options,{logo:n}=e,i=n!==void 0&&n!=="auto"?n:t;return i==="auto"?e.components.some(({role:r})=>um(r)):!!i}_syncStatus(e,{state:t}){if(!e)return;const{status:n,ongoing:i,meta:{miso_id:r,empty:o=!1,unanswerable:c=!1}={}}=t,u=[n,o?C.EMPTY:C.NONEMPTY];n===C.READY&&u.push(i?C.ONGOING:C.DONE),c&&u.push(C.UNANSWERABLE),e.setAttribute("status",u.join(" ")),r?e.setAttribute("miso-id",r):e.removeAttribute("miso-id")}_trackInteractions(e,t){const{status:n}=t;n===C.READY&&(this._trackImpression(),this._trackViewable(e))}_trackImpression(){const{impression:e}=this._view.tracker.options||{};e&&(this._impression||(this._impression=!0,this._view.tracker.impression()))}async _trackViewable(e){const{viewable:t}=this._view.tracker.options||{};t&&await this._viewables.track(e,t)&&this._view.tracker.viewable()}}function um(s){return s===d.PRODUCTS||s===d.ANSWER}const lm="error",am="miso-error";function fm(s,e){const{className:t,templates:n}=s,{status:i,value:r}=e;return i!=="erroneous"?"":`<div class="${t}"><div class="${t}__message">${n.message(s,r)}</div></div>`}function hm(s,e){return`Error: ${e.message||e}`}const wu=Object.freeze({root:fm,message:hm});class yu extends Re{static get type(){return lm}static get defaultTemplates(){return wu}constructor({className:e=am,templates:t,...n}={}){super({className:e,templates:{...wu,...t},...n})}}const _m='<svg viewBox="0 0 500 200"><path d="M131.1,39.4 C144.3,39.4 155,43.8 163.2,52.7 C171.3,61.3 175.2,72.9 175.2,87.6 L175.2,159.1 L140.4,159.1 L140.4,90.6 C140.4,78.7 134.6,71.5 123.7,71.5 C112.3,71.5 105.5,79.7 105.5,93.4 L105.5,159.1 L70.7,159.1 L70.7,90.6 C70.7,78.7 64.9,71.5 54,71.5 C42.6,71.5 35.8,79.7 35.8,93.4 L35.8,159.1 L1,159.1 L1,42.7 L35.8,42.7 L35.8,53.4 C42.1,44.1 52.6,39.4 67,39.4 C80.5,39.4 90.7,44.5 97.4,54.8 C104.6,44.5 115.8,39.4 131.1,39.4 Z M202,42.4 L238.4,42.4 L238.4,159.1 L202,159.1 Z M202,0 L238.4,0 L202,36.4 Z M302.6,76.6 C302.6,81.2 311.7,83.8 323,86.8 C339.2,90.3 360.5,98.7 360.3,124 C360.3,136.6 355.6,146.1 346.2,152.6 C336.8,158.9 325.3,162.1 311.5,162.1 C286.9,162.1 270,152.8 261.1,134.5 L291.6,117.3 C294.6,126.3 301.4,131 311.5,131 C319.9,131 324.2,128.7 324.2,123.8 C324.2,119.1 315,116.3 303.8,113.5 C287.6,109.1 266.5,101.2 266.5,77.5 C266.5,65.4 270.9,56.1 279.6,49.4 C288.5,42.6 299.5,39.4 312.4,39.4 C331.9,39.4 348.6,48.2 358.2,64.3 L328.2,80.3 C324.4,73.6 319.2,70.1 312.4,70.1 C305.9,70.1 302.6,72.2 302.6,76.6 Z M480.4,144.5 C468.4,156.3 453.7,162.1 436.3,162.1 C419,162.1 404.2,156.3 392.2,144.5 C380.3,132.6 374.2,118 374.2,100.8 C374.2,83.6 380.3,69.1 392.2,57.3 C404.2,45.4 419,39.4 436.3,39.4 C453.7,39.4 468.4,45.4 480.4,57.3 C492.4,69.1 498.5,83.6 498.5,100.8 C498.5,118 492.4,132.6 480.4,144.5 Z M417.1,120.5 C422.2,125.6 428.6,128.2 436.3,128.2 C444.1,128.2 450.4,125.6 455.5,120.5 C460.7,115.4 463.3,108.9 463.3,100.8 C463.3,92.6 460.7,86.1 455.5,81 C450.4,75.9 444.1,73.3 436.3,73.3 C428.6,73.3 422.2,75.9 417.1,81 C411.9,86.1 409.3,92.6 409.3,100.8 C409.3,108.9 411.9,115.4 417.1,120.5 Z" /></svg>',dm='<svg viewBox="0 0 16 16"><path d="M8.342 3.652 4.979 5.708a1 1 0 0 0-.479.852v5.561a1 1 0 0 0 .87.992l6.029.79a1 1 0 0 0 1.042-.583l2.534-5.65a1 1 0 0 0-.74-1.394l-3.543-.623.9-3.1A2.097 2.097 0 0 0 10.297 0L8.719 3.237a1 1 0 0 1-.377.415ZM1 6.5a1.5 1.5 0 0 1 3 0v6a1.5 1.5 0 0 1-3 0Z"/></svg>',pm="banner",mm="miso-banner";function gm(s){const{className:e,templates:t}=s;return`<div class="${e}"><div class="${e}__logo">${t.logo(s)}</div></div>`}const Eu=Object.freeze({root:gm,logo:()=>_m});class bm extends Re{static get type(){return pm}static get defaultTemplates(){return Eu}constructor({className:e=mm,templates:t,...n}={}){super({className:e,templates:{...Eu,...t},...n})}}function wm(s,e,t){const n=new Map,i=new Map,r=[];for(let o=0;o<s.length;o++){const c=s[o],u=t[o],h=e[o],a=Object.freeze({index:o,key:c,value:h,element:u});n.set(c,a),i.set(u,a),r.push(a)}return{k2b:n,e2b:i,entries:r}}function Tu(s,e){const t=[];for(const n of e.entries){const i=s.e2b.get(n.element);(!i||i.key!==n.key)&&t.push(n)}return t}class Su{constructor(){this._k2b=new Map,this._e2b=new Map,this._entries=[]}get entries(){return[...this._entries]}get(e){return this._e2b.get(e)||void 0}find(e){return this._k2b.get(e)||void 0}update(e,t,n){const i=wm(e,t,n),r={k2b:this._k2b,e2b:this._e2b,entries:this._entries},o=Tu(r,i),c=Tu(i,r);return this._k2b=i.k2b,this._e2b=i.e2b,this._entries=i.entries,{bounds:o,unbounds:c}}clear(){const e=this._entries;return this._k2b=new Map,this._e2b=new Map,this._entries=[],{bounds:[],unbounds:e}}}function Yi(s){ps(s,ym.prototype)}class ym{_initTrackable(){this._bindings=new Su,this._viewables=new gu}_syncBindings(e,t){const n=this._getItems(t)||[],i=n.map(u=>this._getItemKey(u)),r=this._getItemElements(e),{bounds:o,unbounds:c}=this._bindings.update(i,n,r);this._onBindingsUpdate(o,c)}_clearBindings(){const{bounds:e,unbounds:t}=this._bindings.clear();this._onBindingsUpdate(e,t)}_getItemKey(e){return e.product_id||e.text||e.id||e}_getItems(e){throw new Error("Not implemented.")}_getItemElements(e){throw new Error("Not implemented.")}_onBindingsUpdate(e,t){this._trackImpressions(e),this._untrackViewables(t),this._trackViewables(e)}_trackImpressions(e){if(e.length===0)return;const{impression:t}=this._view.tracker.options||{};t&&this._view.tracker.impression(e.map(({value:n})=>n))}_untrackViewables(e){for(const{element:t}of e)this._viewables.untrack(t)}_trackViewables(e){if(e.length===0)return;const{viewable:t}=this._view.tracker.options||{};if(t)for(const{value:n,element:i}of e)(async()=>await this._viewables.track(i,t)&&this._view.tracker.viewable([n]))()}_trackClick(e,t){const{click:n}=this._view.tracker.options||{};zp(n,e)&&(ji(e),this._view.tracker.click([t.value]))}_destroyTrackable(){const{unbounds:e}=this._bindings.clear();this._untrackViewables(e)}}function Em(s){ps(s,Tm.prototype)}class Tm{_initTriggerable(){this._trigger=void 0}_syncTrigger(e,t){if(!this.options.infiniteScroll)return;const n=this._view.workflowOptions.pagination;!n.active||n.mode!=="infiniteScroll"||(t.status===C.READY?this._trackTrigger(e):this._untrackTrigger())}async _trackTrigger(e){if(this._trigger)return;const t=e.querySelector('[data-role="trigger"]');if(!t)return;const n=new AbortController;this._trigger=Object.freeze({element:t,ac:n});let i=!1;try{await Si(t,{area:1,duration:0,signal:n.signal}),i=!0}catch(r){if(r.name!=="AbortError")throw r}finally{this._trigger=void 0}i&&this._onTrigger()}_onTrigger(){this._view.hub.trigger(Di())}_untrackTrigger(){this._trigger&&(this._trigger.ac&&this._trigger.ac.abort(),this._trigger=void 0)}_destroyTriggerable(){this._untrackTrigger()}}function Sm(s,e){const{className:t,role:n,templates:i,options:r}=s,{status:o}=e,c=n?` data-role="${n}"`:"",u=r.itemType?` data-item-type="${r.itemType}"`:"";return`<div class="${t} ${o}"${c}${u}>${o===C.READY?i[o](s,e):""}${i.trigger(s,e)}${i.loading(s,e)}</div>`}function Om(s,e){const{templates:t}=s,n=s._getItems(e)||[];return n.length>0||e.ongoing?t.body(s,e,n):t.empty(s,e)}function Am(s,e,t){return s.templates.list(s,e,t)}function vm(s,e,t){const{className:n,templates:i,options:r}=s,o=i.ordered?"ol":"ul",c=r.itemType?` data-item-type="${r.itemType}"`:"";return`<${o} class="${n}__list" data-role="list"${c}>${i.items(s,e,t)}</${o}>`}function Im(s,e,t,{offset:n=0}={}){const{templates:i}=s;let r=n;return t.map(o=>i.item(s,e,o,r++)).join("")}function Cm(s,e,t,n){const{className:i,templates:r,options:o}=s,{itemType:c}=o,u=r[c](s,e,t,{index:n});return`<li class="${i}__item">${u}</li>`}function xm(s,e){const{className:t}=s;return`<div class="${t}__trigger" data-role="trigger"></div>`}function Rm(){return'<div class="miso-loading" aria-label="Loading" data-role="loading"></div>'}const Ou=Object.freeze({product:Yp,article:Jp,compactArticle:cu,image:Xp,question:Zp,root:Sm,[C.READY]:Om,empty:()=>"",body:Am,list:vm,ordered:!1,items:Im,item:Cm,productInfoBlock:zi,articleInfoBlock:uu,compactArticleInfoBlock:Hi,imageInfoBlock:lu,brandBlock:au,titleBlock:qt,descriptionBlock:mn,dateBlock:Gi,authorsBlock:fu,authorsAndDateBlock:hu,priceBlock:Qi,discountRateText:_u,ctaBlock:Vi,cta:sm,imageBlock:Bt,indexBlock:Wi,trigger:xm,loading:Rm});class ve extends Re{static get defaultTemplates(){return Ou}constructor({templates:e,itemType:t="product",...n}){super({templates:{...Ou,...e},itemType:t,...n}),this._initTrackable(),this._initTriggerable()}initialize(e){this._unsubscribes.push(e.proxyElement.on("click",this._onClick.bind(this)))}_preprocess({state:e,rendered:t}){const n=this._shallRenderIncrementally(e,t),i=this._html(e,t,n);return{...e,incremental:n,html:i}}_shallRenderIncrementally(e,t){return this.options.incremental&&t&&t.value&&t.value.length>0&&e.value&&e.value.length>=t.value.length&&e.session&&t.session&&e.session.id===t.session.id}_html(e,t,n){if(n){const i=t.value.length,r=(this._getItems(e)||[]).slice(i);return r.length>0?this.templates.items(this,e,r,{offset:i}):""}else return this.templates.root(this,e)}_render(e,{state:t},{notifyUpdate:n}){const{incremental:i,html:r}=t;i?r?this._getListElement(e).insertAdjacentHTML("beforeend",r):n(!1):e.innerHTML=r}_afterRender(e,t){this._syncBindings(e,t),this._syncTrigger(e,t)}_unrender(){this._clearBindings(),this._untrackTrigger()}_getItems(e){return e.value&&(e.value.products||e.value)}_getListElement(e){return e.querySelector('[data-role="list"]')}_getItemElements(e){return e?Array.from(e.querySelectorAll('[data-role="item"]')):[]}_onClick(e){const t=e.target.closest('[data-role="item"]');if(!t)return;const n=this._bindings.get(t);n&&(this._trackClick(e,n),this._emitClickEvent(e,n))}_emitClickEvent(e,t){const{session:n}=this._view._state,{value:i,element:r}=t;this._view._events.emit("click",{session:n,value:i,element:r,domEvent:e})}destroy(){this._destroyTrackable(),this._destroyTriggerable(),this._view=void 0,super.destroy()}}Yi(ve.prototype),Em(ve.prototype);const $m="list",Au="miso-list";class zt extends ve{static get type(){return $m}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return Au}constructor({className:e=Au,...t}={}){super({className:e,...t})}}const km="horizontal",vu="miso-horizontal";class Iu extends ve{static get type(){return km}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return vu}constructor({className:e=vu,...t}={}){super({className:e,...t})}}const Pm="cards",Cu="miso-cards";class Nm extends ve{static get type(){return Pm}static get defaultTemplates(){return super.defaultTemplates}static get defaultClassName(){return Cu}constructor({className:e=Cu,...t}={}){super({className:e,...t})}}function xu(s,e,t){t===void 0?s.removeAttribute(e):s.setAttribute(e,t)}function Ht(s,e,t){t?s.classList.add(e):s.classList.remove(e)}function Lm(s){if(typeof s=="number")return s;const[e,t]=Um(s);switch(t){case"":case"px":return e;case"rem":return Dm(e);default:throw new Error(`Unsupported unit: ${t}`)}}function Um(s){const e=s.match(/^([+-]?(?:\d+|\d*\.\d+))([a-z]*)$/);if(!e)throw new Error(`Invalid length: ${s}`);const t=parseFloat(e[1]),n=e[2]||"";return[t,n]}function Dm(s=1){return s*parseFloat(getComputedStyle(document.documentElement).fontSize)}function Zi(s){return s===void 0||s instanceof Ru?s:new Ru(s)}class Ru{constructor(e){switch(this._width=NaN,this._height=NaN,typeof e){case"number":this._width=e,this._height=1;break;case"object":Array.isArray(e)&&(this._width=parseFloat(e[0]),this._height=parseFloat(e[1]));break;case"string":const t=e.indexOf("/");t<0?(this._width=parseFloat(e),this._height=1):(this._width=parseFloat(e.slice(0,t).trim()),this._height=parseFloat(e.slice(t+1).trim()));break}if(this._width===NaN||this._height===NaN)throw new Error(`Invalid aspect ratio value: ${e}`)}get width(){return this._width}get height(){return this._height}get floatValue(){return this._width/this._height}scaleBy(e){return e=Zi(e),Zi([e._width*this._width,e._height*this._height])}toString(){return this._height===1?`${this._width}`:`${this._width} / ${this._height}`}}function Fm(s){ps(s,Mm.prototype)}class Mm{_initSwipeable(){this._swipeableContext={itemCount:void 0,itemIndex:void 0,displayedCount:void 0,displayedIndex:void 0,displayEventIndex:void 0}}get itemIndex(){return this._swipeableContext.itemIndex}set itemIndex(e){const t=this._swipeableContext;t.itemCount!==void 0&&(e<0?e=t.itemCount-1:e>=t.itemCount&&(e=0),t.itemIndex=e,rn(()=>this._syncDisplayedSwipeableItemIndex()))}next(){this._swipeableContext.itemCount!==void 0&&this.itemIndex++}previous(){this._swipeableContext.itemCount!==void 0&&this.itemIndex--}_renderSwipeable(e,t,n){this._syncSwipeableItemCount(t),this._syncDisplayedSwipeableItemCount(),this._syncDisplayedSwipeableItemIndex()}_afterRenderSwipeable(){this._emitSwipeableDisplayEvent()}_syncSwipeableItemCount({state:e}={}){const t=this._swipeableContext,n=this._getItems(e),i=t.itemCount,r=t.itemCount=n?n.length:void 0;r!==i&&(r===void 0?t.itemIndex=void 0:i===void 0&&(t.itemIndex=0))}_syncDisplayedSwipeableItemCount(){const e=this._swipeableContext,{itemCount:t}=e;if(t===e.displayedCount)return;let{element:n}=this._view;n=n.firstElementChild,n&&(xu(n,"data-item-count",t),e.displayedCount=t)}_syncDisplayedSwipeableItemIndex(){const e=this._swipeableContext,{itemIndex:t}=e;t!==e.displayedIndex&&(e.displayedIndex=t,this._syncSwipeableListIndex(t),this._syncSwipeableIndicatorIndex(t))}_syncSwipeableListIndex(e){const{element:t}=this._view,n=t&&this._getListElement(t);n&&(n.style.left=`${-e*100}%`)}_syncSwipeableIndicatorIndex(e){const{element:t}=this._view,n=t&&this._getSwipeableIndicatorElement(t);if(!n)return;let i=0;for(const r of n.children)Ht(r,"active",i===e),i++}_getSwipeableIndicatorElement(e){return e.querySelector('[data-role="index-indicator"]')}_emitSwipeableDisplayEvent(){const e=this._swipeableContext,t=e.displayedIndex;e.displayEventIndex!==t&&(e.displayEventIndex=t,this._view._events.emit("display",{index:t}))}_onClickSwipeable(e){const{target:t}=e;t.closest('[data-role="previous"]')&&(e.preventDefault(),this.previous()),t.closest('[data-role="next"]')&&(e.preventDefault(),this.next())}}const jm="1.12.7";function qm(s){const t=s*Math.tan(3*Math.PI/8),n=t*Math.sin(Math.PI/4);return`M${s} 0L${100-t} 0A${s} ${s} 0 0 1 ${100-n} ${n}L${n} ${100-n}A${s} ${s} 0 0 1 0 ${100-t}L0 ${s}Z`}const st="miso-ui-icon",$u=`${st}-svg-${jm.replaceAll(".","_")}`,Ie={SEND:"send",SEARCH:"search",TRIANGLE:"triangle",TRIANGLE_EQ:"triangle-eq",CHEVRON:"chevron",CHEVRON_NEGATIVE:"chevron-negative",BULB:"bulb"},Bm=`<symbol id="${st}-${Ie.SEND}" viewBox="0 0 32 32"><path fill="currentColor" d="M11.499,19.173l5.801,-5.849c0.389,-0.392 1.022,-0.394 1.414,-0.006c0.392,0.389 0.395,1.022 0.006,1.414l-5.798,5.847l5.306,8.002c0.207,0.313 0.572,0.483 0.945,0.441c0.373,-0.042 0.691,-0.289 0.824,-0.64l9.024,-23.904c0.138,-0.366 0.05,-0.78 -0.226,-1.058c-0.276,-0.278 -0.689,-0.369 -1.057,-0.233l-24.004,8.892c-0.353,0.13 -0.602,0.448 -0.646,0.821c-0.044,0.373 0.125,0.74 0.438,0.948l7.973,5.325Z"/></symbol>`,zm=`<symbol id="${st}-${Ie.SEARCH}" viewBox="0 0 24 24"><path fill="currentColor" d="M4 11C4 7.13401 7.13401 4 11 4C14.866 4 18 7.13401 18 11C18 14.866 14.866 18 11 18C7.13401 18 4 14.866 4 11ZM11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C13.125 20 15.078 19.2635 16.6177 18.0319L20.2929 21.7071C20.6834 22.0976 21.3166 22.0976 21.7071 21.7071C22.0976 21.3166 22.0976 20.6834 21.7071 20.2929L18.0319 16.6177C19.2635 15.078 20 13.125 20 11C20 6.02944 15.9706 2 11 2Z"/></symbol>`,Hm=`<symbol id="${st}-${Ie.TRIANGLE}" viewBox="-5 -5 105 105"><path d="${qm(5)}"/></symbol>`,Gm=`<symbol id="${st}-${Ie.TRIANGLE_EQ}" viewBox="-100 -100 200 200"><path d="M12.99 -77.5A15 15,0,0,0,-12.99 -77.5L-73.61 27.5A15 15,0,0,0,-60.62 50L60.62 50A15 15,0,0,0,73.61 27.5L12.99 -77.5Z"/></symbol>`,Qm=`<symbol id="${st}-${Ie.CHEVRON}" viewBox="-100 -100 200 200"><path d="M10.61 -43.94A15 15,0,0,0,-10.61 -43.94L-60.61 6.06A15 15,0,0,0,-39.39 27.27L0 -12.12L39.39 27.27A15 15,0,0,0,60.61 6.06L10.61 -43.94Z"/></symbol>`,Wm=`<symbol id="${st}-${Ie.CHEVRON_NEGATIVE}" viewBox="-100 -100 200 200"><path d="M100 100V-200H-200V200H200ZM-10.61 -43.94A15 15,0,0,1,10.61 -43.94L60.61 6.06A15 15,0,0,1,39.39 27.27L0 -12.12L-39.39 27.27A15 15,0,0,1,-60.61 6.06L-10.61 -43.94Z"/></symbol>`,Vm=`<symbol id="${st}-${Ie.BULB}" viewBox="0 0 16 16"><path d="M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a2 2 0 0 0-.453-.618A5.98 5.98 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1"/></symbol>`,Km=`<svg id="${$u}" style="display:none;">${[Bm,zm,Hm,Gm,Qm,Wm,Vm].join("")}</svg>`;let ku=!1;function Ym(){ku||document.head.querySelector(`#${$u}`)||(ku=!0,document.head.insertAdjacentHTML("beforeend",Km))}Ym();function ys(s){return`<svg class="miso-ui-icon miso-ui-icon-${s}"><use href="#${st}-${s}"></use></svg>`}const Zm=new Set(Object.values(Ie));function Jm(s){return Zm.has(s)?ys(s):""}const Xm=ys(Ie.TRIANGLE),Pu=ys(Ie.CHEVRON),eg=ys(Ie.CHEVRON_NEGATIVE),tg=ys(Ie.BULB),sg="carousel",Nu="miso-carousel",Lu=Object.freeze({body:ig,controls:rg,controlContainer:og,control:cg,controlIcon:ug,indexIndicator:lg,indexIndicatorItem:()=>"",trigger:()=>""}),ng=Object.freeze({...ve.defaultTemplates,...Lu});function ig(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__viewport"><div class="${n}__viewport-inner">${i.list(s,e,t)}</div></div>${i.controls(s,e,t)}`}function rg(s,e,t){const{templates:n}=s;return`${n.controlContainer(s,e,"previous")}${n.controlContainer(s,e,"next")}${n.indexIndicator(s,e,t)}`}function og(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__control-container-${t}">${i.control(s,e,t)}</div>`}function cg(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__control-${t}" data-role="${t}">${i.controlIcon(s,e,t)}</div>`}function ug(s){return s.options.itemType==="image"?eg:Pu}function lg(s,e,t){const{className:n,templates:i}=s;return`<ul class="${n}__index-indicator" data-role="index-indicator">${t.map(r=>`<li class="${n}__index-indicator-item">${i.indexIndicatorItem(s,e,r)}</li>`).join("")}</ul>`}class Uu extends ve{static get type(){return sg}static get defaultTemplates(){return ng}static get defaultClassName(){return Nu}constructor({className:e=Nu,templates:t,...n}={}){super({className:e,templates:{...Lu,...t},...n}),this._initSwipeable()}_render(e,t,n){super._render(e,t,n),this._renderSwipeable(e,t,n)}_afterRender(e,t){super._afterRender(e,t),this._afterRenderSwipeable(e,t)}_onClick(e){this._onClickSwipeable(e),super._onClick(e)}}Fm(Uu.prototype);function ag(s,e){const t=e*2;let n=Math.max(t-s,0),i=s;const r=Math.min(Math.floor(n/3),i);i-=r,n-=r*3;const o=Math.min(n,i);return i-=o,n-=o,[r,o,i]}function fg(s,e,t,n){const{className:i,templates:r,options:o}=s,{itemType:c}=o,u=r[c](s,e,t,{index:n}),h=t._size?` ${i}__item-${t._size}`:"";return`<li class="${i}__item${h}">${u}</li>`}const hg="16rem",Du=Object.freeze({...ve.defaultTemplates,item:fg}),_g="gallery",Fu="miso-gallery";class Mu extends ve{static get type(){return _g}static get defaultTemplates(){return Du}static get defaultClassName(){return Fu}constructor({className:e=Fu,templates:t,...n}={}){super({className:e,templates:{...Du,...t},...n}),this._galleryContext={itemAspectRatio:void 0,itemCount:void 0,columnCount:void 0}}syncSize(){const{element:e}=this._view,t=e&&this._getListElement(e);t&&(this._syncListAspectRatio(t),this._syncItemSizes(t))}_preprocess({state:e,rendered:t}){const n=this._shallRenderIncrementally(e,t),i=n?void 0:this._bodyHtml(e),r=this._itemsHtml(e,t);return{...e,...L({incremental:n,bodyHtml:i,itemsHtml:r})}}_bodyHtml(e){return this.templates.root(this,{...e,value:[]})}_itemsHtml(e,t){const n=t&&t.value&&t.value.length||0,i=(this._getItems(e)||[]).slice(n);return i.length>0?this.templates.items(this,e,i,{offset:n}):""}_render(e,t,n){this._syncItemCount(t),this._syncCssVariables();const i=this._renderListElement(e,t,n);i&&(this._syncListAspectRatio(i),this._renderItems(i,t,n))}_renderListElement(e,{state:t}){const{incremental:n,bodyHtml:i}=t;return n||(e.innerHTML=i),this._getListElement(e)}_renderItems(e,t){t.state.incremental?this._appendItems(e,t):this._updateItems(e,t)}_updateItems(e,{state:t}){const{itemSizes:n}=this._galleryContext,i=this._writeItemSizes(this._getItems(t)||[],n);e.innerHTML=this.templates.items(this,t,i)}_appendItems(e,{state:t}){const{itemSizes:n}=this._galleryContext;this._syncItemSizes(e);const i=e.children.length,r=this._writeItemSizes((this._getItems(t)||[]).slice(i),n,i);e.insertAdjacentHTML("beforeend",this.templates.items(this,t,r,{offset:i}))}_writeItemSizes(e,[t=0,n=0]=[],i=0){let r=0;i>0&&(r=Math.min(i,t),i-=r,t-=r),i>0&&(r=Math.min(i,n),i-=r,n-=r);const o=[];for(const c of e){let u="small";t>0?(u="large",t--):n>0&&(u="medium",n--),o.push({...c,_size:u})}return o}_syncCssVariables(){const e=this._galleryContext;let{itemAspectRatio:t=1}=this.options;t=e.itemAspectRatio=Zi(t);const{element:n}=this._view;n&&(n.style.setProperty("--miso-gallery-item-1x1-aspect-ratio",`${t}`),n.style.setProperty("--miso-gallery-item-1x2-aspect-ratio",`${t.scaleBy([1,2])}`))}_syncListAspectRatio(e){const t=this._galleryContext,{itemCount:n,itemAspectRatio:i}=t,{height:r=hg}=this.options,o=Lm(r),c=e.clientWidth;if(c===0){t.columnCount=void 0,t.itemSizes=void 0;return}const u=t.columnCount=Math.round(c*i.width*2/(o*i.height));t.itemSizes=ag(n,u),e.style.aspectRatio=`${u} / 2`,e.style.height=n>0?"auto":"0"}_syncItemCount({state:e}={}){const t=this._getItems(e);this._galleryContext.itemCount=t?t.length:void 0}_syncItemSizes(e){const{itemSizes:t=[]}=this._galleryContext;let[n=0,i=0]=t;const{className:r}=this;for(const o of e.children){let c=!1,u=!1;n>0?(c=!0,n--):i>0&&(u=!0,i--),Ht(o,`${r}__item-large`,c),Ht(o,`${r}__item-medium`,u),Ht(o,`${r}__item-small`,!c&&!u)}}}const dg="search-box",ju="miso-search-box",pg="miso-autocomplete";function mg(s){const{className:e,templates:t,role:n,options:i,autocomplete:r}=s,{placeholder:o}=i,c=n?`data-role="${n}"`:"";return`
<div class="${e}" ${c}>
  <div class="${e}__input-group">
    <input class="${e}__input" type="text" data-role="input" ${o?`placeholder="${o}"`:""}>
    <button class="${e}__button" type="submit" data-role="submit">${t.buttonContent(s)}</button>
  </div>
  <div class="${r.className}" data-role="autocomplete"></div>
</div>`.trim()}function gg(s){const{templates:e,options:t}=s;if(t.buttonText)return t.buttonText;const{buttonText:n,buttonIcon:i}=e,r=typeof n=="function"?n(s):`${n}`,o=typeof i=="function"?i(s):Jm(i)||`${i}`;return r+o}function bg(s,e){const{templates:t,workflow:n,autocomplete:i}=s;s={templates:t,workflow:n,...i};const r=[],o=[];for(const c of e)(c.product?r:o).push(c);return t.queries(s,o)+(o.length>0&&r.length>0?"<hr>":"")+t.products(s,r)}function wg(s,e){const{templates:t}=s;return t.completionList(s,"query",e)}function yg(s,e){const{templates:t}=s;return t.completionList(s,"product",e)}function Eg(s,{text:e,text_with_inverted_markups:t}={}){return t||xe(e)}function Tg(s,{product:e}){const{templates:t}=s,[n,i]=t.helpers.tagPair(s,e,{role:!1});return[n,t.imageBlock(s,e),t.productInfoBlock(s,e),i].join("")}function Sg(s,e,t){const{className:n,templates:i}=s;return`<ul class="${n}__${e}-list" data-role="${e}-list">${t.map(r=>i.completionItem(s,e,r)).join("")}</ul>`}function Og(s,e,t){const{className:n,templates:i}=s;return`
<li class="${n}__${e}-item" data-role="${e}-item" data-index="${t._index}" tabindex="0">
  ${i[e](s,t)}
</li>`.trim()}const qu=Object.freeze({root:mg,buttonContent:gg,buttonText:"",buttonIcon:"search",completions:bg,completionList:Sg,completionItem:Og,queries:wg,products:yg,query:Eg,product:Tg,imageBlock:Bt,productInfoBlock:zi}),Ag=Object.freeze({className:pg,debounce:300});class Gt extends Re{static get type(){return dg}static get defaultTemplates(){return qu}static get defaultClassName(){return ju}constructor({className:e=ju,templates:t,autocomplete:n,...i}={}){super({className:e,templates:{...qu,...t},...i}),G(this,{autocomplete:{...Ag,...n}}),this._contexts=new WeakMap,this._prevInput=void 0,this._debounce=ic(this.autocomplete.debounce)}initialize(e){const{proxyElement:t,hub:n}=e;this._unsubscribes=[...this._unsubscribes,t.on("input",i=>this._syncInput(i)),t.on("keydown",i=>this._handleKeyDown(i)),t.on("click",i=>this._handleClick(i)),t.on("focusin",i=>this._handleFocusIn(i)),t.on("focusout",i=>this._handleFocusOut(i)),n.on(Ni(),()=>e.refresh({force:!0}))]}focus(){this._element?this._context().focus():this._focusRequested=!0}open(){this._element.classList.add("open")}close(){this._element.classList.remove("open")}set value(e){this._element?this._context().value=e:this._valueRequested=e}_preprocess({state:e}){return e=super._preprocess({state:e}),{...e,completions:this._view.hub.states[Ni()]}}_render(e,t,n){e.childElementCount===0&&super._render(e,t,n),this._updateCompletions(e,t,n)}_afterRender(e,t){this._fullfillFocusRequest(e),this._fullfillValueRequest(e)}_updateCompletions(e,{state:t,rendered:n},{writeToState:i}){if(!t.completions)return;const{status:r=C.INITIAL,session:o,value:c}=t.completions,{index:u}=o;if(n&&n.completions.index===u&&n.completions.status===r)return;const h=this._context(e),{autocompleteElement:a}=h;if(!a)return;const _=h.trackItems(c);Ht(e,"nonempty",_.length>0),a.setAttribute("data-status",r),a.innerHTML=this.templates.completions(this,_),i({completions:{index:u,status:r}})}_fullfillFocusRequest(e){!e||!this._focusRequested||(this._focusRequested=!1,this._context(e).focus())}_fullfillValueRequest(e){!e||!this._valueRequested||(this._context(e).value=this._valueRequested,this._valueRequested=void 0)}_context(e){if(e=e||this._view.element,!e)return Qt.empty();let t=this._contexts.get(e);return t||this._contexts.set(e,t=new Qt(e)),t}_syncInput(){const{inputElement:e}=this._context();if(!e)return;const t=e.value.trim();if(this._prevInput===t)return;this._prevInput=t;const n=this;this._debounce(()=>n._view.hub.update(Yc(),{value:t}))}_handleFocusIn({target:e}){this._element&&e.matches('[data-role="input"]')&&(this._syncInput(),this.open())}_handleFocusOut({relatedTarget:e}){this._element&&(!e||!Ti(e,t=>t===this._element||void 0))&&this.close()}_handleKeyDown({key:e,target:t,isComposing:n}){!n&&e==="Enter"&&t.matches('[data-role="input"]')&&(this._submit(t.value),t.blur())}_handleClick(e){const{target:t}=e,{inputElement:n}=this._context();for(let i=t;i&&i!==this._element;i=i.parentElement){if(i.matches('[data-role="submit"]')||i.matches('[data-role="button"]')||i.matches('[type="submit"]')){n&&(n.blur(),this._submit(n.value));return}if(i.matches('[data-role="query-item"]')){const r=i.getAttribute("data-index"),o=this._context().data.get(parseInt(r)),c=o&&o.text;c&&(n&&(n.value=c),this._view._events.emit("select",Object.freeze({value:o,index:r,domEvent:e})),e.defaultPrevented||this._submit(c)),this.close();return}if(i.matches('[data-role="product-item"]')){this._view._events.emit("select",Object.freeze({value:item,index,domEvent:e}));return}}}async _submit(e){!e||!e.trim()||(this.close(),this._view.hub.update(at(),{q:e}),this._trackSubmit(e))}_trackSubmit(e){const{[fe.SUBMIT]:t}=this._view.tracker.options||{};t&&this._view.tracker.submit({value:e})}}class Qt{static empty(){return Qt._empty||(Qt._empty=new Qt)}constructor(e){this._element=e,this._cache={},this._data=new Map}get inputElement(){return this._get("input")}get autocompleteElement(){return this._get("autocomplete")}get data(){return this._data}trackItems(e){let t=0;const n=this._data=new Map,i=[];for(const r in e)for(const o of e[r])o.product&&!o.product.url||(o._index=t,o._field=r,n.set(t,o),i.push(o),t++);return i}focus(){if(!this._element)return;const{inputElement:e}=this;e&&e.focus()}set value(e){if(!this._element)return;const{inputElement:t}=this;t&&(t.value=e)}_get(e){return this._element?this._cache[e]||(this._cache[e]=this._element.querySelector(`[data-role="${e}"]`)):void 0}}const vg="option-list",Bu="miso-option-list";function Ig(s,e){const{className:t,role:n,templates:i}=s,r=n?`data-role="${n}"`:"";return`
<div class="${t}" ${r}>
  ${i.options(s,e)}
</div>
`}function Cg(s,e){const{className:t,templates:n}=s,i=e.value||[];return`
<ol class="${t}__options" data-role="options">
  ${i.map((r,o)=>n.option(s,r,{index:o})).join("")}
</ol>
`}function xg(s,e){const{className:t}=s,n=xe(e.text||e);return`<li class="${t}__option" data-role="option" tabindex="0">${n}</li>`}const zu=Object.freeze({root:Ig,options:Cg,option:xg});class bn extends Re{static get type(){return vg}static get defaultTemplates(){return zu}static get defaultClassName(){return Bu}constructor({className:e=Bu,templates:t,...n}={}){super({className:e,templates:{...zu,...t},...n}),this._initTrackable()}initialize(e){const{proxyElement:t}=e;this._unsubscribes=[...this._unsubscribes,t.on("click",n=>this._handleClick(n))]}_render(e,t,n){super._render(e,t,n);const{state:i}=t;this._syncOptionValues(e,i)}_afterRender(e,t){this._syncBindings(e,t)}_unrender(){this._clearBindings()}_syncOptionValues(e,t){const n=e&&this._getOptionsElement(e);if(!n)return;const i=this._getItems(t)||[];Ht(n,"empty",i.length===0)}_getItems(e){return e.value}_getOptionsElement(e){return e.querySelector('[data-role="options"]')}_getItemElements(e){return e?Array.from(e.querySelectorAll('[data-role="option"]')):[]}_handleClick(e){const t=e.target.closest('[data-role="option"]');if(!t)return;const n=this._bindings.get(t),i=n&&n.value;i&&(this._trackClick(e,n),this._select(i.text))}async _select(e){e&&this._view._events.emit("select",{value:e})}destroy(){this._destroyTrackable(),super.destroy()}}Yi(bn.prototype);function Rg(s){const{className:e,role:t,templates:n}=s,i=t?`data-role="${t}"`:"";return`
<div class="${e}" ${i}>
  ${n.options(s)}
</div>
`}function $g(s,e){const{className:t,templates:n}=s;return`
<div role="button" class="${t}__option" data-value="${e.value}">
  ${n.content(s,e)}
</div>
`}const Hu=Object.freeze({...ou("options"),root:Rg,option:$g});class kg extends Re{static get defaultTemplates(){return Hu}constructor({className:e,templates:t,field:n,defaultValue:i,...r}={}){super({className:e,templates:{...Hu,...t},...r}),this._field=n,this._defaultValue=i}initialize(e){const{proxyElement:t}=e;this._unsubscribes=[...this._unsubscribes,e.hub.on(this._field,()=>this._refresh()),t.on("click",n=>this._handleClick(n))],this._defaultValue?this._select(this._defaultValue,{silent:!0}):this._clear({silent:!0})}_preprocess(e,t){return e.rendered&&t.skip(),super._preprocess(e,t)}_handleClick({target:e}){const t=Ti(e,o=>o.hasAttribute("data-value")?o:void 0);if(!t)return;let{unselected:n,value:i}=this._view.hub.states[this._field];n=n||i===void 0;const r=t.getAttribute("data-value");n||i===void 0||i!==r?this._select(r):this._clear()}_refresh(){this._state=this._view.hub.states[this._field],rn(()=>this._syncValueAttribute())}_syncValueAttribute(){if(!this._state||!this._view)return;const{element:e}=this._view,t=e&&e.children[0];if(!t)return;let{unselected:n,value:i}=this._state;n?t.removeAttribute("data-selected"):t.setAttribute("data-selected",i),this._state=void 0}_select(e,t){this._submit({value:e},t)}_clear(e){this._submit({unselected:!0},e)}async _submit(e,t){this._view.hub.update(this._field,e,t)}}const Pg="feedback",Gu="miso-feedback",Ng=["helpful","unhelpful"];function Lg(s){const{templates:e}=s;return Ng.map(t=>e.option(s,{value:t})).join("")}function Ug(s,{value:e}){const{className:t,templates:n,options:i={}}=s;return`
${i.icon!==!1?`<i class="${t}__icon">${n.icon(s,e)}</i>`:""}
${i.text!==!1?`<span class="${t}__text">${n.text(s,e)}</span>`:""}
`}function Dg(s,e){switch(e){case"helpful":case"unhelpful":return dm;default:return""}}function Fg(s,e){switch(e){case"helpful":return"Helpful";case"unhelpful":return"Not helpful";default:return""}}const Qu=Object.freeze({options:Lg,content:Ug,icon:Dg,text:Fg});class Wu extends kg{static get type(){return Pg}static get defaultTemplates(){return Qu}static get defaultClassName(){return Gu}constructor({className:e=Gu,templates:t,...n}={}){if(super({className:e,templates:{...Qu,...t},field:Kc(),...n}),n.text===!1&&n.icon===!1)throw new Error("At least one of options.text or options.icon must be enabled")}}const Mg="text",Vu="miso-text";function jg(s,{value:e}){const{className:t,role:n,options:{raw:i=!1,tag:r}}=s,o=n?`data-role="${n}"`:"",c=e!==void 0?xe(qg(s)(e)):"";return i?c:`<${r} class="${t}" ${o}>${c}</${r}>`}function qg(s){let{format:e}=s.options;const{formatDate:t,formatNumber:n}=s.templates.helpers;if(!e)return o=>`${o}`;switch(typeof e){case"function":return e;case"string":e=[e];break}let[i,r]=e;switch(i){case"date":return o=>t(o,r);case"number":return o=>n(o,r);default:return o=>`${o}`}}const Ku=Object.freeze({root:jg});class Es extends Re{static get type(){return Mg}static get defaultTemplates(){return Ku}static get defaultClassName(){return Vu}constructor({className:e=Vu,templates:t,tag:n="p",...i}={}){super({className:e,templates:{...Ku,...t},tag:n,...i})}}class Bg extends Bi{constructor(e){super(e)}_takePending(){return this._pending}_applyRender(e,t={}){const n=cn(!1);super._applyRender(e,{...t,loop:n.t}),n.value&&this._requestRaf()}}class zg{clear(e){return e.innerText="",{cursor:0,done:!1}}update(e,{value:t,cursor:n},{value:i,cursor:r,done:o}){const c=i.length;r=Math.min(r,c);const u=!!o&&r===c,h=t.substring(0,n),a=!i.startsWith(h);return u||a?e.innerText=i:e.insertAdjacentText("beforeend",i.substring(n,r)),u&&e.classList.add("done"),{cursor:r,done:u}}}function Hg(s,e,{status:t}){if(!e)return;e.children.length===0&&(e.innerHTML=Gg(s));const n=e.children[0];return n.setAttribute("data-status",t||C.INITIAL),n}function Gg(s){let{className:e,role:t,options:{tag:n,format:i,builtInStyles:r=!0}}=s;n==="auto"&&(n=i==="markdown"?"div":"p");const o=t?`data-role="${t}"`:"",c=[e,Yu(e)];return r&&i==="markdown"&&c.push("miso-markdown"),`<${n} class="${c.join(" ")}" ${o} data-format="${i}"></${n}>`}function Yu(s){return`${s}__cursor`}function Qg(s,e){return s&&e&&s.session&&e.session&&s.session.uuid===e.session.uuid}function Wg(s){if(s===!0)return Vg();if(s){if(typeof s=="function")return s;throw new Error("onDebug must be a function or a boolean")}}function Vg(s=performance.now()){return function({summary:e,timestamp:t,elapsed:n,ref:i,operation:r,conflict:o}){MisoClient.debug("<progressive-markdown>",`[${Kg(t-s)}](${Zu(n[0])}, ${Zu(n[1])})`,e,`${r}`,i,o)}}function Kg(s){return`${Math.floor(s)/1e3}s`}function Zu(s){return`${Math.floor(s*100)/100}ms`}const Yg="typewriter",Ju="miso-typewriter";class Ts extends Bg{static get type(){return Yg}static get defaultClassName(){return Ju}constructor({className:e=Ju,tag:t="auto",format:n="markdown",tooltip:i=!1,speed:r,acceleration:o,nextCursorFn:c,...u}={}){super({tag:t,format:n,tooltip:i,...u}),G(this,{className:e}),this._prevState=void 0,this._getNextCursor=typeof c=="function"?c:x_({speed:r,acceleration:o}),this._readiness=new Je,n==="markdown"&&Ts.MisoClient.plugins.install("std:ui-markdown")}initialize(){this._setup()}async _setup(){try{switch(this.options.format){case"plaintext":await this._setupForPlaintext();break;default:await this._setupForMarkdown()}this._readiness.resolve()}catch(e){this._readiness.reject(e)}}async _setupForMarkdown(){const e=await this._view._views._extensions.require("markdown");if(!this._view)return;const t=Yu(this.className),{onDebug:n,onCitationLink:i,variant:r}=this.options;this._renderer=e.createRenderer({cursorClass:t,getSource:o=>this._getSource(o),onCitationLink:i,onDebug:Wg(n),variant:r}),this._unsubscribes.push(this._view.proxyElement.on("click",o=>this._onClick(o)))}_getSource(e){const{data:t={}}=this._view._data,{sources:n=[]}=t;return n[e]}async _setupForPlaintext(){this._renderer=new zg}async _ready(){return this._readiness.promise}async render(...e){await this._ready(),await super.render(...e)}_preprocess({state:e}){const t=this._prevState,{value:{value:n="",stage:i,finished:r}={},session:o,status:c}=e,u=Qg(t,e),h=u&&i===t.stage,a=t?h?t.streak:t.streak+1:0,_=u&&t&&t.doneAt||(c===C.READY&&r?performance.now():void 0),m=_!==void 0;return this._prevState=Object.freeze(L({session:o,status:c,value:n,stage:i,streak:a,doneAt:_,done:m}))}_render(e,{state:t,rendered:n},{notifyUpdate:i,writeToState:r,loop:o}){const c=Hg(this,e,t);let u;const h=!n||t.streak!==n.streak;if(h)u=this._renderer.clear(c,n);else{const m=this._getNextCursor(n.cursor,t.doneAt,n.timestamp,t.timestamp);u=this._renderer.update(c,n,{...t,cursor:m})}r(u);const a=t.status===C.READY&&!u.done,_=a&&(!n||n.status===C.READY)&&!h;i({ongoing:a},{silent:_}),a&&o()}_onClick(e){const{target:t}=e,n=t.closest('[data-role="citation-link"]');if(n){const o=parseInt(n.dataset.index);Number.isNaN(o)||this._view._events.emit("citation-click",{event:e,index:o});return}const i=t.closest('[data-role="follow-up-link"]');if(i){let{q:o}=i.dataset;o=o?o.trim():void 0,o&&this._view._events.emit("follow-up-click",{event:e,q:o});return}const r=t.closest("a");if(r){if(!e.defaultPrevented){const{href:o,innerText:c,className:u}=r;o&&this._view._events.emit("link-click",L({event:e,url:o,text:c?c.trim():"",className:u||"",attributes:Zg(r)}))}return}}}function Zg(s){const{attributes:e}=s,t={};for(const{name:n,value:i}of e)n.startsWith("data-")&&(t[n]=i);try{return JSON.stringify(t)}catch{return"{}"}}const Jg="affiliation",Xu="miso-affiliation";function Xg(s,e){const{className:t,role:n,templates:i,options:r}=s,{status:o}=e,c=n?` data-role="${n}"`:"",u=e.value||{},h=u.channel?` data-channel="${u.channel}"`:"",a=s._getItems(e),_=a?a.length:void 0,m=_!==void 0?` data-item-count="${_}"`:"",T=r.itemType?` data-item-type="${r.itemType}"`:"";return`<div class="${t} ${o}"${c}${h}${T}${m}>${o===C.READY?i[o](s,e):""}</div>`}function eb(s,e){const{templates:t}=s,n=s._getItems(e);return n&&n.length>0?t.controlContainer(s,e,"previous")+t.body(s,e)+t.controlContainer(s,e,"next"):t.empty(s,e)}function tb(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__control-${t}-container">${i.control(s,e,t)}</div>`}function sb(s,e,t){const{className:n,templates:i}=s;return`<div class="${n}__control-${t}" data-role="${t}">${i.controlIcon(s,e,t)}</div>`}function nb(s,e,t){return Xm}function ib(s,e){const{className:t,templates:n}=s,i=s._getItems(e);return`<div class="${t}__body">${n.list(s,e,i)}</div>`}function rb(s,e,t,n){const{className:i,templates:r,options:o}=s,{itemType:c}=o,u=r.itemHeader(s,e,t,{index:n}),h=r[c](s,e,t,{index:n});return`<li class="${i}__item"><div class="${i}__item-inner">${u}${h}</div></li>`}function ob(s,e,t,n){const{className:i,templates:r}=s;let{itemHeaderLeftText:o,itemHeaderRightText:c}=r;return o=tt.asFunction(o)(s,e,t,n),c=tt.asFunction(c)(s,e,t,n),`<div class="${i}__item-header">
  <div class="${i}__item-header-left">${o}</div>
  <div class="${i}__item-header-right">${c}</div>
</div>`}function cb(s,e,t,n){const{className:i,templates:r}=s,o=tt.asFunction(r.logoText)(s,e,t,n)||"",c=tt.asFunction(r.logoImg)(s,e,t,n);return c?`<span class="${i}__item-header-logo-text">${o}</span>${c}`:""}function ub(s,e,t,n){const{className:i,templates:r}=s,o=tt.asFunction(r.logoUrl)(s,e,t,n);if(!o)return"";const c=tt.asFunction(r.logoAltText)(s,e,t,n),u=c?` alt="${c}"`:"";return`<img class="${i}__item-header-logo" src="${o}"${u}>`}const el=Object.freeze({root:Xg,[C.READY]:eb,controlContainer:tb,control:sb,controlIcon:nb,body:ib,item:rb,itemHeader:ob,affiliation:em,ctaText:"View deal",itemHeaderLeftText:"Today's best deals",itemHeaderRightText:cb,logoImg:ub,logoText:"Selected by"}),lb=Object.freeze({...ve.defaultTemplates,...el});class tl extends ve{static get type(){return Jg}static get defaultTemplates(){return lb}static get defaultClassName(){return Xu}constructor({className:e=Xu,templates:t,autoplay:n,...i}={}){super({className:e,itemType:"affiliation",templates:{...el,...t},...i}),this._itemCount=void 0,this._itemIndex=0,this._displayedCount=void 0,this._displayedIndex=void 0,this._viewable=void 0}initialize(e){super.initialize(e);const{viewable:t}=this._view.tracker.options||{};this._viewable=new U_(this._onViewable.bind(this),t)}get itemIndex(){return this._itemIndex}set itemIndex(e){this._itemCount!==void 0&&(e<0?e=this._itemCount-1:e>=this._itemCount&&(e=0),this._itemIndex=e,rn(()=>this._syncItemIndex()))}next(){this._itemCount!==void 0&&this.itemIndex++}previous(){this._itemCount!==void 0&&this.itemIndex--}_render(e,t,n){super._render(e,t,n),this._syncItemCount(t),this._syncItemIndex()}_syncElement(e){const t=this._element;super._syncElement(e),this._syncViewableElement(t,e)}_syncViewableElement(e,t){e!==t&&(e&&this._viewable.unobserve(e),t&&this._viewable.observe(t))}_syncItemCount({state:e}={}){const t=this._getItems(e),n=this._itemCount=t?t.length:void 0;if(n===this._displayedCount)return;let{element:i}=this._view;i=i.firstElementChild,i&&(xu(i,"data-item-count",n),this._displayedCount=n)}_syncItemIndex(){const e=this._itemIndex;if(e===this._displayedIndex)return;const{element:t}=this._view,n=t&&this._getListElement(t);n&&(this._displayedIndex=e,n.style.left=`${-e*100}%`,this._viewable.display(e),this._view._events.emit("display",{index:e}))}_onViewable(e){const t=this._getRenderedItemData(e);t&&this._view.tracker.viewable([t])}_getRenderedItemData(e){const{value:t}=this._rendered.get(this._element)||{};if(!t)return;const{products:n=[]}=t;return n[e]}_trackViewables(){}_onClick(e){const t=e.target;if(t.closest('[data-role="previous"]')){this.previous();return}if(t.closest('[data-role="next"]')){this.next();return}super._onClick(e)}}const ab="facets",sl="miso-facets",wn="miso-facet",nl="custom_attributes.";function fb(s,e){const{className:t,role:n,templates:i}=s,r=n?`data-role="${n}"`:"";return`<div class="${t}" ${r}>${i.facets(s,e)}</div>`}function hb(s,e){const{templates:t}=s,{facet_fields:n={}}=e.value||{};return Object.keys(n).map(i=>t.facet(s,{field:i,entries:n[i]},e))}function _b(s,e,t){const{facetClassName:n=wn,templates:i}=s,{field:r}=e;return`<div class="${n}" data-role="facet" data-field="${xe(r)}">${i.header(s,e,t)}${i.options(s,e,t)}</div>`}function db(s,e,t){const{facetClassName:n=wn,templates:i}=s;return`<div class="${n}__header">${i.title(s,e,t)}</div>`}function pb(s,{field:e}){return e.startsWith(nl)&&(e=e.substring(nl.length)),xe(e)}function mb(s,{field:e,entries:t},n){const{facetClassName:i=wn,templates:r}=s;return`<ul class="${i}__options" data-role="options">${t.map(([o,c])=>r.option(s,{field:e,value:o,count:c},n)).join("")}</ul>`}function gb(s,e,t){const{facetClassName:n=wn,templates:i}=s;return`
<li class="${n}__option" data-role="option" tabindex="0">
  <span class="${n}__value">${i.value(s,e,t)}</span>
  <span class="${n}__count">${i.count(s,e,t)}</span>
</li>`}function bb(s,{value:e},t){return xe(e)}function wb(s,{count:e},t){return s.templates.helpers.formatNumber(e)}const il=Object.freeze({root:fb,facets:hb,facet:_b,header:db,title:pb,options:mb,option:gb,value:bb,count:wb});function yb(s,e){return`${s}:::${e}`}function rl(s){const e={};for(const t in s)e[t]=new Set(s[t]);return e}class ol extends Re{static get type(){return ab}static get defaultTemplates(){return il}static get defaultClassName(){return sl}constructor({className:e=sl,templates:t,...n}={}){super({className:e,templates:{...il,...t},...n}),this._bindings=new Su}initialize(e){const{proxyElement:t,filters:n}=e;this._unsubscribes=[...this._unsubscribes,t.on("click",i=>this._handleClick(i)),n.on("update",i=>this._updateSelections(i)),n.on("reset",()=>this._syncSelections())]}_render(e,t,n){super._render(e,t,n)}_afterRender(e,t){this._syncBindings(e,t),this._syncSelections()}_unrender(){this._clearBindings()}_syncSelections(){const e=rl(this._view.hub.states[jt()].facets);for(const{value:{field:t,value:n},element:i}of this._bindings.entries)this._setSelected(i,e[t]&&e[t].has(n))}_updateSelections({updates:e}){const t=rl(e.facets);for(const{value:{field:n,value:i},element:r}of this._bindings.entries)t[n]&&this._setSelected(r,t[n].has(i))}_setSelected(e,t){e&&(t?e.classList.add("selected"):e.classList.remove("selected"))}_syncBindings(e,t){if(!e||!t.value)return;const n=this._getItems(t),i=[],r=[],o=[];for(const c of this._getFacetElements(e)){const u=c.getAttribute("data-field"),h=n[u];if(!h)continue;const a=this._getItemElements(c);for(let _=0;_<a.length;_++){const m=a[_],T=h[_];if(!T)break;i.push(yb(u,T)),r.push({field:u,value:T}),o.push(m)}}this._bindings.update(i,r,o)}_clearBindings(){this._bindings.clear()}_getItems({value:e}={}){const{facet_fields:t={}}=e||{},n={};for(const i in t)n[xe(i)]=t[i].map(([r])=>r);return n}_getFacetElements(e){return Array.from(e.querySelectorAll('[data-role="facet"]'))}_getFacetElement(e,t){return e.querySelector(`[data-role="facet"][data-field="${t}"]`)}_getItemElements(e){return Array.from(e.querySelectorAll('[data-role="option"]'))}_handleClick(e){if(e.button!==0)return;const t=e.target.closest('[data-role="option"]');if(!t)return;const n=this._bindings.get(t),i=n&&n.value;if(!i)return;const{field:r,value:o}=i;this._view.filters.facets.toggle(r,o),this._view.filters.apply()}destroy(){this._bindings.clear(),super.destroy()}}const Eb="select",cl="miso-select";function Tb(s,e){const{className:t,role:n,templates:i}=s,r=n?`data-role="${n}"`:"",o=s._getItems(e),c=o.find(u=>u.selected)||o[0];return`
<div class="${t}" ${r}>
  ${i.button(s,c)}
  ${i.options(s,e)}
</div>`}function Sb(s,e){const{className:t,templates:n}=s;return`<button class="${t}__button" data-role="button" tabindex="0">${n.text(s,e)}</button>`}function Ob(s,e){const{className:t,templates:n}=s,i=s._getItems(e);return`<ul class="${t}__options">${i.map((r,o)=>n.option(s,r,{index:o})).join("")}</ul>`}function Ab(s,e){const{className:t,templates:n}=s,i=e.selected?"selected":"";return`<li class="${t}__option ${i}" data-role="option" tabindex="0">${n.text(s,e)}</li>`}function vb(s,e){return xe(e&&e.text&&s_(e.text)||e||"")}const ul=Object.freeze({root:Tb,button:Sb,options:Ob,option:Ab,text:vb});class Ji extends Re{static get type(){return Eb}static get defaultTemplates(){return ul}static get defaultClassName(){return cl}constructor({className:e=cl,templates:t,...n}={}){super({className:e,templates:{...ul,...t},...n}),this._initTrackable()}initialize(e){const{proxyElement:t}=e;this._unsubscribes=[...this._unsubscribes,t.on("click",n=>this._handleClick(n))]}_afterRender(e,t){this._syncBindings(e,t)}_unrender(){this._clearBindings()}_getItems(e){return e.value||[]}_getOptionsElement(e){return e.querySelector('[data-role="options"]')}_getItemElements(e){return e?Array.from(e.querySelectorAll('[data-role="option"]')):[]}_handleClick(e){if(this._element)for(let t=e.target;t&&t!==this._element;t=t.parentElement){const{role:n}=t.dataset;switch(n){case"button":this._toggle();break;case"option":const i=this._bindings.get(t);this._select(i&&i.value);break}}}_toggle(){if(!this._element)return;const e=this._element.children[0];e&&e.classList.toggle("open")}async _select(e){e&&this._view._events.emit("select",{value:e})}destroy(){this._destroyTrackable(),super.destroy()}}Yi(Ji.prototype);const Ib="more-button",ll="miso-more-button";function Cb(s,e){const{className:t,role:n,templates:i}=s,r=n?` data-role="${n}"`:"",o=e.status!==C.READY?" disabled":"";return`
<div class="${t}"${r}${o}>
  ${i.text(s)}
</div>
`}const al=Object.freeze({root:Cb,text:xb});function xb(s){return"More"}class fl extends Re{static get type(){return Ib}static get defaultTemplates(){return al}static get defaultClassName(){return ll}constructor({className:e=ll,templates:t,...n}={}){super({className:e,templates:{...al,...t},...n})}initialize(e){this._unsubscribes=[...this._unsubscribes,e.proxyElement.on("click",t=>this._handleClick(t))]}_handleClick(e){if(e.button!==0)return;const t=e.target.closest('[data-role="more"]');!t||t.disabled||this._view.hub.trigger(Di())}}const Rb=Object.freeze(Object.defineProperty({__proto__:null,AffiliationLayout:tl,BannerLayout:bm,CardsLayout:Nm,CarouselLayout:Uu,CollectionLayout:ve,ContainerLayout:bu,ErrorLayout:yu,FacetsLayout:ol,FeedbackLayout:Wu,GalleryLayout:Mu,HorizontalLayout:Iu,ListLayout:zt,MoreButtonLayout:fl,OptionListLayout:bn,SearchBoxLayout:Gt,SelectLayout:Ji,TemplateBasedLayout:Re,TextLayout:Es,TypewriterLayout:Ts},Symbol.toStringTag,{value:"Module"}));function $b(s,{hub:e,workflowOptions:t={}}={}){const{sort:{options:n=[]}={}}=t.filters||{};if(!n.length)return[];const{sort:i}=e.states[jt()]||{},r=i&&i.field||kb(n).field;return r?n.map(o=>({...o,selected:o.field===r})):n}function kb(s){for(const e of s)if(e.default)return e;return s[0]}function Pb(s){if(!s||!s.value)return;const{answer:e="",answer_stage:t,finished:n}=s.value;return Object.freeze({value:e,stage:t,finished:!!n})}function Nb(s){if(!s||!s.value)return;const{reasoning:e="",reasoning_finished:t}=s.value;return Object.freeze({value:e,stage:"reasoning",finished:!!t})}function Lb(s,{workflow:e}={}){const t=e.previous,n=t&&t.states[re()].value,i=n&&(n.suggested_followup_questions||n.followup_questions||[]);return i&&i.map(r=>({text:r}))}function Ub(s){if(!(!s||!s.value))return(s.value.followup_questions||[]).map(e=>({text:e}))}function hl({qs:s,...e}={}){return ln(e,{metadata:{question_source:s||Tt.ORGANIC}})}function Db(s,e){return e===lt.QUERY?s:{...s,answer:!1}}function _l(s){return s&&s.value&&s.value.revision}function Fb(s,e){if(!s||!s.value||s.request||!e||!e.request)return s;const{request:t}=e;return{...s,request:t}}function Mb(s){const e=jb(s),t=e===C.READY?s.ongoing:void 0;return L({status:e,ongoing:t,...s})}function jb(s){if(!s)return C.INITIAL;const{request:e,error:t,value:n}=s;return t?C.ERRONEOUS:n?C.READY:e?C.LOADING:C.INITIAL}function qb(s){const{value:e}=s;if(!e)return s;const{miso_id:t}=e;return t?{...s,meta:{...s.meta,miso_id:t}}:s}function dl(s){const{session:e,value:t}=s;if(!e||!t)return;const{miso_id:n}=t;n&&(e.meta.miso_id=n)}function Bb(s){const{session:e,value:t}=s;if(!e||!t)return s;const{meta:{miso_id:n}={}}=e;return n?{...s,meta:{...s.meta,miso_id:n}}:s}function pl(s){const{request:e,value:t}=s;if(!e)return s;const{payload:n}=e||{},{q:i}=n||{};return i?{...s,value:{...t,keywords:i}}:s}function zb(s){const{value:e}=s;if(!e)return s;const{answer_stage:t}=e;return t?{...s,ongoing:!e.finished,meta:{...s.meta,answer_stage:t}}:s}function Hb(s,e){if(!e)return s;const{status:t,value:n}=s;switch(t){case C.INITIAL:case C.LOADING:break;default:return s}return n&&n.facet_counts?s:{...s,value:{...n,facet_counts:e}}}function Gb(s){const{value:e}=s;if(!e)return s;const{miso_id:t}=e;return t?{...s,value:{...e,root_miso_id:t}}:s}function Qb(s,e,{role:t=d.PRODUCTS}={}){if(!e.value)return s;const{[t]:n=[],facet_counts:i,total:r,root_miso_id:o}=s.value,{[t]:c=[]}=e.value;return{...e,value:{...e.value,facet_counts:i,total:r,root_miso_id:o,[t]:[...n,...c]}}}function Wb(s,{role:e=d.PRODUCTS}={}){const{status:t,request:n,value:i}=s;if(t!==C.READY||!n||!i)return s;const{[e]:r}=i;if(!r)return s;const{rows:o}=n.payload,{length:c}=r;return c<o?{...s,meta:{...s.meta,exhausted:!0}}:s}function Vb(s,e){const{question_id:t}=e&&e.value||{};return t?{...s,value:{...s.value,question_id:t}}:s}function Kb(s){const{role:e,type:t,items:n}=s,i={type:t==="viewable"?"viewable_impression":t,context:{custom_context:L({property:e})}};switch(Hd(t)&&(Yb(e,n)?i.product_ids=(n||[]).map(r=>typeof r=="string"?r:r.product_id).filter(r=>r):(i.product_ids=[],i.context.custom_context.items=(n||[]).map(r=>r.text||r.id||r))),t){case fe.SUBMIT:i.context.custom_context.value=s.value;break;case fe.FEEDBACK:i.context.custom_context.value=i.value=s.value,i.context.custom_context.result_type=i.result_type=s.result_type;break}return L(i)}function Yb(s,e=[]){return Bd(s)||e.length>0&&typeof e[0]=="object"&&e[0].product_id}function Zb(s,e){const{data:t}=e;if(!t)return s;const n=t.request&&t.request.payload&&t.request.payload.metadata;return n?Oe(s,{context:{custom_context:n}}):s}function Jb(s,e){const{data:t}=e;if(!t)return s;const n=t.request&&t.request.payload;if(!n)return s;const{question:i,q:r,fq:o}=n;return Oe(s,{context:{custom_context:{question:i,q:r,fq:o}}})}function Xb(s,e){if(e.role!==d.AFFILIATION)return s;const{items:t}=e,n=t[0]&&t[0].channel||void 0,i=t.map(r=>r.position);return Oe(s,{context:{custom_context:{channel:n,positions:i}}})}function ml(s,e){return s=ew(s,e),s=tw(s,e),s=sw(s,e),s}function ew(s={},{data:e}={}){if(!e)return s;const{request:t={},value:n={}}=e,{question_source:i}=t.payload&&t.payload.metadata||{},{question_id:r}=n;return Oe(s,{context:{custom_context:{question_source:i,question_id:r}}})}function tw(s,e){if(e.role!==d.ANSWER)return s;const{items:t=[]}=e;return Oe(s,{context:{custom_context:{urls:t.map(n=>n.url),texts:t.map(n=>n.text),class_names:t.map(n=>n.className),attributes:t.map(n=>n.attributes)}}})}function sw(s,{event_target:e}={}){return e?Oe(s,{context:{custom_context:{event_target:e}}}):s}function nw(s){const{value:e}=s;return!e||!e.finished||e.finish_reason!=="success"||e.sources&&e.sources.length>0?s:{...s,meta:{...s.meta,unanswerable:!0}}}const gl=Object.freeze({}),bl=Object.freeze({[d.CONTAINER]:bu.type,[d.ERROR]:yu.type}),wl=Object.freeze({}),iw=Object.freeze({api:gl,layouts:bl,trackers:wl}),rw=Object.freeze({mappings:{[d.ERROR]:s=>s.error}});class W extends pe{constructor(e){super(e.name||"workflow",e.plugin);let{context:t,plugin:n,client:i,defaults:r,options:o,extraOptions:c}=e;this._context=t,this._plugin=n=n||t._plugin,this._client=i=i||t._client,e=Object.freeze({...e,plugin:n,client:i}),this._name=e.name,this._roles=e.roles,this._extensions=n._getExtensions(i),this._defaults=r,this._options=o||new qc(t&&t._options,r),this._extraOptions=c||{},this._hub=new Sp({onUpdate:u=>this._onHubUpdate(u),onEmit:u=>this._onHubEmit(u)}),this._sessionContext=new WeakMap,i._events.emit("workflow",this),this._initProperties(e),this._initActors(e),this._initSubscriptions(e),this._initSession(e)}_initProperties(){}_initActors({roles:e}){const t=this._hub,n=this._client,i=this._options,r=this._extensions,o=this._plugin.layouts;this._sessions=new Op(t),this._data=new Ap(t,{source:ru(n),options:i,...this._extraOptions.api}),this._views=new Hp(t,{extensions:r,layouts:o,roles:e,options:i,workflow:this}),this._interactions=new Vp(t,{client:n,options:i})}_initSubscriptions({roles:e}){this._unsubscribes=[this._hub.on(_n(),t=>this._onSession(t)),this._hub.on(Wc(),t=>this.updateData(t)),this._hub.on(Ui(),t=>this._onTracker(t))],e.main&&this._unsubscribes.push(this._hub.on(et(e.main),t=>this._onMainViewUpdate(t)))}_initSession(){this.restart()}_getSessionContext(e){let t=this._sessionContext.get(e);return t||this._sessionContext.set(e,t={}),t}_onHubUpdate(e){this._runCallbacks(this._client.meta.parent._hubUpdateCallbacks,e)}_onHubEmit(e){this._runCallbacks(this._client.meta.parent._hubEmitCallbacks,e),this._emitAsWorkflowEvent(e)}_emitAsWorkflowEvent({action:e,name:t,state:n,silent:i}){i||this._emit(t,{_action:e,...n})}get uuid(){return this.session&&this.session.uuid}get session(){return this._hub.states[_n()]}get states(){return this._hub.states}get status(){const e=this._hub.states[re()];return e&&e.status}get views(){return this._views.interface}restart(){return this._emitInterruptEventIfNecessary(),this._sessions.restart(),this}_emitInterruptEventIfNecessary(){const{main:e}=this._roles;if(!e)return;const t=this._hub.states[et(e)]||{};t.session&&t.status===C.LOADING&&(this._emitLifecycleEvent("interrupt",t),this._emitLifecycleEvent("finally",t))}_onSession(e){this.updateData({session:e})}_onMainViewUpdate(e){const{status:t}=e,n=t===C.READY,i=t===C.ERRONEOUS,r=i?"error":t;this._emitLifecycleEvent(r,e),n&&this._emitLifecycleEvent("done",e),(n||i)&&this._emitLifecycleEvent("finally",e)}_shallEmitLifecycleEvent(e,{session:t}){const n=this._getSessionContext(t),i=n.lifecycleEvents||(n.lifecycleEvents=new Set),r=i.has(e);return i.add(e),!r}_emitLifecycleEvent(e,t){this._shallEmitLifecycleEvent(e,t)&&this._emit(e,t)}_request(e={}){const{session:t}=this,n=Dc(this._options.resolved.api,e);this.updateData({session:t,request:n}),this._hub.update(Li(),{...n,session:t})}updateData(e){if(!e)throw new Error("Data is required.");const{session:t}=e;if(!t)throw new Error("Session is required to update data.");if(!this.session)throw new Error("No session is created yet. Call workflow.restart() to start a new session.");if(t.uuid!==this.session.uuid)return;const n=_l(e);if(!nn(n)){const i=_l(this._hub.states[re()]);if(!nn(i)&&n<=i)return}return this._updateData(e),this}_updateData(e){const t=this._hub.states[re()];e=this._defaultProcessData(e,t);for(const n of this._options.resolved.dataProcessor)e=n(e,t);this._updateDataInHub(e,t)}_defaultProcessData(e,t){return e=Fb(e,t),e=Mb(e),e=qb(e),e}_updateDataInHub(e){this._hub.update(re(),e)}notifyViewUpdate(e,t){return t={status:C.READY,session:this.session,...t},this._hub.update(et(e),t),this}get trackers(){return this._views.trackers}_onTracker(e){const t=this,n=this._hub.states[re()],i=this._buildInteraction({...e,data:n,workflow:t});this._sendInteraction(i)}_buildInteraction(e){let t=Kb(e);t=this._defaultProcessInteraction(t,e);const{preprocess:n=[]}=this._options.resolved.interactions;for(const i of n)t=i(t,e);return t}_defaultProcessInteraction(e,t){return e=this._writeApiInfoToInteraction(e,t),e=this._writeMisoIdToInteraction(e,t),e=Jb(e,t),e=Zb(e,t),e=Xb(e,t),e}_writeApiInfoToInteraction(e){const{group:t,name:n}=this._options.resolved.api;return Oe(e,{context:{custom_context:{api_group:t,api_name:n}}})}_writeMisoIdToInteraction(e,t){const n=this._hub.states[et(t.role)]||{},i=n.meta&&n.meta.miso_id||void 0;return i?Oe(e,{miso_id:i}):e}_sendInteraction(e){const{handle:t}=this._options.resolved.interactions;typeof t=="function"?t(e):this._hub.trigger(Vc(),e)}destroy(e){this._emit("destroy"),this._destroy(e)}get destroyed(){return!!this._destroyed}_destroy({dom:e}={}){for(const t of this._unsubscribes||[])t();this._unsubscribes=[],this._views._destroy({dom:e}),this._data._destroy(),this._destroyed=!0}_runCallbacks(e,t){for(const n of e)try{n({workflow:this,...t})}catch(i){this._error(i)}}_emit(e,t){this._events.emit(e,{_event:e,...t}),this._context&&this._context._events.emit(e,{workflow:this,_event:e,...t})}}ws(W.prototype),Object.assign(W,{DEFAULT_API_OPTIONS:gl,DEFAULT_LAYOUTS:bl,DEFAULT_TRACKERS:wl,DEFAULT_OPTIONS:iw,ROLES_OPTIONS:rw});function ow(s){if(!s||!s.value)return s;const{value:e}=s;return{...s,value:cw(e)}}function cw(s){if(s.affiliation_products){const{affiliation_products:e,...t}=s;s={...t,affiliation:lw(e)}}else if(s.sovrn_aff){const{sovrn_aff:e,...t}=s;s={...t,affiliation:aw(e)}}return uw(s)}function uw(s){const{affiliation:e}=s;if(!e)return s;let{channel:t,products:n}=e;if(!n)return s;n=n.map(r=>({...r}));let i=0;for(const r of n)t&&(r.channel=t),r.position=i++;return{...s,affiliation:{...e,products:n}}}function lw(s){return{channel:"miso",products:s}}function aw({products:s,...e}){return{channel:"sovrn",...e,products:s.map(fw)}}function fw({id:s,deeplink:e,headline:t,description:n,currency:i,retailPrice:r,salePrice:o,discountRate:c,image:u,thumbnail:h,merchant:a,..._}){const m=a&&a.name,T=a&&a.logo;return L({id:`sovrn-${s}`,title:t,description:n,cover_image:u,url:e,currency:i,original_price:r,sale_price:o,discount_rate_percent:c,brand:m,brand_logo:T,custom_attributes:yl({sovrn_id:s,thumbnail:h,merchant:a,..._})})}function yl(s,e=""){return Object.keys(s).reduce((t,n)=>{const i=s[n];if(i===void 0)return t;const r=e?`${e}_${n}`:n;return typeof i=="object"?{...t,...yl(i,r)}:{...t,[r]:i}},{})}function Xi(s){ps(s,er.prototype)}class er{useLink(e,t={}){if(typeof e!="function"&&e!==!1)throw new Error("useLink(fn) expects fn to be a function or false");return this._linkFn=e?[e,t]:!1,this}_submitToPage(e={}){if(!this._linkFn)return;const t=this._getSubmitUrl(e),[n,i={}]=this._linkFn;if(i.open===!1)window.location.href=t;else{const r=i.target||"_blank",o=i.windowFeatures||"";window.open(t,r,o)}}_getSubmitUrl({q:e,...t}={}){if(!this._linkFn)throw new Error("useLink(fn) must be called before _getSubmitUrl()");return this._linkFn[0](e,t)}}const El=Object.freeze({...W.DEFAULT_API_OPTIONS,group:te.ASK,payload:{...W.DEFAULT_API_OPTIONS.payload,source_fl:["cover_image","url","created_at","updated_at","published_at"],cite_link:1,cite_start:"[",cite_end:"]"}}),Tl=Object.freeze({actor:!1,api:{group:te.ASK,name:Se.AUTOCOMPLETE}}),tr=Object.freeze({...W.DEFAULT_LAYOUTS,[d.QUERY]:[Gt.type,{placeholder:"Ask a question"}],[d.QUESTION]:[Es.type,{tag:"h2"}],[d.ANSWER]:Ts.type,[d.FEEDBACK]:Wu.type,[d.IMAGES]:[Mu.type,{incremental:!0,itemType:"image"}],[d.SOURCES]:[zt.type,{incremental:!0,itemType:"article",templates:{ordered:!0}}],[d.AFFILIATION]:[tl.type,{incremental:!0,itemType:"affiliation",link:{rel:"noopener nofollow"}}]}),Sl=Object.freeze({...W.DEFAULT_TRACKERS,[d.ANSWER]:{active:!0,itemless:!0,deduplicated:!1,click:Ae.click},[d.IMAGES]:Ae,[d.SOURCES]:Ae,[d.AFFILIATION]:Ae,[d.PRODUCTS]:Ae}),hw=Object.freeze({...W.DEFAULT_OPTIONS,api:El,autocomplete:Tl,layouts:tr,trackers:Sl}),_w=bs(W.ROLES_OPTIONS,{main:d.ANSWER,members:Object.keys(tr),mappings:{[d.ANSWER]:Pb,[d.REASONING]:Nb}});class se extends W{_initProperties(e){super._initProperties(e),this._questionId=void 0,this._autoQuery=!1}_initActors(e){super._initActors(e),this._feedback=new Wp(this._hub)}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._hub.on(at(),t=>this._query(t)),this._views.get(d.ANSWER).on("citation-click",t=>this._onCitationClick(t)),this._views.get(d.ANSWER).on("link-click",t=>this._onAnswerLinkClick(t))]}restart(){this._questionId&&(this._questionId=void 0),super.restart()}_shallEmitLifecycleEvent(e,t){return e==="answer-stage"||super._shallEmitLifecycleEvent(e,t)}_emitInterruptEventIfNecessary(){const e=this._hub.states[et(this._roles.main)]||{};e.session&&e.status!==C.INITIAL&&(e.status!==C.READY||e.ongoing)&&(this._emitLifecycleEvent("interrupt",e),this._emitLifecycleEvent("finally",e))}_onMainViewUpdate(e){const{status:t,session:n}=e,i=t===C.READY&&!e.ongoing,r=t===C.ERRONEOUS,o=i?"done":r?"error":t,c=this._getSessionContext(n),u=c.answerStage,h=e.meta&&e.meta.answer_stage;h&&h!==u&&(this._emitLifecycleEvent("answer-stage",Object.freeze({...e,answer_stage:h})),c.answerStage=h),this._emitLifecycleEvent(o,e),(i||r)&&this._emitLifecycleEvent("finally",e)}get questionId(){return this._questionId}autoQuery(e={}){Gc.call(this,e)}query(e){if(!e.q&&!e.questionId)throw new Error("q is required in query() call");this._hub.update(at(),e)}_query(e={}){if(this._linkFn){this._submitToPage(e);return}this.restart(),this._writeQuestionSourceToSession(e);const t=this._buildPayload(e);this._request({payload:t})}_writeQuestionSourceToSession(e){this.session.meta.question_source=e.qs||Tt.ORGANIC}_buildPayload(){throw new Error("Not implemented")}_writeWikiLinkTemplateToPayload(e){return!this._autoQuery||!this._autoQuery.param||this._autoQuery.param===Hc?e:{...e,wiki_link_template:`?${this._autoQuery.param}=%s`}}_updateData(e){if(this._writeQuestionIdFromData(e),e.value&&!e.value.answer_stage){this._handleHeadResponse(e);return}super._updateData(e),Qc.call(this,e)}_handleHeadResponse(e){}_defaultProcessData(e,t){return e=super._defaultProcessData(e,t),e=ow(e),e=zb(e),e}_writeQuestionIdFromData({value:e}){e&&this._writeQuestionId(e.question_id)}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=ml(e,t),e}_getQuestionSourceFromViewState(e){const{request:t}=this._hub.states[et(e.role)]||{},{payload:n}=t||{};return n&&n.metadata&&n.metadata.question_source||void 0}_onCitationClick({index:e,event:t}){if(t.button!==0||Mi(t))return;const{value:n}=this._hub.states[re()]||{},{sources:i}=n||{},r=i&&i[e-1];!r||!r.product_id||(ji(t),this._views.trackers.sources.click([r.product_id],{event_target:"citation-link"}))}_onAnswerLinkClick({event:e,...t}){e.button===0&&(Mi(e)||(ji(e),this._views.trackers.answer.click([],{items:[t]})))}_writeQuestionId(e){!this._questionId&&e&&(this._questionId=e)}_clearQuestionId(){this._questionId=void 0}_destroy(e){this._feedback._destroy(),super._destroy(e)}}Xi(se.prototype),Object.assign(se,{DEFAULT_API_OPTIONS:El,DEFAULT_AUTOCOMPLETE_OPTIONS:Tl,DEFAULT_LAYOUTS:tr,DEFAULT_TRACKERS:Sl,DEFAULT_OPTIONS:hw,ROLES_OPTIONS:_w});const Ol=Object.freeze(Object.defineProperty({__proto__:null,CLASS_PREFIX:"miso-ask-combo",CONAINER_TAG:"miso-ask"},Symbol.toStringTag,{value:"Module"})),Al=Object.freeze(Object.defineProperty({__proto__:null,followUpQuestions:"Related questions you can explore",question:"You asked...",relatedResources:"Go beyond, and learn more about this topic",sources:"This reply is based on the following articles",thoughts:"Thoughts"},Symbol.toStringTag,{value:"Module"}));let vl=class{constructor({helpers:e}){this._helpers=e}errorSection(e){const{section:t,container:n}=this._helpers;return t(e,{name:"error"},[n(e,{name:"error",visibleWhen:"erroneous"},"<miso-error></miso-error>")])}answerGroup(e){return[this.answer(e),this.affiliation(e),this.sources(e)]}answer(e){const{container:t}=this._helpers;return t(e,{name:"answer",visibleWhen:"ready"},[...this.question(e),"<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}question(e){const{phrase:t}=this._helpers;return[t(e,{name:"question",tag:"div"}),"<miso-question></miso-question>"]}sources(e){const{container:t,phrase:n}=this._helpers;return t(e,{name:"sources",visibleWhen:"nonempty"},[n(e,{name:"sources",tag:"h3"}),"<miso-sources></miso-sources>"])}affiliation(e){const{container:t}=this._helpers,{affiliation:n=!0}=e||{};return n?t(e,{name:"affiliation",visibleWhen:"nonempty"},["<miso-affiliation></miso-affiliation>"]):""}};class Il{constructor(e){this._context=e,G(this,{lowerCamelToKebab:Zo,kebabToLowerCamel:Ko,kebabOrSnakeToLowerCamel:Yo})}normalizeOptions({classPrefix:e,circledCitationIndex:t=!0,phrases:n,...i}={}){return e=e||this._context.CLASS_PREFIX,n=this.normalizePhraseOptions(n),{classPrefix:e,circledCitationIndex:t,phrases:n,...i}}normalizePhraseOptions(e={}){if(!e)return{};const t={};for(const n in e)t[this.normalizePhraseOptionKey(n)]=e[n];return t}normalizePhraseOptionKey(e){return e=Yo(e),e==="relatedQuestions"||e==="querySuggestions"?"followUpQuestions":e}phrase(e,{name:t,extraNames:n=[],tag:i="div",inline:r=!1}){const{classPrefix:o}=e,c=r?`${o}__phrase-inline`:`${o}__phrase`;return`<${i} class="${c} ${[t,...n].map(u=>`${o}__${u}-phrase`).join(" ")}">${this.phraseText(e,Ko(t))}</${i}>`}phraseText(e,t){const{phrases:n={}}=e,i=n[t]||this._context.DEFAULT_PHRASES[t];switch(typeof i){case"function":return i(e);case"string":return i;default:return""}}section({classPrefix:e},{name:t},n){return this.element("section",{classes:[`${e}__section`,`${e}__${t}`]},n)}container({classPrefix:e,circledCitationIndex:t,parentQuestionId:n,workflow:i},{name:r,extraNames:o=[],visibleWhen:c,trait:u,logo:h=!1},a){const _=[r,...o].map(m=>`${e}__${m}-container`);return t&&_.push("miso-circled-citation-index"),this.element(this._context.CONAINER_TAG,{classes:_,visibleWhen:c,trait:u,logo:h,parentQuestionId:n,workflow:i},a)}element(e,t={},n=""){return`<${e}${this.attrs(t)}>${Array.isArray(n)?n.join(""):n}</${e}>`}attrs({classes:e=[],...t}={}){let n="";e.length&&(n+=` class="${e.join(" ")}"`);for(const i in t){const r=t[i];r!==void 0&&(n+=` ${Zo(i)}="${r}"`)}return n}}let dw=class extends vl{constructor(){super({helpers:Ss})}answerGroup(e){const{container:t}=this._helpers;return[this.question(e),this.reasoning(e),this.answer(e),this.affiliation(e),this.sources(e),this.followUpQuestions(e),t(e,{name:"bottom-spacing",visibleWhen:"ongoing"})]}question(e){const{container:t,phrase:n}=this._helpers;return t(e,{name:"question",visibleWhen:"ready"},[e.parentQuestionId?"<hr>":"",n(e,{name:"question",tag:"div"}),"<miso-question></miso-question>"])}answer(e){const{container:t}=this._helpers;return t(e,{name:"answer",visibleWhen:"ready"},["<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}reasoning(e={}){const{phrases:t,reasoning:n={}}=e,{container:i,element:r,phraseText:o}=this._helpers,c=[];return n.expand&&c.push("expanded"),i(e,{name:"reasoning",visibleWhen:"nonempty"},[r("miso-stub",{classes:c,trait:"collapsible","data-role":"reasoning-box"},[r("div",{classes:["miso-collapsible__header"],"data-role":"toggle-expand"},[`<div class="miso-collapsible__icon">${n.icon||tg}</div>`,`<div class="miso-collapsible__title" data-role="title">${o(t,"thoughts")}</div>`,`<div class="miso-collapsible__toggle">${Pu}</div>`]),r("div",{classes:["miso-collapsible__body"]},["<miso-reasoning></miso-reasoning>"])])])}sources(e){const{container:t,phrase:n}=this._helpers;return t(e,{name:"sources",visibleWhen:"nonempty"},["<hr>",n(e,{name:"sources",tag:"h3"}),"<miso-sources></miso-sources>"])}followUpQuestions(e){const{container:t,phrase:n}=this._helpers,i="follow-up-questions",r=["query-suggestions"];return t(e,{name:i,extraNames:r,visibleWhen:"nonempty"},[n(e,{name:i,extraNames:r,tag:"h3"}),"<miso-follow-up-questions></miso-follow-up-questions>"])}followUps(e){const{features:t={}}=e;return t.followUpQuestions===!1?"":'<miso-follow-ups id="miso-ask-combo__follow-ups" class="miso-ask-combo__follow-ups"></miso-follow-ups>'}relatedResourcesSection(e){const{container:t,phrase:n,section:i}=this._helpers,{features:r={},logo:o=!0}=e,c=r.relatedResources===!1?"":t({...e,workflow:"active"},{name:"related-resources",visibleWhen:"nonempty",logo:o},[n(e,{name:"related-resources",tag:"h2"}),"<miso-related-resources></miso-related-resources>"]);return i(e,{name:"related-resources"},c)}};const Ss=un(new Il({...Ol,DEFAULT_PHRASES:Al})),sr=un(new dw({helpers:Ss}));function pw(s={}){const{normalizeOptions:e,section:t,container:n}=Ss,{followUps:i,relatedResourcesSection:r,answerGroup:o}=sr;return s=e(s),[t(s,{name:"question"},[n(s,{name:"query"},"<miso-query></miso-query>")]),t(s,{name:"answer"},o(s)),i(s),r(s)].join("")}function yn(s={}){const{normalizeOptions:e,section:t,container:n}=Ss,{answerGroup:i}=sr;return s=e(s),t(s,{name:"follow-up"},[n(s,{name:"query",visibleWhen:"initial loading"},"<miso-query></miso-query>"),...i(s)])}const mw=Object.freeze(Object.defineProperty({__proto__:null,followUp:yn,helpers:Ss,root:pw,sections:sr},Symbol.toStringTag,{value:"Module"})),gw=Object.freeze({...se.DEFAULT_API_OPTIONS,name:Se.QUESTIONS,payload:{...se.DEFAULT_API_OPTIONS.payload,related_resource_fl:["cover_image","url","created_at","updated_at","published_at"]}}),Cl=Object.freeze({...se.DEFAULT_LAYOUTS,[d.QUERY]:[Gt.type,{templates:{buttonIcon:"send"}}],[d.REASONING]:Ts.type,[d.RELATED_RESOURCES]:[zt.type,{incremental:!0,itemType:"article"}],[d.QUERY_SUGGESTIONS]:bn.type,[d.FOLLOW_UP_QUESTIONS]:bn.type}),bw=Object.freeze({...se.DEFAULT_TRACKERS,[d.RELATED_RESOURCES]:Ae,[d.QUERY_SUGGESTIONS]:{...Ae,click:{...Ae.click,validate:s=>s.button===0}}}),ww=Object.freeze({followUp:yn}),yw=Object.freeze({...se.DEFAULT_OPTIONS,api:gw,layouts:Cl,trackers:bw,templates:ww}),Ew=bs(se.ROLES_OPTIONS,{members:Object.keys(Cl),mappings:{[d.QUERY_SUGGESTIONS]:Lb,[d.FOLLOW_UP_QUESTIONS]:Ub}});class xl extends se{constructor(e,t){super({name:"ask",context:e,roles:Ew,defaults:yw,parentQuestionId:t})}_initProperties(e){super._initProperties(e);const{parentQuestionId:t}=e;G(this,{parentQuestionId:t})}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._hub.on(et(d.REASONING),t=>this._onReasoningViewUpdate(t)),this._views.get(d.ANSWER).on("follow-up-click",t=>this._onFollowUpClick(t)),this._views.get(d.FOLLOW_UP_QUESTIONS).on("select",t=>this._onFollowUpQuestionSelect(t)),this._views.get(d.QUERY_SUGGESTIONS).on("select",t=>this._onQuerySuggestionSelect(t))]}_initSession(e){e.parentQuestionId&&this._context._byPqid.set(e.parentQuestionId,this),this._context._events.emit("create",this),super._initSession(e)}restart(){const{next:e}=this;e&&e.destroy(),this._questionId&&this._context._byQid.delete(this._questionId),super.restart()}get rootQuestionId(){return this._context.root.questionId}get previous(){const{parentQuestionId:e}=this;return e?this._context.getByQuestionId(e):void 0}get next(){const{questionId:e}=this;return e?this._context.getByParentQuestionId(e):void 0}getOrCreateNext(){const{questionId:e}=this;return e?this._context.getByParentQuestionId(e,{autoCreate:!0}):void 0}_buildPayload({q:e,qs:t,questionId:n,...i}={}){if(n)return L({...i,question_id:n});const{parentQuestionId:r}=this;let o=L({...i,question:e,parent_question_id:r});return o=hl({...o,qs:t}),o=this._writeWikiLinkTemplateToPayload(o),o}_updateData(e){super._updateData(e),this._triggerSuggestionsRefreshIfNecessary()}_triggerSuggestionsRefreshIfNecessary(){const{next:e}=this;if(!e)return;const t=e._views.get(d.QUERY_SUGGESTIONS);t&&t.refresh()}_onReasoningViewUpdate({status:e,ongoing:t}){if(e!==C.READY||t)return;const n=this._getReasoningBoxElement();n&&n.classList.add("done")}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=this._writeAdditionalAskPropertiesToInteraction(e,t),e}_writeAdditionalAskPropertiesToInteraction(e,t){const n=this.rootQuestionId;let{property:i}=e.context&&e.context.custom_context||{},r,o,c;return(t.role===d.FOLLOW_UP_QUESTIONS||t.role===d.QUERY_SUGGESTIONS)&&(i="suggested_followup_questions"),t.role===d.QUERY_SUGGESTIONS?(o=this.previous&&this.previous.parentQuestionId,r=this.parentQuestionId,c=this.previous&&this.previous.session.meta.question_source):o=this.parentQuestionId,Oe(e,{context:{custom_context:L({property:i,root_question_id:n,parent_question_id:o,question_id:r,question_source:c})}})}_onFollowUpClick({q:e,event:t}={}){t.button===0&&this._submitFollowUpQuestion({q:e,qs:Tt.INLINE_QUESTION_LINK})}_onFollowUpQuestionSelect({value:e}){this._submitFollowUpQuestion({q:e,qs:Tt.SUGGESTED_QUESTIONS})}_submitFollowUpQuestion({q:e="",qs:t}={}){if(e=e.trim(),!e)return;this.getOrCreateNext().query({q:e,qs:t})}_onQuerySuggestionSelect({value:e}){e&&this.query({q:e,qs:Tt.SUGGESTED_QUESTIONS})}_writeQuestionId(e){!this._questionId&&e&&(this._questionId=e,this._context._byQid.set(e,this))}_clearQuestionId(){this._questionId&&(this._context._byQid.delete(this._questionId),this._questionId=void 0)}_getReasoningBoxElement(){const e=this._views.get(d.REASONING),t=e&&e.element;return t&&t.closest('[data-role="reasoning-box"]')}_destroy(e){const{next:t,parentQuestionId:n,questionId:i}=this;t&&t.destroy(e),n&&this._context._byPqid.delete(n),i&&this._context._byQid.delete(i),super._destroy(e)}}const Rl={event:"done"};function Tw(s=Rl){switch(s===!0&&(s=Rl),typeof s=="string"&&(s={event:s}),typeof s){case"object":return e=>e&&s.event===e._event;case"function":return s;default:return()=>!1}}class $l extends Pi{constructor(e,t){super("asks",e,t),this._byQid=new Map,this._byPqid=new Map,this._root=new xl(this),this._events.on("*",n=>this._createNextIfNecessary(n)),this._events.on("loading",n=>this._setActive(n.workflow)),this._events.on("destroy",()=>this._requestEmitAfterDestroy()),this._events.on("after-destroy",()=>this._syncActiveOnAfterDestroy()),this._autoNextFn=void 0,this._active=this._root}get root(){return this._root}get workflows(){return[this._root,...this._byPqid.values()]}get active(){return this._active}getByQuestionId(e){if(typeof e!="string")throw new Error(`Required ID to be a string: ${e}`);return this._byQid.get(e)}getByParentQuestionId(e,{autoCreate:t=!1}={}){if(e===void 0)return this._root;if(typeof e!="string")throw new Error(`Required ID to be a string: ${e}`);let n=this._byPqid.get(e);return!n&&t&&(n=new xl(this,e)),n}reset({root:e=!0,events:t,...n}={}){t===void 0&&(t=!!e),t&&this._events.clear();for(const i of this._byPqid.values())i.destroy(n);e&&this._root.restart()}autoNext(e){this._autoNextFn=Tw(e)}_createNextIfNecessary(e){if(!this._autoNextFn||!this._autoNextFn(e))return;const{workflow:t}=e;t&&t.getOrCreateNext()}_requestEmitAfterDestroy(){this._emitAfterDestroyRequested||(this._emitAfterDestroyRequested=!0,setTimeout(()=>{this._emitAfterDestroyRequested=!1,this._events.emit("after-destroy",{})},0))}_syncActiveOnAfterDestroy(){if(!this._active.destroyed)return;let e=this._root;for(;e.next&&e.next.status!==C.INITIAL;e=e.next);this._setActive(e)}_setActive(e){e!==this._active&&(this._active=e,this._events.emit("active",{workflow:e}))}}ws($l.prototype,[ee.TEMPLATES]);const Sw=10,Ow=10,kl=Object.freeze({...W.DEFAULT_API_OPTIONS,group:te.SEARCH,payload:{...W.DEFAULT_API_OPTIONS.payload,fl:["cover_image","url","created_at","updated_at","published_at","title"],rows:Sw}}),nr=Object.freeze({...W.DEFAULT_LAYOUTS,[d.QUERY]:[Gt.type],[d.PRODUCTS]:[zt.type,{incremental:!0,infiniteScroll:!0}],[d.KEYWORDS]:[Es.type,{raw:!0}],[d.TOTAL]:[Es.type,{raw:!0,format:"number"}],[d.FACETS]:[ol.type],[d.SORT]:[Ji.type],[d.MORE]:[fl.type]}),Pl=Object.freeze({...W.DEFAULT_TRACKERS,[d.PRODUCTS]:Ae}),Nl=Object.freeze({active:!1,mode:"infiniteScroll",pageLimit:10}),Aw=Object.freeze({...W.DEFAULT_OPTIONS,api:kl,layouts:nr,trackers:Pl,pagination:Nl}),vw=bs(W.ROLES_OPTIONS,{main:d.PRODUCTS,members:Object.keys(nr),mappings:{[d.FACETS]:"facet_counts",[d.SORT]:$b}});class oe extends W{_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._hub.on(at(),t=>this._query(t)),this._hub.on(jt(),()=>this._refine()),this._hub.on(Di(),()=>this._more()),this._views.get(d.SORT).on("select",t=>this._handleSortSelect(t))]}restart(){super.restart(),this._page=0}get exhausted(){const e=this._hub.states[re()];return!!(e&&e.meta&&e.meta.exhausted)}get page(){return this._page}autoQuery(e={}){Gc.call(this,e)}query(e){if(!e.q)throw new Error("q is required in query() call");this._hub.update(at(),e)}_query(e){if(this._linkFn){this._submitToPage(e);return}const t=lt.QUERY;this._views.filters.reset({silent:!0}),this.restart({type:t});const n=this._buildPayload(e,t);this._request({payload:n,type:t})}_refine(){const e=lt.REFINE,{facet_counts:t}=this._hub.states[re()].value||{};this._currentFacetCounts=t,this.restart({type:e});const n=this._getQuery(),i=this._buildPayload(n,e);this._request({payload:i,type:e})}_more(){if(this.status!==C.READY)throw new Error("Can not call more() while loading.");if(this.exhausted||this._page>=Ow-1)return;this._page++;const e=lt.MORE,t=this._getQuery(),n=this._buildPayload(t,e);this._request({payload:n,type:e})}_getQuery(){return this._hub.states[at()]}_getPageSize(){return this._options.resolved.api.payload.rows}_buildPayload(e,t){return e=this._writeFiltersToPayload(e),e=this._writePageInfoToPayload(e),t===lt.MORE&&(e=this._processPayloadForMoreRequest(e)),e}_writeFiltersToPayload(e){const t=this._hub.states[jt()],{facets:n,sort:i}=t||{};return L({...e,facet_filters:this._buildFacetFilters(n),order_by:this._buildOrderBy(i)})}_buildFacetFilters(e){if(!e)return;const t={};for(const n in e){const i=e[n];!i||!i.length||(t[n]={terms:i})}return Object.keys(t).length?t:void 0}_buildOrderBy(e){if(e)return Et(e)}_writePageInfoToPayload(e){return{...e,metadata:{...e.metadata,page:this._page}}}_processPayloadForMoreRequest(e={}){const t=this._hub.states[re()],{[this._roles.main]:n=[]}=t&&t.value||{},i=n.map(o=>o.product_id).filter(o=>o),r=[...e.exclude||[],...i];return r.length===0?e:{...e,exclude:r}}_defaultProcessData(e,t){return e=super._defaultProcessData(e,t),e=pl(e),e=Hb(e,this._currentFacetCounts),e=Wb(e,{role:this._roles.main}),e}_updateData(e){super._updateData(e),Qc.call(this,e)}_updateDataInHub(e,t){e=this._appendResultsFromMoreRequest(e),super._updateDataInHub(e,t)}_appendResultsFromMoreRequest(e){const{request:t}=e;if(!t)return e;const{metadata:n}=t.payload;if(!n||!n.page)return Gb(e);const i=this._hub.states[re()];return Qb(i,e,{role:this._roles.main})}_handleSortSelect({value:e}={}){e&&(this._views.filters.update({sort:e}),this._views.filters.apply())}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=this._writeRootMisoIdToInteraction(e),e}_writeRootMisoIdToInteraction(e){const t=this._hub.states[re()],{root_miso_id:n}=t&&t.value||{};return n?Oe(e,{context:{custom_context:{root_miso_id:n}}}):e}}ws(oe.prototype,[ee.PAGINATION,ee.FILTERS]),Xi(oe.prototype),Object.assign(oe,{DEFAULT_API_OPTIONS:kl,DEFAULT_LAYOUTS:nr,DEFAULT_TRACKERS:Pl,DEFAULT_PAGINATION:Nl,DEFAULT_OPTIONS:Aw,ROLES_OPTIONS:vw});const Iw=se.ROLES_OPTIONS;class Cw extends se{constructor(e){super({name:"hybrid-search/answer",plugin:e._plugin,client:e._client,options:e._options,defaults:e._defaults,roles:Iw,superworkflow:e})}_initProperties(e){super._initProperties(e),this._superworkflow=e.superworkflow}_initSession(){}_doLoading(e){const{session:t}=this;this.updateData({...e,session:t})}_queryWithQuestionId(e){const{session:t}=this,{request:n,value:i}=e;this.updateData({...e,session:t});const{question_id:r}=i;if(!r)return;const o={...n.payload,question_id:r};o.metadata.page!==void 0&&delete o.metadata.page,this._hub.update(Li(),{...n,payload:o,session:t})}_defaultProcessData(e,t){return e=super._defaultProcessData(e,t),e=pl(e),e=Bb(e),e=nw(e),e}_handleHeadResponse(e){super._handleHeadResponse(e),dl(e)}_onTracker(e){this._superworkflow._onTracker(e)}}const xw=oe.ROLES_OPTIONS.members;function Rw(s){return xw.includes(s)?"results":"answer"}class $w{constructor(e){this._subviews=e,this._containers=new Set}get filters(){return this._subviews.results.filters}get(e){return this._getSubviews(e).get(e)}addContainer(e){if(this._containers.has(e))return;this._containers.add(e);const{components:t}=e;for(const n of t)this.addComponent(n)}removeContainer(e){for(const t of this._getAllSubviews())t.removeContainer(e);this._containers.delete(e)}addComponent(e){this._getViewByElement(e).element=e,this._addContainerToSubviews(e._container,e)}removeComponent(e){this._getViewByElement(e).element=void 0,this._removeContainerFromSubviewsIfNecessary(e._container)}updateComponentRole(e,t,n){}refreshElement(e){const t=e.isContainer?this._containers.get(e):this._getViewByElement(e);t&&t.refresh({force:!0})}_getAllSubviews(){return Object.values(this._subviews)}_getSubviews(e){return this._subviews[Rw(e)]}_getViewByElement(e){let{role:t}=e;if(!t)throw new Error("Component must have a role");return this.get(t)}_addContainerToSubviews(e,t){if(!e)return;const{role:n}=t,i=this._getSubviews(n);if(!i._containers.has(e)){for(const r of this._getAllSubviews())if(r!==i&&r._containers.has(e)){for(const o of e.components)if(r.containsElement(o))throw new Error(`<${e.tagName.toLowerCase()}> cannot contain both <${o.tagName.toLowerCase()}> and <${t.tagName.toLowerCase()}>, for they don't share the same data lifecycle.`);throw new Error(`Failed to add container <${e.tagName.toLowerCase()}> with child component <${t.tagName.toLowerCase()}>.`)}i.addContainer(e)}}_removeContainerFromSubviewsIfNecessary(e){if(!(!e||e.components.length>0))for(const t of this._getAllSubviews())t.removeContainer(e)}}const kw=Object.freeze({members:[]});function Pw({layouts:s,trackers:e,...t}={}){return{active:!1,...t,layouts:{},trackers:{}}}function Nw(s,e){return En(s)===En(e)}function En(s){return s&&s.value&&s.value.trim()||void 0}class Lw extends W{constructor(e,{defaults:t,...n}={}){super({name:"autocomplete",plugin:e._plugin,client:e._client,defaults:Pw(t),roles:kw,superworkflow:e,...n})}_initProperties(e){super._initProperties(e),this._superworkflow=e.superworkflow,this._active=e.defaults.active}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,e.superworkflow._hub.on(Yc(),t=>this._query(t))]}get enabled(){return this._active}enable(){this._active=!0}disable(){this._active=!1}_query(e){if(!this._active||Nw(e,this._args))return;this._args=e,this.restart();const{session:t}=this;if(t.meta.input=e,!En(e)){this._updateCompletions({session:t,status:C.INITIAL});return}const n=this._buildPayload(e);this._request({payload:n})}_buildPayload(e){return{q:En(e)}}_updateDataInHub(e){e.value&&(e={...e,value:e.value.completions}),this._updateCompletions(e)}_updateCompletions(e){this._superworkflow.updateCompletions(e)}}function Ll(s){ps(s,Uw.prototype)}class Uw{_initAutocomplete(e){this._autocomplete=new Lw(this,{defaults:e.defaults.autocomplete})}get autocomplete(){return this._autocomplete}updateCompletions(e){return this._hub.update(Ni(),e),this}_destroyAutocomplete(){this._autocomplete&&this._autocomplete._destroy(),this._autocomplete=void 0}}const Dw=Object.freeze({group:te.ASK,name:Se.SEARCH,payload:{...se.DEFAULT_API_OPTIONS.payload,...oe.DEFAULT_API_OPTIONS.payload,source_fl:["cover_image","url","created_at","updated_at","published_at","title","authors"]}}),Ul=Object.freeze({...se.DEFAULT_LAYOUTS,...oe.DEFAULT_LAYOUTS,[d.QUERY]:[Gt.type,{placeholder:""}],[d.QUESTION]:[Es.type,{raw:!0}],[d.SOURCES]:[Iu.type,{incremental:!0,itemType:"article",templates:{ordered:!0,article:cu,articleInfoBlock:Hi}}]}),Fw=Object.freeze({...se.DEFAULT_TRACKERS,...oe.DEFAULT_TRACKERS}),Mw=Object.freeze({...oe.DEFAULT_PAGINATION,active:!0}),jw=Object.freeze({api:{group:te.ASK,name:Se.SEARCH_AUTOCOMPLETE,payload:{completion_fields:["suggested_queries"]}}}),qw=Object.freeze({sort:{options:[{field:"relevance",text:"Relevance",default:!0},{field:"published_at",text:"Date"}]}}),Bw=Object.freeze({...se.DEFAULT_OPTIONS,...oe.DEFAULT_OPTIONS,api:Dw,layouts:Ul,trackers:Fw,autocomplete:jw,pagination:Mw,filters:qw}),zw=Object.freeze({main:d.PRODUCTS,members:Object.keys(Ul),mappings:Object.freeze({...se.ROLES_OPTIONS.mappings,...oe.ROLES_OPTIONS.mappings})}),Hw=Object.freeze({api:Object.freeze({polling:!1})});class ir extends oe{constructor(e,t){super({name:"hybrid-search",plugin:e,client:t,roles:zw,defaults:Bw,extraOptions:Hw})}_initProperties(e){super._initProperties(e),this._initAutocomplete(e),this._answer=new Cw(this)}_initActors(e){super._initActors(e),this._views=new $w({results:this._views,answer:this._answer._views})}restart({type:e}={}){super.restart(),(!e||e===lt.QUERY)&&this._answer.restart()}get answer(){return this._answer}get questionId(){return this._answer.questionId}_buildPayload(e,t){return e=super._buildPayload(e,t),e=Db(e,t),e=hl(e),e=this._writeQuestionIdToPayload(e,t),e.answer!==!1&&(e=se.prototype._writeWikiLinkTemplateToPayload.call(this,e)),e}_buildOrderBy(e){if(e)return e.field}_writeQuestionIdToPayload(e,t){if(t===lt.QUERY)return e;const n=this._answer.questionId;return n?ln(e,{metadata:{question_id:n}}):e}_defaultProcessData(e,t){return e=super._defaultProcessData(e,t),dl(e),e}_updateDataInHub(e,t){this._dispatchDataToAnswerWorkflow(e),e=Vb(e,t),super._updateDataInHub(e,t)}_dispatchDataToAnswerWorkflow(e){const{request:t}=e;if(!t)return;const{type:n,payload:i}=t;if(!(n!==lt.QUERY||!i||i.answer===!1))switch(e.status){case C.LOADING:this._answer._doLoading(e);break;case C.READY:this._answer._queryWithQuestionId(e);break}}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=ml(e,t),e}_destroy(){this._answer.destroy(),super._destroy()}}ws(ir.prototype,[ee.PAGINATION,ee.FILTERS]),Ll(ir.prototype);const Gw=Object.freeze({group:te.SEARCH,name:Se.SEARCH,payload:{fl:["*"]}}),Qw=Object.freeze({api:{group:te.SEARCH,name:Se.AUTOCOMPLETE,payload:{completion_fields:["suggested_queries","title"],fl:["title","url","cover_image"]}}}),Ww=Object.freeze({...oe.DEFAULT_LAYOUTS}),Vw=Object.freeze({...oe.DEFAULT_TRACKERS}),Kw=Object.freeze({...oe.DEFAULT_OPTIONS,api:Gw,autocomplete:Qw,layouts:Ww,trackers:Vw}),Yw=oe.ROLES_OPTIONS;class Dl extends oe{constructor(e,t){super({name:"search",plugin:e,client:t,roles:Yw,defaults:Kw})}_initProperties(e){super._initProperties(e),this._initAutocomplete(e)}notifyViewUpdate(e=d.PRODUCTS,...t){return super.notifyViewUpdate(e,...t),this}_destroy(e){this._destroyAutocomplete(),super._destroy(e)}}Ll(Dl.prototype);class Fl extends Pi{constructor(e,t,n){super(e,t,n),this._members=new Map}workflows(){return[...this._members.values()]}create(e=ki){if(this._members.has(e))throw new Error(`Unit already exists: ${e}`);return this._create(e)}has(e=ki){return this._members.has(e)}get(e=ki){if(typeof e!="string")throw new Error(`Required unit ID to be a string: ${e}`);return this._members.get(e)||this._create(e)}_create(e){throw new Error("Not implemented")}}class me extends W{_initProperties(e){super._initProperties(e);const{id:t}=e;G(this,{id:t})}_initSession(e){this._context._members.set(e.id,this),super._initSession(e)}_defaultProcessInteraction(e,t){return e=super._defaultProcessInteraction(e,t),e=this._writeUnitIdToInteraction(e,t),e}_writeUnitIdToInteraction(e){const t=this.id,n=this.uuid;return Oe(e,{context:{custom_context:{unit_id:t,unit_instance_uuid:n}}})}_destroy(e){this._context._members.delete(this.id),super._destroy(e)}}Object.assign(me,{DEFAULT_API_OPTIONS:W.DEFAULT_API_OPTIONS,DEFAULT_LAYOUTS:W.DEFAULT_LAYOUTS,DEFAULT_TRACKERS:W.DEFAULT_TRACKERS,DEFAULT_OPTIONS:W.DEFAULT_OPTIONS,ROLES_OPTIONS:W.ROLES_OPTIONS});const Zw=Object.freeze({...me.DEFAULT_API_OPTIONS,group:te.RECOMMENDATION,name:Se.USER_TO_PRODUCTS,payload:{...me.DEFAULT_API_OPTIONS.payload,fl:["*"]}}),Ml=Object.freeze({...me.DEFAULT_LAYOUTS,[d.PRODUCTS]:zt.type}),Jw=Object.freeze({...me.DEFAULT_TRACKERS,[d.PRODUCTS]:Ae}),Xw=Object.freeze({...me.DEFAULT_OPTIONS,api:Zw,layouts:Ml,trackers:Jw}),ey=bs(me.ROLES_OPTIONS,{main:d.PRODUCTS,members:Object.keys(Ml)});class ty extends me{constructor(e,t){super({name:"recommendation",context:e,roles:ey,defaults:Xw,id:t})}start(){return this._request(),this}notifyViewUpdate(e=d.PRODUCTS,...t){return super.notifyViewUpdate(e,...t),this}}class sy extends Fl{constructor(e,t){super("recommendations",e,t)}_create(e){return new ty(this,e)}}const ny=Object.freeze({...me.DEFAULT_API_OPTIONS,group:te.ASK,name:Se.RELATED_QUESTIONS}),jl=Object.freeze({...me.DEFAULT_LAYOUTS,[d.RELATED_QUESTIONS]:[zt.type,{itemType:"question",link:{rel:"noopener nofollow"}}],[d.QUERY]:[Gt.type,{placeholder:"Ask a question"}]}),iy=Object.freeze({...me.DEFAULT_TRACKERS,[d.RELATED_QUESTIONS]:Ae,[d.CONTAINER]:{...Ae,itemless:!0},[d.QUERY]:{[fe.SUBMIT]:{active:!0}}}),ry=Object.freeze({...me.DEFAULT_OPTIONS,api:ny,layouts:jl,trackers:iy}),oy=bs(me.ROLES_OPTIONS,{main:d.RELATED_QUESTIONS,members:Object.keys(jl)});class ql extends me{constructor(e,t){super({name:"explore",context:e,roles:oy,defaults:ry,id:t})}_initProperties(e){super._initProperties(e),this._productId=void 0,this._linkFn=void 0}_initSubscriptions(e){super._initSubscriptions(e),this._unsubscribes=[...this._unsubscribes,this._views.get(d.RELATED_QUESTIONS).on("click",t=>this._handleRelatedQuestionClick(t)),this._hub.on(at(),t=>this._query(t))]}set productId(e){console.warning("DEPRECATED: use useApi() instead"),this.useApi({product_id:e})}useApi(...e){const t=(typeof e[0]=="object"?e[0]:e[1])||{},{product_id:n}=t;return n&&(this._productId=n),super.useApi(...e)}useLink(e,t){return er.prototype.useLink.call(this,e,t),t&&this.useLayouts({[d.RELATED_QUESTIONS]:{link:t}}),this}start({relatedQuestions:e=!0}={}){if(this._linkFn===void 0)throw new Error("Must define link mapping function with useLink(fn) before calling start()");if(e)this._request();else{const{session:t}=this;this.updateData({session:t,request:{},value:{related_questions:[]}})}return this}notifyViewUpdate(e=d.RELATED_QUESTIONS,...t){return super.notifyViewUpdate(e,...t),this}_defaultProcessData(e,t){return e=super._defaultProcessData(e,t),e=this._addUrlToRelatedQuestions(e),e}_addUrlToRelatedQuestions(e){const{value:t}=e;if(!t||!t.related_questions)return e;const n=this._linkFn&&this._linkFn[0],i=t.related_questions.map(n?(r=>({text:r,url:this._getSubmitUrl({q:r,generated:!0})})):(r=>({text:r})));return{...e,value:{...t,related_questions:i}}}_handleRelatedQuestionClick({value:e,...t}){this._events.emit("select",Object.freeze({...t,question:e}))}query(e){if(!e.q)throw new Error("q is required in query() call");this._hub.update(at(),e)}_query(e){this._submitToPage({...e,generated:!1})}_getSubmitUrl(e){let t=er.prototype._getSubmitUrl.call(this,e);return!e.generated||!this._productId?t:`${t}&qs=${encodeURIComponent(this._productId)}`}}Xi(ql.prototype);class cy extends Fl{constructor(e,t){super("explores",e,t)}_create(e){return new ql(this,e)}}let uy=class extends pe{constructor({name:e,plugin:t,MisoClient:n,...i}){super(e||"combo",t),this._name=e,this._plugin=t,this._MisoClient=n,this._options=i}get MisoClient(){return this._MisoClient}get element(){return this._element}async waitForElement(){return this._element||(this._elementRes||(this._elementRes=new Je)).promise}set element(e){this._element=e,this._elementRes&&this._elementRes.resolve(e)}start(e){this._started||(this._started=!0,e&&this.config(e),this._start())}_start(){throw new Error("Unimplemented")}};function ly(s,e,t){if(!s)throw new Error("client is required");ay(s,t),fy(e)}function ay(s,{template:e=yn,...t}={}){if(typeof e!="function")throw new Error("template must be a function or undefined");const n=Object.keys(t).length>0;e===yn&&!n||s.ui.asks.useTemplates({followUp:n?i=>e({...t,...i}):e})}function fy(s){if(!s||s.tagName.toLowerCase()==="miso-follow-ups")return;const e=document.createElement("miso-follow-ups");for(const{name:t,value:n}of s.attributes)e.setAttribute(t,n);s.parentNode.replaceChild(e,s)}function hy(s,e){if(!s)throw new Error("client is required");if(e)for(const t of e.querySelectorAll("miso-ask"))t.setAttribute("workflow","active")}const Bl=Object.freeze(Ol),_y=Object.freeze(Al),zl=Object.freeze(mw),dy=Object.freeze(Object.defineProperty({__proto__:null,constants:Bl,phrases:_y,templates:zl,wireFollowUps:ly,wireRelatedResources:hy},Symbol.toStringTag,{value:"Module"})),{currentScript:rr}=document,py=Object.freeze({templates:zl,autostart:!0}),my=["templates","phrases","features"];class gy{constructor(){this._defaults=py,this._scriptSrc=yy(),this._pageUrl=Ey()}resolve(e){return wy(Hl(this._defaults,this._scriptSrc,e,this._pageUrl))}}function Hl(...s){let e={};for(const t of s)t&&(e=by(e,t));return e}function by(s,e){if(!e)return s;Object.assign(s,e);for(const t of my)t in e&&(s[t]={...s[t],...e[t]});return s}function wy({api_key:s,api_host:e,templates:t,phrases:n,...i}={}){return L({apiKey:s,apiHost:e,templates:or(t),phrases:n,...i})}function yy(){if(!rr||!rr.src)return{};const s=document.createElement("a");s.href=rr.src;const e={};for(const[t,n]of new URLSearchParams(s.search))t!=="q"&&(e[t]=Gl(n));return e}function Ey(){const s={};for(const[e,t]of new URLSearchParams(window.location.search))e.startsWith("miso_")&&e.length>5&&e!=="miso_api_key"?s[e.substring(5)]=Gl(t):e==="q"&&(s.q=t);return s}function Gl(s){return s===""?!0:s==="false"?!1:s}function or(s){if(s==null)return s;switch(typeof s){case"function":return s;case"string":case"number":return()=>s;case"object":return Array.isArray(s)?s.map(or):Ty(s,or);default:throw new Error(`Unsupported template type: ${s}`)}}function Ty(s,e){const t={};for(const[n,i]of Object.entries(s))t[n]=e(i);return t}class Sy{constructor(e,{classPrefix:t=Bl.CLASS_PREFIX}={}){if(!e)throw new Error("Root element is required");G(this,{root:e,followUpsSection:e.querySelector(`.${t}__follow-ups`),relatedResourcesSection:e.querySelector(`.${t}__related-resources`),relatedResourcesContainer:e.querySelector(`.${t}__related-resources miso-ask`)})}}class Oy extends uy{constructor(e,t){super({name:"ask-combo",plugin:e,MisoClient:t}),this._options=new gy,this._localOptions={}}config(e={}){e=Hl(this._localOptions,e);const t=this._options.resolve(e);return this._localOptions=e,this._resolvedOptions=t,this}get resolvedOptions(){return this._resolvedOptions||(this._resolvedOptions=this._options.resolve(this._localOptions))}get client(){return this._client}get elements(){return this._elements}autoStart(){this.resolvedOptions.autostart&&this.start()}async _start(){await o_(),await this.waitForElement(),await this._setupMisoClient(),this._renderRootContent(),this._createClientInstance(),this._setupWorkflows()}async _setupMisoClient(){const{MisoClient:e,resolvedOptions:t}=this,{version:n}=e;G(e,{name:"miso-ask-combo"}),(n==="dev"||n.indexOf("beta")>0||t.debug)&&e.plugins.use("std:debug"),t.dry_run&&e.plugins.use("std:dry-run"),t.lorem&&await e.plugins.install("std:lorem")}_renderRootContent(){const{element:e,resolvedOptions:t}=this,{templates:n={}}=t;e.innerHTML=n.root(t),this._elements=new Sy(e,t)}async _createClientInstance(){this._client=new MisoClient(this.resolvedOptions)}async _setupWorkflows(){const{MisoClient:e,client:t,elements:n,resolvedOptions:i}=this,{wireFollowUps:r,wireRelatedResources:o}=e.ui.defaults.ask,{templates:c={},features:u={},api:h}=i,a=t.ui.asks,_=t.ui.ask;h&&a.useApi(h),u.followUpQuestions!==!1&&r(t,n.followUpsSection,{...i,template:c.followUp}),u.relatedResources!==!1&&u.followUpQuestions!==!1&&o(t,n.relatedResourcesSection),_.autoQuery()}}class Ay extends cc{constructor(e){super("layouts",e,{libName:"layout",keyName:t=>t.type}),this._plugin=e}get(e){return this._libraries[e]}create(e,t){if(e!==!1)switch(typeof e){case"function":return{render:e};case"string":const n=this.get(e);if(!n)throw new Error(`Layout of name '${e}' not found.`);return new n(t);default:throw new Error(`Expect a string, a render function, or boolean value false: ${e}`)}}}const vy="miso-stub",cr="trait",Iy=Object.freeze([cr]);class Ot extends HTMLElement{static get tagName(){return vy}static get observedAttributes(){return Iy}constructor(){super(),this._traits=[]}connectedCallback(){this._syncTraits()}disconnectedCallback(){for(const e of this._traits)this._destroyTrait(e);this._traits=[]}attributeChangedCallback(e){switch(e){case cr:this._syncTraits();break}}_syncTraits(){const e=(this.getAttribute(cr)||"").split(/\s+/).filter(Boolean),t=[];for(const n of this._traits)e.includes(n.constructor.traitName)?t.push(n):this._destroyTrait(n);if(e.length>0){const n=Cy(Ot.MisoClient);for(const i of e){if(this._traits.find(c=>c.constructor.traitName===i))continue;const r=n[i];if(!r){console.warn(`Unknown trait: ${i}`);continue}const o=new r(this);t.push(o)}}this._traits=t}_destroyTrait(e){try{e._destroy&&e._destroy()}catch(t){console.error(t)}}}function Cy(s){const e=s.ui&&s.ui.traits||{};return Object.values(e).reduce((t,n)=>(t[n.traitName]=n,t),{})}let Ql,ur,Tn;async function Wl(s){const e=await xy(s);return ur=ur||e.any(),Tn=Tn||await ur,Tn.ui||await ky(0),Tn}async function xy(s){return s.MisoClient||window.MisoClient||Ql||(Ql=Ry())}async function Ry(){return new Promise(s=>{(window.misocmd||(window.misocmd=[])).push(()=>s(window.MisoClient))})}function $y(s){for(let e=s;e;e=e.parentNode)if(e.isContainer)return e;throw new Error(`${s.tagName} needs to be placed under a workflow container element.`)}function ky(s){return new Promise(e=>setTimeout(e,s))}const Os="logo",Vl="auto",Py=Object.freeze([...Ot.observedAttributes,Os]);function lr(s){if(!s)return Vl;switch(s){case"true":return!0;case"false":return!1;default:throw new Error(`Invalid logo attribute value: ${s}.`)}}function Ny(s){switch(s){case Vl:return;case!0:return"true";case!1:return"false";default:throw new Error(`Invalid logo property value: ${s}.`)}}class $e extends Ot{static get observedAttributes(){return Py}constructor(){super(),this._workflow=void 0,this._components=new Set}get isContainer(){return!0}get workflow(){return this._workflow}set workflow(e){this._setWorkflow(e)}get logo(){return lr(this.getAttribute(Os))}set logo(e){if(this.logo===e)return;const t=Ny(e);t?this.setAttribute(Os,t):this.removeAttribute(Os)}async connectedCallback(){super.connectedCallback();const e=this._client=await Wl($e);document.body.contains(this)&&(this._setWorkflow(this._getWorkflow(e)),this._onConnected(e))}disconnectedCallback(){this._setWorkflow(void 0),super.disconnectedCallback()}_onConnected(e){}_getWorkflow(e){throw new Error("Unimplemented")}_setWorkflow(e){this._workflow!==e&&(this._workflow&&this._workflow._views.removeContainer(this),e&&e._views.addContainer(this),this._workflow=e)}attributeChangedCallback(e,t,n){switch(e){case Os:this._handleLogoUpdate(t,n);break;default:super.attributeChangedCallback(e,t,n)}}_handleLogoUpdate(e,t){const n=lr(e),i=lr(t);n===i||!this._workflow||this._workflow._views.refreshElement(this)}get components(){return[...this._components]}_addComponent(e){this._components.has(e)||(this._components.add(e),this._workflow&&this._workflow._views.addComponent(e))}_removeComponent(e){this._components.has(e)&&(this._workflow&&this._workflow._views.removeComponent(e),this._components.delete(e))}_updateComponentRole(e,t,n){this._workflow&&this._workflow._views.updateComponentRole(e,t,n)}}const Ly="miso-ask",ar="workflow",As="parent-question-id",Uy=Object.freeze([...$e.observedAttributes,ar,As]);class Dy extends $e{static get tagName(){return Ly}static get observedAttributes(){return Uy}_getWorkflow(e){return this.boundToActiveWorkflow?e.ui.asks.active:this._getWorkflowByParentQuestionId(e,this.parentQuestionId)}_getWorkflowByParentQuestionId(e,t){return e.ui.asks.getByParentQuestionId(t,{autoCreate:!0})}get parentQuestionId(){return this.getAttribute(As)||void 0}set parentQuestionId(e){e=e!==void 0?`${e}`:void 0,e!==this.parentQuestionId&&(e?this.setAttribute(As,e):this.removeAttribute(As))}get boundToActiveWorkflow(){return this.getAttribute(ar)==="active"}_setWorkflow(e){this._workflow!==e&&(super._setWorkflow(e),e&&(this.parentQuestionId=e.parentQuestionId))}async connectedCallback(){if(await super.connectedCallback(),document.body.contains(this)){const e=this._client.ui.asks;this._unsubscribes=[...this._unsubscribes||[],e.on("active",t=>{this.boundToActiveWorkflow&&(this.workflow=t.workflow)})]}}disconnectedCallback(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[],super.disconnectedCallback()}attributeChangedCallback(e,t,n){switch(e){case As:this._handleParentQuestionIdUpdate(t,n);break;case ar:this._handleQuestionUpdate(t,n);break;default:super.attributeChangedCallback(e,t,n)}}_handleQuestionUpdate(e,t){e=e||void 0,t=t||void 0,!(e===t||!this._client)&&t===ATTR_VALUE_ACTIVE&&this._setWorkflow(this._getWorkflow(this._client))}_handleParentQuestionIdUpdate(e,t){e=e||void 0,t=t||void 0,!(e===t||!this._client)&&this._setWorkflow(this._getWorkflowByParentQuestionId(this._client,t))}}const vs="unit-id",Fy=Object.freeze([...$e.observedAttributes,vs]);class Sn extends $e{static get observedAttributes(){return Fy}_getWorkflow(e){return this._getWorkflowByUnitId(e,this.unitId)}_getWorkflowByUnitId(e,t){throw new Error("Not implemented")}get unitId(){return this.getAttribute(vs)||void 0}set unitId(e){e=e&&`${e}`,e?this.setAttribute(vs,e):this.removeAttribute(vs)}attributeChangedCallback(e,t,n){switch(e){case vs:this._handleUnitIdUpdate(t,n);break;default:super.attributeChangedCallback(e,t,n)}}_handleUnitIdUpdate(e,t){e===t||!this._client||this._setWorkflow(this._getWorkflowByUnitId(this._client,t))}}const My="miso-explore";class jy extends Sn{static get tagName(){return My}static get observedAttributes(){return Sn.observedAttributes}_getWorkflowByUnitId(e,t){return e.ui.explores.get(t)}}const qy="miso-hybrid-search";class By extends $e{static get tagName(){return qy}static get observedAttributes(){return $e.observedAttributes}_getWorkflow(e){return e.ui.hybridSearch}}const zy="miso-search";class Hy extends $e{static get tagName(){return zy}static get observedAttributes(){return $e.observedAttributes}_getWorkflow(e){return e.ui.search}}const Gy="miso-recommendation";class Qy extends Sn{static get tagName(){return Gy}static get observedAttributes(){return Sn.observedAttributes}_getWorkflowByUnitId(e,t){return e.ui.recommendations.get(t)}}const Wy=Object.freeze(Object.defineProperty({__proto__:null,MisoAskElement:Dy,MisoExploreElement:jy,MisoHybridSearchElement:By,MisoRecommendationElement:Qy,MisoSearchElement:Hy},Symbol.toStringTag,{value:"Module"})),Vy="miso-component",Is="role",Ky=Object.freeze([Is]);class Z extends HTMLElement{static get tagName(){return Vy}static get observedAttributes(){return Ky}constructor({role:e}={}){super(),e&&Object.defineProperty(this,"_role",{value:e,writable:!1})}get role(){return this._role}connectedCallback(){const e=$y(this);this._container&&this._container!==e&&this._container._removeComponent(this),this._syncRole(),e._addComponent(this),this._container=e,this._containerResolution&&this._containerResolution.resolve(e)}_syncRole(){const e=this.getAttribute(Is);if(e)this._role?console.warn(`Element <${this.tagName}>' already has a predefined role '${this._role}', so attribute '${Is}="${e}"' is ignored.`):this._role=e;else{if(!this._role)throw new Error(`An attribute '${Is}' is required for element <${this.tagName}>`);return}}disconnectedCallback(){this._container&&(this._container._removeComponent(this),this._container=void 0,this._containerResolution=void 0)}attributeChangedCallback(e,t,n){t!==n&&e===Is&&this._container&&this._container._updateComponentRole(this,t,n)}}class Yy extends Z{constructor(){super({role:d.QUERY})}static get tagName(){return"miso-query"}}class Zy extends Z{constructor(){super({role:d.FOLLOW_UP_QUESTIONS})}static get tagName(){return"miso-follow-up-questions"}}class Jy extends Z{constructor(){super({role:d.QUERY_SUGGESTIONS})}static get tagName(){return"miso-query-suggestions"}}class Xy extends Z{constructor(){super({role:d.FEEDBACK})}static get tagName(){return"miso-feedback"}}class eE extends Z{constructor(){super({role:d.PRODUCTS})}connectedCallback(){console.warn("Element <miso-results> is deprecated. Please use <miso-products> instead."),super.connectedCallback()}static get tagName(){return"miso-results"}}class tE extends Z{constructor(){super({role:d.PRODUCTS})}static get tagName(){return"miso-products"}}class sE extends Z{constructor(){super({role:d.QUESTION})}static get tagName(){return"miso-question"}}class nE extends Z{constructor(){super({role:d.ANSWER})}static get tagName(){return"miso-answer"}}class iE extends Z{constructor(){super({role:d.REASONING})}static get tagName(){return"miso-reasoning"}}class rE extends Z{constructor(){super({role:d.SOURCES})}static get tagName(){return"miso-sources"}}class oE extends Z{constructor(){super({role:d.IMAGES})}static get tagName(){return"miso-images"}}class cE extends Z{constructor(){super({role:d.RELATED_RESOURCES})}static get tagName(){return"miso-related-resources"}}class uE extends Z{constructor(){super({role:d.RELATED_QUESTIONS})}static get tagName(){return"miso-related-questions"}}class lE extends Z{constructor(){super({role:d.AFFILIATION})}static get tagName(){return"miso-affiliation"}}class aE extends Z{constructor(){super({role:d.KEYWORDS})}static get tagName(){return"miso-keywords"}}class fE extends Z{constructor(){super({role:d.TOTAL})}static get tagName(){return"miso-total"}}class hE extends Z{constructor(){super({role:d.FACETS})}static get tagName(){return"miso-facets"}}class _E extends Z{constructor(){super({role:d.MORE})}static get tagName(){return"miso-more"}}class dE extends Z{constructor(){super({role:d.SORT})}static get tagName(){return"miso-sort"}}class pE extends Z{constructor(){super({role:d.ERROR})}static get tagName(){return"miso-error"}}const mE=Object.freeze(Object.defineProperty({__proto__:null,MisoAffiliationElement:lE,MisoAnswerElement:nE,MisoComponentElement:Z,MisoErrorElement:pE,MisoFacetsElement:hE,MisoFeedbackElement:Xy,MisoFollowUpQuestionsElement:Zy,MisoImagesElement:oE,MisoKeywordsElement:aE,MisoMoreElement:_E,MisoProductsElement:tE,MisoQueryElement:Yy,MisoQuerySuggestionsElement:Jy,MisoQuestionElement:sE,MisoReasoningElement:iE,MisoRelatedQuestionsElement:uE,MisoRelatedResourcesElement:cE,MisoResultsElement:eE,MisoSortElement:dE,MisoSourcesElement:rE,MisoTotalElement:fE},Symbol.toStringTag,{value:"Module"}));class Cs extends Ot{static get observedAttributes(){return Ot.observedAttributes}constructor(){super(),this._context=void 0}get context(){return this._context}set context(e){this._setContext(e)}async connectedCallback(){super.connectedCallback();const e=this._client=await Wl(Cs);document.body.contains(this)&&this._setContext(this._getContext(e))}disconnectedCallback(){this._setContext(void 0),super.disconnectedCallback()}_getContext(e){throw new Error("Unimplemented")}_setContext(e){if(this._context===e)return;const t=this._context;this._context=e,this._onContext(e,t)}_onContext(){}}const gE="miso-follow-ups";class bE extends Cs{static get tagName(){return gE}static get observedAttributes(){return Cs.observedAttributes}constructor(){super(),this._elementToWorkflow=new WeakMap,this._unsubscribes=[]}_getContext(e){return e.ui.asks}_onContext(e,t){e!==t&&(this._unwire(),this._wire(e))}_unwire(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[]}_wire(e){e&&(e._autoNextFn||e.autoNext(),this._unsubscribes.push(e.on("create",t=>{const{parentQuestionId:n}=t,i=t._options.resolved.templates.followUp;if(!n||!i)return;const r=this.children.length;this.insertAdjacentHTML("beforeend",i({parentQuestionId:n}));const o=this.children.length;for(const c of Array.prototype.slice.call(this.children,r,o))this._elementToWorkflow.set(c,t)})),this._unsubscribes.push(e.on("loading",({workflow:t})=>{for(const n of this.children)if(this._elementToWorkflow.get(n)===t){n.scrollIntoView({behavior:"smooth",block:"start"});break}})),this._unsubscribes.push(e.on("destroy",({workflow:t})=>{for(const n of this.children)this._elementToWorkflow.get(n)===t&&(this._elementToWorkflow.delete(n),n.remove())})))}}const wE=Object.freeze(Object.defineProperty({__proto__:null,MisoFollowUpsElement:bE},Symbol.toStringTag,{value:"Module"}));class On extends HTMLElement{constructor(){super()}async connectedCallback(){document.body.contains(this)&&this._setCombo(this._getCombo(On.MisoClient))}disconnectedCallback(){}_getCombo(e){throw new Error("Unimplemented")}_setCombo(e){this._combo!==e&&(this._combo=e,e.element=this,e.autoStart())}}const yE="miso-ask-combo";class EE extends On{static get tagName(){return yE}constructor(){super()}_getCombo(e){return e.ui.combo.ask}}const TE=Object.freeze(Object.defineProperty({__proto__:null,MisoBannerElement:gn,MisoStubElement:Ot,combos:Object.freeze(Object.defineProperty({__proto__:null,MisoAskComboElement:EE},Symbol.toStringTag,{value:"Module"})),containers:Wy,contexts:wE,roles:mE},Symbol.toStringTag,{value:"Module"})),Kl="miso-hybrid-search-combo",Yl=Object.freeze(Object.defineProperty({__proto__:null,CLASS_PREFIX:Kl,CONAINER_TAG:"miso-hybrid-search"},Symbol.toStringTag,{value:"Module"})),SE="You asked ${value}",OE="Sources",AE="You searched for ${value}",vE="${value} Results",Zl="Show more",Jl="Show less",Xl=Object.freeze(Object.defineProperty({__proto__:null,keywords:AE,question:SE,showLess:Jl,showMore:Zl,sources:OE,total:vE},Symbol.toStringTag,{value:"Module"}));class IE extends vl{constructor(){super({helpers:An})}answer(e){const{container:t}=this._helpers;return t(e,{name:"answer",visibleWhen:"ready !unanswerable"},[...this.question(e),"<miso-answer></miso-answer>","<miso-feedback></miso-feedback>"])}answerBox(e){const{element:t}=this._helpers,{classPrefix:n}=e;return t("div",{classes:[`${n}__answer-box`]},[t("div",{classes:[`${n}__answer-box-inner`]},this.answerGroup(e)),this.answerBoxToggle(e)])}question(e){const{phrase:t}=this._helpers;return t(e,{name:"question",tag:"div"}).replaceAll("${value}","<miso-question></miso-question>")}answerBoxToggle(e){const{element:t}=this._helpers,{classPrefix:n}=e;return t("div",{classes:[`${n}__answer-box-toggle-container`]},[t("div",{classes:[`${n}__answer-box-toggle`],"data-role":"answer-box-toggle"})])}searchResultsGroup(e){const{container:t}=this._helpers;return t(e,{name:"search-results",visibleWhen:"loading ready"},[this.searchResultsInfoGroup(e),this.searchResultsFilters(e),"<miso-products></miso-products>",this.more(e)])}searchResultsInfoGroup(e){const{element:t}=this._helpers,{classPrefix:n}=e;return t("div",{classes:[`${n}__search-results-info`]},[this.keywords(e),this.total(e)])}searchResultsFilters(e){const{element:t}=this._helpers,{classPrefix:n}=e;return t("div",{classes:[`${n}__search-results-filters`]},["<miso-facets></miso-facets>","<miso-sort></miso-sort>"])}keywords(e){const{phrase:t}=this._helpers;return t(e,{name:"keywords",tag:"div",inline:!0}).replaceAll("${value}","<miso-keywords></miso-keywords>")}total(e){const{phrase:t}=this._helpers;return t(e,{name:"total",tag:"div",inline:!0}).replaceAll("${value}","<miso-total></miso-total>")}more(e){if(!e.moreButton)return"";const{element:t}=this._helpers,{classPrefix:n}=e;return t("div",{classes:[`${n}__search-results-more-container`]},["<miso-more></miso-more>"])}}const An=un(new Il({...Yl,DEFAULT_PHRASES:Xl})),ea=un(new IE({helpers:An}));function CE(s={}){const{normalizeOptions:e,section:t,container:n}=An;s=e(s);const{answerBox:i,answerGroup:r,searchResultsGroup:o}=ea,{answerBox:c=!1}=s;return[t(s,{name:"question"},[n(s,{name:"query"},"<miso-query></miso-query>")]),t(s,{name:"answer"},c?[i(s)]:r(s)),t(s,{name:"search-results"},o(s))].join("")}const xE=Object.freeze(Object.defineProperty({__proto__:null,helpers:An,root:CE,sections:ea},Symbol.toStringTag,{value:"Module"})),xs="answer-box-open",vn="answer-box-shown",ta='[data-role="answer-box-toggle"]';class fr{constructor(e,t,{classPrefix:n=Kl,phrases:i={},hideWhenUnanswerable:r=!0}={}){this._client=e,this._workflow=e.ui.hybridSearch,this._element=t,this._classPrefix=n,this._phrases=i,this._hideWhenUnanswerable=r,this._init()}_init(){const e=this._element,t=this._workflow;t.answerBox=this,t._unsubscribes.push(()=>{t.answerBox===this&&(this.destroy(),t.answerBox=void 0)});const n=i=>this._handleClick(i);e.addEventListener("click",n),this._syncWofkflowStatus(),this._syncButtonText(),this._unsubscribes=[()=>e.removeEventListener("click",n),t._answer._hub.on(re(),()=>this._syncWofkflowStatus())]}_handleClick({target:e,button:t}){t===0&&e.closest(ta)&&this.toggleOpen()}_syncWofkflowStatus(){const{status:e}=this._workflow._answer,{meta:{unanswerable:t=!1}={}}=this._workflow._answer._hub.states[re()];switch(e){case C.ERRONEOUS:case C.READY:t&&this._hideWhenUnanswerable?this.hide():this.show();break;default:this.hide()}}_updateBoxStatus(e,t){this._element.classList[e](`${this._classPrefix}__${t}`)}_syncButtonText(){const e=this.isOpen?this._phrases.showLess||Jl:this._phrases.showMore||Zl;for(const t of this._element.querySelectorAll(ta))t.textContent=e}_syncScroll(){this.isOpen||this._element.scrollIntoView({behavior:"smooth"})}destroy(){for(const t of this._unsubscribes)t();const e=this._workflow;e&&e.answerBox===this&&delete e.answerBox}}const RE={isOpen:xs,shown:vn},$E={toggleOpen:["toggle",xs],open:["add",xs],close:["remove",xs],toggleHidden:["toggle",vn],show:["add",vn],hide:["remove",vn]};for(const[s,e]of Object.entries(RE))Object.defineProperty(fr.prototype,s,{get(){return this._element.classList.contains(`${this._classPrefix}__${e}`)}});for(const[s,[e,t]]of Object.entries($E))fr.prototype[s]=function(){this._updateBoxStatus(e,t),t===xs&&(this._syncButtonText(),this._syncScroll())};function kE(s,e,t={}){if(!s)throw new Error("client is required");e&&new fr(s,e,t)}const PE=Object.freeze(Yl),NE=Object.freeze(Xl),LE=Object.freeze(xE),UE=Object.freeze(Object.defineProperty({__proto__:null,constants:PE,phrases:NE,templates:LE,wireAnswerBox:kE},Symbol.toStringTag,{value:"Module"})),DE=Object.freeze(dy),FE=Object.freeze(UE),ME=Object.freeze(Object.defineProperty({__proto__:null,ask:DE,hybridSearch:FE},Symbol.toStringTag,{value:"Module"}));function jE(s,e){for(const t of e)Object.defineProperty(s,t,{get(){return this._element&&this._element.classList.contains(t)}})}function qE(s,e){for(const{action:t,classAction:n,className:i}of e)s[t]=function(){this._element&&this._element.classList[n](i),this[`_${t}`]&&this[`_${t}`]()}}function BE(s,e){s._handleClick=function(t){const{target:n,button:i}=t;if(i===0){for(let{role:r,selector:o,action:c}of e)if(o=o||`[data-role="${r}"]`,!!o&&n.closest(o)){this[c](),t.stopPropagation();return}}}}function zE(s){const e=s._element;if(!e)return()=>{};const t=n=>s._handleClick(n);return e.addEventListener("click",t),()=>e.removeEventListener("click",t)}const sa="miso-collapsible",hr="expanded",HE=[{action:"expand",classAction:"add",className:hr},{action:"collapse",classAction:"remove",className:hr}],GE=[{role:"expand",action:"expand"},{role:"collapse",action:"collapse"},{role:"toggle-expand",action:"toggle"}];class In{static get traitName(){return"collapsible"}constructor(e){this._element=e,e.collapsible=this,e.classList.add(sa),this._unsubscribes=[zE(this)]}_destroy(){for(const e of this._unsubscribes||[])e();this._unsubscribes=[],delete this._element.collapsible,this._element.classList.remove(sa),this._element=void 0}toggle(){this.expanded?this.collapse():this.expand()}}jE(In.prototype,[hr]),qE(In.prototype,HE),BE(In.prototype,GE);const QE=Object.freeze(Object.defineProperty({__proto__:null,CollapsibleTrait:In},Symbol.toStringTag,{value:"Module"})),WE="ui";let na,ia;async function VE(){return ia||(ia=tc(KE()))}function KE(){return na||(na=sc(WE))}const YE="std:ui";class ZE extends pe{static get id(){return YE}constructor(){super("ui"),this.layouts=new Ay(this),this._recommendations=new WeakMap,this._explores=new WeakMap,this._asks=new WeakMap,this._extensions=new WeakMap,this._ready=new Je}async install(e,t){t.addSubtree(this),e.on("create",this._injectClient.bind(this));const n={defaults:ME,traits:QE};ct(n,this,["layouts","combo","ready"]),G(this,{MisoClient:e}),G(e,{ui:n}),this.combo=new eT(this,e);const i=Object.values(Rb).filter(m=>m.type);for(const m of i)m.MisoClient=e;for(const m of i)this.layouts.register(m);const{containers:r,roles:o,combos:c,contexts:u,...h}=TE,a=[...Object.values(c),...Object.values(u),...Object.values(r),...Object.values(o),...Object.values(h)],_=[$e,Cs,On];for(const m of[..._,...a])m.MisoClient=e;await VE();for(const m of a)r_(m);this._ready.resolve()}async requireExtension(e){switch(e){case"markdown":return await this.MisoClient.plugins.install("std:ui-markdown");default:throw new Error(`Unknown extension: ${e}`)}}get ready(){return Promise.all([this._ready.promise,MisoClient.any()]).then(()=>{})}_injectClient(e){G(e,{ui:new XE(this,e)})}_getExtensions(e){if(this._extensions.has(e))return this._extensions.get(e);const t=new JE(this,e);return this._extensions.set(e,t),t}_getRecommendations(e){let t=this._recommendations.get(e);return t||this._recommendations.set(e,t=new sy(this,e)),t}_getExplores(e){let t=this._explores.get(e);return t||this._explores.set(e,t=new cy(this,e)),t}_getAsks(e){let t=this._asks.get(e);return t||this._asks.set(e,t=new $l(this,e)),t}}class JE{constructor(e,t){this._plugin=e,this._client=t,this._contexts={}}async require(e){if(this._contexts[e])return this._contexts[e];const t=await this._plugin.requireExtension(e);return this._contexts[e]=t.getContext(this._client)}}class XE{constructor(e,t){this._plugin=e,this._client=t,G(this,{sources:{api:ru(t)}})}get recommendations(){return this._recommendations||(this._recommendations=this._plugin._getRecommendations(this._client))}get recommendation(){return this.recommendations.get()}get search(){return this._search||(this._search=new Dl(this._plugin,this._client))}get asks(){return this._asks||(this._asks=this._plugin._getAsks(this._client))}get ask(){return this.asks.root}get hybridSearch(){return this._hybridSearch||(this._hybridSearch=new ir(this._plugin,this._client))}get explores(){return this._explores||(this._explores=this._plugin._getExplores(this._client))}get explore(){return this.explores.get()}get ready(){return this._plugin._ready.promise}}class eT{constructor(e,t){this._plugin=e,this._MisoClient=t}get ask(){return this._ask||(this._ask=new Oy(this._plugin,this._MisoClient))}}qe.plugins.use(ZE);function tT(s){const e=[];function t(i){e.push(i)}ec("misodev",{transform:i=>()=>i({addCmdTransform:t})});const n=i=>{for(const r of e)i=r(i);return i};setTimeout(()=>{ec("misocmd",{transform:n}),s&&s()})}qe.attach(),tT(X_);const sT="oB6D6G5TNRmMlOatuPHxKAsWXatp5YBm32dJ2Oy6",nT="MisoCustomScript",ra="miso-answer-page",iT={id:"miso-ask-combo",class:"miso-ask-combo"},rT={__name:"App",props:{query:{type:String,required:!0}},setup(s){const e=s;return Jr(async()=>{const t=new qe(sT),n=t.ui.ask;await t.ui.ready;const r=qe.ui.defaults.ask.templates,o=document.querySelector("#miso-ask-combo");o.innerHTML=r.root(),n.query({q:e.query})}),(t,n)=>(th(),ih("div",iT))}};let Wt=null;const oa=s=>{Wt&&(Wt.unmount(),Wt=null);const e=document.getElementById(ra);return e?(Wt=Gh(rT,{query:s}),Wt.mount(e),Wt):(console.error(`[miso-investopedia-script] Can't find answer page element with id: ${ra}`),null)};typeof window<"u"&&(window[nT]={init:oa,setEventHooks:s=>{console.log("[miso-investopedia-script] setEventHooks",s)},renderAnswerPage:s=>{oa(s)}})})();
